try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.exchange.clients.owa2.client.desktop.viewmodels.js'] = (new Date()).getTime();
Type.registerNamespace("_i");_i.$1=function(){};_i.$1.get_$9jl=function(){return _fm.$B.$9("conversations_showdeleted.png")};_i.$1.get_$6KQ=function(){return _fm.$B.$9("conversations_hidedeleted.png")};_i.$1.get_$6lM=function(){return _fm.$B.$9("conversations_newestontop.png")};_i.$1.get_$94R=function(){return _fm.$B.$9("conversations_oldestontop.png")};_i.$1.get_$5KO=function(){return _fm.$B.$9("readingpane_off.png")};_i.$1.get_$9J9=function(){return _fm.$B.$9("readingpane_onbottom.png")};_i.$1.get_$6vn=function(){return _fm.$B.$9("readingpane_onright.png")};_i.$1.get_$A4N=function(){return _fm.$G.$9("alert-triangle-yellow","x18","owa","owa-color-neutral-yellow")};_i.$ID=function(n,t,i,r,u){this.$$d_$Dgi=Function.createDelegate(this,this.$Dgi);this.$$d_$Dgj=Function.createDelegate(this,this.$Dgj);this.$$d_$Dgg=Function.createDelegate(this,this.$Dgg);this.$$d_$Dgh=Function.createDelegate(this,this.$Dgh);this.$$d_$Dgb=Function.createDelegate(this,this.$Dgb);this.$$d_$Dge=Function.createDelegate(this,this.$Dge);this.$$d_$Dgf=Function.createDelegate(this,this.$Dgf);_i.$ID.initializeBase(this,[n]);this.$d=t;this.set_$kF(this.$2kt());this.$N=i;this.$2Y=r;this.$W2=!!u&&u.$2u("FolderBasedClutter")};_i.$ID.prototype={$W2:!1,$d:null,$3FL:!1,$2kI:!1,$3FM:!1,$Lb:null,$wa:1,$Nz:0,$10J:0,$27u:null,$3gX:!1,$2tt:0,$6MV:0,$3Kd:0,$na:0,$3Ka:0,$3Ke:0,$1CE:0,$1y1:null,$2M2:0,$2AI:null,$137:null,$4s9:0,$6M2:null,$N:null,$1oK:!1,$2Y:null,$1LU:!1,$6M5:!1,$1fj:!1,get_$2sh:function(){return 3},get_$8Vc:function(){return this.$d.get_$9K().get_$2VP()},set_$6yQ:function(n){if(n!==this.$2tt){this.$2tt=n;this.$4("ReportJunkOption")}return n},set_$kF:function(n){if(this.$Lb!==n){this.$Lb=n;this.$4("PivotOptions")}return n},set_$Gj:function(n){if(this.$Nz!==n){this.$Nz=n;this.$5F2();this.$4("PivotSelectedOptionIndex")}return n},set_$2us:function(n){if(this.$wa!==n){this.$wa=n;this.$4("SelectedPivot")}return n},set_$8Z0:function(n){if(n!==this.$3Kd){this.$3Kd=n;this.$4("ListViewMessageFormat")}return n},set_$323:function(n){this.$na=n;this.$4("AutoSelectFirstMessage");return n},set_$4W1:function(n){if(n!==this.$1CE){this.$1CE=n;this.$4("ConversationOrder")}this.$EUM(n);return n},set_$3jV:function(n){if(n!==this.$1y1){this.$1y1=n;this.$4("ConversationOrderImage")}return n},set_$8La:function(n){if(n!==this.$2M2){this.$2M2=n;this.$4("HideDeletedItemsOption")}this.$EXb(n);return n},set_$7Dx:function(n){if(n!==this.$2AI){this.$2AI=n;this.$4("ShowOrHideDeletedItemsImage")}return n},set_$8Yu:function(n){if(n!==this.$3Ka){this.$3Ka=n;this.$4("ListViewClutterOption")}return n},set_$8Z2:function(n){if(n!==this.$3Ke){this.$3Ke=n;this.$4("ListViewPreviewOption")}return n},set_$5KP:function(n){if(n!==this.$10J){this.$10J=n;this.$4("ReadingPanePositionOption")}this.$9hN(n);return n},set_$3U3:function(n){if(n!==this.$27u){this.$27u=n;this.$4("ReadingPanePositionImage")}return n},set_$7Uq:function(n){this.$3gX=n;this.$4("ApplyRPPositionToAllFolders");return n},set_$1Ec:function(n){if(n!==this.$1LU){this.$1LU=n;this.$4("IsOptimizedForAccessibility")}return n},get_$C0L:function(){return!this.$W2},get_$DaH:function(){var n=this;return function(t){n.$1oK||n.$DaG()}},get_$DQG:function(){var n=this;return function(t){n.$1oK||n.$DQF()}},get_$DaK:function(){var n=this;return function(t){n.$1oK||n.$DaJ()}},get_$DfD:function(){var n=this;return function(t){n.$1oK||n.$DfC()}},get_$DSt:function(){var n=this;return function(t){n.$1oK||n.$DSs()}},get_$DYD:function(){var n=this;return function(t){n.$1oK||n.$DYC()}},get_$DSC:function(){var n=this;return function(t){n.$1oK||n.$DSB()}},set_$Dmc:function(n){if(this.$1fj!==n){this.$1fj=n;this.$4("OwaLightEnabled");this.$4("OwaLightOptionDescription")}return n},get_$9DK:function(){return this.$1fj?_nbs.NonBootStrings.l_SettingsOwaLightOptionDescription_Text:_nbs.NonBootStrings.l_SettingsOwaLightOptionDisabled_Text},$EXU:function(n){n&&this.set_$Gj(2)},$E9:function(){this.$1oK=!0;this.$A5y();this.$137=this.$4mb();this.$4s9=this.$10J;this.$6M2=this.$d.get_$6o().$1be;this.$6M5=this.$1LU;this.$6MV=this.$2tt;this.$2kI=!1;this.$3FL=!1;this.$3FM=!1;this.set_$GX(1);this.$26Q=!1;this.$1oK=!1},$Az:function(){var n=this.$APX();var i=null;var r=null;this.set_$GX(3);if(this.$3gX){this.$d.get_$1j().set_$1nQ(this.$10J);var f=this.$d.get_$6o().$1be;for(var u in f){var t={key:u,value:f[u]};if(t.value.$MC!==3){t.value.set_$1A5(3);this.$d.get_$6o().$2BS(t.value)}}i=_h.$1z.$4VD(this.$d.get_$6o().get_$b1(),OwaApplication.$2B,this.$$d_$Dgf,this.$$d_$Dgb);_a.$i.$GY(this.$8GG())}else if(this.$4s9!==this.$10J){i=_h.$1z.$4VD(this.$d.get_$6o().get_$b1(),OwaApplication.$2B,this.$$d_$Dgf,this.$$d_$Dge);this.$2kI=!0;_a.$i.$GY(this.$8GG())}if(n){n.add_$2s(this.$$d_$Dgh);n.add_$2b(this.$$d_$Dgg);this.$n.$1U(n);this.$3FL=!0}this.$1fj&&!n&&this.$1LU!==this.$d.get_$1j().get_$1Ec()&&(r=this.$9P5());this.$6MV!==this.$2tt&&this.$EXF(this.$2tt);n||i||r||this.$5cr()},$Gd:function(){this.$9ON();this.$9OM();this.$9OO();SettingsPanelViewModelBase.prototype.$Gd.call(this)},$Dgh:function(n){var t=this.$4mb();if(this.$137.ConversationSortOrder!==t.ConversationSortOrder||this.$137.HideDeletedItems!==t.HideDeletedItems){this.$d.get_$1j().set_$eV(this.$1CE);this.$d.get_$1j().set_$rf(this.$2M2===1);this.$N.$1o(_y.$ws,new _y.$ws);this.$N.$1o(_h.$Pr,new _h.$Pr(9))}this.$W2&&!this.$d.get_$9K().get_$2UN()&&t.ShowInferenceUiElements&&this.$d.get_$9K().set_$2UN(!0);this.$3FL=!1;this.$1fj&&this.$1LU!==this.$d.get_$1j().get_$1Ec()&&this.$9P5();this.$5cr()},$Dgf:function(n){this.$2kI=!1;this.$5cr()},$Dgj:function(n){this.$3FM=!1;this.$5cr()},$Dgg:function(n){this.$3FL=!1;this.set_$GX(5);this.$9ON()},$Dge:function(n){this.$2kI=!1;this.set_$GX(5);this.$9OM()},$Dgb:function(n){this.$2kI=!1;this.set_$GX(5);this.$E3g()},$Dgi:function(n){this.$3FM=!1;this.set_$GX(5);this.$9OO()},$5cr:function(){var n=!this.$3FL&&!this.$2kI&&!this.$3FM;if(n){this.set_$GX(4);this.$26Q=!0;this.get_$gw()&&this.get_$gw()()}},$2kt:function(){var n=[];Array.add(n,new _ff.$4N(_nbs.NonBootStrings.l_ViewSettingsMessageListPivot_Text,1));Array.add(n,new _ff.$4N(_nbs.NonBootStrings.l_ViewSettingsConversationsPivot_Text,2));Array.add(n,new _ff.$4N(_nbs.NonBootStrings.l_ViewSettingsReadingPanePivot_Text,0));this.get_$8Vc()&&Array.add(n,new _ff.$4N(_nbs.NonBootStrings.l_JunkEmailSetting_Text,5));Array.add(n,new _ff.$4N(_nbs.NonBootStrings.l_ViewSettingsOwaVersionPivot_Text,4));return n},$5F2:function(){this.set_$2us(this.$Lb[this.$Nz].$1e)},$CDR:function(n){if(this.$137.ShowInferenceUiElements!==n.ShowInferenceUiElements){if(this.$d.get_$1j().get_$15P())this.$2Y.$9rM();else{this.$2Y.$9rL(2);this.$E26()}return!0}return this.$137.ShowSenderOnTopInListView!==n.ShowSenderOnTopInListView?!0:this.$137.ShowPreviewTextInListView!==n.ShowPreviewTextInListView?!0:this.$137.ConversationSortOrder!==n.ConversationSortOrder?!0:this.$137.HideDeletedItems!==n.HideDeletedItems?!0:this.$137.GlobalReadingPanePosition!==n.GlobalReadingPanePosition?!0:this.$137.ShowFirstMessageOnSignIn!==n.ShowFirstMessageOnSignIn?!0:!1},$4mb:function(){var n=new _g.$Op;n.ShowInferenceUiElements=!this.$3Ka;n.ShowSenderOnTopInListView=!this.$3Kd;n.ShowFirstMessageOnSignIn=!this.$na;n.ShowPreviewTextInListView=!this.$3Ke;n.ConversationSortOrder=this.$1CE;n.HideDeletedItems=this.$2M2===1;n.GlobalReadingPanePosition=this.$3gX?this.$10J:this.$d.get_$1j().get_$1nQ();return n},$A5k:function(n){this.$d.get_$1j().set_$15P(n.ShowInferenceUiElements);this.$d.get_$1j().set_$1OM(n.ShowSenderOnTopInListView);this.$d.get_$1j().set_$1OJ(n.ShowPreviewTextInListView);this.$d.get_$1j().set_$eV(n.ConversationSortOrder);this.$d.get_$1j().set_$rf(n.HideDeletedItems);this.$d.get_$1j().set_$1OL(n.ShowFirstMessageOnSignIn);this.$d.get_$1j().set_$1nQ(n.GlobalReadingPanePosition)},$A5y:function(){this.set_$8Yu(this.$d.get_$1j().get_$15P()?0:1);this.set_$8Z0(this.$d.get_$1j().get_$1OM()?0:1);this.set_$323(this.$d.get_$1j().get_$1OL()?0:1);this.set_$8Z2(this.$d.get_$1j().get_$1OJ()?0:1);this.set_$5KP(_y.$1O.$2jc(this.get_$11w(),this.$d));this.set_$7Uq(!1);(this.$d.get_$1j().get_$eV()==="ChronologicalNewestOnTop"||this.$d.get_$1j().get_$eV()==="ChronologicalNewestOnBottom")&&this.set_$4W1(this.$d.get_$1j().get_$eV());this.set_$8La(this.$d.get_$1j().get_$rf()?1:0);this.set_$1Ec(this.$d.get_$1j().get_$1Ec());this.set_$Dmc(this.$d.get_$9K().get_$6qu());this.$d.get_$1j().get_$gs()?this.set_$6yQ(this.$d.get_$1j().get_$mc()?1:2):this.set_$6yQ(0)},$EXF:function(n){switch(n){case 0:this.$d.get_$1j().set_$gs(!1);break;case 1:this.$d.get_$1j().set_$mc(!0);this.$d.get_$1j().set_$gs(!0);break;case 2:this.$d.get_$1j().set_$mc(!1);this.$d.get_$1j().set_$gs(!0);break}_h.$1z.$Kn(this.$d.get_$1j().$Hl,OwaApplication.$2B)},$9hN:function(n){switch(n){case 2:this.set_$3U3(_i.$1.get_$9J9());break;case 0:this.set_$3U3(_i.$1.get_$5KO());break;case 1:this.set_$3U3(_i.$1.get_$6vn());break}},$EUM:function(n){switch(n){case"ChronologicalNewestOnBottom":this.set_$3jV(_i.$1.get_$94R());break;case"ChronologicalNewestOnTop":this.set_$3jV(_i.$1.get_$6lM());break}},$EXb:function(n){switch(n){case 1:this.set_$7Dx(_i.$1.get_$6KQ());break;case 0:this.set_$7Dx(_i.$1.get_$9jl());break}},$DaG:function(){this.$d.get_$1j().set_$1OM(!this.$3Kd)},$DQF:function(){this.$d.get_$1j().set_$1OL(!this.$na)},$DaJ:function(){this.$d.get_$1j().set_$1OJ(!this.$3Ke)},$DfC:function(){this.$7Uo(this.$10J)},$7Uo:function(n){var t=this.$d.get_$6o().$f7(this.get_$11w());t.set_$1A5(n);this.$d.get_$6o().$2BS(t)},$APX:function(){var n=this.$4mb();return this.$CDR(n)?new _c.$pZ(n):null},$DSs:function(){this.$N.$1o(_y.$IZ,new _y.$IZ(this.$1CE,this.$2M2===1))},$DYC:function(){this.$N.$1o(_y.$IZ,new _y.$IZ(this.$1CE,this.$2M2===1))},$DSB:function(){this.$d.get_$1j().set_$15P(!this.$3Ka)},$E26:function(){this.$d.get_$1j().set_$3tH(!1);this.$d.get_$1j().set_$3tK(!1);this.$d.get_$1j().set_$3tI(!1);this.$d.get_$1j().set_$3tL(!1);this.$d.get_$1j().set_$3tJ(!1);this.$d.get_$1j().set_$3tM(!1);this.$d.get_$1j().set_$fV(this.$d.get_$1j().get_$fV()&-2);this.$d.get_$1j().set_$fV(this.$d.get_$1j().get_$fV()&-3);_h.$1z.$Kn(this.$d.get_$1j().$Hl,OwaApplication.$2B)},$9ON:function(){this.$A5k(this.$137);var n=this.$4mb();(this.$137.ConversationSortOrder!==n.ConversationSortOrder||this.$137.HideDeletedItems!==n.HideDeletedItems)&&this.$N.$1o(_y.$IZ,new _y.$IZ(this.$137.ConversationSortOrder,this.$137.HideDeletedItems))},$9OM:function(){this.$7Uo(this.$4s9)},$E3g:function(){var i=this.$6M2;for(var r in i){var n={key:r,value:i[r]};var t=this.$d.get_$6o().$1be[n.key];t.set_$1A5(n.value.$MC);this.$d.get_$6o().$2BS(t)}},$9OO:function(){this.$d.get_$1j().set_$1Ec(this.$6M5)},$9P5:function(){this.$d.get_$1j().set_$1Ec(this.$1LU);var n=_h.$1z.$4VD(this.$d.get_$1j().$Hl,OwaApplication.$2B,this.$$d_$Dgj,this.$$d_$Dgi);this.$3FM=!0;return n},$8GG:function(){var n=null;switch(this.$10J){case 0:n="VM.MailUsage.SetReadingPaneOff";break;case 1:n="VM.MailUsage.SetReadingPaneRight";break;case 2:n="VM.MailUsage.SetReadingPaneBottom";break}return n}};_i.$vV=function(n,t,i,r,u){this.$$d_$Hb=Function.createDelegate(this,this.$Hb);this.$$d_$5P=Function.createDelegate(this,this.$5P);this.$$d_$Gd=Function.createDelegate(this,this.$Gd);this.$$d_$6mV=Function.createDelegate(this,this.$6mV);_i.$vV.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;this.dispose=this.$1v;_i.$vV.initializeBase(this);_a.$4.$z(n,"eventAggregator");_a.$4.$z(t,"offlineBootStrapper");_a.$4.$z(i,"userAgent");_a.$4.$z(r,"bookmarker");this.$N=n;this.$I0=t;this.$1D=i;this.$qZ=r;this.$xF=u;this.$XG=new _C(this.$$d_$6mV,_a.$0.$L1);this.$8U=new _C(this.$$d_$Gd,_a.$0.$L1);this.$5a=new _C(this.$$d_$5P,_a.$0.$L1);this.$3Qm=new _C(this.$$d_$Hb,_a.$0.$L1);this.$H1=1;this.$346=0;this.$3tp=!1;this.$4GZ=!1;this.set_$8VF(!0)};_i.$vV.prototype={$1D:null,$qZ:null,$N:null,$I0:null,$xF:null,$DE:null,$48:null,$5a:null,$8U:null,$3Qm:null,$XG:null,$H1:0,$346:0,$3tp:!1,$4GZ:!1,$5Jq:!1,$4ww:!1,set_$8VF:function(n){if(this.$4ww!==n){this.$4ww=n;this.$4("IsProvisioning")}return n},get_$De:function(){return this.$1D.get_$De()},get_$A1B:function(){return this.$1D.get_$2Np()?_nbs.NonBootStrings.l_OfflineUserAddBookmark_Manual_Mac_Text:_nbs.NonBootStrings.l_OfflineUserAddBookmark_Manual_PC_Text},get_$CFl:function(){return this.$5Jq?_nbs.NonBootStrings.l_OfflineNotAvailable_Text:_nbs.NonBootStrings.l_OfflineSettingsDone_Text},set_$9jJ:function(n){if(this.$4GZ!==n){this.$4GZ=n;this.$4("ShowAbortProvisionInfo")}return n},set_$6Kc:function(n){if(this.$3tp!==n){this.$3tp=n;this.$4("HideNextButton")}return n},set_$AHF:function(n){if(this.$346!==n){this.$346=n;this.$4("ComputerPrivacyMode");this.$346===1?this.$9xw():this.$AIC()}return n},get_$5F:function(){return this.$48},set_$5F:function(n){this.$48=n;return n},get_$gw:function(){return this.$DE},set_$gw:function(n){this.$DE=n;return n},get_$7kt:function(){return!1},get_$3sq:function(){return null},get_$2sh:function(){return 3},get_$4Y3:function(){return this.$H1},set_$4Y3:function(n){if(this.$H1!==n){this.$H1=n;this.$H1===4&&this.set_$6Kc(!0);this.$4("CurrentStep");this.$4("StepInfo")}return n},get_$EiC:function(){return String.format(_nbs.NonBootStrings.l_StepInfo_Text,this.$H1,4)},$5P:function(){this.$DE();this.$N.$1o(_a.$PB,new _a.$PB);this.set_$8VF(!1)},$6mV:function(){_js.Trace.logInfo(_a.$0.$L1,"OfflineSettingProvision is invoking OK");this.$5P()},$Gd:function(){_js.Trace.logInfo(_a.$0.$L1,"OfflineSettingProvision is cancelling offline provision");this.$5P();if(this.$H1>1){this.$62U(!1);this.$I0.$6xq(_g.$1H.$1Q,window.location)}},$Hb:function(){_js.Trace.logInfo(_a.$0.$L1,"OfflineSettingProvision is invoking next");switch(this.$H1){case 1:this.$C5B();break;case 3:this.$62U(!1);break;default:break}this.$5Jq?this.set_$4Y3(4):this.set_$4Y3(this.get_$4Y3()+1)},$9xw:function(){this.set_$6Kc(!0);this.set_$9jJ(!0)},$AIC:function(){this.set_$6Kc(!1);this.set_$9jJ(!1)},$C5B:function(){var t=this,n=this;this.$I0.$6u4(_g.$1H.$1Q,null,!0,_js.$D.get_$Q(),"Mouse",function(n){_g.$1H.set_$Q(n);t.$N.$1o(_a.$PA,new _a.$PA(!0))},function(t){_js.Trace.logError(_a.$0.$1b,"Failed to install offline components. {0}",t);if(n.$4ww){n.$5Jq=!0;n.$4("LastStepInfo")}else{var i=new _a.$2y([_nbs.NonBootStrings.l_OfflineNotAvailable_Text],1,null);n.$N.$1o(_a.$2y,i)}});this.$qZ.$Dqz(this.$xF)},$62U:function(n){this.$qZ.$62U(n)}};_i.$nq=function(n,t,i,r,u,f,e,o){this.$$d_$6W0=Function.createDelegate(this,this.$6W0);this.$$d_$Gd=Function.createDelegate(this,this.$Gd);this.$$d_$6mV=Function.createDelegate(this,this.$6mV);_i.$nq.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;this.dispose=this.$1v;_i.$nq.initializeBase(this);_a.$4.$z(n,"eventAggregator");_a.$4.$z(t,"offlineBootStrapper");_a.$4.$z(r,"userAgent");_a.$4.$z(u,"bookmarker");_a.$4.$z(i,"owaShell");this.$N=n;this.$I0=t;this.$1D=r;this.$qZ=u;this.$xF=f;this.$I=i;this.$1Yn=e;this.$38=o;this.$XG=new _C(this.$$d_$6mV,_a.$0.$L1);this.$8U=new _C(this.$$d_$Gd,_a.$0.$L1);this.$Q6=new _C(this.$$d_$6W0,_a.$0.$L1)};_i.$nq.prototype={$I:null,$N:null,$I0:null,$1D:null,$qZ:null,$xF:null,$38:null,$1Yn:null,$DE:null,$48:null,$4s8:0,$2fH:0,$XG:null,$8U:null,$Q6:null,$1rk:null,$Lb:null,$wa:0,$Nz:0,get_$5F:function(){return this.$48},set_$5F:function(n){this.$48=n;return n},get_$gw:function(){return this.$DE},set_$gw:function(n){this.$DE=n;return n},get_$7kt:function(){return!1},get_$3sq:function(){return null},get_$2sh:function(){return 3},set_$7hz:function(n){if(this.$2fH!==n){this.$2fH=n;this.$4("CurrentOfflinEnabledStatus");this.$4("ShowOptOutWarningInfo")}return n},get_$Ed8:function(){return!this.$2fH&&this.$I0.get_$6qi()>0},set_$DOT:function(n){if(n!==this.$1rk){this.$1rk=n;this.$4("OfflineFoldersViewModel")}return n},set_$kF:function(n){if(this.$Lb!==n){this.$Lb=n;this.$4("PivotOptions")}return n},set_$Gj:function(n){if(this.$Nz!==n){this.$Nz=n;this.$5F2();this.$4("PivotSelectedOptionIndex")}return n},set_$2us:function(n){if(this.$wa!==n){this.$wa=n;this.$4("SelectedPivot")}return n},$5P:function(){this.$DE()},$2kt:function(){var n=[];Array.add(n,new _ff.$4N(_nbs.NonBootStrings.l_SetUp_Text,0));Array.add(n,new _ff.$4N(_nbs.NonBootStrings.l_OfflineFolders_Text,1));return n},$5F2:function(){this.set_$2us(this.$Lb[this.$Nz].$1e)},$6W0:function(){this.$4s8=this.$I0.$BI.get_$1iQ()?1:0;this.set_$7hz(this.$4s8);if(this.$I0.$BI.get_$YK()){this.$1rk||this.set_$DOT(new _d.$Ed(this.$I,_nbs.NonBootStrings.l_OfflineFolders_Text,this.$N,this.$1Yn,this.$48,this.$38));this.$1rk.$5VV();this.$Lb||this.set_$kF(this.$2kt())}},$6mV:function(){_js.Trace.logInfo(_a.$0.$L1,"OfflineSettings Invoking OK");this.$5P();if(this.$2fH!==this.$4s8)if(this.$2fH===1){var n=new _i.$vV(this.$N,this.$I0,this.$1D,this.$qZ,this.$xF);this.$I.$Ax(n)}else this.$I0.$6xq(_g.$1H.$1Q,window.location);else this.$9Iq();this.$1rk&&this.$1rk.$70K()},$Gd:function(){this.$5P();this.$1rk&&this.$1rk.$5VV();this.$9Iq()},$9Iq:function(){this.$N.$1o(_a.$PB,new _a.$PB)}};function SettingsPanelFactory(n,t,i,r,u,f,e,o,s){this.$n=n;this.$d=t;this.$N=i;this.$1D=r;this.$2Y=u;this.$3a=o;this.$85=s;this.$1Yn=f;this.$38=e}SettingsPanelFactory.prototype={$n:null,$d:null,$N:null,$1D:null,$2Y:null,$1Yn:null,$38:null,$3a:null,$85:null,$4XS:function(){return new _i.$LM(this.$n,this.$d,this.$N)},$4Wr:function(){return new _i.$ID(this.$n,this.$d,this.$N,this.$2Y,this.$3a)},$4X4:function(n,t,i,r){return new _i.$nq(this.$N,n,t,this.$1D,i,r,this.$1Yn,this.$38)},$4XP:function(){return new _i.$xQ(this.$d,this.$85)}};function SettingsPanelViewModelBase(n){this.$$d_$Dgd=Function.createDelegate(this,this.$Dgd);this.$$d_$Dgk=Function.createDelegate(this,this.$Dgk);this.$$d_$9Di=Function.createDelegate(this,this.$9Di);this.$$d_$E9=Function.createDelegate(this,this.$E9);this.$$d_$Gd=Function.createDelegate(this,this.$Gd);this.$$d_$Az=Function.createDelegate(this,this.$Az);this.$$d_$5P=Function.createDelegate(this,this.$5P);SettingsPanelViewModelBase.initializeBase(this);this.$n=n;this.$5a=new _C(this.$$d_$5P,_a.$0.$1b);this.$Dz=new _C(this.$$d_$Az,_a.$0.$1b);this.$8U=new _C(this.$$d_$Gd,_a.$0.$1b);this.$Q6=new _C(this.$$d_$E9,_a.$0.$1b)}SettingsPanelViewModelBase.prototype={$n:null,$48:null,$7a:null,$5a:null,$Dz:null,$8U:null,$Q6:null,$UP:null,$6NY:!1,$HK:0,$26Q:!1,$3S3:null,$3iq:null,$4V1:null,$4V2:null,get_$8Z5:function(){return this.$Q6},get_$11w:function(){return this.$UP},set_$11w:function(n){this.$UP=n;return n},get_$2N2:function(){return this.$6NY},set_$2N2:function(n){this.$6NY=n;this.$EXU(n);return n},set_$GX:function(n){if(this.$HK!==n){this.$HK=n;this.$4("Status")}return n},get_$2sh:function(){return 2},get_$3sq:function(){return this.$$d_$9Di},get_$5F:function(){return this.$48},set_$5F:function(n){this.$48=n;return n},get_$gw:function(){return this.$7a},set_$gw:function(n){this.$7a=n;return n},get_$7kt:function(){return!1},get_$3S4:function(){return this.$3S3},set_$3S4:function(n){this.$3S3=n;return n},$mV:function(){},$IW:function(){if(this.$3S3){_a.$6.$1F(this.$3S3);this.$3S3=null}},$pa:function(){},$Tj:function(){if(this.$3iq){_a.$6.$1F(this.$3iq);this.$3iq=null}},$APV:function(){return null},$9Ap:function(n){},$Gd:function(){this.$26Q=!0;this.get_$gw()&&this.get_$gw()()},$5Ew:function(n){},$EXU:function(n){},$Az:function(){var n=this.$APV();if(n){this.set_$GX(3);n.add_$2s(this.$$d_$Dgk);n.add_$2b(this.$$d_$Dgd);this.$n.$1U(n)}else{this.$26Q=!0;this.get_$gw()()}},$Dgk:function(n){this.set_$GX(4);this.$9Ap(n);this.$26Q=!0;this.get_$gw()()},$Dgd:function(n){this.set_$GX(5);this.$5Ew(n)},$5P:function(){this.$4V1&&this.$4V2&&(this.$3iq=_a.$6.$1f(this.$4V1,this.$4V2,!0));this.$26Q=!0;this.get_$gw()()},$9Di:function(n,t){return!this.$26Q}};_i.$LM=function(n,t,i){this.$$d_$996=Function.createDelegate(this,this.$996);this.$$d_$DaZ=Function.createDelegate(this,this.$DaZ);_i.$LM.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;_i.$LM.initializeBase(this,[n]);var r=t.get_$R2().DefaultTheme;_js.$9.$1g(r)&&(r="base");this.$1AF=t.get_$1j().get_$4J1();_js.$9.$1g(this.$1AF)&&(this.$1AF=r);this.$N=i;this.$4V1=_a.$0.$1b;this.$4V2="ThemesPanelClose"};_i.$LM.prototype={$N:null,$1AF:null,$10o:null,$2Fh:null,$2a4:null,$1AL:null,$2PQ:null,$14p:null,get_$1Hx:function(){return this.$10o},set_$1Hx:function(n){if(this.$10o!==n){this.$10o=n;this.$4("ThemesList")}return n},get_$16m:function(){return this.$2Fh},set_$16m:function(n){if(this.$2Fh!==n){this.$2Fh=n;this.$4("CssPaths")}return n},set_$9ox:function(n){if(this.$2a4!==n){this.$2a4=n;this.$4("ThemePath")}return n},set_$3WN:function(n){if(this.$1AL!==n){this.$1AL=n;this.$4("SelectedThemeId");this.$N.$1o(_a.$Sp,new _a.$Sp(this.$1AL))}return n},set_$70R:function(n){if(this.$1AF!==n){this.$1AF=n;this.$4("SavedThemeId")}return n},$E9:function(){this.$2PQ=_a.$6.$1f(_a.$0.$1b,"ThemesLoad",!0);this.set_$GX(0);this.$26Q=!1;var n=new _c.$1HJ;n.add_$2s(this.$$d_$DaZ);n.add_$2b(this.$$d_$996);this.$n.$1U(n)},$APV:function(){this.$14p=_a.$6.$1f(_a.$0.$1b,"ThemesSave",!0);return new _c.$1QB(this.$1AL)},$9Ap:function(n){this.set_$70R(n.$466);this.$N.$1o(_a.$YD,new _a.$YD(this.$1AF));if(!$C(this.$14p)){var t=new _a.$3z;t.$CW("T",n.$466);_a.$6.$1F(this.$14p,null,"",n.$FG(),t.toString());this.$14p=null}},$Gd:function(){SettingsPanelViewModelBase.prototype.$Gd.call(this);this.$N.$1o(_a.$Sp,new _a.$Sp(this.$1AF))},$5Ew:function(n){if(!$C(this.$14p)){_a.$6.$1F(this.$14p,null,n.$2H?n.$2H.toString():"unknown",n.$FG());this.$14p=null}},$DaZ:function(n){this.set_$GX(1);var r=!1;if(!$C(n)){var t=n.$7IQ;this.set_$16m(t.CssPaths);this.set_$9ox(t.ThemePath);this.set_$1Hx(t.Themes);($C(this.$10o)||!this.$10o.length)&&this.$996(n);for(var i=0;i<this.$10o.length;i++)if(this.$10o[i].FolderName===this.$1AF){r=!0;break}}r||this.set_$70R("base");this.set_$3WN(this.$1AF);if(!$C(this.$2PQ)){_a.$6.$1F(this.$2PQ,null,"",n.$FG());this.$2PQ=null}},$996:function(n){this.set_$GX(2);if(!$C(this.$2PQ)){_a.$6.$1F(this.$2PQ,null,n.$2H?n.$2H.toString():"unknown",n.$FG());this.$2PQ=null}}};_i.$xQ=function(n,t){this.$$d_$7aV=Function.createDelegate(this,this.$7aV);this.$$d_$BmS=Function.createDelegate(this,this.$BmS);this.$$d_$Gd=Function.createDelegate(this,this.$Gd);this.$$d_$6mV=Function.createDelegate(this,this.$6mV);this.$$d_$6W0=Function.createDelegate(this,this.$6W0);_i.$xQ.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;this.dispose=this.$1v;_i.$xQ.initializeBase(this);this.$1Om=new _i.$18Q;this.$d=n;this.$85=t;this.$Q6=new _C(this.$$d_$6W0,_a.$0.$52);this.$XG=new _C(this.$$d_$6mV,_a.$0.$52);this.$8U=new _C(this.$$d_$Gd,_a.$0.$52);this.$1yy=new _C(_a.$c.$1JP,_a.$0.$52);this.$17v=new _C(this.$$d_$BmS,_a.$0.$52);this.$33d=new _C(this.$$d_$7aV,_a.$0.$52)};_i.$xQ.prototype={$d:null,$85:null,$Q6:null,$XG:null,$8U:null,$1yy:null,$17v:null,$33d:null,$1bj:!1,$1bk:!1,$1Id:!1,$1Om:null,$6qX:null,$33e:null,$G5:!1,$DE:null,$48:null,get_$C5A:function(){return _a.$c.get_$2m6()?null:_i.$1.get_$A4N()},get_$8PV:function(){return _a.$c.get_$2m6()?String.format(_nbs.NonBootStrings.l_Smime_MostRecentControlIsInstalled_Text,_a.$c.get_$5A()):String.format(_nbs.NonBootStrings.l_Smime_NewControlAvailable_Text,_a.$c.get_$5A())},get_$AXH:function(){return _a.$c.get_$2m6()?_u.Strings.l_Smime_ReinstallControlLabel_Text:_u.Strings.l_Smime_UpdateControlLabel_Text},get_$5F:function(){return this.$48},set_$5F:function(n){this.$48=n;return n},get_$gw:function(){return this.$DE},set_$gw:function(n){this.$DE=n;return n},get_$7kt:function(){return!1},get_$3sq:function(){return null},get_$2sh:function(){return 3},set_$Ar0:function(n){if(this.$1bj!==n){this.$1bj=n;this.$4("ForceEncryptMessage")}return n},set_$ArA:function(n){if(this.$1bk!==n){this.$1bk=n;this.$4("ForceSignMessage")}return n},set_$A4e:function(n){if(this.$1Id!==n){this.$1Id=n;this.$4("AllowUserChoiceOfSigningCertificate")}return n},set_$7f:function(n){if(this.$G5!==n){this.$G5=n;this.$4("IsBusy")}return n},$5P:function(){this.$DE()},$6W0:function(){this.set_$7f(!0);if(this.$d.get_$VP()){this.set_$Ar0(this.$d.get_$VP().AlwaysEncrypt);this.set_$ArA(this.$d.get_$VP().AlwaysSign);this.set_$A4e(this.$d.get_$VP().AllowUserChoiceOfSigningCertificate)}this.$1Om.$8Z4(this.$1bj,this.$1bk,this.$1Id);this.$1Om.set_$4c4(this.$d.get_$1j().get_$2Yw());this.$1Om.set_$5YS(this.$d.get_$1j().get_$2Yy());this.$1Om.set_$7WB(!this.$d.get_$1j().get_$2np());this.$1Om.set_$3ac(this.$d.get_$1j().get_$2xS());this.$1Om.set_$5YQ(this.$d.get_$1j().get_$2Yr());this.$6qX=this.$1Om.$4s();this.set_$7f(!1)},$7Uu:function(n,t){if(n){(!this.$1bj||t)&&this.$d.get_$1j().set_$2Yw(n.get_$4c4());(!this.$1bk||t)&&this.$d.get_$1j().set_$2Yy(n.get_$5YS());if(this.$1Id||t){this.$d.get_$1j().set_$2np(!n.$2Dp);if(!n.$2Dp||t){this.$d.get_$1j().set_$2xS(n.get_$3ac());this.$d.get_$1j().set_$2Yr(n.$1hs)}}}t&&this.$d.get_$1j().$Hl.$AU()},$6mV:function(){if(!this.$G5){_js.Trace.logInfo(_a.$0.$52,"SmimeSettings Invoking OK");this.set_$7f(!0);this.$7Uu(this.$1Om,!1);var t=this,n=this;var i=_h.$1z.$4VD(this.$d.get_$1j().$Hl,OwaApplication.$2B,function(){t.set_$7f(!1);t.$5P()},function(t){n.set_$7f(!1);n.$dp(_nbs.NonBootStrings.l_Smime_CannotSaveSettings_Text);_js.Trace.logException(_a.$0.$52,t.$2H,"Failed to save S/MIME settings.")});if(!i){this.set_$7f(!1);this.$5P();return}}},$Gd:function(){this.$7Uu(this.$6qX,!0);this.$5P()},$7aV:function(){if(!this.$G5){var n=this;_a.$c.$19x.$6HK(null,function(t){var r=JsonParser.deserialize(t);if(r.ErrorCode){n.$dp(_u.Strings.l_Smime_CannotGetSubjectCertFromStore_Text);return}n.set_$7f(!0);n.$33e=r.Data;var i=new _h.$lZ(200,n.$33e,!1);i.add_$2s(function(){if(i.get_$4d().IsValid){n.$1Om.set_$3ac(_a.$c.$4oM(i.get_$4d().Subject));n.$1Om.set_$5YQ(i.get_$4d().SubjectKeyIdentifier)}else{_js.Trace.logInfo(_a.$0.$52,"The chosen cert can't be used for signing.");n.$dp(_u.Strings.l_Smime_ChoosenCertificateIsInvalid_Text)}});i.add_$2b(function(t){_js.Trace.logException(_a.$0.$52,t.$2H,"Unabled to verify the chosen cert.");n.$dp(_u.Strings.l_Smime_CannotVerifyChoosenCertificate_Text)});i.add_$4T(function(){n.set_$7f(!1)});OwaApplication.$2B.$1U(i)})}},$BmS:function(){this.$85.$iP(9)},$dp:function(n){_a.$3t.$44(n,0)}};_i.$18Q=function(){_i.$18Q.initializeBase(this)};_i.$18Q.prototype={$1bj:!1,$1bk:!1,$1Id:!1,$386:!1,$3aa:!1,$1OO:null,$1hs:null,$2Dp:!1,get_$4c4:function(){return this.$386||this.$1bj},set_$4c4:function(n){if(this.$386!==n){this.$386=n;this.$4("EncryptMessage")}return n},get_$5YS:function(){return this.$3aa||this.$1bk},set_$5YS:function(n){if(this.$3aa!==n){this.$3aa=n;this.$4("SignMessage")}return n},set_$7WB:function(n){if(this.$2Dp!==n){this.$2Dp=n;this.$4("AutoChooseCert")}return n},get_$3ac:function(){return _js.$9.$o(this.$1OO)?_u.CommonStrings.l_None_Text:this.$1OO},set_$3ac:function(n){if(this.$1OO!==n){this.$1OO=n;this.$4("SigningCertSubject")}return n},set_$5YQ:function(n){if(this.$1hs!==n){this.$1hs=n;this.$4("SigningCertSubjectKeyId")}return n},$8Z4:function(n,t,i){this.$1bj=n;this.$1bk=t;this.$1Id=i},$4s:function(){var n=new _i.$18Q;n.$1bj=this.$1bj;n.$1bk=this.$1bk;n.$1Id=this.$1Id;n.$386=this.$386;n.$3aa=this.$3aa;n.$2Dp=this.$2Dp;n.$1OO=this.$1OO;n.$1hs=this.$1hs;return n}};function DesktopViewModelsComponent(){}DesktopViewModelsComponent.prototype={$2FB:function(n,t,i){var u=this;n.$r(SettingsPanelFactory).$2a(ISettingsPanelFactory).$1I().$t(function(){return new SettingsPanelFactory(n.$2(_a.$2b),n.$2(_g.$O),n.$2(_ff.$M),n.$2(_a.UserAgent),n.$2(IInferenceTracker),n.$37(ISyncFolderSettingProcessor),n.$2(_js.$3a),n.$2(_a.$1d),n.$2(IModuleHelpProvider))});var r=this;n.$r(_i.$LM).$2a(IThemesViewModel).$t(function(){return new _i.$LM(n.$2(_a.$2b),_g.$O.get_$Q(),n.$2(_ff.$M))})},$BjW:function(){return null}};_i.$1.registerClass("_i.$1");SettingsPanelViewModelBase.registerClass("SettingsPanelViewModelBase",ISettingsPanelViewModelBase,_y.$Ok);_i.$ID.registerClass("_i.$ID",SettingsPanelViewModelBase);_i.$vV.registerClass("_i.$vV",_a.$Em,_bc.$Ki,_bc.$dz,_bc.$m7,_a.$1Xr,_js.$13h,Sys.IDisposable);_i.$nq.registerClass("_i.$nq",_a.$Em,_bc.$Ki,_bc.$dz,_bc.$m7,_a.$1Xr,_js.$13h,Sys.IDisposable);SettingsPanelFactory.registerClass("SettingsPanelFactory",null,ISettingsPanelFactory);_i.$LM.registerClass("_i.$LM",SettingsPanelViewModelBase,IThemesViewModel,_js.$13h);_i.$xQ.registerClass("_i.$xQ",_a.$Em,_bc.$Ki,_bc.$dz,_bc.$m7,_a.$1Xr,_js.$13h,Sys.IDisposable);_i.$18Q.registerClass("_i.$18Q",_js.$Eb);DesktopViewModelsComponent.registerClass("DesktopViewModelsComponent",null,_a.$1XU);
window.scriptsLoaded['microsoft.exchange.clients.owa2.client.desktop.viewmodels.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.exchange.clients.owa2.client.desktop.viewmodels.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
