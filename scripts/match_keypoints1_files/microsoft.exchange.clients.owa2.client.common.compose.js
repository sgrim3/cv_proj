try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.exchange.clients.owa2.client.common.compose.js'] = (new Date()).getTime();
Type.registerNamespace("_cmc");_cmc.$4z=function(n,t,i){this.$$d_$E0x=Function.createDelegate(this,this.$E0x);this.$$d_$3HR=Function.createDelegate(this,this.$3HR);_cmc.$4z.initializeBase(this,[n]);this.$1D=t;this.set_$VS(2);this.get_$4y().set_$Rs(22);n.setAttribute("contenteditable","true");n.setAttribute("spellcheck","true");n.setAttribute("useinlinestyle","true");n.style.outline="none";this.$A5a(n,i.get_$1j());this.$By(352)};_cmc.$4z.prototype={$1D:null,$1Q1:null,$A8:!1,$1tb:null,$14F:null,$14I:null,$5JA:!1,set_$16L:function(n){if(n){var t=this.$1Q1===n;this.$1Q1=n;n.get_$6OF()||this.$7nl(n);t||this.$4("CallContext")}return n},set_$G6:function(n){this.$A8=n;this.$4("IsInitialized");return n},add_$1rq:function(n){this.$14F||(this.$14F=new _js.$HI);this.$14F.$HM(n)},remove_$1rq:function(n){this.$14F&&this.$14F.$R8(n)},add_$1fb:function(n){this.$14I||(this.$14I=new _js.$HI);this.$14I.$HM(n)},remove_$1fb:function(n){this.$14I&&this.$14I.$R8(n)},set_$Ds4:function(n){this.$5JA!==n&&(this.$5JA=n);return n},get_$9xf:function(){var n=this.$6Gw();return n?n.toString():null},get_$9xh:function(){var n=this.$6Gw();return n?n.startContainer:null},$4SD:function(){this.$2gY("bold",!1,null)},$4yQ:function(){this.$2gY("italic",!1,null)},$5dM:function(){this.$2gY("underline",!1,null)},$63n:function(n){this.$2gY("forecolor",!1,n)},$5mP:function(n){this.$2gY("backcolor",!1,n)},$2BK:function(){this.$2gY("undo",!1,null)},$284:function(){this.$2gY("redo",!1,null)},$EqL:function(){this.$1IE(352)},$A59:function(n){var i=this.$5Lq(n);var t=this.$6Mc(i);this.get_$S().append(t)},$Bi0:function(){var t=null;var n=this.$3sM();if(!this.$6Ro(n.getRangeAt(0)))return null;n.focusNode.childNodes.length>0&&n.focusNode.childNodes[n.focusOffset-1].nodeName.toLowerCase()==="a"?t=n.focusNode.childNodes[n.focusOffset-1]:n.focusNode.childNodes.length>0&&n.focusNode.lastChild.nodeName.toLowerCase()==="a"?t=n.focusNode.lastChild:n.focusNode.previousSibling&&n.focusNode.previousSibling.nodeName.toLowerCase()==="a"&&(t=n.focusNode.previousSibling);return t},$6Gw:function(){var r=this.$1T6();if(r){var i=r.startContainer;var t=r.startOffset;if(!t)return null;if(i.nodeName==="#text"){var f=t;var n=document.createRange();n.setEnd(i,f);for(;;){t--;n.setStart(i,t);var u=n.toString();if(u.startsWith(" ")||u.startsWith(String.fromCharCode(160))){n.setStart(i,t+1);return n}else if(!t)return n}}}return null},$E0x:function(n){var t=this.$6Gw();if(t){t.deleteContents();this.$4sS(t,$(n));var i=this.$3sM();t.collapse(!1);i.removeAllRanges();i.addRange(t)}},$3HR:function(){return!!this.$5d2()},$3RS:function(n){this.$14F&&this.$14F.$Mo()},$1T6:function(){var n=null;var t=null;try{n=this.$5d2();if(!n){t=document.activeElement;this.get_$S().focus();n=this.$5d2()}}catch(i){_js.Trace.logException(_cmc.$4z.$2D,i,"Exception encountered attempting to get selection for insertion")}finally{$C(t)||t.focus()}return n},$3R:function(){_js.$F.prototype.$3R.call(this);this.get_$S()[0].parentNode.appendChild($(_cmc.$4z.$92m)[0]);var n=this.$8EE();this.set_$16L(new _cmc.$1G1(n));_js.Trace.logInfo(_cmc.$4z.$2D,"sending get content callback with content on activation with content "+n);this.set_$G6(!0)},$1W3:function(n){_js.$F.prototype.$1W3.call(this,n);n.get_$9k()===8&&n.$O8();if(n.get_$9k()===9&&n.$XU()){this.$14I&&this.$14I.$Mo();this.$5JA&&this.$Wj(n)}},$1rn:function(n){_js.$F.prototype.$1rn.call(this,n);var t=this.$5d2();if(t){this.$1tb=t;_js.Trace.logInfo(this.get_$m(),"selectionRangeAtLastBlur is set to "+t.startContainer?t.startContainer.nodeValue:"null")}},$8EE:function(){var n=this.get_$S().clone();n.removeAttr("contenteditable");n.removeAttr("spellcheck");n.removeClass();n.css("min-height","");n.css("height","");n.removeAttr("tabindex");n.removeAttr("id");n.removeAttr("autoid");var t=n.wrap("<div>").parents().html();this.$1D.get_$De()&&document.documentMode===11&&(t=t.replace(_cmc.$4z.$2zc,""));var i='<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css" style="display:none"><!-- p {margin-top:0;margin-bottom:0;} --></style></head><body>'+t+"</body></html>";_js.Trace.logInfo(_cmc.$4z.$2D,"Got full content from content editable div: "+i);return i},$7nl:function(n){if(_y.$13A.isInstanceOfType(n)){var f=this.$8EE();n.set_$DX(f);_js.Trace.logInfo(_cmc.$4z.$2D,"executing get content call context, content="+f)}else if(_y.$1Jm.isInstanceOfType(n)){var r=n.get_$DX();var o=this.$5Lq(r);var h=this.$6Mc(o);this.get_$S().html(h);_js.Trace.logInfo(_cmc.$4z.$2D,"executing set content call context, content="+r)}else if(_y.$13G.isInstanceOfType(n)){var t=n;var i=null;if(t.get_$C9d()){var c=n.get_$DX();var s=this.$5Lq(c);var e=this.$6Mc(s);i=$(e)}else{var u=document.createElement("div");u.innerText=t.get_$DX();i=$(u)}t.get_$3ut()===1?this.$4sR(i):t.get_$3ut()===2?this.$6Mo(i,t.get_$9xx()):this.$3ur(i,t.get_$9t0(),t.get_$9MV())}else if(_y.$1Jn.isInstanceOfType(n))this.get_$S().focus();else throw Error.notImplemented("content editable div does not support call context type "+Object.getType(n).getName());},$A5a:function(n,t){var u="Calibri";var f="#000000";var r="12";if(t){t.get_$344()&&(u=t.get_$344());t.get_$343()&&(f=t.get_$343());t.get_$2F8()>0&&t.get_$2F8()<_cmc.$4z.$1lS.length&&(r=_cmc.$4z.$1lS[t.get_$2F8()])}var i=n.style;i.fontSize=r+"pt";i.color=f;i.backgroundColor="#FFFFFF";var e=this.$3ry(u);i.fontFamily=e;_js.Trace.logInfo(_cmc.$4z.$2D,"applying user default font "+u+", color "+f+", size "+r+", family "+e)},$3ry:function(n){for(var t=0;t<_cmc.$4z.$1Jm.length;++t)if(_cmc.$4z.$1Jm[t][0]===n)return _cmc.$4z.$1Jm[t][1];return n},$AqG:function(){var t=_js.$F.prototype.$3Q.call(this);if(t&&this.$1tb&&this.$6Ro(this.$1tb)){var n=this.$3sM();n.removeAllRanges();n.addRange(this.$1tb);this.$1tb=null}},$5d2:function(){var t=this.$3sM();if(t)try{var n=t.getRangeAt(0);if(this.$6Ro(n))return n}catch(i){_js.Trace.logInfo(_cmc.$4z.$2D,"CED: TryGetSelectionRange: Ignoring an exception. Details: "+i.message)}return null},$6Ro:function(n){if($C(n.commonAncestorContainer))return!1;var r=n.commonAncestorContainer;var u=$(r);var t=this.getAttachedElement();var i=u.closest(t);return i.length?!0:!1},$4sS:function(n,t){for(var u=t.get(),e=u.length,i=0;i<e;++i){var r=u[i];n.collapse(!1);if($C(n.insertNode))$C(n.pasteHTML)||n.pasteHTML(r.innerHTML);else{var f=document.importNode(r,!0);n.insertNode(f)}}},$6Mo:function(n,t){_js.Trace.logInfo(_cmc.$4z.$2D,"Appending element. Html: "+n.html()+"");var u=this.get_$S().find('div[id^="Signature"]');if(t&&u&&u.length>0){var r=u.get(0);var i=document.createRange();i.selectNodeContents(r.previousSibling?r.previousSibling:r);i.collapse(!0);this.$4sS(i,n)}else this.get_$S().append(n)},$4sR:function(n){_js.Trace.logInfo(_cmc.$4z.$2D,"Prepending element. Html: "+n.html()+"");this.get_$S().prepend(n)},$3ur:function(n,t,i){var r=this.$1T6();if(r){_js.Trace.logInfo(_cmc.$4z.$2D,"Got a good selection range. Calling InsertElementAtRange");!r.collapsed&&i&&r.deleteContents();var f=r.cloneRange();this.$4sS(r,n);var u=this.$3sM();u.removeAllRanges();if(t){_js.Trace.logInfo(_cmc.$4z.$2D,"Set new selection after insertion");r.collapse(!1);u.addRange(r)}else{_js.Trace.logInfo(_cmc.$4z.$2D,"Restore original selection range after insertion");u.addRange(f)}}else{_js.Trace.logInfo(_cmc.$4z.$2D,"Could not get a Range to insert content, so appending the element to the end of the CED");this.$6Mo(n,!0)}},$2gY:function(n,t,i){this.$AqG();if(this.get_$k()&&_y.$IA.isInstanceOfType(this.get_$k())){var r=this.get_$k().get_$c8();if(r){r.document.execCommand(n,t,i);return}}document.execCommand(n,t,i)},$5Lq:function(n){_js.Trace.logInfo(this.get_$m(),"RemovePStyles: RemovePStyles");return n.replace(_cmc.$4z.$4e9,"$1").replace(_cmc.$4z.$4en,"")},$6Mc:function(n){return this.$1D.get_$De()&&document.documentMode===11?n.replace(_cmc.$4z.$7mQ,"<p>&#8203;</p>"):n},$3sM:function(){if(this.get_$k()&&_y.$IA.isInstanceOfType(this.get_$k())){var n=this.get_$k().get_$c8();if(n)return n.getSelection()}return window.getSelection()}};_cmc.$1E9=function(n){this.$60U=n};_cmc.$1E9.prototype={$60U:0,get_$4cS:function(){return this.$60U},set_$Dy:function(n){return n}};_cmc.$11B=function(n,t,i){this.$tU=n;this.$ii=t;this.$1QB=i};_cmc.$11B.prototype={$tU:null,$ii:0,$1QB:null,get_$2dX:function(){return this.$tU},get_$4Us:function(){return this.$ii},get_$4Ut:function(){return this.$1QB},set_$Dy:function(n){return n}};_cmc.$MU=function(n,t,i){this.$6Mq=n;this.$Fb=t;this.$6Pt=i};_cmc.$MU.prototype={$Fb:null,$6Pt:!1,$18O:!1,$6Mq:0,$2z0:!1,$28E:!0,$4NX:!0,get_$DX:function(){return this.$Fb},get_$C9d:function(){return this.$6Pt},get_$6OF:function(){return this.$18O},get_$3ut:function(){return this.$6Mq},get_$9t0:function(){return this.$2z0},get_$9MV:function(){return this.$28E},get_$9xx:function(){return this.$4NX}};function CommonComposeComponent(){}CommonComposeComponent.prototype={$2FB:function(n,t,i){var r=this;n.$r(_cmc.$kO).$1I().$t(function(){return new _cmc.$kO})},$BjW:function(){return null}};_cmc.$1E8=function(){};_cmc.$1E8.prototype={$Fb:null,$18O:!1,get_$DX:function(){return this.$Fb},set_$DX:function(n){this.$Fb=n;return n},get_$6OF:function(){return this.$18O}};_cmc.$sc=function(n){this.$Fb=n};_cmc.$sc.prototype={$Fb:null,$18O:!1,get_$DX:function(){return this.$Fb},get_$6OF:function(){return this.$18O}};_cmc.$1G1=function(n){this.$18O=!0;this.$Fb=n};_cmc.$1G1.prototype={$Fb:null,$18O:!1,get_$DX:function(){return this.$Fb},set_$DX:function(n){this.$Fb=n;return n},get_$6OF:function(){return this.$18O}};_cmc.$1G2=function(){};_cmc.$1G2.prototype={$Fb:null,$18O:!1,get_$DX:function(){return this.$Fb},set_$DX:function(n){this.$Fb=n;return n},get_$6OF:function(){return this.$18O}};_cmc.$1Kq=function(n){this.$2Un=n};_cmc.$1Kq.prototype={$2Un:null,$7OO:!1,get_$1gD:function(){return this.$2Un},set_$Eyg:function(n){this.$7OO=n;return n},get_$6OF:function(){return!1}};_cmc.$17y=function(n){this.$Fb=n};_cmc.$17y.prototype={$Fb:null,$18O:!1,get_$DX:function(){return this.$Fb},get_$6OF:function(){return this.$18O}};_cmc.$1Pm=function(){};_cmc.$1Pm.prototype={$18O:!1,get_$6OF:function(){return this.$18O}};_cmc.$Tr=function(n){this.$8B=n};_cmc.$Tr.prototype={$8B:null,get_$6OF:function(){return!1}};_cmc.$UK=function(n){this.$130=n};_cmc.$UK.prototype={$130:null,get_$6OF:function(){return!1}};_cmc.$tw=function(n,t,i,r,u,f){this.$9z=n;this.$2PJ=t;this.$4zs=i;this.$1k1=r;this.$3ul=u;this.$4sK=f};_cmc.$tw.prototype={$9z:null,$2PJ:null,$4zs:null,$1k1:null,$3ul:null,$4sK:null,get_$6OF:function(){return!1},get_$C4r:function(){return this.$3ul}};_cmc.$Od=function(n,t){this.$130=n;this.$2gj=t};_cmc.$Od.prototype={$130:null,$2gj:null,get_$6OF:function(){return!1}};_cmc.$gZ=function(n,t){this.$2FH=n;this.$130=t};_cmc.$gZ.prototype={$2FH:null,$130:null,get_$6OF:function(){return!1}};_cmc.$ga=function(n,t,i){this.$130=n;this.$9z=t;this.$2FH=i};_cmc.$ga.prototype={$130:null,$9z:null,$2FH:null,get_$6OF:function(){return!1}};_cmc.$s0=function(n,t){this.$7CR=n;this.$7CM=t};_cmc.$s0.prototype={$7CR:!1,$7CM:!1,get_$EZb:function(){return this.$7CR},get_$EZT:function(){return this.$7CM},get_$6OF:function(){return!1}};_cmc.$1CZ=function(){};_cmc.$1CZ.prototype={get_$6OF:function(){return!1}};_cmc.$11A=function(n){this.$6Tm=n};_cmc.$11A.prototype={$6Tm:null,get_$1l:function(){return this.$6Tm},set_$Dy:function(n){return n}};_cmc.$1EA=function(n){this.$22N=n};_cmc.$1EA.prototype={$22N:null,get_$lp:function(){return this.$22N},set_$Dy:function(n){return n}};_cmc.$l4=function(){};_cmc.$l4.prototype={set_$Dy:function(n){return n}};_cmc.$sb=function(n){this.$QF=n};_cmc.$sb.prototype={$QF:!1,set_$Dy:function(n){this.$QF=n;return n}};_cmc.$11C=function(n,t,i,r){this.$A8=n;this.$JL=t;this.$2gA=i;this.$7CY=r};_cmc.$11C.prototype={$A8:!1,$JL:!1,$2gA:null,$7CY:!1,get_$G6:function(){return this.$A8},get_$dF:function(){return this.$JL},get_$4bR:function(){return this.$2gA},get_$EZo:function(){return this.$7CY},set_$Dy:function(n){return n}};_cmc.$1CS=function(n,t){_cmc.$1CS.initializeBase(this);this.$5f=n;this.$2D=t};_cmc.$1CS.prototype={$5f:null,$2D:null,$1PY:function(n){if(this.$5f){var t=this;_js.$D.get_$Q().$2V(_a.$0.$1l,"ComposeCopyPasteViewModel.OnAttachViaString",function(){var i=_a.$6.$1f(_a.$0.$1l,"AttachmentCopyAndPasteItemAttachments",!0);t.$5f.$30L(n,null,i)},0)}}};_cmc.$kO=function(){};_cmc.$kO.prototype={$9:function(n,t){return new _cmc.$1CS(n,t)}};_cmc.$4z.registerClass("_cmc.$4z",_js.$F);_cmc.$1E9.registerClass("_cmc.$1E9",null,_y.$1Id,_y.$1W5);_cmc.$11B.registerClass("_cmc.$11B",null,_y.$1Ig,_y.$1W5);_cmc.$MU.registerClass("_cmc.$MU",null,_y.$13G,_fm.$1Ib);CommonComposeComponent.registerClass("CommonComposeComponent",null,_a.$1XU);_cmc.$1E8.registerClass("_cmc.$1E8",null,_y.$13A,_fm.$1Ib);_cmc.$sc.registerClass("_cmc.$sc",null,_y.$1Jm,_fm.$1Ib);_cmc.$1G1.registerClass("_cmc.$1G1",null,_y.$13A,_fm.$1Ib);_cmc.$1G2.registerClass("_cmc.$1G2",null,_y.$13A,_fm.$1Ib);_cmc.$1Kq.registerClass("_cmc.$1Kq",null,_y.$13H,_fm.$1Ib);_cmc.$17y.registerClass("_cmc.$17y",null,_y.$1Jm,_fm.$1Ib);_cmc.$1Pm.registerClass("_cmc.$1Pm",null,_y.$1Jn,_fm.$1Ib);_cmc.$Tr.registerClass("_cmc.$Tr",null,_fm.$1Ib);_cmc.$UK.registerClass("_cmc.$UK",null,_fm.$1Ib);_cmc.$tw.registerClass("_cmc.$tw",null,_y.$1WY,_fm.$1Ib);_cmc.$Od.registerClass("_cmc.$Od",null,_fm.$1Ib);_cmc.$gZ.registerClass("_cmc.$gZ",null,_fm.$1Ib);_cmc.$ga.registerClass("_cmc.$ga",null,_fm.$1Ib);_cmc.$s0.registerClass("_cmc.$s0",null,_y.$1Iq,_fm.$1Ib);_cmc.$1CZ.registerClass("_cmc.$1CZ",null,_y.$1Jh,_fm.$1Ib);_cmc.$11A.registerClass("_cmc.$11A",null,_y.$1Ic,_y.$1W5);_cmc.$1EA.registerClass("_cmc.$1EA",null,_y.$1Ie,_y.$1W5);_cmc.$l4.registerClass("_cmc.$l4",null,_y.$1If,_y.$1W5);_cmc.$sb.registerClass("_cmc.$sb",null,_y.$1Ih,_y.$1W5);_cmc.$11C.registerClass("_cmc.$11C",null,_y.$1Ii,_y.$1W5);_cmc.$1CS.registerClass("_cmc.$1CS",_a.$Em);_cmc.$kO.registerClass("_cmc.$kO");_cmc.$4z.$7mQ=new RegExp("<p>\\s*</p>","gim");_cmc.$4z.$2zc=new RegExp("​","gim");_cmc.$4z.$2D=_a.$0.$Jp;_cmc.$4z.$1lS=["","8","10","12","14","18","24","36"];_cmc.$4z.$1Jm=[["Angsana New","'Angsana New',Serif"],["Arial","Arial,Helvetica,sans-serif"],["Calibri","Calibri,Arial,Helvetica,sans-serif"],["Cambria","Cambria,Serif"],["Comic Sans MS","'Comic Sans MS',Fantasy,cursive"],["Candara","Candara,Sans-Serif"],["Consolas","Consolas,monospace"],["Constantia","Constantia,Serif"],["Corbel","Corbel,Sans-Serif"],["Cordia New","'Cordia New',Sans-Serif"],["Courier New","'Courier New',monospace"],["DaunPenh","DaunPenh,Sans-Serif"],["Gautami","Gautami,Sans-Serif"],["Georgia","Georgia,serif"],["Gungsuh","Gungsuh,Serif"],["Helvetica","Helvetica, Sans-Serif"],["Impact","Impact, Charcoal, sans-serif"],["Iskoola Pota","'Iskoola Pota',Sans-Serif"],["Kalinga","Kalinga,Sans-Serif"],["Kartika","Kartika,Sans-Serif"],["Latha","Latha,Sans-Serif"],["Lucida Console","'Lucida Console', Monaco, monospace"],["Lucida Sans Unicode","'Lucida Sans Unicode', 'Lucida Grande', sans-serif"],["Mangal","Mangal,Sans-Serif"],["Palatino Linotype","'Palatino Linotype', 'Book Antiqua', Palatino, serif"],["Segoe","Segoe,'Segoe UI', Sans-Serif"],["Segoe UI","'Segoe UI',Sans-Serif"],["Symbol","Symbol,'Segoe UI',Tahoma,Sans-Serif"],["Tahoma","Tahoma, Geneva, sans-serif"],["Times","Times,'Times New Roman',Serif"],["Times New Roman","'Times New Roman', Times, serif"],["Trebuchet MS","'Trebuchet MS', sans-serif"],["Tunga","Tunga,Sans-Serif"],["Verdana","Verdana, Geneva, sans-serif"],["Vrinda","Vrinda,Sans-Serif"],["Wingdings","Wingdings,Zapf Dingbats"],["黑体","SimHei,'黑体',Sans-Serif"],["微軟正黑體","'Microsoft JhengHei','微軟正黑體',Sans-Serif"],["微软雅黑","'Microsoft YaHei','微软雅黑',Sans-Serif"],["宋体","SimSun,'宋体',Serif"],["宋体-ExtB","SimSun-ExtB,Serif"],["仿宋","FangSong,'仿宋',Serif"],["楷体","KaiTi,'楷体'，Sans-Serif"],["細明體","MingLiU,'細明體',Serif"],["細明體_HKSCS","MingLiU_HKSCS,'細明體_HKSCS',Serif"],["新細明體","PMingLiU,'新細明體',Serif"],["新細明體-ExtB","PMingLiU-ExtB,'新細明體-ExtB',Serif"],["맑은 고딕","'Malgun Gothic','맑은 고딕',Sans-Serif"],["굴림","Gulim,'굴림',Sans-Serif"],["돋움","Dotum,'돋움',Sans-Serif"],["바탕","Batang,'바탕',Serif"],["メイリオ","Meiryo,'メイリオ',Sans-Serif"],["ＭＳ ゴシック","'MS Gothic','ＭＳ ゴシック',Sans-Serif"],["ＭＳ Ｐゴシック","'MS PGothic','ＭＳ Ｐゴシック',Sans-Serif"],["ＭＳ 明朝","'MS Mincho','ＭＳ 明朝',Serif"],["ＭＳ Ｐ明朝","'MS PMincho','ＭＳ Ｐ明朝',Serif"],["Nyala","Nyala,Sans-Serif"],["Raavi","Raavi,Sans-Serif"],["Shruti","Shruti,Sans-Serif"],["Sylfaen","Sylfaen,Serif"]];_cmc.$4z.$92m='<style type="text/css" style="display:none;">P{margin-top:0;margin-bottom:0;}</style>';_cmc.$4z.$4e9=new RegExp("(<style[^>]*>)[\\s]*p[\\s]*{[^}]*}","i");_cmc.$4z.$4en=new RegExp("}[\\s]*p[\\s]*{[^}]*","gi");
window.scriptsLoaded['microsoft.exchange.clients.owa2.client.common.compose.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.exchange.clients.owa2.client.common.compose.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
