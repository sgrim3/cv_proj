try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.exchange.clients.owa2.client.extensibility.js'] = (new Date()).getTime();
Type.registerNamespace("_ex");function ExtensibilityComponent(){}ExtensibilityComponent.prototype={$2FB:function(n,t,i){var e=this;n.$r(IExtensibilityStatistics).$2a(IExtensibilityStatistics).$1I().$t(function(){return new _ex.$11X});var o=this;n.$r(_ex.$Ub).$1I().$t(function(){return new _ex.$Ub(n.$2(_g.$MR),n.$2(IExtensibilityStatistics),n.$2(_a.$1d))});var s=this;n.$r(_ex.$Uf).$1I().$t(function(){return new _ex.$Uf});var r=this,u=this;n.$r(_ex.$Ud).$1I().$t(function(){var t=n.$2(_g.$O);return new _ex.$Ud(t.get_$ga(),t.get_$4X().get_$Lh(),t.get_$4X().get_$Fu(),t.get_$1j().get_$HL(),n.$2(_y.$W),n.$3O(IItemReadingPaneContextFactory),n.$3O(IItemReadingPaneViewModelPopOutFactory),n.$3O(IMailComposeContextFactory),n.$3O(IMailComposeActionFactory),n.$2(_a.$t),n.$2(_a.$3G),n.$2(_a.$2b),n.$2(_a.$AE))}).$c5(function(t){t.$xc=n.$3O(ICalendarItemDetailsViewModelFactory);t.$zQ=n.$3O(IMailComposeViewModelFactory);t.$xs=n.$3O(IComposeCalendarItemViewModelFactory)});var f=this;n.$r(IExtensibilityViewModelFactory).$2a(IExtensibilityViewModelFactory).$1I().$t(function(){var t=n.$2(_g.$O);return new _ex.$11Z(n.$2(_a.$1w),n.$2(_ex.$Uf),t.get_$4X().get_$CE(),i.get_$9D2(),n.$2(_a.$3G),n.$2(_a.$t),n.$2(_y.$W),n.$2(_ff.$M),n.$2(_ex.$Ub),n.$2(_ex.$Ud),n.$2(IExtensibilityStatistics),n.$2(_a.$1d))})},$BjW:function(){return null}};_ex.$lG=function(n,t,i){_ex.$lG.initializeBase(this);this.$Ai=n;this.$PS=t;this.$N1=i};_ex.$lG.prototype={$Ai:null,$PS:null,$N1:null,$6NV:function(n){var i=new _g.$UX(this.$Ai,this.$PS,this.$N1);var t=new _g.$11L(this.$2i);t.actionName="Ext_ExecuteEwsProxy";n.$4cs(i,t,this.$$d_$6pk,this.$$d_$1Mo)},$6uq:function(n,t,i){t()}};_ex.$la=function(n,t){_ex.$la.initializeBase(this);this.$1vU=new Array(n.length);for(var i=0;i<n.length;i++){this.$1vU[i]=new _g.$Nd(t);this.$1vU[i].Id=n[i]}};_ex.$la.prototype={$1vU:null,$6NV:function(n){var i=new _g.$O6(this.get_$7g());i.Body.TokenRequests=this.$1vU;var t=new _g.$lb(this.$2i);t.actionName="Ext_GetUserIdentityToken";n.$3Dg(i,t,this.$$d_$6pk,this.$$d_$1Mo)},$wL:function(n){n.ResponseCode==="NoError"&&n.ResponseClass==="Success"&&_ex.$5K.get_$Q().$7TE(n.Token)}};_ex.$lg=function(n){_ex.$lg.initializeBase(this);this.$b=n};_ex.$lg.prototype={$b:null,$6NV:function(n){var i=new _g.$JB(_h.$f.get_$r2());i.ItemIds=[new _g.$1T(this.$b.get_$y().Id)];var t=new _g.$O8(this.$2i);t.clientStoreItem=0;var r=new _g.$JA(this.get_$7g(),i);n.$63(r,t,this.$$d_$6pk,this.$$d_$1Mo)},$wL:function(n){var t=n.Items[0];this.$b.set_$r2(t.EntityExtractionResult)}};_ex.$4V=function(){_ex.$4V.initializeBase(this)};_ex.$4V.prototype={$zD:!1,$8i:null,$2FK:0,$5z:null,$11:function(n,t){if(OwaApplication.$1PQ){_ex.$4V.$ei=new _g.$O0;_ex.$4V.$ei.Extensions=new Array(0)}else if(!this.$zD){this.$5z=new _g.$VB(n,t);this.$zD=!0;this.$8i=_a.$8.get_$36();OwaApplication.$2B.$1U(this)}},$6NV:function(n){var t=new _g.$120(this.$2i);t.actionName="Ext_LoadApps";n.$2Kr(this.$5z,t,this.$$d_$6pk,this.$$d_$1Mo)},$6uq:function(n,t,i){this.$2FK=_a.$8.get_$36().$6M(this.$8i);_ex.$4V.$ei=n;t()}};_ex.$Vc=function(n,t){_ex.$Vc.initializeBase(this);if(_js.$9.$o(t))throw Error.argument("scope","scope can not be null or empty.");this.$1vT=new _g.$Nd("ScopedToken");this.$1vT.Id=n;this.$1vT.Scope=t};_ex.$Vc.prototype={$1vT:null,$PS:null,$6NV:function(n){var i=new _g.$O6(this.get_$7g());i.Body.TokenRequests=[this.$1vT];var t=new _g.$lb(this.$2i);t.actionName="Ext_GetAttachmentToken";n.$3Dg(i,t,this.$$d_$6pk,this.$$d_$1Mo)},$wL:function(n){n.ResponseCode==="NoError"&&n.ResponseClass==="Success"&&(this.$PS=n.Token)}};_ex.$WN=function(n,t){_ex.$WN.initializeBase(this);this.$N1=n;this.$5i=t};_ex.$WN.prototype={$N1:null,$5i:null,$6NV:function(n){var i=new _g.$WO(this.$N1,this.$5i);var t=new _g.$14U(this.$2i);t.actionName="Ext_LoadExtensionCustomProperties";n.$50C(i,t,this.$$d_$6pk,this.$$d_$1Mo)},$6uq:function(n,t,i){t()}};_ex.$17V=function(n){_ex.$17V.initializeBase(this);_a.$4.$1s(n,"input");this.$3GX=n};_ex.$17V.prototype={$3GX:null,$6NV:function(n){var t=new _g.$17W(this.$2i);n.$4Br(this.$3GX,t,this.$$d_$6pk,this.$$d_$1Mo)},$6uq:function(n,t,i){if(null===n){i(Error.create("SanitizeHtmlAction failed."));return}_js.Trace.logInfo(_a.$0.$4U,"SanitizeHtml Web Service request successful.");t()}};_ex.$p6=function(n,t,i){_ex.$p6.initializeBase(this);this.$N1=n;this.$5i=t;this.$3Wb=i};_ex.$p6.prototype={$N1:null,$5i:null,$3Wb:null,$6NV:function(n){var i=new _g.$XX(this.$N1,this.$5i,this.$3Wb);var t=new _g.$17X(this.$2i);t.actionName="Ext_SaveExtensionCustomProperties";n.$5NZ(i,t,this.$$d_$6pk,this.$$d_$1Mo)},$6uq:function(n,t,i){t()}};_ex.$p7=function(n,t,i){_ex.$p7.initializeBase(this);this.$N1=n;this.$38d=t;this.$3Wc=i};_ex.$p7.prototype={$N1:null,$38d:null,$3Wc:null,$6NV:function(n){var i=new _g.$XZ(this.$N1,this.$38d,this.$3Wc);var t=new _g.$17Y(this.$2i);t.actionName="Ext_SaveExtensionSettings";n.$5Na(i,t,this.$$d_$6pk,this.$$d_$1Mo)},$6uq:function(n,t,i){t()}};_ex.$5K=function(){this.$1Ps={};this.$1Pp={}};_ex.$5K.get_$Q=function(){$C(_ex.$5K.$1Q)&&(_ex.$5K.$1Q=new _ex.$5K);return _ex.$5K.$1Q};_ex.$5K.prototype={$7TE:function(n){switch(n.TokenType){case"CallerIdentity":this.$1Ps[n.Id]=new _ex.$5K.$3hn(n);break;case"ExtensionCallback":this.$1Pp[n.Id]=new _ex.$5K.$3hn(n);break;default:var t=String.format("Error: ClientAccessTokenCache.AddToken type not supported - {0}",_js.$1I.$Gr(_g.$Tt,n));_js.Trace.logError(_a.$0.$Ud,t);break}},$34K:function(n){return n in this.$1Ps&&!this.$1Ps[n].$1oB()},$34J:function(n){return n in this.$1Pp&&!this.$1Pp[n].$1oB()},$8IU:function(n){return this.$34K(n)?this.$1Ps[n].$PS:null},$8Dr:function(n){return this.$34J(n)?this.$1Pp[n].$PS:null},$8RG:function(){var t=this.$1Ps;for(var n in t){var i={key:n,value:t[n]};if(i.value.$1oB())return!0}return!1},$8R9:function(){var t=this.$1Pp;for(var n in t){var i={key:n,value:t[n]};if(i.value.$1oB())return!0}return!1}};_ex.$5K.$3hn=function(n){this.$1aG=new Date;this.$PS=n};_ex.$5K.$3hn.prototype={$1aG:null,$PS:null,$1oB:function(){var t=new Date;var n=t.getTime()-this.$1aG.getTime();return n>=(this.$PS.TTL-15)*6e4}};_ex.$1VL=function(){};_ex.$1VL.registerInterface("_ex.$1VL");_ex.$Ub=function(n,t,i){this.$2K=n;this.$FE=t;this.$1G=i||null};_ex.$Ub.prototype={$2K:null,$FE:null,$1G:null,$4XD:function(n,t){return new _ex.$6E(n,this.$2K,t,this.$FE)},$4WZ:function(n){return new _ex.$11R(this.$FE,n,this.$1G)}};_ex.$11R=function(n,t,i){this.$FE=n;this.$o0=t;this.$1G=i||null};_ex.$11R.prototype={$FE:null,$1G:null,$o0:0,$60f:function(n,t){_a.$6.stPT(_a.$0.$4U,"AppActivationInComposeForm",5);for(var v=_a.$6.$1f(_a.$0.$4U,"AppActivationInComposeForm",!0),y=_a.$8.get_$36(),s=new(_ff.$18.$$(_ex.$7a)),r=0;r<n.length;r++){var l=n[r];var i;var f,h;if(h=_ex.$7a.$5cs(l,new _ex.$lC(this.$FE,this.$o0),f={val:i}),i=f.val,h){var e=null;var p=_a.$8.get_$36();var c,o;var u=i.$xK?(o=i.$xK.$2HM(null,i.$Vn,c={val:e}),e=c.val,o):!1;var a=_a.$8.get_$36();u&&s.$F(i);this.$FE.$5cQ(l.Id,a.$6M(p),u)}}this.$FE.$5cV(_a.$8.get_$36().$6M(y));t(s);this.$AU();this.$FE.$4eN();_a.$6.$1F(v,"AppActivationInComposeForm");_a.$6.endPT("AppActivationInComposeForm")},$9is:function(){return!0},$AU:function(){}};_ex.$6E=function(n,t,i,r){this.$b=n;this.$2NK=i;this.$FE=r;this.$2K=t};_ex.$6E.get_$5Bw=function(){_ex.$6E.$2Sc||(_ex.$6E.$2Sc=["junkemail","drafts"]);return _ex.$6E.$2Sc};_ex.$6E.prototype={$2NK:!1,$b:null,$FE:null,$1Ck:null,$2K:null,$60f:function(n,t){var e=!0;this.$1Ck=new(_ff.$18.$$(_ex.$7a));for(var r=0;r<n.length;r++){var s=n[r];var f=new _ex.$lC(this.$FE,1);f.$ro=this.$2NK;var i;var u,o;if(o=_ex.$7a.$5cs(s,f,u={val:i}),i=u.val,o){this.$1Ck.$F(i);i.$xK&&(i.$xK.$4vj(this.$b,i.$Vn)||(e=!1))}}e?this.$4cb(t):this.$8ZA(t)},$9is:function(){if(this.$b.get_$9i()||this.$b.get_$Hy())return!1;if(this.$b.get_$CJ()){var n=this.$b.get_$CJ().toLowerCase();if(n.startsWith("report")||-1!==n.indexOf(".smime"))return!1}return this.$b.get_$3G()&&!this.$9it(this.$b.get_$3G().Id)?!1:!0},$AU:function(){this.$1Ck=null},$9it:function(n){if(!_ex.$6E.$1rW){_ex.$6E.$1rW={};for(var t=0;t<_ex.$6E.get_$5Bw().length;t++){var r=_ex.$6E.get_$5Bw()[t];var i=this.$2K.nameToId(r);i&&(_ex.$6E.$1rW[i.Id]=!0)}}return!(n in _ex.$6E.$1rW)},$4cb:function(n){if(this.$1Ck){_a.$6.stPT(_a.$0.$4U,"AppActivationInReadingPane",5);var c=_a.$6.$1f(_a.$0.$4U,"AppActivationInReadingPane",!0);var e=new(_ff.$18.$$(_ex.$7a));this.$FE.$5cS(this.$b.get_$2t2(),this.$b.get_$r2());for(var h=_a.$8.get_$36(),o=null,i=0;i<this.$1Ck.get_$A();i++){var t=this.$1Ck.get_$E(i);var l=_a.$8.get_$36();var f,u;var r=(u=this.$9iu(t,f={val:o}),o=f.val,u);var s=_a.$8.get_$36();if(r){e.$F(t);t.$9gD(this.$b.get_$r2())}this.$FE.$5cQ(t.$5O.Id,s.$6M(l),r)}this.$FE.$5cV(_a.$8.get_$36().$6M(h));n(e);this.$AU();this.$FE.$4eN();_a.$6.$1F(c,"AppActivationInReadingPane","");_a.$6.endPT("AppActivationInReadingPane")}},$9iu:function(n,t){if($C(n)||$C(n.$xK))return!1;var i=!1;n.$Vn.$1Wq={};i=!!(i|n.$xK.$2HM(this.$b,n.$Vn,t));return i},$8ZA:function(n){var t=new _ex.$lg(this.$b);var i=this;t.add_$2s(function(t){i.$4cb(n)});OwaApplication.$2B.$1U(t)}};_ex.$j7=function(n,t,i,r){this.$$d_$9vc=Function.createDelegate(this,this.$9vc);this.$$d_$7Vw=Function.createDelegate(this,this.$7Vw);_ex.$j7.initializeBase(this,[i,r]);this.$73=n;this.$ia=t};_ex.$j7.$8Dq=function(n){switch(n){case 0:return 9007;case 3:return 9e3;case 1:default:return 9007}};_ex.$j7.prototype={$73:null,$ia:null,$tR:null,$7nj:function(){var n;if(!this.$9rK()){this.$g9();return}var r,i,t;if(t=this.$9qp(r={val:n},i={val:this.$tR}),n=r.val,this.$tR=i.val,t){this.$tR.add_$ED(this.$$d_$7Vw);this.$tR.add_$1G2(this.$$d_$9vc)}else{this.$Yy(n,null);return}},$9vc:function(n){this.$tR.remove_$1G2(this.$$d_$9vc);if(n.get_$3S6()){var i=_ex.$j7.$8Dq(n.get_$31s());this.$Yy(i,null);return}var t=this.$ia.$F(this.$tR);this.$To(t,null)},$7Vw:function(n,t){if(t==="IsDeleted"&&this.$tR.get_$1dQ()){this.$tR.remove_$ED(this.$$d_$7Vw);this.$Yy(9006,null)}}};_ex.$yP=function(n,t,i,r){_ex.$yP.initializeBase(this,[n,t,i,r])};_ex.$yP.prototype={get_$Ti:function(){return"AddFileAttachment"},get_$5HZ:function(){return 3},$9rK:function(){var t=this.$1e.uri;var n=this.$1e.name;if(_js.$9.$o(t)||_js.$9.$o(n)){_js.Trace.logError(_a.$0.$4U,"AddFileAttachment got null or empty uri or name");return!1}else if(t.length>2048||n.length>255){_js.Trace.logError(_a.$0.$4U,"AddFileAttachment got too long uri or name");return!1}else return!0},$9qp:function(n,t){var r=this.$1e.uri;var i=this.$1e.name;t.val=this.$73.$4Ob(r,i,n);return!!t.val}};_ex.$yQ=function(n,t,i,r){_ex.$yQ.initializeBase(this,[n,t,i,r])};_ex.$yQ.prototype={get_$Ti:function(){return"AddItemAttachment"},get_$5HZ:function(){return 3},$9rK:function(){var t=this.$1e.itemId;var n=this.$1e.name;if(_js.$9.$o(t)||_js.$9.$o(n)){_js.Trace.logError(_a.$0.$4U,"AddItemAttachment got null or empty itemId or name");return!1}else if(t.length>200||n.length>255){_js.Trace.logError(_a.$0.$4U,"AddItemAttachment got too long itemId or name");return!1}else return!0},$9qp:function(n,t){var r=this.$1e.itemId;var u=this.$1e.name;var i=new _g.$7Q;i.set_$y(new _g.$1T(r));i.set_$1x(u);i.set_$C9(!1);i.set_$8A(0);t.val=this.$73.$4Og(i,n);return!!t.val}};_ex.$jD=function(n,t,i,r){_ex.$jD.initializeBase(this,[t,i]);this.$73=n;this.$2El=r};_ex.$jD.prototype={$2El:!1,$73:null,get_$Ti:function(){return this.$2El?"SetRecipients":"AddRecipients"},get_$5HZ:function(){return 3},$9qv:function(n,t){t.val=new(_ff.$18.$$(_g.$1K));if($C(n)||!n.length)return!0;for(var o=n.length,u=0;u<o;u++){var e=n[u];var f=e.address;var r=e.name;if(!r&&!f){_js.Trace.logError(_a.$0.$4U,"Add/SetRecipientsAsync null for both displayName and address");this.$g9();return!1}if(r&&r.length>255){_js.Trace.logError(_a.$0.$4U,"Add/SetRecipientsAsync got displayName lengths over the limit");this.$g9();return!1}if(_a.$2i.$YN(f)){var i=new _g.$1K;i.EmailAddress=f;i.Name=r;i.MailboxType="OneOff";i.RoutingType="SMTP";t.val.$F(i)}}if(t.val.get_$A()>0)return!0;else{this.$Yy(9013,null);return!1}},$7nj:function(){var u=this.$1e.recipientField;var r=this.$1e.recipientArray;var n;if(r.length>100){_js.Trace.logError(_a.$0.$4U,"Add/SetRecipientsAsync got more recipients in the list than the limit.");this.$g9();return}var t,i;if(i=this.$9qv(r,t={val:n}),n=t.val,i){if(this.$2El)this.$73.$9hP(u,n);else if(!this.$73.$9qn(u,n)){this.$Yy(9012,null);return}this.$To(null,null)}}};_ex.$1Z1=function(n,t){this.$1e=n;this.$1Gg=t};_ex.$1Z1.prototype={$1e:null,$1Gg:null,$Eh:null,$11:function(n){if(!this.$7oX(n)){_js.Trace.logError(_a.$0.$4U,String.format("API call failing due to insufficient permission {0}",this.get_$Ti()));this.$g9();return}_a.$6.stPT(_a.$0.$4U,this.get_$Ti(),5);this.$Eh=_a.$6.$1f(_a.$0.$4U,this.get_$Ti(),!0);this.$7nj()},$To:function(n,t){this.$1Gg(_ex.$1R.$4XQ(n));_a.$6.$1F(this.$Eh,this.get_$Ti(),"",t);_a.$6.endPT(this.get_$Ti())},$Yy:function(n,t){this.$1Gg(_ex.$1R.$7fI(n));_a.$6.$1F(this.$Eh,this.get_$Ti(),_ex.$F4.$8ay(n),t);_a.$6.endPT(this.get_$Ti())},$2Vm:function(n,t){this.$1Gg(n);_a.$6.$1F(this.$Eh,this.get_$Ti(),"",t);_a.$6.endPT(this.get_$Ti())},$9OJ:function(n,t,i){this.$1Gg(n);_a.$6.$1F(this.$Eh,this.get_$Ti(),t,i);_a.$6.endPT(this.get_$Ti())},$g9:function(){this.$1Gg(null);_a.$6.$1F(this.$Eh,this.get_$Ti(),"NonAPI",null);_a.$6.endPT(this.get_$Ti())},$7oX:function(n){return n===2?!0:this.get_$5HZ()===2?!1:n>=this.get_$5HZ()}};_ex.$zE=function(n,t,i,r){_ex.$zE.initializeBase(this,[n,t,i,r])};_ex.$zE.prototype={get_$Ti:function(){return"BodyPrepend"},get_$5HZ:function(){return 3},$2Mq:function(n){this.$73_1.$9Gh(n,this.$xp===3);this.$To(null,null)}};_ex.$zF=function(n,t,i,r){_ex.$zF.initializeBase(this,[n,t,i,r])};_ex.$zF.prototype={get_$Ti:function(){return"BodySetSelectedData"},get_$5HZ:function(){return 3},$2Mq:function(n){this.$73_1.$8PC(n,this.$xp===3);this.$To(null,null)}};_ex.$1Z0=function(){};_ex.$1Z0.$Vd=function(){};_ex.$1Z0.$Vd.prototype={text:0,html:3};_ex.$1Z0.$Vd.registerEnum("_ex.$1Z0.$Vd",!1);_ex.$11P=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$9ge=Function.createDelegate(this,this.$9ge);this.$$d_$8FD=Function.createDelegate(this,this.$8FD);this.$$d_$9i4=Function.createDelegate(this,this.$9i4);this.$$d_$8IG=Function.createDelegate(this,this.$8IG);_ex.$11P.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$N0=n};_ex.$11P.prototype={$N0:null,$1Ia:function(n,t){n.itemType=5;var i=this;_ex.$1Zx.prototype.$1Ia.call(this,n,function(){t()})},$2CZ:function(n){n.$3x([_ex.$27.$9("GetTimeAsync",this.$$d_$8IG),_ex.$27.$9("SetTimeAsync",this.$$d_$9i4),_ex.$27.$9("GetLocationAsync",this.$$d_$8FD),_ex.$27.$9("SetLocationAsync",this.$$d_$9ge)]);_ex.$1Zx.prototype.$2CZ.call(this,n)},$8IG:function(n,t){new _ex.$12J(this.$N0,n,t).$11(this.$8c.$5O.RequestedCapabilities)},$9i4:function(n,t){new _ex.$18B(this.$N0,n,t).$11(this.$8c.$5O.RequestedCapabilities)},$9ge:function(n,t){new _ex.$183(this.$N0,n,t).$11(this.$8c.$5O.RequestedCapabilities)},$8FD:function(n,t){new _ex.$124(this.$N0,n,t).$11(this.$8c.$5O.RequestedCapabilities)}};_ex.$1Ed=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){_ex.$1Ed.initializeBase(this,[n,t,i,r,u,!1,f,e,o,s,h,c,l,a,v,y,p,w])};_ex.$1Ed.prototype={$1Ia:function(n,t){var r=this.$b.get_$CJ()?this.$b.get_$CJ().toLowerCase():"";if(_ex.$F9.$6Nu(r)){n.itemType=2;var i=this.$b;this.$A13(i,n)}var u=this;_ex.$4e.prototype.$1Ia.call(this,n,function(){t()})},$A13:function(n,t){if(!this.get_$1LK()){_ex.$4e.$1wT(t,"to",n.get_$Bm(),n.get_$MA());_ex.$4e.$1wT(t,"cc",n.get_$DH(),null);_ex.$4e.$1wT(t,"resources",n.get_$EP(),null);n.get_$MA()&&_ex.$4e.$3fT(t,"organizer",n.get_$MA())}n.get_$6D()&&(t.location=n.get_$6D().get_$29());n.get_$1T()&&(t.start=n.get_$1T().$f9().getTime());n.get_$2y()&&(t.end=n.get_$2y().$f9().getTime())}};_ex.$1Zx=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$8CJ=Function.createDelegate(this,this.$8CJ);this.$$d_$4d0=Function.createDelegate(this,this.$4d0);this.$$d_$4cu=Function.createDelegate(this,this.$4cu);this.$$d_$9Gi=Function.createDelegate(this,this.$9Gi);this.$$d_$9hf=Function.createDelegate(this,this.$9hf);this.$$d_$9he=Function.createDelegate(this,this.$9he);this.$$d_$8HQ=Function.createDelegate(this,this.$8HQ);this.$$d_$9hs=Function.createDelegate(this,this.$9hs);this.$$d_$8Hv=Function.createDelegate(this,this.$8Hv);this.$$d_$9hQ=Function.createDelegate(this,this.$9hQ);this.$$d_$7Se=Function.createDelegate(this,this.$7Se);this.$$d_$8Gi=Function.createDelegate(this,this.$8Gi);this.$$d_$1Wv=Function.createDelegate(this,this.$1Wv);this.$$d_$4Ob=Function.createDelegate(this,this.$4Ob);this.$$d_$4Og=Function.createDelegate(this,this.$4Og);_ex.$1Zx.initializeBase(this,[t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$73=n};_ex.$1Zx.prototype={$73:null,$ia:null,get_$2DG:function(){return"ComposeAppSelection"},get_$4Qj:function(){return"ComposeAppSelectionToProgressDone"},get_$31x:function(){this.$ia||(this.$ia=new(_ex.$Ue.$$(_y.$OS))(this.$8c.$5O.Id));return this.$ia},$4Og:function(n,t){new _ex.$yQ(this.$73,this.get_$31x(),n,t).$11(this.$8c.$5O.RequestedCapabilities)},$4Ob:function(n,t){new _ex.$yP(this.$73,this.get_$31x(),n,t).$11(this.$8c.$5O.RequestedCapabilities)},$1Wv:function(n,t){new _ex.$17F(this.get_$31x(),n,t).$11(this.$8c.$5O.RequestedCapabilities)},$8Gi:function(n,t){new _ex.$VX(this.$73,n,t).$11(this.$8c.$5O.RequestedCapabilities)},$9hQ:function(n,t){new _ex.$jD(this.$73,n,t,!0).$11(this.$8c.$5O.RequestedCapabilities)},$7Se:function(n,t){new _ex.$jD(this.$73,n,t,!1).$11(this.$8c.$5O.RequestedCapabilities)},$8Hv:function(n,t){new _ex.$12G(this.$73,n,t).$11(this.$8c.$5O.RequestedCapabilities)},$9hs:function(n,t){new _ex.$18A(this.$73,n,t).$11(this.$8c.$5O.RequestedCapabilities)},$8HQ:function(n,t){new _ex.$12E(this.$73,n,t).$11(this.$8c.$5O.RequestedCapabilities)},$9he:function(n,t){new _ex.$189(this.$73,n,t,this.$n).$11(this.$8c.$5O.RequestedCapabilities)},$9hf:function(n,t){new _ex.$zF(this.$73,n,t,this.$n).$11(this.$8c.$5O.RequestedCapabilities)},$9Gi:function(n,t){new _ex.$zE(this.$73,n,t,this.$n).$11(this.$8c.$5O.RequestedCapabilities)},$8CJ:function(n,t){new _ex.$11v(this.$73,n,t).$11(this.$8c.$5O.RequestedCapabilities)},$1Ia:function(n,t){t()},$2CZ:function(n){_ex.$1R.prototype.$2CZ.call(this,n);n.$3x([_ex.$27.$9("AddItemAttachmentAsync",this.$$d_$4Og),_ex.$27.$9("AddFileAttachmentAsync",this.$$d_$4Ob),_ex.$27.$9("RemoveAttachmentAsync",this.$$d_$1Wv),_ex.$27.$9("GetRecipientsAsync",this.$$d_$8Gi),_ex.$27.$9("AddRecipientsAsync",this.$$d_$7Se),_ex.$27.$9("SetRecipientsAsync",this.$$d_$9hQ),_ex.$27.$9("GetSubjectAsync",this.$$d_$8Hv),_ex.$27.$9("SetSubjectAsync",this.$$d_$9hs),_ex.$27.$9("GetSelectedDataAsync",this.$$d_$8HQ),_ex.$27.$9("SetSelectedDataAsync",this.$$d_$9he),_ex.$27.$9("BodySetSelectedDataAsync",this.$$d_$9hf),_ex.$27.$9("BodyPrependAsync",this.$$d_$9Gi),_ex.$27.$9("LoadCustomProperties",this.$$d_$4cu),_ex.$27.$9("SaveCustomProperties",this.$$d_$4d0),_ex.$27.$9("GetBodyTypeAsync",this.$$d_$8CJ)])},$4d0:function(n,t){new _ex.$LB(this.$73,n,this.$8c.$5O.Id,t).$11(this.$8c.$5O.RequestedCapabilities)},$4cu:function(n,t){new _ex.$14T(this.$73,n,this.$8c.$5O.Id,this.$n,t).$11(this.$8c.$5O.RequestedCapabilities)}};_ex.$1R=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.$$d_$8YK=Function.createDelegate(this,this.$8YK);this.$$d_$7nq=Function.createDelegate(this,this.$7nq);this.$$d_$7np=Function.createDelegate(this,this.$7np);this.$$d_$7nr=Function.createDelegate(this,this.$7nr);this.$$d_$7nz=Function.createDelegate(this,this.$7nz);this.$$d_$9qC=Function.createDelegate(this,this.$9qC);this.$$d_$9JS=Function.createDelegate(this,this.$9JS);this.$$d_$9JO=Function.createDelegate(this,this.$9JO);this.$$d_$7oA=Function.createDelegate(this,this.$7oA);this.$$d_$7nw=Function.createDelegate(this,this.$7nw);this.$$d_$8Ed=Function.createDelegate(this,this.$8Ed);this.$$d_$97a=Function.createDelegate(this,this.$97a);this.$$d_$9q4=Function.createDelegate(this,this.$9q4);_a.$4.$z(a,"nativeBridge");this.$I=n;this.$ki=t;this.$tD=i;this.$LF=r;this.$PT=u;this.$xs=f;this.$xc=e;this.$zQ=o;this.$s5=s;this.$zG=h;this.$fR=c;this.$l=a;this.$n=v;this.$6K=_a.$6i.$9()};_ex.$1R.get_$11T=function(){_ex.$1R.$2Da||(_ex.$1R.$2Da=String.format(_nbs.NonBootStrings.l_AsyncMethodNotExecutedBecauseAsyncLimitIsExceeded_Text,3));return _ex.$1R.$2Da};_ex.$1R.get_$2Dd=function(){_ex.$1R.$2Dc||(_ex.$1R.$2Dc={wasSuccessful:!1,errorMessage:_ex.$1R.get_$11T()});return _ex.$1R.$2Dc};_ex.$1R.get_$7Vc=function(){_ex.$1R.$2Db||(_ex.$1R.$2Db={wasProxySuccessful:!1,errorMessage:_ex.$1R.get_$11T()});return _ex.$1R.$2Db};_ex.$1R.get_$7Vd=function(){_ex.$1R.$2De||(_ex.$1R.$2De={error:1,errorMessage:_ex.$1R.get_$11T()});return _ex.$1R.$2De};_ex.$1R.$4XQ=function(n){return{error:0,data:n}};_ex.$1R.$7fI=function(n){return{error:1,errorCode:n}};_ex.$1R.$6Ge=function(n){switch(n){case"Mouse":return"ThreeColumns";case"TouchNarrow":return"OneColumn";case"TouchWide":return"TwoColumns"}return null};_ex.$1R.prototype={$1RL:0,$tD:null,$LF:null,$PT:null,$I:null,$ki:null,$J6:null,$Vn:null,$8c:null,$2Tf:0,$1tk:null,$s5:null,$n:null,$xs:null,$xc:null,$zQ:null,$zG:null,$fR:null,$1ta:null,$1td:null,$11b:0,$2DA:0,$2U0:0,$1lI:!1,$2Cc:!1,$12C:null,$1Cg:null,$1Ch:null,$vM:null,$1nd:!1,$l:null,$6K:null,$1s0:null,$2Kv:0,get_$1LK:function(){return!this.$8c.$5O.RequestedCapabilities},$3e:function(n,t,i){this.$8c=n;this.$J6=t;this.$Vn=i;this.$1s0={};window.msWriteProfilerMark=this.$$d_$9q4},$9rg:function(){window.msWriteProfilerMark=null;this.$11b=0},$8Ed:function(n,t){var u=_a.$8.get_$36();var f=_a.$6.acsa(_a.$0.$4U,"GetInitialData",!0);var i={};i.permissionLevel=this.$8c.$5O.RequestedCapabilities;i.timeZoneOffsets=this.$8IH();i.hostVersion=this.$I.get_$2zO();i.owaView=_ex.$1R.$6Ge(this.$I.get_$U());i.overrideWindowOpen=this.$l.$8D(this.$l.get_$IE())&&this.$l.get_$IE().get_$2Gn().get_$2PB();if(!this.get_$1LK()){i.userDisplayName=this.$LF;i.userEmailAddress=this.$PT;i.userTimeZone=this.$tD;i.ewsUrl=this.$J6.EwsUrl}var r=this;this.$1Ia(i,function(){_a.$6.acea(f);r.$2Kv=_a.$8.get_$36().$6M(u);t(i);r.$1lI=!0;r.$2gM()})},$9K8:function(){if(!this.$1nd){if(!this.$vM){this.$vM=new(_ff.$18.$$(_ex.$27));this.$2CZ(this.$vM)}for(var t=0;t<this.$vM.get_$A();t++){var n=this.$vM.get_$E(t);this.$1tk.registerMethod(n.$W9,n.$m1,0,n.$32P)}this.$l.$8D(this.$l.get_$IE())&&this.$l.get_$IE().get_$2Gn().get_$2PB()&&this.$1tk.unregisterMethod("ContextActivationManager_openWindowInHost");this.$1nd=!0}},$9rw:function(){if(this.$1nd&&this.$vM){for(var n=0;n<this.$vM.get_$A();n++){var t=this.$vM.get_$E(n);this.$1tk.unregisterMethod(t.$W9)}this.$1nd=!1}},$7nw:function(n,t){_a.$6.stPT(_a.$0.$4U,"ExecuteEwsRequest",5);this.$12C=_a.$6.$1f(_a.$0.$4U,"ExecuteEwsRequest",!0);var i=this.$8c.$5O;if(i.RequestedCapabilities!==2){_js.Trace.logInfo(_a.$0.$4U,"Ext host: Extension '{0}' has insufficient permission for ExecuteEwsRequest",i.DisplayName);t(_ex.$1R.$1Rr);this.$Gf(this.$12C,"ExecuteEwsRequest","Failed",null);return}var s=n;var e=s.body;var o=_ex.$5K.get_$Q();if($C(e)||this.$nT(e.length,_y.$Uc.$40Y,"ExecuteEwsRequest")){t(_ex.$1R.$1Rr);this.$Gf(this.$12C,"ExecuteEwsRequest","Failed",null);return}var r,u;if(!(u=this.$1Q7(r={val:t},_ex.$1R.get_$7Vc()),t=r.val,u)){this.$Gf(this.$12C,"ExecuteEwsRequest",_ex.$1R.get_$11T(),null);return}if(!o.$34J(i.Id)||o.$8R9()){var h=this,f=this;this.$4WO("ExtensionCallback",function(r){h.$5E3(i,n,t)},function(n){t({wasProxySuccessful:!1});f.$Gf(f.$12C,"ExecuteEwsRequest","Failed",n)})}else this.$5E3(i,n,t)},$7oA:function(n,t){_a.$6.stPT(_a.$0.$4U,"ExecuteSaveSettingsRequest",5);this.$1Ch=_a.$6.$1f(_a.$0.$4U,"ExecuteSaveSettingsRequest",!0);var u=this.$8c;var c=n;var o=c[0];var s=JsonParser.serialize(o);if(this.$nT(s.length,32768,"ExecuteSaveSettingsRequest")){t({error:1});this.$Gf(this.$1Ch,"ExecuteSaveSettingsRequest","Failed",null);return}var h,f;if(!(f=this.$1Q7(h={val:t},_ex.$1R.get_$7Vd()),t=h.val,f)){this.$Gf(this.$1Ch,"ExecuteSaveSettingsRequest",_ex.$1R.get_$11T(),null);return}var i=new _ex.$p7(u.$5O.Id,u.$5O.Version,s);var r=this;i.add_$2s(function(n){if(i.get_$4d().WasSuccessful){u.set_$5VQ(o);t({error:0});r.$Gf(r.$1Ch,"ExecuteSaveSettingsRequest","",n)}else{t({errorMessage:i.get_$4d().ErrorMessage,error:1});r.$Gf(r.$1Ch,"ExecuteSaveSettingsRequest",i.get_$4d().ErrorMessage,n)}});var e=this;i.add_$2b(function(n){t({errorMessage:i.$2H.message,error:1});e.$Gf(e.$1Ch,"ExecuteSaveSettingsRequest",i.$2H.message,n)});this.$n.$1U(i)},$7nz:function(n,t){_a.$6.stPT(_a.$0.$4U,"ExecuteGetUserIdentityTokenRequest",5);this.$1Cg=_a.$6.$1f(_a.$0.$4U,"ExecuteGetUserIdentityTokenRequest",!0);if(this.get_$1LK()){_js.Trace.logInfo(_a.$0.$4U,"Ext host: Extension '{0}' has insufficient permission for ExecuteGetUserIdentityToken",this.$8c.$5O.DisplayName);t(_ex.$1R.$1Rr);this.$Gf(this.$1Cg,"ExecuteGetUserIdentityTokenRequest","InsufficientPermission",null);return}var u=_ex.$5K.get_$Q();var r=this.$8c.$5O.Id;if(!u.$34K(r)||u.$8RG()){var e,o;if(!(o=this.$1Q7(e={val:t},_ex.$1R.get_$2Dd()),t=e.val,o)){this.$Gf(this.$1Cg,"ExecuteGetUserIdentityTokenRequest",_ex.$1R.get_$11T(),null);return}var i=this,f=this;this.$4WO("CallerIdentity",function(n){i.$5E6(r,t);i.$Gf(i.$1Cg,"ExecuteGetUserIdentityTokenRequest","",n)},function(n){t({wasSuccessful:!1});f.$Gf(f.$1Cg,"ExecuteGetUserIdentityTokenRequest","Failed",n)})}else{this.$5E6(r,t);this.$Gf(this.$1Cg,"ExecuteGetUserIdentityTokenRequest","",null)}},$7nr:function(n,t){var u=n;var i=this.$7rX(u);if(!i){t(null);return}var r=this;this.$xs.$9(function(n){if(r.$I.get_$U()==="Mouse"){var f=n.$39o(i);r.$I.$VG(IComposeCalendarItemViewModelFactory,null,null,_bc.$2I.get_$r5(),f,!1)}else{var u=n.$wU(i.$5z,null,null);r.$5Xl(u)}t(null)})},$7np:function(n,t){var f=n;var u=f.itemId;if(_js.$9.$o(u)){t(null);return}var i=new _y.$BC;i.$n0(new _g.$1T(u));var r=this;this.$xc.$9(function(n){if(r.$I.get_$U()==="Mouse")r.$I.$VG(ICalendarItemDetailsViewModelFactory,null,i.$5z,_bc.$2I.get_$r5(),null,!1);else{var u=n.$wU(i.$5z,null,null);r.$5Xl(u)}t(null)})},$7nq:function(n,t){var i=n;this.$8Ep(i.itemId,this.$$d_$97a);t(null)},$8YK:function(n,t){if(this.$l.$8D(this.$l.get_$IE())){var i=n.launchUrl;i&&this.$l.get_$IE().$2PA(i)}t(null)},$9JO:function(n,t){var r=n;if(this.$8c.$5O.Origin===3){var i=new _ex.$11a(this.$8c.$5O.DisplayName.replace(_ex.$1R.$1w5,""));i.$9Fs(r);i.$1U()}t(null)},$9JS:function(n,t){var i=n;if(this.$8c.$5O.Origin!==3){t(null);return}var f=_a.$0.$4U;var u="[{0}] {1}";var r=this.$8c.$5O.DisplayName.replace(_ex.$1R.$1w5,"");switch(i.TraceLevel){case"Warning":_js.Trace.logWarning(f,u,r,i.Message);break;case"Error":_js.Trace.logError(f,u,r,i.Message);break;default:break}t(null)},$9qC:function(n,t){var r=n;if(this.$8c.$5O.Origin!==3){t(null);return}var i=this.$8c.$5O.DisplayName.replace(_ex.$1R.$1w5,"")+"."+r.Name.replace(_ex.$1R.$1w5,"");var u=r.Event;switch(u){case"Start":_a.$6.$1f(_a.$0.$4U,i);break;case"End":_a.$6.$1F(null,i);break;default:break}t(null)},setServiceEndPoint:function(n){this.$1tk=n},$8IH:function(){return this.$ki.$3Ea(this.$tD)},$7Fi:function(){this.$1lI=!1;this.$2Cc=!1;this.$2DA=0;this.$2Kv=0;this.$1RL=0;this.$2U0=0;_a.$6.stPT(_a.$0.$4U,this.get_$2DG(),5);this.$1ta=_a.$6.$1f(_a.$0.$4U,this.get_$2DG(),!0);this.$1td=_a.$6.$1f(_a.$0.$4U,this.get_$4Qj(),!0)},$2gM:function(){if(this.$1ta){this.$388(!1);var n=this.$1lI?"":"Failed";_a.$6.$1F(this.$1ta,this.get_$2DG(),n,null,this.$4np());_a.$6.endPT(this.get_$2DG());this.$1ta=null}},$388:function(n){if(this.$1td){_a.$6.$1F(this.$1td,this.get_$4Qj(),n?"":"Failed",null,this.$4np());this.$1td=null}},$Gf:function(n,t,i,r){i||(i="");var u=null;r&&(_ex.$lG.isInstanceOfType(r)&&r.$67?u=r.$67.correlationId:_ex.$p7.isInstanceOfType(r)&&r.$67?u=r.$67.correlationId:_ex.$WN.isInstanceOfType(r)&&r.$67?u=r.$67.correlationId:_ex.$p6.isInstanceOfType(r)&&r.$67?u=r.$67.correlationId:_ex.$la.isInstanceOfType(r)&&r.$67?u=r.$67.correlationId:_ex.$Vc.isInstanceOfType(r)&&r.$67&&(u=r.$67.correlationId));n?_a.$6.$1F(n,t,i,u):_a.$6.$1F(null,t,i,u);_a.$6.endPT(t)},$2CZ:function(n){n.$3x([_ex.$27.$7ea("GetInitialData",this.$$d_$8Ed),_ex.$27.$9("EwsRequest",this.$$d_$7nw),_ex.$27.$9("saveSettingsAsync",this.$$d_$7oA),_ex.$27.$9("RecordDataPoint",this.$$d_$9JO),_ex.$27.$9("RecordTrace",this.$$d_$9JS),_ex.$27.$9("TrackCtq",this.$$d_$9qC),_ex.$27.$9("GetUserIdentityToken",this.$$d_$7nz),_ex.$27.$9("DisplayNewAppointmentForm",this.$$d_$7nr),_ex.$27.$9("DisplayExistingAppointmentForm",this.$$d_$7np),_ex.$27.$9("DisplayExistingMessageForm",this.$$d_$7nq),_ex.$27.$9("LaunchPalUrl",this.$$d_$8YK)])},$30a:function(n){this.$2U0|=n},$nT:function(n,t,i){if(n>t){_js.Trace.logWarning(_a.$0.$4U,"{0} in ext host: Extension '{1}' exceeded limit of {2}, actual is {3}.",i,this.$8c.$5O.DisplayName,t,n);return!0}return!1},$1Q7:function(n,t){if(this.$2Tf<3){var r=n.val;var i=this;n.val=function(n){i.$7cJ();r(n)};this.$2Tf++;return!0}n.val(t);return!1},$7cJ:function(){this.$2Tf--},$9q4:function(n){if(!_js.$9.$o(n)){n===OSF.NotificationUxPerfMarker.RemoveLoadingAnimationEnd?this.$388(!0):n===OSF.OsfControlActivationPerfMarker.SelectionTimeout?this.$388(!1):n===OSF.OsfControlActivationPerfMarker.ActivationStart&&this.$2DA++;if(n.endsWith("Start")){n=n.substr(0,n.length-5);var i=_a.$6.acsa(_a.$0.$4U,n,!0);this.$1s0[n]=i}else if(n.endsWith("End")){n=n.substr(0,n.length-3);var t=this.$1s0[n];if(t){_a.$6.acea(t);delete this.$1s0[n]}}}},$5E6:function(n,t){var i="";_ex.$5K.get_$Q().$34K(n)&&(i=_ex.$5K.get_$Q().$8IU(n).TokenValue);t({wasSuccessful:!0,token:i})},$4WO:function(n,t,i){for(var f=new(_ff.$18.$$(String)),r=0;r<this.$J6.Extensions.length;r++){var e=this.$J6.Extensions[r];(n==="CallerIdentity"&&e.RequestedCapabilities>=1||n==="ExtensionCallback"&&e.RequestedCapabilities===2)&&f.$F(this.$J6.Extensions[r].Id)}var u=new _ex.$la(f.$3T(),n);u.add_$2s(t);u.add_$2b(i);this.$n.$1U(u)},$5E3:function(n,t,i){var s=t;var o=s.body;var f="";if(_ex.$5K.get_$Q().$34J(n.Id)){f=_ex.$5K.get_$Q().$8Dr(n.Id).TokenValue;var r=new _ex.$lG(o,f,n.Id);var u=this;r.add_$2s(function(n){i({wasProxySuccessful:r.get_$4d().WasProxySuccessful,errorMessage:r.get_$4d().ErrorMessage,statusCode:r.get_$4d().StatusCode,statusDescription:r.get_$4d().StatusDescription,body:r.get_$4d().Body});u.$Gf(u.$12C,"ExecuteEwsRequest","",r)});var e=this;r.add_$2b(function(n){i({wasProxySuccessful:!1,errorMessage:r.$2H.message,statusCode:500,statusDescription:r.$2H.message,body:null});e.$Gf(e.$12C,"ExecuteEwsRequest",r.$2H.message,r)});this.$n.$1U(r)}else i({wasProxySuccessful:!0,errorMessage:null,statusCode:200,statusDescription:"",body:""})},$4np:function(){if(!this.$11b){var r=this.$6K.$63("ExtAppVistedUrls");var u=this.$8c.$1RN.toLowerCase();this.$11b=_js.$9.$o(r)?3:-1!==r.indexOf(u)?1:2}if(!this.$2Cc&&this.$1lI&&this.$11b!==1){var t=this.$6K.$63("ExtAppVistedUrls");var i=this.$8c.$1RN.toLowerCase();if(t){t.length>5e3&&(t=t.substr(i.length));t+=i}else t=i;this.$6K.$I6("ExtAppVistedUrls",t);this.$2Cc=!0}var n=new _a.$3z;n.$5H("G",this.$2Kv);n.$5H("S",this.$11b);this.$1RL&&n.$5H("E",this.$1RL);n.$5H("R",this.$2DA);n.$5H("F",this.$2U0);n.$CW("Id",this.$8c.$5O.Id);n.$CW("Name",this.$8c.$5O.DisplayName);return n.toString()},$97a:function(n){if(n.get_$Hy()){var i=this;this.$s5.$9(function(t){var r=t.$H0(!0,!1);r.$4rz(n);i.$zQ.$9(function(n){i.$I.$VG(IMailComposeViewModelFactory,function(){return n},null,_bc.$2I.get_$r5(),r,!1)})})}else{var t=this;this.$zG.$9(function(i){var r=i.$9(!1);r.set_$E(n);t.$fR.$9(function(n){t.$I.$VG(IItemReadingPaneViewModelPopOutFactory,function(){return n},null,_bc.$2I.get_$r5(),r,!1)})})}},$7rX:function(n){var t=new _bc.$Nh;if("requiredAttendees"in n){t.set_$Bm(new _js.$X);var e=n.requiredAttendees;if(this.$nT(e.length,100,"ExecuteDisplayNewAppointmentForm.requiredAttendees"))return null;for(var f=0;f<e.length;f++)t.get_$Bm().$F(_g.$2o.$4fC(e[f]))}if("optionalAttendees"in n){t.set_$DH(new _js.$X);var o=n.optionalAttendees;if(this.$nT(o.length,100,"ExecuteDisplayNewAppointmentForm.optionalAttendees"))return null;for(var i=0;i<o.length;i++)t.get_$DH().$F(_g.$2o.$4fC(o[i]))}if("start"in n&&!$C(n.start)){var v=n.start;var w=new Date(v);t.set_$1T(_a.$8.$4fA(w))}else{var a=_a.$1x.$34q(_a.$8.get_$36());t.set_$1T(a)}if("end"in n){var p=n.end;var y=new Date(p);t.set_$LM(_a.$8.$4fA(y).$6M(t.get_$1T()))}else t.set_$LM(18e5);if("subject"in n){var s=n.subject;if(this.$nT(s.length,255,"ExecuteDisplayNewAppointmentForm.subject"))return null;t.set_$3n(s)}if("body"in n){var u=n.body;if(this.$nT(u.length,32768,"ExecuteDisplayNewAppointmentForm.Body"))return null;var r;r=this.$I.get_$U()==="Mouse"?new _g.$5d("HTML",_a.$1J.$4W7(u)):new _g.$5d("Text",u);var l=new _g.$5E(r);t.set_$4n(l)}var h=_g.$3Q.$1CH();if("location"in n){var c=n.location;if(this.$nT(c.length,255,"ExecuteDisplayNewAppointmentForm.location"))return null;h.set_$29(c)}t.set_$6D(h);return t},$8Ep:function(n,t){var f=_h.$o.get_$Q();var i=f.$63(n);if($C(i)||$C(i.get_$4n()))if(!$C(i)&&i.get_$Hy())this.$4ml(n,i.get_$zy(),t);else{var u=this;var r=function(i){i.get_$Hy()?u.$4ml(n,i.get_$zy(),t):t(i)};this.$3bJ(n,_h.$f.get_$3yx(),"ItemNormalizedBody",r)}else t(i)},$4ml:function(n,t,i){var r;r=this.$I.get_$U()==="Mouse"&&t!==1?_h.$f.get_$24B():_h.$f.get_$3L6();this.$3bJ(n,r,"MailCompose",i)},$3bJ:function(n,t,i,r){var f=new _g.$1T(n);var u=new _h.$lh(100,[f],t,i,0,!1);var e=this;u.add_$2s(function(t){var i=_h.$o.get_$Q().$63(n);r(i)});this.$n.$1U(u)},$5Xl:function(n){this.$I.$Ax(n)}};_ex.$Ud=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.$ki=n;this.$LF=t;this.$PT=i;this.$tD=r;this.$I=u;this.$zG=f;this.$fR=e;this.$s5=o;this.$1Lv=s;this.$1D=h;this.$l=c;this.$n=l;this.$1G=a};_ex.$Ud.prototype={$ki:null,$LF:null,$PT:null,$tD:null,$I:null,$s5:null,$1Lv:null,$zG:null,$fR:null,$1G:null,$xc:null,$zQ:null,$xs:null,$1D:null,$l:null,$n:null,$4Wy:function(n,t){return new _ex.$11W(this.$I,this.$ki,this.$tD,this.$LF,this.$PT,t,this.$xs,this.$xc,this.$zQ,this.$s5,this.$1Lv,this.$zG,this.$fR,n,this.$1D,this.$l,this.$n,this.$1G)},$7ek:function(n){return new _ex.$1Ed(this.$I,this.$ki,this.$tD,this.$LF,this.$PT,this.$xs,this.$xc,this.$zQ,this.$s5,this.$1Lv,this.$zG,this.$fR,n,this.$1D,this.$l,this.$n,this.$1G)},$5tr:function(n){return new _ex.$11V(n,this.$I,this.$ki,this.$tD,this.$LF,this.$PT,this.$xs,this.$xc,this.$zQ,this.$s5,this.$zG,this.$fR,this.$1D,this.$l,this.$n)},$5t4:function(n){return new _ex.$11P(n,this.$I,this.$ki,this.$tD,this.$LF,this.$PT,this.$xs,this.$xc,this.$zQ,this.$s5,this.$zG,this.$fR,this.$1D,this.$l,this.$n)}};_ex.$11V=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){_ex.$11V.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$38c=n};_ex.$11V.prototype={$38c:null,$1Ia:function(n,t){n.itemType=4;n.conversationId=this.$38c.$4mX();var i=this;_ex.$1Zx.prototype.$1Ia.call(this,n,function(){t()})}};_ex.$11W=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){_ex.$11W.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b])};_ex.$11W.prototype={$1Ia:function(n,t){var i=this.$b.get_$CJ()?this.$b.get_$CJ().toLowerCase():"";if(_ex.$F9.$4w5(i)){if(_g.$9y.isInstanceOfType(this.$b)){n.itemType=3;this.$7Rx(n)}else n.itemType=1;this.$8ZC(n,t)}else _ex.$4e.prototype.$1Ia.call(this,n,t)},$8ZC:function(n,t){var r=this.$b;n.conversationId=r.get_$5N()?r.get_$5N().Id:null;n.internetMessageId=r.get_$HR();if(this.get_$1LK())_ex.$4e.prototype.$1Ia.call(this,n,t);else if(r.$21w){this.$30a(16);var i=new _h.$lY(this.$b.get_$y());var f=this;i.add_$2b(function(){_js.Trace.logWarning(_a.$0.$4U,"GetAllRecipients to fetch extra recipients failed "+i.$2H);f.$30a(256)});var u=this;i.add_$4T(function(){u.$4PG(n,t)});OwaApplication.$2B.$1U(i)}else this.$4PG(n,t)},$4PG:function(n,t){var i=this.$b;_ex.$4e.$3fT(n,"from",i.get_$5Q());_ex.$4e.$3fT(n,"sender",i.get_$Ek());_ex.$4e.$4Of(n,"to",i.get_$77());_ex.$4e.$4Of(n,"cc",i.get_$7x());n.itemType===3&&this.$7TN(n);_ex.$4e.prototype.$1Ia.call(this,n,t)},$7TN:function(n){var t=this.$b;_ex.$4e.$1wT(n,"to",t.get_$Px().get_$Bm(),t.get_$Px().get_$MA());_ex.$4e.$1wT(n,"cc",t.get_$Px().get_$DH(),null);_ex.$4e.$1wT(n,"resources",t.get_$Px().get_$EP(),null)},$7Rx:function(n){var t=this.$b;t.get_$Px().get_$6D()&&(n.location=t.get_$Px().get_$6D().get_$29());t.get_$Px().get_$1T()&&(n.start=t.get_$Px().get_$1T().$f9().getTime());t.get_$Px().get_$2y()&&(n.end=t.get_$Px().get_$2y().$f9().getTime())}};_ex.$Ue=function(n){this.$1rf={};this.$32E=n};_ex.$Ue.$$=function(n){var t="$Ue"+"$"+n.getName().replace(/\./g,"_");if(!_ex[t]){var r=_ex[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_ex.$Ue.apply(this,t)};r.registerClass("_ex."+t);var e={"_ex.$Ue":{T:n}};r.prototype.$$gta=e;var f=_ex.$Ue.prototype;for(var u in f){var i={key:u,value:f[u]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _ex[t]};_ex.$Ue.prototype={$32E:null,$18J:0,$F:function(n){var t=this.$32E+(+new Date).toString()+this.$18J.toString();this.$1rf[t]=n;this.$18J++;return t},$7TT:function(n,t){this.$1rf[n]=t;return n},$9O7:function(n,t){var i=this.$1rf[n];t&&delete this.$1rf[n];return i}};_ex.$4e=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){this.$$d_$7ns=Function.createDelegate(this,this.$7ns);this.$$d_$7nt=Function.createDelegate(this,this.$7nt);this.$$d_$4d0=Function.createDelegate(this,this.$4d0);this.$$d_$4cu=Function.createDelegate(this,this.$4cu);this.$$d_$7ny=Function.createDelegate(this,this.$7ny);_ex.$4e.initializeBase(this,[n,t,i,r,u,e,o,s,h,l,a,y,p,w]);this.$jX=f;this.$b=v;this.$1G=b;this.$1Lv=c};_ex.$4e.$3fT=function(n,t,i){$C(i)||(n[t]=_ex.$4e.$4XF(i.Mailbox))};_ex.$4e.$4Of=function(n,t,i){if(!$C(i)&&i.get_$A()>0){for(var f=[],r=0;r<i.get_$A()&&r<100;r++){var u=i.get_$E(r);$C(u)||(f[r]=_ex.$4e.$4XF(u))}n[t]=f}};_ex.$4e.$1wT=function(n,t,i,r){var f=null;var o=0;var s=!1;if(r&&r.Mailbox){s=!0;f=new Array(0);f[o++]=_ex.$4e.$4WT(r.Mailbox,"Organizer")}if(!$C(i)&&i.get_$A()>0){f||(f=new Array(0));for(var e=0;e<i.get_$A()&&o<100;e++){var u=i.get_$E(e);if(u&&u.get_$AA()){if(s&&r.Mailbox.EmailAddress&&u.get_$AA().EmailAddress&&u.get_$AA().EmailAddress.toLowerCase()===r.Mailbox.EmailAddress.toLowerCase())continue;f[o++]=_ex.$4e.$4WT(u.get_$AA(),u.get_$i6())}}}n[t]=f};_ex.$4e.$4XF=function(n){var t={};t.name=n.Name;t.address=n.EmailAddress;t.recipientType=_ex.$4e.$3LH(n.MailboxType);return t};_ex.$4e.$3LH=function(n){switch(n){case"PublicDL":case"PrivateDL":case"PublicFolder":return 1;case"Mailbox":case"Contact":return 2;case"OneOff":return 3;default:return 0}};_ex.$4e.$7Rp=function(n,t){if(!$C(t)&&t.get_$A()>0){for(var f=[],u=0;u<t.get_$A();u++){var i=t.get_$E(u);var r={};if(i){r.id=i.get_$6I().Id;r.name=i.get_$1x();r.contentType=i.get_$KK();r.size=i.get_$8A();r.attachmentType=_g.$54.isInstanceOfType(i)?0:1;r.isInline=i.get_$C9();f[u]=r}}n.attachments=f}};_ex.$4e.$4WT=function(n,t){var r={};r.name=n.Name;r.address=n.EmailAddress;r.recipientType=_ex.$4e.$3LH(n.MailboxType);var i=0;switch(t){case"Organizer":i=1;break;case"Tentative":i=2;break;case"Accept":i=3;break;case"Decline":i=4;break;case"NoResponseReceived":i=5;break}r.appointmentResponse=i;return r};_ex.$4e.prototype={$jX:!1,$1G:null,$1Lv:null,$b:null,get_$2DG:function(){return"ReadAppSelection"},get_$4Qj:function(){return"ReadAppSelectionToProgressDone"},$7ny:function(n,t){_a.$6.stPT(_a.$0.$4U,"ExecuteGetCallbackTokenRequest",5);var i=_a.$6.$1f(_a.$0.$4U,"ExecuteGetCallbackTokenRequest",!0);if(this.get_$1LK()){_js.Trace.logInfo(_a.$0.$4U,"Ext host: Extension '{0}' has insufficient permission for ExecuteGetCallbackToken",this.$8c.$5O.DisplayName);t(_ex.$1R.$1Rr);this.$Gf(i,"ExecuteGetCallbackTokenRequest","InsufficientPermission",null);return}var f,e;if(!(e=this.$1Q7(f={val:t},_ex.$1R.get_$2Dd()),t=f.val,e)){this.$Gf(i,"ExecuteGetCallbackTokenRequest",_ex.$1R.get_$11T(),null);return}var r=new _ex.$Vc(this.$8c.$5O.Id,String.format("ParentItemId:{0}",this.$b.get_$y().Id));var u=this;r.add_$2s(function(n){u.$97m(t,n);u.$Gf(i,"ExecuteGetCallbackTokenRequest","",n)});var o=this;r.add_$2b(function(n){t({wasSuccessful:!1});o.$Gf(i,"ExecuteGetCallbackTokenRequest","Failed",n)});OwaApplication.$2B.$1U(r)},$4cu:function(n,t){_a.$6.stPT(_a.$0.$4U,"ExecuteLoadCustomPropRequest",5);var r=_a.$6.$1f(_a.$0.$4U,"ExecuteLoadCustomPropRequest",!0);var s=n;var i=new _ex.$WN(this.$8c.$5O.Id,this.$b.get_$y().Id);var f,u;if(!(u=this.$1Q7(f={val:t},_ex.$1R.get_$2Dd()),t=f.val,u)){this.$Gf(r,"ExecuteLoadCustomPropRequest","InsufficientPermission",null);return}var e=this;i.add_$2s(function(n){t({errorMessage:i.get_$4d().ErrorMessage,wasSuccessful:i.get_$4d().WasSuccessful,customProperties:i.get_$4d().CustomProperties});e.$Gf(r,"ExecuteLoadCustomPropRequest","",n)});var o=this;i.add_$2b(function(n){t({errorMessage:i.$2H.message,wasSuccessful:!1,customProperties:null});o.$Gf(r,"ExecuteLoadCustomPropRequest",i.$2H.message,n)});OwaApplication.$2B.$1U(i)},$4d0:function(n,t){_a.$6.stPT(_a.$0.$4U,"ExecuteSaveCustomPropRequest",5);var r=_a.$6.$1f(_a.$0.$4U,"ExecuteSaveCustomPropRequest",!0);var c=n;var h=c.customProperties;var e=JsonParser.serialize(h);if(this.$nT(e.length,2500,"ExecuteSaveCustomPropertiesRequest")){t(_ex.$1R.$1Rr);this.$Gf(r,"ExecuteSaveCustomPropRequest","Failed",null);return}var u,f;if(!(f=this.$1Q7(u={val:t},_ex.$1R.get_$2Dd()),t=u.val,f)){this.$Gf(r,"ExecuteSaveCustomPropRequest",_ex.$1R.get_$11T(),null);return}var i=new _ex.$p6(this.$8c.$5O.Id,this.$b.get_$y().Id,e);var o=this;i.add_$2s(function(n){t({errorMessage:i.get_$4d().ErrorMessage,wasSuccessful:i.get_$4d().WasSuccessful});o.$Gf(r,"ExecuteSaveCustomPropRequest","",n)});var s=this;i.add_$2b(function(n){t({errorMessage:i.$2H.message,wasSuccessful:!1});s.$Gf(r,"ExecuteSaveCustomPropRequest",i.$2H.message,n)});OwaApplication.$2B.$1U(i)},$7nt:function(n,t){if(!this.$8Vb()){t(null);return}var r="";var i=n;if(i&&"htmlBody"in i){r=i.htmlBody;if(this.$nT(r.length,32768,"ExecuteDisplayReplyForm.htmlBody")){t(null);return}}this.$5XW(1,r);t(null)},$7ns:function(n,t){if(!this.$8Va()){t(null);return}var r="";var i=n;if(i&&"htmlBody"in i){r=i.htmlBody;if(this.$nT(r.length,32768,"ExecuteDisplayReplyAllForm.htmlBody")){t(null);return}}this.$5XW(2,r);t(null)},$1Ia:function(n,t){if(this.$8Tm())this.$8ZB(n,t);else{this.$30I(n);t()}},$2CZ:function(n){_ex.$1R.prototype.$2CZ.call(this,n);n.$3x([_ex.$27.$9("GetCallbackToken",this.$$d_$7ny),_ex.$27.$9("LoadCustomProperties",this.$$d_$4cu),_ex.$27.$9("SaveCustomProperties",this.$$d_$4d0),_ex.$27.$9("DisplayReplyForm",this.$$d_$7nt),_ex.$27.$9("DisplayReplyAllForm",this.$$d_$7ns)])},$30I:function(n){n.id=this.$b.get_$y().Id;n.itemClass=this.$b.get_$CJ();this.$b.get_$1CU()&&(n.dateTimeCreated=this.$b.get_$1CU().$f9().getTime());this.$b.get_$Jl()&&(n.dateTimeModified=this.$b.get_$Jl().$f9().getTime());this.$b.get_$16r()&&(n.dateTimeSent=this.$b.get_$16r().$f9().getTime());$C(this.$b.get_$r2())||(n.entities=this.$8Dt(this.$b.get_$r2()));var i=this.$Vn.$em.$8DS();i&&(n.filteredEntities=i);if(!this.get_$1LK()){n.subject=this.$b.get_$3n();n.normalizedSubject=this.$b.get_$149();var t=this.$Vn.$1Wq;$C(t)||(n.regExMatches=t);_ex.$4e.$7Rp(n,this.$b.get_$EU())}},$8Tm:function(){if(this.$b.get_$r2())return!1;var n=this.$b.get_$2t2();return n?n.ExtractedAddresses||n.ExtractedContacts||n.ExtractedEmails||n.ExtractedMeetings||n.ExtractedPhones||n.ExtractedTasks||n.ExtractedUrls:!1},$8ZB:function(n,t){var i=new _ex.$lg(this.$b);var u=_a.$8.get_$36();var f=this;i.add_$2s(function(i){f.$1RL=_a.$8.get_$36().$6M(u);f.$30I(n);t()});var r=this;i.add_$2b(function(f){_js.Trace.logWarning(_a.$0.$4U,"GetItem to fetch entities failed "+i.$2H);r.$30a(1);r.$1RL=_a.$8.get_$36().$6M(u);r.$30I(n);t()});OwaApplication.$2B.$1U(i)},$8Dt:function(n){var t={};t.Addresses=_ex.$3l.$12p(n.Addresses,3,this.$jX);t.Urls=_ex.$3l.$12p(n.Urls,4,this.$jX);t.PhoneNumbers=_ex.$3l.$12p(n.PhoneNumbers,5,this.$jX);if(!this.get_$1LK()){t.Contacts=_ex.$3l.$12p(n.Contacts,7,this.$jX);t.EmailAddresses=_ex.$3l.$12p(n.EmailAddresses,6,this.$jX);t.MeetingSuggestions=_ex.$3l.$12p(n.MeetingSuggestions,1,this.$jX);t.TaskSuggestions=_ex.$3l.$12p(n.TaskSuggestions,2,this.$jX)}return t},$5XW:function(n,t){var i=this;this.$s5.$9(function(r){var u=r.$H0(!0,!1);u.set_$6W(n);u.$1Ta(i.$b);var e=u.$1kC(!0);var f;if(n===1)f=new _g.$gc;else if(n===2)f=new _g.$gb;else return;f.$3dd(e.get_$Ad());f.set_$2SQ(new _g.$5E(new _g.$5d("HTML",t)));f.set_$2tW(i.$b.get_$y());u.$6MG(f);i.$1Lv.$9(function(n){var t=n.$4XI(u,f,i.$1G);t.$M6=0;t.add_$2s(function(n){_js.Trace.logInfo(_a.$0.$4U,"Create response action succeeded");var t=n;if(t.$99===u.get_$D1()){u.$AU();u.set_$5j(0);u.set_$6W(4);u.set_$Fc(t.$5i);var i=new _y.$Cb;i.$WH(u)}});OwaApplication.$2B.$1U(t)})})},$8Va:function(){return this.$b?_g.$2g.isInstanceOfType(this.$b)?this.$b.get_$11f():!0:!1},$8Vb:function(){return this.$b?_g.$2g.isInstanceOfType(this.$b)?this.$b.get_$xk():!0:!1},$97m:function(n,t){var i="";t&&_ex.$Vc.isInstanceOfType(t)&&t.$PS&&(i=t.$PS.TokenValue);n({wasSuccessful:!0,token:i})}};_ex.$11v=function(n,t,i){_ex.$11v.initializeBase(this,[t,i]);this.$73=n};_ex.$11v.prototype={$73:null,get_$Ti:function(){return"GetBodyType"},get_$5HZ:function(){return 1},$7nj:function(){var t=this.$73.$2Kg();var n=null;t==="Text"?n="text":t==="HTML"&&(n="html");this.$To(n,null)}};_ex.$124=function(n,t,i){_ex.$124.initializeBase(this,[t,i]);this.$N0=n};_ex.$124.prototype={$N0:null,get_$Ti:function(){return"GetLocation"},get_$5HZ:function(){return 1},$7nj:function(){var n=this.$N0.$3EA();this.$To(n,null)}};_ex.$VX=function(n,t,i){_ex.$VX.initializeBase(this,[t,i]);this.$73=n};_ex.$VX.$7qw=function(n){var u=[];if(!n)return u;for(var f=n.get_$A()>100?100:n.get_$A(),t=0;t<f;t++){var r=n.get_$E(t).get_$2Uy();var i={};i.recipientType=_ex.$4e.$3LH(r.get_$2Z().MailboxType);i.address=r.get_$2Z().EmailAddress||null;i.name=r.get_$29();u[t]=i}return u};_ex.$VX.prototype={$73:null,get_$Ti:function(){return"GetRecipients"},get_$5HZ:function(){return 1},$7nj:function(){var i=this.$1e.recipientField;var t=this.$73.$8Gh(i);var n=_ex.$VX.$7qw(t);this.$To(n,null)}};_ex.$12G=function(n,t,i){_ex.$12G.initializeBase(this,[t,i]);this.$73=n};_ex.$12G.prototype={$73:null,get_$Ti:function(){return"GetSubject"},get_$5HZ:function(){return 1},$7nj:function(){var n=this.$73.$uv();this.$To(n||"",null)}};_ex.$12E=function(n,t,i){_ex.$12E.initializeBase(this,[t,i]);this.$73=n};_ex.$12E.prototype={$73:null,get_$Ti:function(){return"GetSelectedData"},get_$5HZ:function(){return 1},$7nj:function(){var e=this.$1e;var n=0;var t;var s=e.coercionType;var f,r,u;var o=(u=this.$73.$8HP(s===_ex.$1Z0.$Vd.toString(3)?_ex.$1Z0.$Vd.toString(3):_ex.$1Z0.$Vd.toString(0),f={val:t},r={val:n}),t=f.val,n=r.val,u);if(n)this.$Yy(n,null);else{var i={};i.data=o;i.sourceProperty=t;this.$To(i,null)}}};_ex.$12J=function(n,t,i){_ex.$12J.initializeBase(this,[t,i]);this.$N0=n};_ex.$12J.prototype={$N0:null,get_$Ti:function(){return"GetTime"},get_$5HZ:function(){return 1},$7nj:function(){var n=null;var t=this.$1e.TimeProperty;t===1?n=this.$N0.$3sO():t===2&&(n=this.$N0.$3rq());this.$To(n.$f9().getTime(),null)}};_ex.$14T=function(n,t,i,r,u){this.$$d_$2nM=Function.createDelegate(this,this.$2nM);this.$$d_$2nQ=Function.createDelegate(this,this.$2nQ);_ex.$14T.initializeBase(this,[t,u]);this.$N1=i;this.$73=n;this.$n=r};_ex.$14T.prototype={$N1:null,$73:null,$n:null,get_$Ti:function(){return"ExecuteLoadCustomPropRequestForCompose"},get_$5HZ:function(){return 0},$7nj:function(){var t=this.$73.$3Dt();if(t)for(var n=t.get_$A()-1;n>=0;n--)if(_h.$6B.$4u9(t.get_$E(n),this.$N1)){this.$2Vm({wasSuccessful:!0,customProperties:t.get_$E(n).get_$1Z()},null);return}var r=this.$73.$2Kx();if(!r){this.$2Vm({wasSuccessful:!0,customProperties:"{}"},null);return}var u=this.$1e;var i=new _ex.$WN(this.$N1,this.$73.$2Kx());i.add_$2s(this.$$d_$2nQ);i.add_$2b(this.$$d_$2nM);this.$n.$1U(i)},$2nQ:function(n){var t=n;var r={wasSuccessful:t.get_$4d().WasSuccessful,customProperties:t.get_$4d().CustomProperties};if(!_js.$9.$o(t.get_$4d().CustomPropertyNames)){var i=this.$73.$3Dt();_h.$6B.$4Op(i,t.get_$4d().CustomPropertyNames)}this.$2Vm(r,n.$99)},$2nM:function(n){_js.Trace.logError(_a.$0.$4U,"custom properties load failed with "+n.$2H);var t={errorMessage:n.$2H.message,wasSuccessful:!1,customProperties:null};this.$9OJ(t,n.$2H.message,n.$99)}};_ex.$17F=function(n,t,i){this.$$d_$5wn=Function.createDelegate(this,this.$5wn);_ex.$17F.initializeBase(this,[t,i]);this.$ia=n};_ex.$17F.prototype={$ia:null,$11V:null,$1PZ:null,get_$Ti:function(){return"RemoveAttachment"},get_$5HZ:function(){return 3},$7nj:function(){this.$1PZ=this.$1e.attachmentIndex;if(this.$1PZ.length>200){_js.Trace.logError(_a.$0.$4U,"RemoveFileAttachment got too long attachmentId");this.$g9();return}if(!this.$1PZ){_js.Trace.logError(_a.$0.$4U,"RemoveAttachment got null or empty attachmentIndex");this.$g9();return}this.$11V=this.$ia.$9O7(this.$1PZ,!0);if(!this.$11V){this.$Yy(9008,null);return}if(this.$11V.get_$1dQ()){this.$To(null,null);return}this.$11V.add_$1ro(this.$$d_$5wn);this.$11V.get_$1CW().$11()},$5wn:function(n){this.$11V.remove_$1ro(this.$$d_$5wn);if(n.get_$3S6()){this.$ia.$7TT(this.$1PZ,this.$11V);this.$Yy(9009,null);return}this.$To(null,null)}};_ex.$LB=function(n,t,i,r){_ex.$LB.initializeBase(this,[t,r]);this.$N1=i;this.$73=n};_ex.$LB.prototype={$N1:null,$73:null,get_$Ti:function(){return"ExecuteSaveCustomPropRequestCompose"},get_$5HZ:function(){return 0},$7nj:function(){var f=this.$1e;var e=f.customProperties;var u=JsonParser.serialize(e);if(u.length>2500){this.$g9();return}for(var r=_h.$6B.$7fM(this.$N1,u),n=this.$73.$3Dt(),i=!1,t=0;t<n.get_$A();t++)if(_h.$6B.$4u9(n.get_$E(t),this.$N1)){n.set_$E(t,r);i=!0;break}i||this.$7SW(n,r);this.$73.$8b3();this.$2Vm(_ex.$LB.$4YR,null)},$7SW:function(n,t){n.$F(t);_h.$6B.$4Op(n,t.get_$Lx().get_$Mn())}};_ex.$1Zw=function(n,t,i,r){this.$$d_$9Os=Function.createDelegate(this,this.$9Os);this.$$d_$9Ot=Function.createDelegate(this,this.$9Ot);_ex.$1Zw.initializeBase(this,[t,i]);this.$73_1=n;this.$n=r};_ex.$1Zw.prototype={$73_1:null,$n:null,$xp:0,$7nj:function(){var i=this.$1e;var n=i.data;if(n.length>1e6){this.$g9();return}var u,r;if(r=this.$9wM(i.coercionType,u={val:this.$xp}),this.$xp=u.val,r)if(this.$xp===3)if(_js.$9.$o(n))this.$2Mq("");else{var t=new _ex.$17V(n);t.add_$2s(this.$$d_$9Ot);t.add_$2b(this.$$d_$9Os);this.$73_1.$9mw();this.$n.$1U(t)}else this.$73_1.$2Kg()==="HTML"?this.$2Mq(_ff.$2a.$Jc(n)):this.$2Mq(n)},$9Os:function(n){_js.Trace.logError(_a.$0.$4U,"Sanitize html failed with "+n.$2H);this.$Yy(9011,null)},$9Ot:function(n){_js.Trace.logInfo(_a.$0.$4U,"Sanitize html succeeded.");if(this.$73_1.$2Kg()==="HTML"){var u=n;var t=u.get_$4d();var r;this.$9ME(r={val:t}),t=r.val;var i=this;this.$73_1.$7a4(function(n){n?i.$Yy(9014,null):i.$2Mq(t)})}else this.$Yy(2006,null)},$9ME:function(n){n.val=n.val.trim();n.val.substr(0,5).toLowerCase()==="<div>"&&n.val.substr(n.val.length-6,6).toLowerCase()==="</div>"&&(n.val=n.val.substring(5,n.val.length-6))},$9wM:function(n,t){var i=this.$73_1.$2Kg();t.val=n;if(!$C(n)){if(i==="Text"&&t.val===3){this.$Yy(2006,null);return!1}return!0}this.$g9();return!1}};_ex.$183=function(n,t,i){_ex.$183.initializeBase(this,[t,i]);this.$N0=n};_ex.$183.prototype={$N0:null,get_$Ti:function(){return"SetLocation"},get_$5HZ:function(){return 3},$7nj:function(){var n=this.$1e.location;if(n.length>255)this.$g9();else{this.$N0.$9gc(n);this.$To(null,null)}}};_ex.$18A=function(n,t,i){_ex.$18A.initializeBase(this,[t,i]);this.$73=n};_ex.$18A.prototype={$73:null,get_$Ti:function(){return"SetSubject"},get_$5HZ:function(){return 3},$7nj:function(){var n=this.$1e.subject;if(n.length>255){this.$g9();return}this.$73.$9hr(n);this.$To(null,null)}};_ex.$189=function(n,t,i,r){_ex.$189.initializeBase(this,[n,t,i,r]);this.$73=n};_ex.$189.prototype={$73:null,get_$Ti:function(){return"SetSelectedData"},get_$5HZ:function(){return 3},$2Mq:function(n){var t;var i;this.$73.$9hd(n,this.$xp===3,i={val:t}),t=i.val;t?this.$Yy(t,null):this.$To(null,null)}};_ex.$18B=function(n,t,i){_ex.$18B.initializeBase(this,[t,i]);this.$N0=n};_ex.$18B.prototype={$N0:null,get_$Ti:function(){return"SetTime"},get_$5HZ:function(){return 3},$7nj:function(){var i=this.$1e.TimeProperty;var r=this.$1e.time;var n=_a.$8.$rB(new Date(r));var t=!0;i===1?this.$N0.$9hn(n):i===2&&(t=this.$N0.$9rG(n));t?this.$To(null,null):this.$Yy(9010,null)}};_ex.$27=function(n,t,i){this.$W9=n;this.$m1=t;this.$32P=i};_ex.$27.$9=function(n,t){return new _ex.$27(n,t,!1)};_ex.$27.$7ea=function(n,t){return new _ex.$27(n,t,!0)};_ex.$27.prototype={$W9:null,$32P:!1,$m1:null};_ex.$19a=function(n,t){this.$1ZH=n;this.$3C=t};_ex.$19a.prototype={$1ZH:null,$3C:null,get_$ExA:function(){return this.$1ZH},get_$1x:function(){return this.$3C},get_$8A:function(){return 0},get_$6h:function(){return""}};_ex.$kQ=function(n,t){this.$$d_$2Hq=Function.createDelegate(this,this.$2Hq);this.$$d_$4pK=Function.createDelegate(this,this.$4pK);_ex.$kQ.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;this.dispose=this.$1v;_ex.$kQ.initializeBase(this);this.$65=n;this.$Q5=t;if(this.$Q5==="TouchNarrow"){this.set_$A0(_y.$1i.$FB(this));var r=this;var i=new _C(function(){r.$5P()},_a.$0.$4U);this.$5w.set_$Tp([_y.$1P.$SB(_nbs.NonBootStrings.l_Close_LowerCase_Text,i)])}};_ex.$kQ.prototype={$Q5:0,$7a:null,$65:null,$v7:!1,$11r:null,$pQ:null,get_$2sh:function(){return 2},get_$3sq:function(){return this.$$d_$4pK},get_$gw:function(){return this.$7a},set_$gw:function(n){this.$7a=n;return n},get_$7kt:function(){return!0},get_$S5:function(){return this.$Q5==="TouchNarrow"?1:0},$4pK:function(n,t){if(this.$v7)return!1;if(this.$pQ){this.$11r=n;this.$pQ(this.$$d_$2Hq);return!0}this.$2Hq();return!1},$5P:function(){if(!this.$v7&&this.$7a){this.$7a();this.$65.$32A(!1)}},$2Hq:function(){this.$v7=!0;this.$11r&&this.$11r()}};_ex.$KL=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){this.$$d_$979=Function.createDelegate(this,this.$979);this.$$d_$5Ef=Function.createDelegate(this,this.$5Ef);this.$$d_$4dw=Function.createDelegate(this,this.$4dw);this.$$d_$6op=Function.createDelegate(this,this.$6op);this.$$d_$953=Function.createDelegate(this,this.$953);this.$$d_$97z=Function.createDelegate(this,this.$97z);this.$$d_$7D7=Function.createDelegate(this,this.$7D7);_ex.$KL.initializeBase(this,[r,u,f,e,o,s,h,c,l,a,v,y,p,w]);_a.$6.stPT(_a.$0.$4U,"EnableAppsButton",5);this.$1uc=_a.$6.$1f(_a.$0.$4U,"EnableAppsButton",!0);this.$FC=t;this.set_$31G(_nbs.NonBootStrings.l_ComposeAppsForOutlook_Text);this.set_$3Ff(!1);this.set_$1PS(!0);this.$2DE=i;this.$15N=new _C(this.$$d_$7D7,n);this.$15N.set_$8F(!1);this.$3Fd=new _C(this.$$d_$97z,n);this.$32B=new _C(this.$$d_$953,n)};_ex.$KL.prototype={$13X:null,$2DF:null,$2M5:!1,$2DE:null,$1YL:!1,$2I9:!1,$1PR:!1,$2DD:0,$15N:null,$3Fd:null,$32B:null,$2DL:!1,$FC:null,$Si:null,$1uc:null,add_$2Sw:function(n){this.$31("OnAppsPaneOpened",n)},remove_$2Sw:function(n){this.$5d("OnAppsPaneOpened",n)},add_$5D8:function(n){this.$31("OnAppsPaneClosed",n)},remove_$5D8:function(n){this.$5d("OnAppsPaneClosed",n)},add_$2T8:function(n){this.$31("OnExtensionOpened",n)},remove_$2T8:function(n){this.$5d("OnExtensionOpened",n)},add_$3RD:function(n){this.$31("BackToList",n)},remove_$3RD:function(n){this.$5d("BackToList",n)},get_$2x6:function(){return this.$15N},set_$7qh:function(n){if(this.$2I9!==n){this.$2I9=n;this.$4("ForceHideAppsButton")}return n},get_$5Wp:function(){return this.$1YL},set_$5Wp:function(n){if(this.$1YL!==n){this.$1YL=n;this.$4("ShowAppsButton")}return n},get_$3ga:function(){return this.$2DD},set_$3ga:function(n){if(this.$2DD!==n){this.$2DD=n;this.$4("AppPaneSize")}return n},get_$1PS:function(){return this.$1PR},set_$1PS:function(n){if(this.$1PR!==n){this.$1PR=n;this.$4("AppPaneIsHidden")}return n},get_$13L:function(){return this.$FC.$aR===1},get_$6TH:function(){return this.$VE.get_$U()==="TouchNarrow"},set_$505:function(n){this.$13X=n;if(n.$cw===3){var t=this.$13X.$38M.get_$2f().extensionViewModel;this.$1Mn(t)}return n},set_$31G:function(n){if(this.$2DF!==n){this.$2DF=n;this.$4("AppPaneTitle")}return n},set_$3Ff:function(n){if(this.$2M5!==n){this.$2M5=n;this.$4("HideExtensionsList")}return n},get_$2Oc:function(){return this.$VE.get_$U()!=="Mouse"},$72:function(){this.$5Kt();this.set_$1PS(!0);this.$8MK();this.$FC&&this.$FC.$p("Orientation",this.$$d_$6op);_ex.$2G.prototype.$72.call(this)},$AI:function(){this.$9re();this.$FC&&this.$FC.$1B("Orientation",this.$$d_$6op);_ex.$2G.prototype.$AI.call(this)},$1Mn:function(n){if(n){this.set_$3Ff(!0);this.set_$222(!1);this.set_$31G(n.get_$1lH().DisplayName);if(this.$l.$8D(this.$l.get_$IE())){var t=this;this.$l.get_$IE().$4cH(n.get_$4cO(),n.get_$1lH().DisplayName,function(){t.$5N2(n)},this.$$d_$4dw)}else this.$5N2(n)}else this.$l.$8D(this.$l.get_$IE())?this.$l.get_$IE().$4dA():this.$4dw()},$7D7:function(){_a.$6.stPT(_a.$0.$4U,"ShowAppPane",3);var n=_a.$6.$1f(_a.$0.$4U,"ShowAppPane",!0);if(this.$VE.get_$U()==="Mouse"){if(this.$1PR){this.set_$3ga(342);this.set_$1PS(!1);this.$5D6(1)}}else if(this.$VE.get_$U()!=="TouchNarrow"&&this.$FC.$aR)this.set_$1PS(!1);else{this.$Si=this.$2HY.$7ew(this,this.$VE.get_$U());this.$Si.$pQ=this.$$d_$5Ef;this.$VE.$Ax(this.$Si)}this.$6S("OnAppsPaneOpened");_a.$6.$1F(n,"ShowAppPane","");_a.$6.endPT("ShowAppPane")},$220:function(n){if(!this.$1PR){var t=null;if(n){_a.$6.stPT(_a.$0.$4U,"HideAppPane",3);t=_a.$6.$1f(_a.$0.$4U,"HideAppPane",!0)}this.$32A(!1);this.set_$3ga(0);this.set_$1PS(!0);this.$6S("OnAppsPaneClosed");this.$5D6(2);if(n){_a.$6.$1F(t,"HideAppPane","");_a.$6.endPT("HideAppPane")}}},$32A:function(n){var t=null;if(n){_a.$6.stPT(_a.$0.$4U,"CloseComposeApp",3);t=_a.$6.$1f(_a.$0.$4U,"CloseComposeApp",!0)}this.$1Mn(null);if(n){_a.$6.$1F(t,"CloseComposeApp","");_a.$6.endPT("CloseComposeApp")}},$4Zn:function(n){return!n},$953:function(){this.$32A(!0)},$6op:function(n,t){this.get_$13L()?this.$Si&&this.$Si.$5P():this.$220(!1);this.$6S("OnAppsPaneClosed")},$97z:function(){this.$VE.get_$U()!=="TouchWide"||this.get_$13L()?this.$220(!0):this.$Si&&this.$Si.$5P()},$5N2:function(n){this.$6S("OnExtensionOpened");_ex.$2G.prototype.$1Mn.call(this,n);this.$1WF(!0)},$4dw:function(){this.$1t8(!0);this.set_$31G(_nbs.NonBootStrings.l_ComposeAppsForOutlook_Text);this.set_$3Ff(!1);this.$6S("BackToList");_ex.$2G.prototype.$1Mn.call(this,null)},$8MK:function(){this.$p(_ex.$2G.$469,this.$$d_$979);this.$p(_ex.$2G.$40U,this.$$d_$979);this.$p("ForceHideAppsButton",this.$$d_$979);this.$2DL=!0},$9re:function(){if(this.$2DL){this.$1B(_ex.$2G.$469,this.$$d_$979);this.$1B(_ex.$2G.$40U,this.$$d_$979);this.$1B("ForceHideAppsButton",this.$$d_$979);this.$2DL=!1}},$979:function(n,t){(t===_ex.$2G.$469||t===_ex.$2G.$40U||t==="ForceHideAppsButton")&&this.$5Kt()},$5D6:function(n){this.$2DE&&this.$2DE(n)},$5Ef:function(n){this.$1Mn(null);n()},$5Kt:function(){this.set_$5Wp(!this.$2I9&&(!this.$468||!!this.$1Ui));this.$15N.set_$8F(this.$1YL);if(this.$1uc&&this.$1YL){_a.$6.$1F(this.$1uc,"EnableAppsButton");_a.$6.endPT("EnableAppsButton");this.$1uc=null}}};_ex.$11S=function(){_ex.$11S.initializeBase(this,[1,"VM.Extensibility.Stats"])};_ex.$11S.prototype={set_$7dO:function(n){this.$P("ContextRetrievalTime",n);return n},set_$7dL:function(n){this.$P("ContextExtensionsCount",n);return n},set_$8ba:function(n){this.$P("MaxCountOfActiveExtensions",n);return n},set_$7Pq:function(n){this.$P("ActivationTime",n);return n},set_$9pk:function(n){this.$P("TotalActivationStatistics",n);return n},set_$9Jv:function(n){this.$P("RegExStatistics",n);return n},set_$9EW:function(n){this.$P("PerExtensionStatistics",n);return n},set_$v6:function(n){this.$P("Interval",n);return n},set_$7rB:function(n){this.$P("FromHtmlStatistics",n);return n},set_$8P3:function(n){this.$P("InnerTextStatistics",n);return n},set_$8MU:function(n){this.$P("HtmlBodyLengthStatistics",n);return n},set_$7do:function(n){this.$P("ConvertedBodyLengthStatistics",n);return n},set_$7nO:function(n){this.$P("EntityStatistics",n);return n}};_ex.$F4=function(){};_ex.$F4.$8ay=function(n){var i=n.toString();var t=_ex.$F4.$L0[i];if(!t){t=_js.$1I.$Gr(_y.$11T,n);_ex.$F4.$L0[i]=t}return t};_ex.$BG=function(n,t){this.$$d_$9QD=Function.createDelegate(this,this.$9QD);this.$$d_$9G6=Function.createDelegate(this,this.$9G6);_ex.$BG.initializeBase(this);this.$Ii=n;this.$iB=t;this.$10D=new _C(this.$$d_$9G6,_a.$0.$4U);this.$1Jd=new _fm.$1t(new Array(0));this.$r4=new _js.$X};_ex.$BG.prototype={$p4:0,$Ii:null,$r4:null,$1Jd:null,$iB:null,$2M4:!0,$1Hr:null,$13X:null,$10D:null,set_$4qO:function(n){if(this.$2M4!==n){this.$2M4=n;this.$4(_ex.$BG.$4qP)}return n},set_$2Zp:function(n){if(this.$1Hr!==n){this.$1Hr=n;$C(n)||this.$4(_ex.$BG.$3bo)}return n},set_$505:function(n){this.$13X=n;if(n.$cw===3){var t=this.$13X.$38M.get_$2f().extensionViewModel;if($C(t)||this.$1Hr===t){this.$iB.$8c=null;this.$iB.$11();this.$Vc()}else{this.$iB.$8c=t;this.$iB.$11();this.set_$2Zp(t)}}return n},$Vc:function(){this.$1Hr=null;this.$4(_ex.$BG.$3bo)},$9G6:function(){if(!(this.$p4<1)){var n=0;var i=this.$Ii.get_$A();var e=!1;var t=this.$1Hr;var r=this.$p4;this.$r4.$1u();while(n<r&&n<i){var o=this.$Ii.get_$E(n);var u=n+1===r||n+1===i;($C(t)||o.$5O.Id===t.$5O.Id)&&(e=!0);var f=u&&!e?t:this.$Ii.get_$E(n);this.$r4.$F(f);f.set_$4vp(u&&i<=r);n++}this.set_$2Zp(t);this.$49R()}},$9QD:function(n){n.set_$4vp(!1);this.$r4.$5W(this.$r4.get_$A()-1);this.$r4.$F(n);this.$iB.$8c=n;this.$iB.$11();this.set_$2Zp(n);this.$49R()},$49R:function(){var i=this.$Ii.get_$A();if(i>this.$p4){var t=0;this.$1Jd.$1a.$1u();while(t<i){var n=this.$Ii.get_$E(t);if(this.$r4.$7q(n)<0){var r=new _fm.$d(n.$5O.DisplayName,null,new _ex.$bT(this.$$d_$9QD,n),!0);this.$1Jd.$1a.$F(r)}t++}this.set_$4qO(!1)}else{this.$1Jd.$1a.$1u();this.set_$4qO(!0)}}};_ex.$lI=function(n,t,i){this.$$d_$4dy=Function.createDelegate(this,this.$4dy);this.$$d_$2Hq=Function.createDelegate(this,this.$2Hq);this.$$d_$4pK=Function.createDelegate(this,this.$4pK);_ex.$lI.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;this.dispose=this.$1v;_ex.$lI.initializeBase(this);this.$65=n;this.$Q5=i;if(i!=="Mouse"){this.set_$A0(_y.$1i.$FB(this));var e=this;var o=new _C(function(){e.$5P()},_a.$0.$4U);this.$5w.set_$Tp([_y.$1P.$SB(_nbs.NonBootStrings.l_Close_LowerCase_Text,o)])}if(i==="TouchWide"&&t.get_$2Oj())if(_g.$2g.isInstanceOfType(this.$65.$b))this.set_$3Jh(this.$65.$b.get_$4n().get_$1Z());else if(this.$65.$b.get_$Ml()&&this.$65.$b.get_$Ml().get_$1Z())this.set_$3Jh(this.$65.$b.get_$Ml().get_$1Z());else{var r=_ff.$1q.$4s(_h.$f.get_$3yx());r.MaximumBodySize=0;r.MaximumRecipientsToReturn=0;var u=new _h.$Fz(100,[this.$65.$b.get_$y()],r,"ItemNormalizedBody",0,!1);var f=this;u.add_$2s(function(n){f.set_$3Jh(f.$65.$b.get_$Ml().get_$1Z())});OwaApplication.$2B.$1U(u)}};_ex.$lI.prototype={$Q5:0,$7a:null,$65:null,$pQ:null,$3Jg:null,$v7:!1,$11r:null,set_$3Jh:function(n){this.$3Jg=n;this.$4("ItemBodyValue");return n},get_$2sh:function(){return 4},get_$3sq:function(){return this.$$d_$4pK},get_$gw:function(){return this.$7a},set_$gw:function(n){this.$7a=n;return n},get_$7kt:function(){return!0},get_$S5:function(){return this.$Q5!=="Mouse"?1:0},$4pK:function(n,t){if(this.$v7)return!1;if(this.$pQ){this.$11r=n;this.$pQ(this.$$d_$2Hq);return!0}this.$2Hq();return!1},$5P:function(){this.$v7||(this.$Q5==="TouchNarrow"?this.$pQ?this.$pQ(this.$$d_$4dy):this.$4dy():this.$7a&&this.$7a())},$4dy:function(){this.$v7=!0;this.$7a&&this.$7a()},$2Hq:function(){this.$v7=!0;this.$11r&&this.$11r()}};_ex.$Uf=function(){};_ex.$Uf.prototype={$7fN:function(n,t,i){return new _ex.$lI(n,t,i)},$7ew:function(n,t){return new _ex.$kQ(n,t)}};_ex.$11X=function(){this.$$d_$4mf=Function.createDelegate(this,this.$4mf);this.$3K9=_a.$8.$mC;this.$11E=[];this.$1Ci={};this.$1Cj={}};_ex.$11X.prototype={$51S:100,$35u:6e5,$nR:null,$bA:null,$TH:null,$1Cf:null,$5cT:function(n,t){if(!this.$1ub()){this.$TH||(this.$TH=new _ex.$11X.$4dO);if(!this.$TH.$1sp){this.$TH.$1sp=[];this.$TH.$1Wr=[]}Array.add(this.$TH.$1sp,n);Array.add(this.$TH.$1Wr,t)}},$9qG:function(n){this.$1Cj[n]=$C(this.$1Cj[n])?1:this.$1Cj[n]+1},$5cQ:function(n,t,i){i&&(this.$1Ci[n]=$C(this.$1Ci[n])?1:this.$1Ci[n]+1);if(!this.$1ub()){this.$TH||(this.$TH=new _ex.$11X.$4dO);this.$TH.$3as=t;this.$TH.$306=i;this.$TH.$2P=n;this.$nR||(this.$nR=new _ex.$11X.$4Nu);Array.add(this.$nR.$2Mc,this.$TH);this.$TH=null}},$5cS:function(n,t){if(!this.$1ub()){this.$1Cf||(this.$1Cf=new _ex.$11X.$7of);this.$1Cf.$5cS(n,t)}},$5cV:function(n){if(!this.$1ub()){this.$nR||(this.$nR=new _ex.$11X.$4Nu);this.$nR.$3cc=n;Array.add(this.$11E,this.$nR);this.$nR=null}},$9qB:function(n,t,i,r){if(!this.$1ub()){this.$bA||(this.$bA=new _ex.$11X.$7Wz);this.$bA.$3Ft.$2W(n,null);this.$bA.$3GW.$2W(r,null);this.$bA.$39j.$2W(i,null);this.$bA.$34e.$2W(t,null)}},$4eN:function(){var n=_a.$8.get_$36();if(n.$6M(this.$3K9)>=this.$35u){_a.$i.$Ih.$7Qq(this.$$d_$4mf);this.$9N4();this.$3K9=n}},$9N4:function(){this.$11E=[];this.$1Ci={};this.$1Cj={};this.$nR=null;this.$TH=null;this.$bA=null;this.$1Cf=null},$uL:function(n){var t=new Sys.StringBuilder;if($C(_ex.$4V.$ei))t.append("Extensions are not initialized yet.");else{n&&t.append('<TABLE class="errorReportingTable">');t.appendLine(this.$4mf().$Gr(n));n&&t.append("</TABLE>")}return new _a.$F3("Pending Extensibility Statistics",t.toString())},$4mf:function(){var l=_ex.$4V.$ei.Extensions.length;var n=new _ex.$11S;n.set_$7dO(_ex.$4V.$2P3);n.set_$7dL(l);if(this.$11E.length>0){for(var e=0,h=new _ex.$Gz,i={},c=new _ex.$Gz,r=0;r<this.$11E.length;r++){var u=this.$11E[r];h.$2W(u.$3cc,null);for(var f=0,s=0;s<u.$2Mc.length;s++){var t=u.$2Mc[s];var o=t.$2P;t.$306&&f++;$C(i[o])&&(i[o]=new _ex.$Gz);i[o].$2W(t.$3as,null);t.$9uq(c)}f>e&&(e=f)}n.set_$8ba(e);n.set_$7Pq(this.$11E.length);n.set_$9pk(h.$we());n.set_$9EW(this.$9RI(i));n.set_$9Jv(c.$we());n.set_$v6(this.$35u/1e3);if(this.$bA){n.set_$7rB(this.$bA.$39j.$we());n.set_$8P3(this.$bA.$3GW.$we());n.set_$8MU(this.$bA.$3Ft.$we());n.set_$7do(this.$bA.$34e.$we())}this.$1Cf&&n.set_$7nO(this.$1Cf.$we())}return n},$9RI:function(n){for(var t=new Sys.StringBuilder,r=0;r<_ex.$4V.$ei.Extensions.length;r++){var i=_ex.$4V.$ei.Extensions[r];var f=$C(this.$1Ci[i.Id])?0:this.$1Ci[i.Id];var u=$C(this.$1Cj[i.Id])?0:this.$1Cj[i.Id];t.append("[");t.append(i.Id);t.append(",");t.append(i.DisplayName);t.append(";");t.append(n[i.Id]?n[i.Id].$we():"");t.append(";");t.append(f.toString());t.append(",");t.append(u.toString());t.append("]")}return t.toString()},$1ub:function(){return this.$11E.length>=this.$51S||!_js.Trace.$43}};_ex.$11X.$4Nu=function(){this.$2Mc=[]};_ex.$11X.$4Nu.prototype={$3cc:0};_ex.$11X.$7Wz=function(){this.$39j=new _ex.$Gz;this.$3GW=new _ex.$Gz;this.$3Ft=new _ex.$Gz;this.$34e=new _ex.$Gz};_ex.$11X.$4dO=function(){};_ex.$11X.$4dO.prototype={$2P:null,$1sp:null,$1Wr:null,$3as:0,$306:!1,$9uq:function(n){if(this.$1Wr)for(var t=0;t<this.$1Wr.length;t++)n.$2W(this.$1Wr[t],this.$1sp[t])}};_ex.$11X.$7of=function(){};_ex.$11X.$7of.prototype={$3Po:0,$3Pp:0,$3Pq:0,$3Pr:0,$3Ps:0,$3Pt:0,$3Pu:0,$144:null,$5cS:function(n,t){this.$144=null;var i=!t;if(n){var r=new(_ff.$18.$$(_g.$BM));if(n.ExtractedAddresses&&(i||!t.Addresses)){this.$1BP(3);this.$3Po++}if(n.ExtractedContacts&&(i||!t.Contacts)){this.$1BP(7);this.$3Pp++}if(n.ExtractedEmails&&(i||!t.EmailAddresses)){this.$1BP(6);this.$3Pq++}if(n.ExtractedMeetings&&(i||!t.MeetingSuggestions)){this.$1BP(1);this.$3Pr++}if(n.ExtractedPhones&&(i||!t.PhoneNumbers)){this.$1BP(5);this.$3Ps++}if(n.ExtractedTasks&&(i||!t.TaskSuggestions)){this.$1BP(2);this.$3Pt++}if(n.ExtractedUrls&&(i||!t.Urls)){this.$1BP(4);this.$3Pu++}}},$we:function(){var n=new Sys.StringBuilder;n.append(String.format("MissingEntitiesCount:{0},{1},{2},{3},{4},{5},{6}.",this.$3Po,this.$3Pp,this.$3Pq,this.$3Pr,this.$3Ps,this.$3Pt,this.$3Pu));if(this.$144){n.append("MissingOnLastMessage:");for(var t=0;t<this.$144.get_$A();t++){n.append(_g.$BM.toString(this.$144.get_$E(t)));n.append(",")}}return n.toString()},$1BP:function(n){this.$144||(this.$144=new(_ff.$18.$$(_g.$BM)));this.$144.$F(n)}};_ex.$11Y=function(n){this.$2i=n};_ex.$11Y.prototype={$2i:null,$Um:null,$2V:function(n,t,i){this.$Um=_js.$D.get_$Q().$2V(i,this.$2i,n,t)},$33A:function(){this.$Um&&(this.$Um=_js.$D.get_$Q().$6Q(this.$Um))}};_ex.$sk=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.$$d_$5Ef=Function.createDelegate(this,this.$5Ef);this.$$d_$4dx=Function.createDelegate(this,this.$4dx);this.$$d_$5Gy=Function.createDelegate(this,this.$5Gy);_ex.$sk.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v])};_ex.$sk.prototype={$Si:null,$2Hp:null,$1Mn:function(n){_ex.$2G.prototype.$1Mn.call(this,n);this.$9jw()},$AI:function(){_ex.$2G.prototype.$AI.call(this);this.$Si&&this.$Si.$5P()},$4Zn:function(n){return"Mouse"!==this.$VE.get_$U()||!n},$5Gy:function(){this.$1WF(!0);this.$7go()},$9jw:function(){"Mouse"!==this.$VE.get_$U()&&this.$CM&&(this.$l.$8D(this.$l.get_$IE())?this.$l.get_$IE().$4cH(this.$CM.get_$4cO(),this.$CM.get_$1lH().DisplayName,this.$$d_$5Gy,this.$$d_$4dx):this.$5Gy())},$7go:function(){this.$Si=this.$2HY.$7fN(this,this.$az,this.$VE.get_$U());this.$Si.$pQ=this.$$d_$5Ef;this.$VE.$Ax(this.$Si)},$5Ef:function(n){this.$dg&&this.$dg.$Vc();this.$2Hp=n;this.$1t8(!0);this.$l.$8D(this.$l.get_$IE())?this.$l.get_$IE().$4dA():this.$4dx()},$4dx:function(){this.$2Hp&&this.$2Hp()}};_ex.$2G=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.$$d_$7aG=Function.createDelegate(this,this.$7aG);this.$$d_$97Y=Function.createDelegate(this,this.$97Y);this.$$d_$978=Function.createDelegate(this,this.$978);this.$$d_$2Kr=Function.createDelegate(this,this.$2Kr);this.$$d_$8Jf=Function.createDelegate(this,this.$8Jf);this.$$d_$9Ce=Function.createDelegate(this,this.$9Ce);this.$$d_$1Mn=Function.createDelegate(this,this.$1Mn);_ex.$2G.initializeBase(this);this.$Hm=n;this.$2HY=u;this.$l=t;this.$az=i;this.$VE=r;this.$Ii=new _js.$X;this.$QS=new _y.$NH;this.$jP=[];this.$3SF=_ex.$2G.$8G6(o);this.$iB=new _ex.$bT(this.$$d_$1Mn,null);this.$3S2=new _C(this.$$d_$9Ce,_a.$0.$4U);this.$2Vl=f;this.$vA=e;this.$2HN=s;this.$FE=h;this.$b=c;this.$xJ=l;this.$fE=a;this.$1G=v};_ex.$2G.add_$2TB=function(n){_ex.$2G.$12o||(_ex.$2G.$12o=new Sys.EventHandlerList);_ex.$2G.$12o.addHandler(_ex.$2G.$5E2,n)};_ex.$2G.remove_$2TB=function(n){_ex.$2G.$12o&&_ex.$2G.$12o.removeHandler(_ex.$2G.$5E2,n)};_ex.$2G.$8G6=function(n){return n?n.replace("osfruntime_strings.js",""):""};_ex.$2G.$2D8=function(n,t){var i=document.createElement("link");i.setAttribute("rel","stylesheet");i.setAttribute("type","text/css");i.setAttribute("href",t);n.appendChild(i)};_ex.$2G.prototype={$VE:null,$az:null,$2HY:null,$FE:null,$Hm:null,$3S2:null,$QS:null,$l:null,$3SF:null,$xJ:null,$fE:null,$iB:null,$1Q9:null,$14k:null,$J6:null,$1uZ:!1,$dg:null,$1af:null,$Ii:null,$CM:null,$b:null,$1TN:!0,$468:!0,$1Ui:null,$2Vl:!1,$vA:!1,$2HN:null,$1Dx:null,$1G:null,$DQ:!1,$jP:null,get_$7bO:function(){switch(this.$VE.get_$U()){case"Mouse":return 3;case"TouchNarrow":return 1;case"TouchWide":return 2}return 3},get_$C1B:function(){return"extensionHighlight"},get_$Anh:function(){return this.$J6},get_$Dje:function(){return null},get_$8Td:function(){return this.$J6?this.$J6.IsInOrgMarketplaceRole:!1},set_$5GF:function(n){this.$dg!==n&&(this.$dg=n);this.$4("OverflowMenuViewModel");return n},set_$486:function(n){if(this.$1af!==n){this.$1af=n;this.$4("OsfContextActivationManager")}return n},get_$1tT:function(){return this.$CM},set_$1tT:function(n){if(this.$CM!==n){$C(n)||this.$FE.$9qG(n.get_$1lH().Id);this.$CM=n;this.$4("SelectedExtension")}return n},set_$222:function(n){if(this.$1TN!==n){this.$1TN=n;this.$4(_ex.$2G.$8Lf)}return n},get_$2qu:function(){return this.$468},set_$2qu:function(n){if(this.$468!==n){this.$468=n;this.$4(_ex.$2G.$469)}return n},get_$224:function(){return this.$jP},set_$224:function(n){if(this.$jP!==n){this.$jP=n;this.$4(_ex.$2G.$8MC)}return n},get_$C7s:function(){return!1},set_$6XE:function(n){this.$1Ui=n;this.$4(_ex.$2G.$40U);return n},$1Mn:function(n){n&&this.$CM===n||this.$fE.$2gM();if(n){this.$fE.$7Fi();if(!this.$1af){var t=_a.$6.acsa(_a.$0.$4U,"ContextActivationManager",!0);this.$1WF(!1);this.set_$486(this.$5tE("15.01"));this.$1t8(!1);_a.$6.acea(t)}this.$60Q(n);this.set_$224(n.get_$224())}else{this.$3ma();this.set_$224([])}this.set_$222(this.$4Zn(n));this.set_$1tT(n)},$AI:function(){_ex.$2G.remove_$2TB(this.$$d_$8Jf);this.$DQ=!1;this.$fE.$2gM();this.$3ma();this.set_$1tT(null);this.$dg&&this.$dg.$Vc();this.$dg=null;this.set_$222(!0);this.$Ii.$1u();this.set_$2qu(!0);this.$xJ.$AU();this.$7Yn()},$72:function(){if(this.$az.get_$94I()){this.$Ii.$1u();if(this.$xJ.$9is()){this.$DQ=!0;if(_a.$8I.$4x6()){_a.$8I.$5Mb();_ex.$2G.$2Na=!1;_ex.$2G.add_$2TB(this.$$d_$8Jf);this.$3Du()}else if($C(this.$J6)&&$C(_ex.$4V.$ei)){_ex.$2G.add_$2TB(this.$$d_$8Jf);this.$3Du()}else{$C(this.$J6)&&!$C(_ex.$4V.$ei)&&(this.$J6=_ex.$4V.$ei);this.$4Nt()}}}},$978:function(n){if(this.$2Vl&&this.$14k){this.$14k.$2y();this.$14k=null}this.$9Io(n);if(this.$1Dx){var t=null;_ex.$4V.isInstanceOfType(n)&&n.$67&&(t=n.$67.correlationId);_a.$6.$1F(this.$1Dx,"GetListOfApps","",t);_a.$6.endPT("GetListOfApps");this.$1Dx=null}},$4Nt:function(){if(this.$xJ){this.$VE.get_$U()==="Mouse"&&this.$J6.MarketplaceUrl&&this.set_$6XE(this.$J6.MarketplaceUrl);if(!$C(this.$J6.Extensions)&&this.$J6.Extensions.length){var n=this;this.$xJ.$60f(this.$J6.Extensions,function(t){if(n.$xJ){if(t.get_$A()>0){n.$Ii.$3x(t.$3T());n.$ApI();n.set_$5GF(new _ex.$BG(n.$Ii,n.$iB));n.$dg.$Vc();n.set_$2qu(!1);n.$4(_ex.$2G.$7oW)}else n.set_$2qu(!0);n.$4(_ex.$2G.$7Pt)}})}}},$60Q:function(n){this.$fE.$3e(n,this.$J6,n.$Vn);this.$fE.$9K8()},$1WF:function(n){this.$5H9(n)&&this.$2HN.$1o(_a.$Ee,new _a.$Ee(!0,"Extensibility"))},$1t8:function(n){this.$5H9(n)&&this.$2HN.$1o(_a.$Ee,new _a.$Ee(!1,"Extensibility"))},$5tE:function(n){var i=new OSF.ContextActivationManager({appName:64,appVersion:n,clientMode:1,appUILocale:this.$Hm,dataLocale:"",hostControl:this.$fE,localizedScriptsUrl:this.$3SF,docUrl:""});var t={frameBorder:"0"};this.$az.get_$JK()&&this.$az.get_$8Z()&&(t.sandbox="allow-scripts allow-forms allow-same-origin");i.setIframeAttributeBag(t);return i},$5H9:function(n){return!this.$az.get_$3I3()&&!this.$az.get_$3wo()?!1:!n||this.$CM&&!this.$CM.get_$1lH().Type?!0:!1},$9Ce:function(){if(this.$1Ui){_a.$6.stPT(_a.$0.$4U,"GetMoreApps",3);var n=_a.$6.$1f(_a.$0.$4U,"GetMoreApps",!0);this.$QS.$aQ(this.$1Ui);this.$9mC();_a.$6.$1F(n,"GetMoreApps","");_a.$6.endPT("GetMoreApps")}},$Dqr:function(){var n=document.getElementsByTagName("head")[0];_ex.$2G.$2D8(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js");_ex.$2G.$2D8(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/o15apptofilemappingtable.js");_ex.$2G.$2D8(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/"+this.$Hm.toLowerCase()+"/office_strings.js");_ex.$2G.$2D8(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/"+this.$Hm.toLowerCase()+"/outlook_strings.js");_ex.$2G.$2D8(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/en-us/office_strings.js");_ex.$2G.$2D8(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/en-us/outlook_strings.js");_ex.$2G.$2D8(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/outlookwebapp-15.01.js")},$ApI:function(){this.$4("ActiveExtensions")},$3ma:function(){this.$fE.$9rg();this.$fE.$9rw()},$3Du:function(){if((!_ex.$2G.$2Na||this.$1uZ)&&!this.$vA){_a.$6.stPT(_a.$0.$4U,"GetListOfApps",5);this.$1Dx=_a.$6.$1f(_a.$0.$4U,"GetListOfApps",!0);_ex.$2G.$2Na=!0;this.$2Kr();if(this.$2Vl){this.$14k=new _ex.$17P(3,3e4,this.$$d_$2Kr,_a.$0.$4U,"GetExtensibilityContext");this.$14k.$1T()}}},$2Kr:function(){var n=new _ex.$4V;n.add_$2s(this.$$d_$978);n.add_$2b(this.$$d_$97Y);n.$11(this.get_$7bO(),this.$Hm)},$97Y:function(n){if(this.$14k&&this.$14k.$2Lk&&this.$1Dx){var t=null;_ex.$4V.isInstanceOfType(n)&&n.$67&&(t=n.$67.correlationId);_a.$6.$1F(this.$1Dx,"GetListOfApps","Failed",t);_a.$6.endPT("GetListOfApps")}},$7Yn:function(){this.$1Q9&&this.$1Q9.$33A()},$9mC:function(){if(!this.$1Q9){this.$1Q9=new _ex.$11Y("CheckNewApp");this.$5K7()}},$5K7:function(){this.$1Q9.$2V(this.$$d_$7aG,5e3,_a.$0.$4U)},$7aG:function(){if(_a.$8I.$4x6()){_a.$8I.$5Mb();this.$1uZ=!0;this.$3Du()}this.$5K7()},$9Io:function(n){if(_ex.$2G.$12o){var t=_ex.$2G.$12o.getHandler(_ex.$2G.$5E2);$C(t)||t(n)}},$8Jf:function(n){_ex.$2G.remove_$2TB(this.$$d_$8Jf);if(this.$J6){if(this.$1uZ){this.$1uZ=!1;_ex.$4V.$2P3=n.$2FK}}else{_ex.$4V.$2P3=n.$2FK;this.$J6=_ex.$4V.$ei;this.$1G&&this.$1G.$2u("AgavePerformance")&&this.$Dqr();this.$4Nt()}}};_ex.$11Z=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$FC=n;this.$1lG=t;this.$Hm=i;this.$1Mv=r;this.$l=u;this.$1D=f;this.$I=e;this.$N=o;this.$1bW=s;this.$1bX=h;this.$FE=c;this.$1G=l};_ex.$11Z.prototype={$Hm:null,$1Mv:null,$l:null,$1D:null,$I:null,$1lG:null,$N:null,$1bW:null,$1bX:null,$FE:null,$FC:null,$1G:null,$7f6:function(n){var t=!this.$1G.$2u("ContextualApps");return null},$4Wy:function(n,t){return this.$7j(n,this.$1bW.$4XD(n,t),this.$1bX.$4Wy(n,t))},$7ek:function(n){return this.$7j(n,this.$1bW.$4XD(n,!1),this.$1bX.$7ek(n))},$5tr:function(n,t){return new _ex.$KL(_a.$0.$15,this.$FC,t,this.$Hm,this.$l,this.$1D,this.$I,this.$1lG,!0,_a.$7Z.$z6(),this.$1Mv,this.$N,this.$FE,null,this.$1bW.$4WZ(2),this.$1bX.$5tr(n),this.$1G)},$5t4:function(n,t){return new _ex.$KL(_a.$0.$25,this.$FC,t,this.$Hm,this.$l,this.$1D,this.$I,this.$1lG,!0,_a.$7Z.$z6(),this.$1Mv,this.$N,this.$FE,null,this.$1bW.$4WZ(3),this.$1bX.$5t4(n),this.$1G)},$7hV:function(n,t){return new _ex.$19a(n,t)},$7j:function(n,t,i){return new _ex.$sk(this.$Hm,this.$l,this.$1D,this.$I,this.$1lG,!0,_a.$7Z.$z6(),this.$1Mv,this.$N,this.$FE,n,t,i,this.$1G)}};_ex.$11a=function(n){_ex.$11a.initializeBase(this,[1,"VM.Extensibility."+n])};_ex.$11a.prototype={$1U:function(){_a.$i.$Ih.$JT(this)},$9Fs:function(n){var r=n;for(var i in r){var t={key:i,value:r[i]};this.$P(t.key,t.value)}}};_ex.$bT=function(n,t){this.$$d_$7oE=Function.createDelegate(this,this.$7oE);_ex.$bT.initializeBase(this);this.set_$8F(!0);this.set_$179(this.$$d_$7oE);this.$3Gg=n;this.$8c=t;this.$2D=_a.$0.$4U};_ex.$bT.prototype={$3Gg:null,$8c:null,$7oE:function(){this.$3Gg(this.$8c)}};_ex.$7a=function(n,t){this.$$d_$4P9=Function.createDelegate(this,this.$4P9);this.$jP=[];_ex.$7a.initializeBase(this);this.$5O=n;this.$Vn=t;this.$xK=_ex.$B6.$9(n.Rule,this.$Vn)};_ex.$7a.$5cs=function(n,t,i){i.val=null;var f=new _ex.$7a(n,t);var u=null;var r=0;var s,o,e;if(e=_ex.$7a.$9qx(n,t.$o0,s={val:u},o={val:r}),u=s.val,r=o.val,e){f.$1RN=u;f.$2fV=r;i.val=f;return!0}return!1};_ex.$7a.$9qx=function(n,t,i,r){i.val=null;r.val=0;var e;if(t===1)e=0;else if(t===2||t===3)e=1;else return!1;if(!n.FormSettingsList)return!1;for(var o=n.FormSettingsList,s=o.length,u=0;u<s;++u){var f=o[u];if(f.SettingsType===e){i.val=f.SourceLocation;if(!n.Type){i.val=i.val.replace("{","%7b");i.val=i.val.replace("}","%7d")}r.val=f.RequestedHeight;return!0}}return!1};_ex.$7a.prototype={$1RN:null,$2fV:0,$5O:null,$xK:null,$Vn:null,$3IC:!1,$1TU:null,get_$1lH:function(){return this.$5O},get_$Wi:function(){return this.$5O.AppStatus},get_$4c6:function(){return this.$5O.EndNodeUrl},get_$29:function(){return this.$5O.DisplayName},get_$8Yg:function(){return this.$5O.LicenseType},get_$9IH:function(){return this.$5O.ProviderName},get_$5VQ:function(){return _js.$9.$1g(this.$5O.Settings)?{}:JsonParser.deserialize(this.$5O.Settings)},set_$5VQ:function(n){this.$5O.Settings=n?JsonParser.serialize(n):"";return n},get_$8Mb:function(){if(!_js.$9.$1g(this.$1TU))return this.$1TU;this.$1TU=_ex.$7a.$4rb?_js.$9.$1g(this.$5O.HighResolutionIconUrl)?this.$5O.IconUrl:this.$5O.HighResolutionIconUrl:_js.$9.$1g(this.$5O.IconUrl)?this.$5O.HighResolutionIconUrl:this.$5O.IconUrl;return this.$1TU},get_$4cO:function(){return this.$1RN},set_$4vp:function(n){if(n!==this.$3IC){this.$3IC=n;this.$4("IsLastExtension")}return n},get_$224:function(){return this.$jP},$9gD:function(n){var e=this.$Vn.$3LZ;var c=this.$Vn.$1Wq;Array.clear(this.$jP);if(!this.$5O.DisableEntityHighlighting){var t={};var o=c;for(var f in o)for(var h={key:f,value:o[f]},u=h.value,i=0;i<u.length;i++)this.$4P9(u[i],null,t);for(var r=0;r<e.length;r++){var s=e[r];switch(s){case 3:_ex.$3l.$uK(n.Addresses,"Address",t,this.$$d_$4P9);break;case 6:_ex.$3l.$uK(n.EmailAddresses,"EmailAddress",t,this.$$d_$4P9);break;case 4:_ex.$3l.$uK(n.Urls,"Url",t,this.$$d_$4P9);break;case 1:_ex.$3l.$uK(n.MeetingSuggestions,"MeetingString",t,this.$$d_$4P9);break;case 2:_ex.$3l.$uK(n.TaskSuggestions,"TaskString",t,this.$$d_$4P9);break;case 5:_ex.$3l.$uK(n.PhoneNumbers,"OriginalPhoneString",t,this.$$d_$4P9);break;case 7:_ex.$3l.$uK(n.Contacts,"ContactString",t,this.$$d_$4P9);break}}this.$Vn.$em.$7qe(t,this.$$d_$4P9)}},$4P9:function(n,t,i){var r=i;if(!(n in r)){Array.add(this.$jP,n);r[n]=!0}}};_ex.$17P=function(n,t,i,r,u){this.$$d_$8Pi=Function.createDelegate(this,this.$8Pi);_ex.$17P.initializeBase(this,[u]);this.$1pJ=n;this.$1i5=t;this.$8B=i;this.$2D=r};_ex.$17P.prototype={$1pJ:0,$1i5:0,$Rr:1,$8B:null,$2Lk:!1,$2D:null,$1T:function(){_js.Trace.logInfo(_a.$0.$4U,"RetryTimer.Start");this.$2Lk=!1;this.$2V(this.$$d_$8Pi,this.$1i5,this.$2D)},$2y:function(){_js.Trace.logInfo(_a.$0.$4U,"RetryTimer.End");this.$2Lk=!0;this.$Rr=this.$1pJ;this.$33A()},$8Pi:function(){_js.Trace.logInfo(_a.$0.$4U,"RetryTimer.Callback: count {0}",this.$Rr);this.$8B();if(this.$Rr<this.$1pJ){this.$Rr++;this.$2V(this.$$d_$8Pi,this.$1i5,this.$2D)}else{_js.Trace.logInfo(_a.$0.$4U,"RetryTimer.Callback: Retry count {0} exceeds max {1}",this.$Rr,this.$1pJ);this.$2y()}}};_ex.$B6=function(){};_ex.$B6.$9=function(n,t){var i=_ex.$B6.$4X2(n,t);if(!$C(i)){t.$35n>7&&i.$1YA("Number of custom pattern rules exceeds the limit of "+7+".");t.$3Vf>15&&i.$1YA("Number of rules exceeds the limit of "+15+".");if(i.$K6)return i}return null};_ex.$B6.$3Io=function(n){return n.$o0===1};_ex.$B6.$4X2=function(n,t){return $C(n)?null:++t.$3Vf>15?null:n.Type==="Collection"?new _ex.$101(n,t):n.Type==="ItemIs"?new _ex.$F9(n):n.Type==="ItemHasKnownEntity"?new _ex.$3l(n):n.Type==="ItemHasRegularExpressionMatch"?new _ex.$Dq(n,t,_a.UserAgent.getInstance()):n.Type==="ItemHasAttachment"?new _ex.$147:null};_ex.$B6.prototype={$K6:!0,$4vj:function(n,t){return!0},$1YA:function(n){_js.Trace.logError(_a.$0.$4U,n);this.$K6=!1}};_ex.$101=function(n,t){_ex.$101.initializeBase(this);if($C(n.Mode)){this.$1YA("Collection rule with no required 'mode' attribute found.");return}if($C(n.Rules)||!n.Rules.length){this.$1YA("Collection rule with no required 'rule' attribute found.");return}this.$2N6="And"===n.Mode;this.$11l=new _js.$X;for(var i=0;i<n.Rules.length;i++){var r=_ex.$B6.$4X2(n.Rules[i],t);$C(r)||this.$11l.$F(r)}};_ex.$101.prototype={$2N6:!1,$11l:null,$2HM:function(n,t,i){for(var r=this.$2N6,u=0;u<this.$11l.get_$A();u++){var f=this.$11l.get_$E(u);r=this.$2N6?!!(r&f.$2HM(n,t,i)):!!(r|f.$2HM(n,t,i))}return r},$4vj:function(n,t){for(var i=0;i<this.$11l.get_$A();i++){var r=this.$11l.get_$E(i);if(!r.$4vj(n,t))return!1}return!0}};_ex.$lC=function(n,t){this.$3LZ=[];this.$em=new _ex.$3k;this.$FE=n;this.$o0=t};_ex.$lC.prototype={$35n:0,$3Vf:0,$1Wq:null,$ro:!1,$FE:null,$o0:0};_ex.$3k=function(){};_ex.$3k.$1Cr=function(n,t,i,r){if(n){var f=n;for(var u in f){var e={key:u,value:f[u]};_ex.$3l.$uK(e.value,t,i,r)}}};_ex.$3k.$1BT=function(n,t,i){i&&(n[t]=i)};_ex.$3k.$1BS=function(n,t,i){n.val||(n.val={});n.val[t]=i};_ex.$3k.prototype={$GZ:null,$xx:null,$TG:null,$1F6:null,$wH:null,$1Hu:null,$xE:null,$8DS:function(){var n={};_ex.$3k.$1BT(n,"Addresses",this.$GZ);_ex.$3k.$1BT(n,"Contacts",this.$xx);_ex.$3k.$1BT(n,"EmailAddresses",this.$TG);_ex.$3k.$1BT(n,"MeetingSuggestions",this.$1F6);_ex.$3k.$1BT(n,"PhoneNumbers",this.$wH);_ex.$3k.$1BT(n,"TaskSuggestions",this.$1Hu);_ex.$3k.$1BT(n,"Urls",this.$xE);return n},$4OY:function(n,t,i){switch(n){case 3:var o;_ex.$3k.$1BS(o={val:this.$GZ},t,i),this.$GZ=o.val;break;case 7:var s;_ex.$3k.$1BS(s={val:this.$xx},t,i),this.$xx=s.val;break;case 6:var h;_ex.$3k.$1BS(h={val:this.$TG},t,i),this.$TG=h.val;break;case 1:var e;_ex.$3k.$1BS(e={val:this.$1F6},t,i),this.$1F6=e.val;break;case 5:var r;_ex.$3k.$1BS(r={val:this.$wH},t,i),this.$wH=r.val;break;case 2:var u;_ex.$3k.$1BS(u={val:this.$1Hu},t,i),this.$1Hu=u.val;break;case 4:var f;_ex.$3k.$1BS(f={val:this.$xE},t,i),this.$xE=f.val;break;default:break}},$7qe:function(n,t){_ex.$3k.$1Cr(this.$GZ,"Address",n,t);_ex.$3k.$1Cr(this.$xx,"ContactString",n,t);_ex.$3k.$1Cr(this.$TG,"EmailAddress",n,t);_ex.$3k.$1Cr(this.$1F6,"MeetingString",n,t);_ex.$3k.$1Cr(this.$wH,"OriginalPhoneString",n,t);_ex.$3k.$1Cr(this.$1Hu,"TaskString",n,t);_ex.$3k.$1Cr(this.$xE,"Url",n,t)}};_ex.$147=function(){_ex.$147.initializeBase(this)};_ex.$147.prototype={$2HM:function(n,t,i){return _ex.$B6.$3Io(t)?n.get_$Oz()!==undefined&&n.get_$Oz():!1}};_ex.$3l=function(n){this.$$d_$7nb=Function.createDelegate(this,this.$7nb);_ex.$3l.initializeBase(this);$C(n.EntityType)?this.$1YA("ItemHasKnownEntity rule contains null entity type."):this.$Bb=n};_ex.$3l.$uK=function(n,t,i,r){if(n&&n.length>0)for(var u=0;u<n.length;u++){var f;f=t?n[u][t]:n[u];f&&r(f,n[u],i)}};_ex.$3l.$12p=function(n,t,i){if($C(n)||!n.length)return null;for(var f=[],r=0,u=0;u<n.length;u++){var e=n[u].Position;if(_ex.$3l.$8Sk(i,e,t)){f[r]=_ex.$3l.$8Du(n[u],t);r++}}if(r>0)_js.Trace.logInfo(_a.$0.$4U,"GetExtractedEntitiesFilteredByView: {2} entities returned for type {0} isConversationView {1}",t,i,r);else{f=null;_js.Trace.logInfo(_a.$0.$4U,"GetExtractedEntitiesFilteredByView: No entities returned for type {0} isConversationView {1}",t,i)}return f};_ex.$3l.$8Sk=function(n,t,i){var r=!1;n?(t==="LatestReply"||t==="Signature"||t==="Subject")&&(r=!0):_ex.$3l.$4wp(i)?(t==="LatestReply"||t==="Signature"||t==="Subject")&&(r=!0):r=!0;return r};_ex.$3l.$4wp=function(n){return n===7||n===1||n===2};_ex.$3l.$8Du=function(n,t){switch(t){case 3:return n.Address;case 6:return n.EmailAddress;case 4:return n.Url;case 1:var i=n;String.isInstanceOfType(i.StartTime)&&(i.StartTime=_a.$8.$5r(i.StartTime,!0).$8Y());String.isInstanceOfType(i.EndTime)&&(i.EndTime=_a.$8.$5r(i.EndTime,!0).$8Y());return i;default:return n}};_ex.$3l.prototype={$Bb:null,$1GW:null,$em:null,$4vj:function(n,t){return n.get_$r2()?!0:this.$8Sj(n.get_$2t2())?this.$1GW?!1:t.$ro?!1:!_ex.$3l.$4wp(this.$Bb.EntityType):!0},$2HM:function(n,t,i){if(!_ex.$B6.$3Io(t))return!1;this.$em=null;var u=n.get_$r2();if($C(u))return!1;if(this.$Bb.RegExFilter){var f,e;if(!(e=_ex.$Dq.$5cu(this.$Bb.RegExFilter,this.$Bb.IgnoreCase,f={val:this.$1GW}),this.$1GW=f.val,e))return!1}var r=!1;switch(this.$Bb.EntityType){case 3:r=this.$1Ce(t,u.Addresses,null);break;case 7:r=this.$1Ce(t,u.Contacts,"ContactString");break;case 6:r=this.$1Ce(t,u.EmailAddresses,null);break;case 1:r=this.$1Ce(t,u.MeetingSuggestions,"MeetingString");break;case 5:r=this.$1Ce(t,u.PhoneNumbers,"OriginalPhoneString");break;case 2:r=this.$1Ce(t,u.TaskSuggestions,"TaskString");break;case 4:r=this.$1Ce(t,u.Urls,null);break}return r},$1Ce:function(n,t,i){var r=null;!$C(t)&&t.length>0&&(r=_ex.$3l.$12p(t,this.$Bb.EntityType,n.$ro));if(r){if(!this.$1GW){Array.add(n.$3LZ,this.$Bb.EntityType);return!0}var u=_a.$8.get_$36();_ex.$3l.$uK(r,i,null,this.$$d_$7nb);n.$FE.$5cT(this.$Bb.FilterName,_a.$8.get_$36().$6M(u));if(this.$em){n.$em.$4OY(this.$Bb.EntityType,this.$Bb.FilterName,this.$em);return!0}}this.$1GW&&n.$em.$4OY(this.$Bb.EntityType,this.$Bb.FilterName,null);return!1},$7nb:function(n,t,i){var r=n.match(this.$1GW);if(r&&r.length>0){this.$em||(this.$em=[]);Array.add(this.$em,t)}},$8Sj:function(n){return n?this.$Bb.EntityType===3&&n.ExtractedAddresses||this.$Bb.EntityType===7&&n.ExtractedContacts||this.$Bb.EntityType===6&&n.ExtractedEmails||this.$Bb.EntityType===1&&n.ExtractedMeetings||this.$Bb.EntityType===5&&n.ExtractedPhones||this.$Bb.EntityType===2&&n.ExtractedTasks||this.$Bb.EntityType===4&&n.ExtractedUrls:!1}};_ex.$Dq=function(n,t,i){_ex.$Dq.initializeBase(this);if(n.RegExName&&n.RegExValue&&n.PropertyName){this.$Bb=n;t.$35n++}else this.$1YA("Invalid ItemHasRegularExpressionMatchRule rule.");this.$1D=i};_ex.$Dq.$5cu=function(n,t,i){i.val=null;try{i.val=new RegExp(n,t?"ig":"g");return!0}catch(r){_js.Trace.logError(_a.$0.$4U,"Failed to create RegularExpression for pattern: {0}",n);return!1}};_ex.$Dq.$9LT=function(n){for(var t=n.length-1;t>=0;t--){var r=!1;if(t>=50||n[t].length>3072)r=!0;else for(var i=t-1;i>=0;i--)if(n[t]===n[i]){r=!0;break}r&&Array.removeAt(n,t)}return n};_ex.$Dq.$8EU=function(n,t){if(t){if(n.get_$S2())return n.get_$S2().get_$1Z()}else if(n.get_$Ml())return n.get_$Ml().get_$1Z();else if(n.get_$4n())return n.get_$4n().get_$1Z();_js.Trace.logWarning(_a.$0.$4U,"Skipping regex eval: no body for item with Id: {0}.",n.get_$y()?n.get_$y().Id:"'null id'");return null};_ex.$Dq.prototype={$Bb:null,$1D:null,$4tA:16e3,$3Gt:64e3,$4fN:5e5,$2HM:function(n,t,i){if(!_ex.$B6.$3Io(t))return!1;var r=null;var o=this.$8Es(n,t,i);if(o){var u;var e,f;if(!(f=_ex.$Dq.$5cu(this.$Bb.RegExValue,this.$Bb.IgnoreCase,e={val:u}),u=e.val,f))return!1;var s=_a.$8.get_$36();r=o.match(u);t.$FE.$5cT(this.$Bb.RegExName,_a.$8.get_$36().$6M(s));if(r&&r.length>0){r=_ex.$Dq.$9LT(r);if(r.length>0){t.$1Wq[this.$Bb.RegExName]=r;return!0}}}t.$1Wq[this.$Bb.RegExName]=new Array(0);return!1},$8Es:function(n,t,i){if(this.$Bb.PropertyName===1)return n.get_$3n();else if(this.$Bb.PropertyName===4){var r=null;if(_g.$5w.isInstanceOfType(n))n.get_$Ek()&&(r=n.get_$Ek().Mailbox);else if(_g.$2g.isInstanceOfType(n)){var o=n.get_$MA();o&&(r=o.Mailbox)}if(r&&r.EmailAddress)return r.EmailAddress}else if(this.$Bb.PropertyName===3){var s=null;n.get_$zy()===3&&(s=this.$4n6(n,t.$ro));return s}else if(this.$Bb.PropertyName===2){if(i.val)return i.val;var u=this.$4n6(n,t.$ro);var c=_a.$8.get_$36();var f=$(u);var e=_a.$8.get_$36();f[0]&&(i.val=f[0].innerText);$C(i.val)&&(i.val=f.text());var h=_a.$8.get_$36();t.$FE.$9qB(u?u.length:0,i.val?i.val.length:0,e.$6M(c),h.$6M(e));return i.val}return null},$4n6:function(n,t){var i=_ex.$Dq.$8EU(n,t);if(i){if(i.length>this.$4fN){_js.Trace.logInfo(_a.$0.$4U,"Body size exceeds general activation size limit");i=null}if(this.$1D.get_$3I3()||this.$1D.get_$3wo())if(this.$Bb.PropertyName===2){if(i.length>this.$4tA){_js.Trace.logInfo(_a.$0.$4U,"Body size exceeds IPhone/IPad activation size limit");i=null}}else if(this.$Bb.PropertyName===3&&i.length>this.$3Gt){_js.Trace.logInfo(_a.$0.$4U,"Body size exceeds IPhone/IPad evaluation size. Truncating to evaluation size");i=i.substr(0,this.$3Gt)}}return i}};_ex.$F9=function(n){_ex.$F9.initializeBase(this);this.$3G9=n.IncludeSubClasses;this.$he=n.ItemType;this.$1UL=n.FormType;$C(n.ItemClass)||(this.$ry=n.ItemClass.toLowerCase())};_ex.$F9.$4w5=function(n){return n.startsWith("ipm.note")||n.startsWith("ipm.schedule")||n.startsWith("ipm.sharing")};_ex.$F9.$6Nu=function(n){return n.startsWith("ipm.appointment")||n==="ipm.ole.class.{00061055-0000-0000-c000-000000000046}"};_ex.$F9.prototype={$ry:null,$3G9:!1,$he:0,$1UL:0,$2HM:function(n,t,i){if(t.$o0===1&&(this.$1UL===2||this.$1UL===3)){if(!$C(n.get_$CJ())){var r=n.get_$CJ().toLowerCase();if(this.$he===1&&_g.$5w.isInstanceOfType(n)&&_ex.$F9.$4w5(r)||this.$he===2&&_g.$2g.isInstanceOfType(n)&&_ex.$F9.$6Nu(r)){if(!this.$ry)return!0;if(this.$3G9){if(r.startsWith(this.$ry))return!0}else if(r===this.$ry)return!0}}}else if(t.$o0===2&&this.$he===1||t.$o0===3&&this.$he===2)return this.$1UL===1||this.$1UL===3;return!1}};_ex.$Gz=function(){this.$1qz=-1};_ex.$Gz.prototype={$2Py:0,$2Q0:null,$3bW:0,$A:0,get_$7WH:function(){return this.$A?Math.round(this.$3bW/this.$A):-1},$2W:function(n,t){this.$A++;this.$3bW+=n;if(n>=this.$2Py){this.$2Py=n;this.$2Q0=t}(this.$1qz===-1||n<this.$1qz)&&(this.$1qz=n)},$we:function(){if(!this.$A)return"";var t=$C(this.$2Q0)?"":this.$2Q0;var n=[this.$1qz,this.get_$7WH(),this.$2Py,t];return n.join(",")}};_ex.$107=function(n){_ex.$107.initializeBase(this,[n])};_ex.$kP=function(n,t){this.$$d_$Da8=Function.createDelegate(this,this.$Da8);_ex.$kP.initializeBase(this,[n,t]);this.$Ch=!1;this.$9X=!0;this.set_$2Gb(!0)};_ex.$kP.prototype={$1E1:null,$jI:!1,$2Vk:!1,$92M:function(){if(this.get_$20().get_$A()>0){this.$4eS();this.$3VF();this.$jI=!1}else{this.$1E1.$3Q();this.$jI=!0}},$3R:function(){_fce.$m.prototype.$3R.call(this);this.get_$S().bind("keydown",this.$$d_$Da8)},$5I:function(){this.get_$S().unbind("keydown",this.$$d_$Da8);_js.$7.prototype.$5I.call(this)},$4Q:function(){_fce.$m.prototype.$4Q.call(this);this.$1E1=this.$u.$1N("GetMoreAppsButton")},$354:function(){var n=_fce.$m.prototype.$354.call(this);if(this.$3L.get_$U()==="Mouse"){n.get_$4y().set_$dy(-1);n.get_$4y().set_$Rs(3);var t=this;n.get_$S().keydown(function(i){if(i.which===13||i.which===32){t.$vJ(n,new _a.$7D(i));i.preventDefault()}})}return n},$vJ:function(n,t){if(this.get_$33()){var i=n.get_$k();t.get_$2f().extensionViewModel=i;this.set_$Ca(new _ff.$Cx(t,3))}},$6nj:function(n){if(!this.$2Vk&&this.$jI){this.$jI=!1;this.$1E1.set_$g(-1)}else this.$2Vk=!1},$Da8:function(n){if(this.$jI||this.get_$ZH()){var t=new _a.$7D(n);var r=this.$Hw(this.get_$ZH());var i=this.get_$20().get_$E(r);if(this.$jI&&(t.get_$9k()===32||t.get_$9k()===13))this.$2Vk=!0;else if(t.get_$9k()===40){if(!this.$jI){this.$63H();if(this.get_$ZH()===i){this.$1AB(null);this.set_$ZH(null);this.$1E1.set_$g(0);this.$1E1.$3Q();this.$jI=!0}}}else if(t.get_$9k()===38)if(this.$jI){this.$4eU();this.$1E1.set_$g(-1);this.$jI=!1}else this.$63J();else t.get_$9k()===9&&_js.$D.get_$Q().$2V(_a.$0.$4U,"ComposeExtensibilityMenuListView",this.$$d_$9NV,100)}}};_ex.$kR=function(n){this.$$d_$5Dx=Function.createDelegate(this,this.$5Dx);this.$$d_$94n=Function.createDelegate(this,this.$94n);this.$$d_$5Dc=Function.createDelegate(this,this.$5Dc);this.$$d_$96x=Function.createDelegate(this,this.$96x);_ex.$kR.initializeBase(this,[n]);this.$5p={}};_ex.$kR.prototype={$5p:null,$2bV:!1,$4Q:function(){_js.$7.prototype.$4Q.call(this);this.$5p.CloseButton=this.$u.$1N("CloseButton");this.$5p.ComposeExtMenuListView=this.$u.$1N("ComposeExtMenuListView");this.$5p.AppsBackButton=this.$u.$1N("AppsBackButton")},$3R:function(){_js.$7.prototype.$3R.call(this);this.get_$S().bind("keydown",this.$$d_$96x);var n=this.get_$k();this.$p("DataContext",this.$$d_$5Dc);n&&this.$5Dc(null,null)},$5I:function(){var n=this.get_$k();this.get_$S().unbind("keydown",this.$$d_$96x);this.$1B("DataContext",this.$$d_$5Dc);if(n&&this.$2bV){n.remove_$2Sw(this.$$d_$94n);n.remove_$3RD(this.$$d_$94n);n.remove_$2T8(this.$$d_$5Dx);this.$2bV=!1}_js.$7.prototype.$5I.call(this)},$5Dc:function(n,t){var i=this.get_$k();i.add_$2Sw(this.$$d_$94n);i.add_$3RD(this.$$d_$94n);i.add_$2T8(this.$$d_$5Dx);this.$2bV=!0},$94n:function(){this.$5p.ComposeExtMenuListView.$92M()},$5Dx:function(){this.$5p.AppsBackButton.$3Q()},$96x:function(n){var t=new _a.$7D(n);if(t.get_$9k()===27){var i=this.get_$k();i.$220(!1);t.$O8()}}};_ex.$11U=function(n){_ex.$11U.initializeBase(this,[n])};_ex.$11U.prototype={$8Mq:function(n){this.get_$S().hide();this.get_$S().prev().show()}};_ex.$3q=function(n,t){this.$$d_$97Q=Function.createDelegate(this,this.$97Q);this.$$d_$26o=Function.createDelegate(this,this.$26o);this.$$d_$8O6=Function.createDelegate(this,this.$8O6);_ex.$3q.initializeBase(this,[n,t]);this.$I=t;this.$Ch=!1;this.set_$2Gb(!0)};_ex.$3q.prototype={$p4:0,$Ii:null,$10D:null,$3Ht:!1,$A8:!1,$I:null,$2OC:!1,set_$2Q4:function(n){if(this.$p4!==n){this.$p4=n;this.$4("MaxTabCount");n>0&&this.$5d5()}return n},set_$6te:function(n){this.$10D=n;this.$2OC&&this.$10D&&this.$5d5();return n},$26o:function(){this.set_$2Q4(this.$4Sp(this.$3sU(!0)))},$354:function(){var n=_fce.$m.prototype.$354.call(this);if(this.$3L.get_$U()==="Mouse"){n.get_$4y().set_$dy(0);n.get_$4y().set_$Rs(3);var t=this;n.get_$S().keydown(function(i){(i.which===13||i.which===32)&&t.$vJ(n,new _a.$7D(i))})}return n},$3R:function(){_fce.$m.prototype.$3R.call(this);_js.$D.get_$Q().$2V(this.get_$m(),"ExtensibilityMenuListView - Trigger InternalOnActivate on delay",this.$$d_$8O6,0)},$5I:function(){_js.$7.prototype.$5I.call(this);if(this.$A8&&"Mouse"===this.$3L.get_$U()){this.$I.remove_$PF(this.$$d_$26o);_g.$O.get_$Q().get_$6o().remove_$1zY(this.$$d_$97Q);_g.$O.get_$Q().get_$6o().remove_$3Eg(this.$$d_$97Q)}},$vJ:function(n,t){if(this.get_$33()){var i=n.get_$k();t.get_$2f().extensionViewModel=i;this.set_$Ca(new _ff.$Cx(t,3))}},$4Sp:function(n){if(!this.$Ii)return 0;for(var r=this.$Ii.get_$A(),e=-1,u=0,o=0,f=new Array(r),i=0;i<r;i++){f[i]=this.$51h(this.$Ii.get_$E(i).$5O.DisplayName);this.$Ii.get_$E(i)===this.get_$1E()&&(e=i)}if(e>-1){o+=f[e];u++}for(var t=0;t<r;){if(t!==e)if(o+f[t]<n){o+=f[t];u++}else break;t++}t<r&&o+46>=n&&u--;return u},$51h:function(n){if(!(n in _ex.$3q.$2EB)){if(!_ex.$3q.$wW||$("#extensionRuler").length<=0){_ex.$3q.$wW=document.createElement("span");_ex.$3q.$wW.id="extensionRuler";_ex.$3q.$wW.className="extensionRuler";document.body.appendChild(_ex.$3q.$wW)}var t=document.createElement("span");t.className="extensionRulerItem";t.appendChild(document.createTextNode(n));_ex.$3q.$wW.appendChild(t);_ex.$3q.$2EB[n]=_ex.$3q.$wW.offsetWidth;_ex.$3q.$wW.removeChild(t)}return _ex.$3q.$2EB[n]},$3sU:function(n){var r=this.$8EH();var i=this.get_$S().width();if(i>0)_ex.$3q.$1Bo=i;else if(!_ex.$3q.$1Bo||n){var t=this;_ex.$3q.$1Bo=i;while(!$C(t)&&!$C(t.get_$Bd())&&!$C(t.get_$S())&&_ex.$3q.$1Bo<=0){t=t.get_$Bd();_ex.$3q.$1Bo=t.get_$S().width()}}return _ex.$3q.$1Bo-r},$8EH:function(){return this.$3Ht?0:this.$51h(_nbs.NonBootStrings.l_ExtensibilityTabGetMoreApps_Text)+22},$97Q:function(n,t){this.$26o()},$8O6:function(){if(this.get_$33()){this.set_$2Q4(0);if("Mouse"===this.$3L.get_$U()){this.$I.add_$PF(this.$$d_$26o);_g.$O.get_$Q().get_$6o().add_$1zY(this.$$d_$97Q);_g.$O.get_$Q().get_$6o().add_$3Eg(this.$$d_$97Q)}this.set_$2Q4(this.$4Sp(this.$3sU(!1)));this.$A8=!0}},$5d5:function(){if(this.$10D){this.$10D.$11();this.$2OC=!1}else this.$2OC=!0}};_ex.$1=function(){};_ex.$1.get_$7nU=function(){return _fm.$G.$9("error-fallback-app-icon","error-fallback-app-icon","owa","ms-bg-color-neutralTertiary ms-font-color-white")};_ex.$1.get_$7VT=function(){return _fm.$G.$9("arrow-left-grey-circle-hover-ext","x16-circle","owa","ms-border-color-neutralSecondary ms-font-color-neutralSecondary")};_ex.$1.get_$1BR=function(){return _fm.$G.$9("add-small-ext","add-small-ext","owa","ms-font-color-neutralSecondary")};_ex.$1.get_$11L=function(){return _fm.$G.$9("add-small-hover-ext","add-small-hover-ext","owa","ms-font-color-neutralDark")};_ex.$1.get_$5jt=function(){return _fm.$G.$9("affordance-grey-ext","x16","owa","ms-font-color-neutralSecondary")};_ex.$CE=function(n,t){_ex.$CE.initializeBase(this,[n]);this.$I=t};_ex.$CE.prototype={$I:null,$3HJ:!1,$3JS:!1,$1G7:null,$CM:null,$Hm:null,$l:null,$11u:null,set_$486:function(n){if(!$C(n)){this.$1G7=n;this.$3cr()}return n},set_$CE:function(n){if(this.$Hm!==n){this.$Hm=n;this.$3cr()}return n},set_$1tT:function(n){if(this.$CM===n)return n;$C(n)&&this.$5Jv();this.$CM=n;this.$3cr();return n},$4ae:function(n,t,i,r,u,f,e,o,s){this.$1G7.displayNotification({infoType:n,id:t,title:i,description:r,buttonTxt:u,buttonCallback:f,detailView:e,displayDeactive:o,reDisplay:s})},$5Jv:function(){if(_ex.$CE.$2TZ>0&&!$C(this.$1G7)&&this.$11u){this.$1G7.purgeOsfControl(this.$11u,!1);this.$11u=null}},$3cr:function(){if(!$C(this.$CM)&&!$C(this.$1G7)&&!$C(this.$Hm)&&!this.get_$17()){this.$5Jv();_ex.$CE.$2TZ++;this.$11u="ocii"+_ex.$CE.$2TZ;var a="DefaultSettings";var e=new OSF.Manifest.ExtensionSettings;e._sourceLocations[this.$Hm]=this.$CM.$1RN;if(OSF.OsfManifestManager.hasManifest(this.$CM.$5O.Id,this.$CM.$5O.Version)){var w=OSF.OsfManifestManager.getCachedManifest(this.$CM.$5O.Id,this.$CM.$5O.Version);w._extensionSettings[a]=e}else{var v=this;var b=new OSF.Manifest.Manifest(function(n){n._id=v.$CM.$5O.Id;n._version=v.$CM.$5O.Version;n._extensionSettings={};n._extensionSettings[a]=e});OSF.OsfManifestManager.cacheManifest(this.$CM.$5O.Id,this.$CM.$5O.Version,b)}var n;if(this.$I.get_$U()==="TouchNarrow"){n=window.innerHeight-50;n<0&&(n=0)}else{n=this.$CM.$2fV;n<32?n=32:n>450&&(n=450)}this.$3HJ||this.get_$S().css("height",n.toString()+"px");this.$1G7.insertOsfControl({div:this.get_$S()[0],id:this.$11u,marketplaceID:this.$CM.$5O.Id,marketplaceVersion:this.$CM.$5O.Version,settings:this.$CM.get_$5VQ(),store:"",storeType:OSF.StoreType.Exchange});if(_y.$z.$1Q.get_$U()==="Mouse"){var p=this;_js.$D.get_$Q().$6F(_a.$0.$4U,"OsfHostContainerView.TryInsertOsfControl",function(){p.get_$S().children()[0]&&p.get_$S().children()[0].focus()})}if(this.$CM.$5O.Origin===1||this.$CM.$5O.Origin===2&&this.$3JS){var t=this;var y=function(){t.$l&&t.$l.$8D(t.$l.get_$IE())&&t.$l.get_$IE().get_$2Gn().get_$2PB()?t.$l.get_$IE().$2PA(t.$CM.get_$4c6()):window.open(t.$CM.get_$4c6())};if(_js.$9.$1g(this.$CM.get_$Wi()))this.$CM.get_$8Yg()===1&&this.$4ae(2,this.$11u,_nbs.NonBootStrings.l_AppInfoTitle_Text,_nbs.NonBootStrings.l_AppTrialMessage_Text,_nbs.NonBootStrings.l_AppBuyButton_Text,y,!1,!1,!0);else{var i;var u;var f;var r;var h,c,l,o,s;(s=this.$9qy(this.$CM.get_$Wi(),h={val:i},c={val:u},l={val:f},o={val:r}),i=h.val,u=c.val,f=l.val,r=o.val,s)&&this.$4ae(1,this.$11u,_nbs.NonBootStrings.l_AppErrorTitle_Text,i,u,y,f,r,!0)}}}},$9qy:function(n,t,i,r,u){t.val="";i.val="";r.val=!1;u.val=!1;switch(n){case"1.0":t.val=_nbs.NonBootStrings.l_AppErrorCode1_0_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeUpdateAction_Text;r.val=!0;u.val=!0;break;case"1.1":t.val=_nbs.NonBootStrings.l_AppErrorCode1_1_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeUpdateAction_Text;r.val=!0;u.val=!0;break;case"1.2":t.val=_nbs.NonBootStrings.l_AppErrorCode1_2_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeUpdateAction_Text;r.val=!0;u.val=!0;break;case"2.0":t.val=_nbs.NonBootStrings.l_AppErrorCode2_0_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeUpdateAction_Text;break;case"2.1":t.val=_nbs.NonBootStrings.l_AppErrorCode2_1_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeUpdateAction_Text;break;case"3.0":t.val=_nbs.NonBootStrings.l_AppErrorCode3_0_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeDetailsAction_Text;break;case"3.1":t.val=_nbs.NonBootStrings.l_AppErrorCode3_1_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeDetailsAction_Text;break;case"3.2":t.val=_nbs.NonBootStrings.l_AppErrorCode3_2_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeDetailsAction_Text;break;case"3.3":t.val=_nbs.NonBootStrings.l_AppErrorCode3_3_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeDetailsAction_Text;break;default:_js.Trace.logWarning(this.get_$m(),String.format("The app status {0} does not have corresponding description.",n));return!1}return!0}};_ex._TI=function(){};_ex._TI.$$cctor=function(){var s="ComposeAppsPane";new _A(s,function(){_ex._TI.$1[s]===undefined&&(_ex._TI.$1[s]=[null]);var t=_ex._TI._hf.childNodes[0].cloneNode(!0);var n=new _ex.$kR(t.children[0]);n.set_$6("ComposeExtensibilityView");return new _B(t,[n])},_ex.$KL,_ex.$107,!1,!1,!1,0,_ex._TI.$1);var o="ComposeExtensibilityPopupView";new _A(o,function(){_ex._TI.$1[o]===undefined&&(_ex._TI.$1[o]=[[[-1,0,["ExtensibilityViewModel"],[_ex._TI.$Cy9],null,"DataContext",null,_ex._TI.$Y,1,null,null,null]]]);var t=_ex._TI._hf.childNodes[1].cloneNode(!0);var n=new _js.$7(t.children[0]);n.set_$6("ComposeExtensibilityView");return new _B(t,[n])},_ex.$kQ,_js.$7,!1,!1,!1,0,_ex._TI.$1);var e="ComposeExtensibilityView._tid1";new _A(e,function(){_ex._TI.$1[e]===undefined&&(_ex._TI.$1[e]=[null,[[-1,4,null,null,null,"AriaLabel",null,_ex._TI.$2m,0,null,null,null,_nbs.NonBootStrings.l_ComposeGetMoreApps_AT_Button_Text],[-1,4,null,null,null,"AriaRole",null,_ex._TI.$6d,0,null,null,0,7],[-1,4,null,null,null,"Text",null,_ex._TI.$1V,0,null,null,null,_nbs.NonBootStrings.l_ComposeGetMoreApps_Text],[-1,0,["IsTouch"],[_ex._TI.$CyD],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0],[-1,0,["OpenMarketplaceCommand"],[_ex._TI.$8t1],null,"ClickCommand",null,_ex._TI.$Z,1,null,null,null]]]);var t=_ex._TI._hf.childNodes[2].cloneNode(!0);var n=new _fc.$H(_B.$3(t,[1,0]));n.set_$g(-1);var i=new _fce.$v(t.children[0]);return new _B(t,[i,n]).R({ListPanel:i,GetMoreAppsButton:n})},_ex.$KL,_ex.$kP,!1,!0,!1,0,_ex._TI.$1);var l="ComposeExtensibilityView.ComposeExtensionListItemTemplate._tid3";new _A(l,function(){_ex._TI.$1[l]===undefined&&(_ex._TI.$1[l]=[null,[[-1,0,["DisplayName"],[_ex._TI.$6gV],null,"Text",null,_ex._TI.$H,1,null,null,null]],[[-1,0,["ProviderName"],[_ex._TI.$CyR],null,"Text",null,_ex._TI.$H,1,null,null,null]]]);var n=_ex._TI._hf.childNodes[3].cloneNode(!0);var i=new _b.$KR(n.children[2]);var r=new _b.$KR(n.children[1]);var t=new _js.$7(n.children[0]);t.set_$6("ComposeExtensibilityView.ExtensionIconImage");return new _B(n,[t,r,i])},_ex.$7a,_js.$7,!1,!0,!1,0,_ex._TI.$1);var c="ComposeExtensibilityView.ComposeExtensionListItemTemplate";new _A(c,function(){_ex._TI.$1[c]===undefined&&(_ex._TI.$1[c]=[[[-1,0,["DisplayName"],[_ex._TI.$6gV],null,"AriaLabel",null,_ex._TI.$1m,1,null,null,null]]]);var t=_ex._TI._hf.childNodes[4].cloneNode(!0);var n=new _js.$7(t.children[0]);n.set_$6("ComposeExtensibilityView.ComposeExtensionListItemTemplate._tid3");return new _B(t,[n])},_ex.$7a,_fce.$21,!1,!1,!1,0,_ex._TI.$1);var h="ComposeExtensibilityView.ExtensionIconImage";new _A(h,function(){_ex._TI.$1[h]===undefined&&(_ex._TI.$1[h]=[[[-1,4,null,null,null,"Id",null,_ex._TI.$16,0,null,null,null,_ex.$1.get_$7nU()]],[[-1,0,["IconUrl"],[_ex._TI.$CyQ],null,"Source",null,_ex._TI.$LW,1,null,null,null]]]);var n=_ex._TI._hf.childNodes[5].cloneNode(!0);var i=new _ex.$11U(n.children[1]);var t=new _fc.$Z(n.children[0],_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$K));return new _B(n,[t,i])},_ex.$7a,_js.$7,!1,!1,!1,0,_ex._TI.$1);var i="ComposeExtensibilityView";new _A(i,function(){_ex._TI.$1[i]===undefined&&(_ex._TI.$1[i]=[[[-1,5,["SelectedExtension"],[_ex._TI.$43g],null,"_ex_s",null,null,0,_ex._TI.get_$23(),null,null],[-1,5,["IsLandscape"],[_ex._TI.$57v],null,"_ex_p",null,null,0,null,null,null],[-1,5,["IsTouchNarrow"],[_ex._TI.$8sv],null,"tnarrow",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaRole",null,_ex._TI.$6d,0,null,null,0,3],[-1,4,null,null,null,"ImageId",null,_ex._TI.$x,0,null,null,null,_n.$1.get_$5P()],[-1,4,null,null,null,"HoveredImageId",null,_ex._TI.$1p,0,null,null,null,_n.$1.get_$Gz()],[-1,4,null,null,null,"PressedImageId",null,_ex._TI.$5m,0,null,null,null,_n.$1.get_$5r0()],[-1,4,null,null,null,"Title",null,_ex._TI.$1c,0,null,null,null,_nbs.NonBootStrings.l_CloseAppPaneButton_Text],[-1,0,["IsTouchNarrow"],[_ex._TI.$8sv],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0],[-1,0,["HideAppPaneCommand"],[_ex._TI.$CyB],null,"ClickCommand",null,_ex._TI.$Z,1,null,null,null],[-1,5,["IsLandscape"],[_ex._TI.$57v],null,"_ex_q",null,null,0,_ex._TI.get_$K(),null,null]],[[-1,4,null,null,null,"AriaRole",null,_ex._TI.$6d,0,null,null,0,3],[-1,4,null,null,null,"Title",null,_ex._TI.$1c,0,null,null,null,_nbs.NonBootStrings.l_AppBackButton_Title_Button_Text],[-1,4,null,null,null,"ImageId",null,_ex._TI.$x,0,null,null,null,_n.$1.get_$7VS()],[-1,4,null,null,null,"HoveredImageId",null,_ex._TI.$1p,0,null,null,null,_ex.$1.get_$7VT()],[-1,0,["BackToListCommand"],[_ex._TI.$8su],null,"ClickCommand",null,_ex._TI.$Z,1,null,null,null],[-1,0,["SelectedExtension"],[_ex._TI.$43g],null,"IsHidden",null,_ex._TI.$8,1,_ex._TI.get_$23(),null,!0]],[[-1,4,null,null,null,"ImageId",null,_ex._TI.$x,0,null,null,null,_b.$1.get_$4Qz()],[-1,4,null,null,null,"PressedImageId",null,_ex._TI.$5m,0,null,null,null,_b.$1.get_$7VR()],[-1,0,["BackToListCommand"],[_ex._TI.$8su],null,"ClickCommand",null,_ex._TI.$Z,1,null,null,null],[-1,0,["SelectedExtension"],[_ex._TI.$43g],null,"IsHidden",null,_ex._TI.$8,1,_ex._TI.get_$23(),null,!0]],[[-1,0,["AppPaneTitle"],[_ex._TI.$CyA],null,"Text",null,_ex._TI.$H,1,null,null,null]],[[-1,5,["IsLandscape"],[_ex._TI.$57v],null,"_ex_r",null,null,0,_ex._TI.get_$K(),null,null]],[[-1,0,["HideExtensionsList"],[_ex._TI.$CyC],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0],[-1,0,["ActiveExtensions"],[_ex._TI.$8sx],null,"DataSource",null,_ex._TI.$2n,1,null,null,null],[-1,0,["ListViewEventInfo"],[_ex._TI.$CyE],_ex._TI.$CyF,"EventInfo",_ex._TI.$vs,_ex._TI.$vt,2,null,null,null]],[[-1,0,["OsfContextActivationManager"],[_ex._TI.$6gT],null,"OsfContextActivationManager",null,_ex._TI.$6gW,1,null,null,null],[-1,0,["HideExtensionContainer"],[_ex._TI.$8sy],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0],[-1,0,["UserCulture"],[_ex._TI.$6gU],null,"UserCulture",null,_ex._TI.$6gY,1,null,null,null],[-1,0,["SelectedExtension"],[_ex._TI.$43g],null,"SelectedExtension",null,_ex._TI.$6gX,1,null,null,null],[-1,0,["IsInOrgMarketplaceRole"],[_ex._TI.$8sz],null,"IsUserInOrgMarketplaceRole",null,_ex._TI.$8t3,1,null,null,!1],[-1,5,["IsLandscape"],[_ex._TI.$57v],null,"_ex_r",null,null,0,_ex._TI.get_$K(),null,null]],[[-1,0,["WindowObjectViewModel"],[_ex._TI.$8t2],null,"DataContext",null,_ex._TI.$Y,1,null,null,null]]]);var n=_ex._TI._hf.childNodes[6].cloneNode(!0);var s=new _b.$Fi(_B.$3(n,[0,3]));var f=new _ex.$CE(_B.$3(n,[0,2]),_js.$2.Instance.$2(_y.$W));f.$3HJ=!0;var t=new _ex.$kP(_B.$3(n,[0,1,0]),_js.$2.Instance.$2(_y.$W));t.set_$3Y("ComposeExtensibilityView.ComposeExtensionListItemTemplate");t.set_$BB("_ex_o");t.set_$6("ComposeExtensibilityView._tid1");var h=new _js.$F(_B.$3(n,[0,1]));var c=new _b.$KR(_B.$3(n,[0,0,3]));var o=new _fc.$H(_B.$3(n,[0,0,2]));var u=new _fc.$H(_B.$3(n,[0,0,1]));var r=new _fc.$H(_B.$3(n,[0,0,0]));r.set_$g(0);var e=new _js.$F(_B.$3(n,[0,0]));return new _B(n,[e,r,u,o,c,h,t,f,s]).R({CloseButton:r,AppsBackButton:u,ComposeExtMenuListView:t})},_ex.$KL,_ex.$kR,!1,!1,!1,0,_ex._TI.$1);var t="ExtensibilityPopupView";new _A(t,function(){_ex._TI.$1[t]===undefined&&(_ex._TI.$1[t]=[[[-1,0,["ExtensibilityViewModel","UserCulture"],[_ex._TI.$57w,_ex._TI.$6gU],null,"UserCulture",null,_ex._TI.$6gY,1,null,null,null],[-1,0,["ExtensibilityViewModel","OsfContextActivationManager"],[_ex._TI.$57w,_ex._TI.$6gT],null,"OsfContextActivationManager",null,_ex._TI.$6gW,1,null,null,null],[-1,0,["ExtensibilityViewModel","OverflowMenuViewModel","TabSelectedExtension"],[_ex._TI.$57w,_ex._TI.$1qR,_ex._TI.$6gS],null,"SelectedExtension",null,_ex._TI.$6gX,1,null,null,null]],[[-1,0,["ItemBodyValue"],[_ex._TI.$CyO],null,"Html",null,_ex._TI.$ve,1,null,null,null],[-1,2,["ExtensibilityViewModel","SelectedExtension","HighlightedTerms"],[_ex._TI.$57w,_ex._TI.$43g,_ex._TI.$1MH],null,_b.$2P.$x4,null,null,1,null,null,null]]]);var n=_ex._TI._hf.childNodes[7].cloneNode(!0);var i=new _b.$2n(n.children[1],_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_a.$C7.$$(ILinkPreviewBuilderFactory)));i.$P(_b.$2P.$lk,"extensionHighlight");var r=new _ex.$CE(n.children[0],_js.$2.Instance.$2(_y.$W));return new _B(n,[r,i])},_ex.$lI,_js.$7,!1,!1,!1,0,_ex._TI.$1);var n="ExtensibilityView._tid4";new _A(n,function(){_ex._TI.$1[n]===undefined&&(_ex._TI.$1[n]=[[[-1,4,null,null,null,"Text",null,_ex._TI.$1V,0,null,null,null,_nbs.NonBootStrings.l_ExtensibilityTabGetMoreApps_Text],[-1,4,null,null,null,"ImageId",null,_ex._TI.$x,0,null,null,null,_ex.$1.get_$1BR()],[-1,4,null,null,null,"HoveredImageId",null,_ex._TI.$1p,0,null,null,null,_ex.$1.get_$11L()],[-1,0,["MarketplaceUrl"],[_ex._TI.$8t0],null,"IsHidden",null,_ex._TI.$8,1,_ex._TI.get_$2e(),null,!0],[-1,0,["OpenMarketplaceCommand"],[_ex._TI.$8t1],null,"ClickCommand",null,_ex._TI.$Z,1,null,null,null]],null,[[-1,4,null,null,null,"ImageId",null,_ex._TI.$x,0,null,null,null,_ex.$1.get_$5jt()],[-1,0,["OverflowMenuViewModel","HideExtensionContextMenu"],[_ex._TI.$1qR,_ex._TI.$8sw],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0]]]);var t=_ex._TI._hf.childNodes[8].cloneNode(!0);var u=new _fc.$H(t.children[2]);var i=new _fce.$1D(_js.$2.Instance.$2(_fc.$l),_js.$2.Instance.$2(_ff.$M),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$K));i.$M(_E.$D(["OverflowMenuViewModel","ExtensionsContextMenuViewModel"],[_ex._TI.$1qR,_ex._TI.$CyG],null,"MenuDataContext",null,_ex._TI.$3p,1)).$M(_E.$D(["OverflowMenuViewModel","HideExtensionContextMenu"],[_ex._TI.$1qR,_ex._TI.$8sw],null,"IsShown",null,_ex._TI.$3l,1,_ex._TI.get_$K(),null,!1));i.$58=3;u.set_$12([i]);var r=new _fce.$v(t.children[1]);var f=new _fc.$H(t.children[0]);return new _B(t,[f,r,u]).R({ListPanel:r})},_ex.$sk,_ex.$3q,!1,!0,!1,0,_ex._TI.$1);var f="ExtensibilityView.ExtensionListItemTemplate._tid7";new _A(f,function(){_ex._TI.$1[f]===undefined&&(_ex._TI.$1[f]=[[[-1,0,["DisplayName"],[_ex._TI.$6gV],null,"Text",null,_ex._TI.$H,1,null,null,null]]]);var n=_ex._TI._hf.childNodes[9].cloneNode(!0);var t=new _fc.$A(n.children[0]);return new _B(n,[t])},_ex.$7a,_js.$7,!1,!0,!1,0,_ex._TI.$1);var u="ExtensibilityView.ExtensionListItemTemplate";new _A(u,function(){_ex._TI.$1[u]===undefined&&(_ex._TI.$1[u]=[[[-1,5,["IsSelected"],[_ex._TI.$Nw],null,"ms-font-color-white ms-bg-color-themeSecondary",null,null,1,null,null,null]]]);var t=_ex._TI._hf.childNodes[10].cloneNode(!0);var n=new _js.$7(t.children[0]);n.set_$6("ExtensibilityView.ExtensionListItemTemplate._tid7");return new _B(t,[n])},_ex.$7a,_fce.$21,!1,!1,!1,0,_ex._TI.$1);var r="ExtensibilityView";new _A(r,function(){_ex._TI.$1[r]===undefined&&(_ex._TI.$1[r]=[[[-1,0,["OverflowMenuViewModel","ExtensionsTabList"],[_ex._TI.$1qR,_ex._TI.$CyH],null,"DataSource",null,_ex._TI.$2n,1,null,null,null],[-1,0,["OverflowMenuViewModel","TabSelectedExtension"],[_ex._TI.$1qR,_ex._TI.$6gS],_ex._TI.$CyN,"SelectedItem",_ex._TI.$6L,_ex._TI.$6H,2,null,null,null],[-1,0,["OverflowMenuViewModel","MaxTabCount"],[_ex._TI.$1qR,_ex._TI.$CyJ],_ex._TI.$CyM,"MaxTabCount",_ex._TI.$CyS,_ex._TI.$CyV,2,null,null,0],[-1,0,["ActiveExtensions"],[_ex._TI.$8sx],null,"ActiveExtensions",null,_ex._TI.$CyT,1,null,null,null],[-1,0,["OverflowMenuViewModel","PopulateMenuItemsCommand"],[_ex._TI.$1qR,_ex._TI.$CyK],null,"PopulateMenuItemsCommand",null,_ex._TI.$CyW,1,null,null,null],[-1,0,["OverflowMenuViewModel","ListViewEventInfo"],[_ex._TI.$1qR,_ex._TI.$CyI],_ex._TI.$CyL,"EventInfo",_ex._TI.$vs,_ex._TI.$vt,2,null,null,null],[-1,0,["MarketplaceUrl"],[_ex._TI.$8t0],null,"IsGetMoreAppHidden",null,_ex._TI.$CyU,1,_ex._TI.get_$2e(),null,!1]],[[-1,0,["OsfContextActivationManager"],[_ex._TI.$6gT],null,"OsfContextActivationManager",null,_ex._TI.$6gW,1,null,null,null],[-1,0,["HideExtensionContainer"],[_ex._TI.$8sy],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0],[-1,0,["UserCulture"],[_ex._TI.$6gU],null,"UserCulture",null,_ex._TI.$6gY,1,null,null,null],[-1,0,["OverflowMenuViewModel","TabSelectedExtension"],[_ex._TI.$1qR,_ex._TI.$6gS],null,"SelectedExtension",null,_ex._TI.$6gX,1,null,null,null],[-1,0,["NativeBridge"],[_ex._TI.$CyP],null,"NativeBridge",null,_ex._TI.$CyX,1,null,null,null],[-1,0,["IsInOrgMarketplaceRole"],[_ex._TI.$8sz],null,"IsUserInOrgMarketplaceRole",null,_ex._TI.$8t3,1,null,null,!1]],[[-1,0,["WindowObjectViewModel"],[_ex._TI.$8t2],null,"DataContext",null,_ex._TI.$Y,1,null,null,null]]]);var t=_ex._TI._hf.childNodes[11].cloneNode(!0);var i=new _b.$Fi(_B.$3(t,[0,2]));var u=new _ex.$CE(_B.$3(t,[0,1]),_js.$2.Instance.$2(_y.$W));var n=new _ex.$3q(_B.$3(t,[0,0,0]),_js.$2.Instance.$2(_y.$W));n.set_$3Y("ExtensibilityView.ExtensionListItemTemplate");n.set_$BB("_ex_x");n.set_$6("ExtensibilityView._tid4");return new _B(t,[n,u,i])},_ex.$sk,_js.$7,!1,!1,!1,0,_ex._TI.$1)};_ex._TI.$9V=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div autoid=\"_ex_0\" class='_ex_2 _ex_3'></div> </div><div> <div autoid=\"_ex_1\" class='_ex_4'></div> </div><div> <div></div> <div class='_ex_l'> <button autoid=\"_ex_7\" type='button' class='_ex_m ms-font-weight-regular'></button> </div> </div><div> <div class='_ex_8'></div> <div autoid=\"_ex_9\" class='_ex_j _ex_5'></div> <div autoid=\"_ex_a\" class='_ex_k ms-font-weight-regular _ex_5'></div> <div style=\"clear:both;\"></div> </div><div> <div autoid=\"_ex_8\" class='_ex_i'></div> </div><div> <span class='_ex_9'></span> <img autoid=\"_ex_b\" class='_ex_a'/> </div><div> <div class='_ex_e'> <div class='_ex_g'> <button autoid=\"_ex_2\" type='button' class='_ex_f'></button>  <button autoid=\"_ex_3\" type='button' class='_ex_6'></button>  <button autoid=\"_ex_4\" type='button' class='_ex_7'></button> <div autoid=\"_ex_5\" class='_ex_h _ex_5'></div> <div style=\"clear:both;\"></div> </div> <div class='_ex_b'> <div autoid=\"_ex_6\" class='_ex_n'></div> </div> <div class='_ex_c'></div> <div class='hidden'> </div> </div>   </div><div> <div class='_ex_t ms-border-color-themeSecondary'></div> <div class='_ex_u ms-bg-color-white'></div> </div><div> <button autoid=\"_ex_d\" type='button' class='_ex_B'></button> <div class='_ex_x'></div> <button type='button' class='_ex_A ms-font-s ms-font-color-themePrimary'></button> </div><div> <span autoid=\"_ex_f\"></span> </div><div> <div autoid=\"_ex_e\" class='_ex_w ms-font-s ms-font-color-themePrimary'></div> </div><div> <div class='_ex_v'> <div class='_ex_y ms-bg-color-neutralLight'> <div autoid=\"_ex_c\"></div> </div> <div class='_ex_z ms-border-color-themeSecondary'></div> <div class='hidden'> </div> </div>  </div>";_js.$F.get_$9N().appendChild(n);return n};_ex._TI.$Cy9=function(n){return n.$65};_ex._TI.$CyD=function(n){return n.get_$2Oc()};_ex._TI.$8t1=function(n){return n.$3S2};_ex._TI.$6gV=function(n){return n.get_$29()};_ex._TI.$CyR=function(n){return n.get_$9IH()};_ex._TI.$CyQ=function(n){return n.get_$8Mb()};_ex._TI.$43g=function(n){return n.$CM};_ex._TI.$57v=function(n){return n.get_$13L()};_ex._TI.$8sv=function(n){return n.get_$6TH()};_ex._TI.$CyB=function(n){return n.$3Fd};_ex._TI.$8su=function(n){return n.$32B};_ex._TI.$CyA=function(n){return n.$2DF};_ex._TI.$CyC=function(n){return n.$2M5};_ex._TI.$8sx=function(n){return n.$Ii};_ex._TI.$CyE=function(n){return n.$13X};_ex._TI.$vs=function(n){return n.get_$Ca()};_ex._TI.$6gT=function(n){return n.$1af};_ex._TI.$8sy=function(n){return n.$1TN};_ex._TI.$6gU=function(n){return n.$Hm};_ex._TI.$8sz=function(n){return n.get_$8Td()};_ex._TI.$8t2=function(n){return n.$QS};_ex._TI.$57w=function(n){return n.$65};_ex._TI.$1qR=function(n){return n.$dg};_ex._TI.$6gS=function(n){return n.$1Hr};_ex._TI.$CyO=function(n){return n.$3Jg};_ex._TI.$1MH=function(n){return n.get_$224()};_ex._TI.$8t0=function(n){return n.$1Ui};_ex._TI.$8sw=function(n){return n.$2M4};_ex._TI.$CyG=function(n){return n.$1Jd};_ex._TI.$Nw=function(n){return n.get_$2g()};_ex._TI.$CyH=function(n){return n.$r4};_ex._TI.$6L=function(n){return n.get_$1E()};_ex._TI.$CyJ=function(n){return n.$p4};_ex._TI.$CyS=function(n){return n.$p4};_ex._TI.$CyK=function(n){return n.$10D};_ex._TI.$CyI=function(n){return n.$13X};_ex._TI.$CyP=function(n){return n.$l};_ex._TI.$Y=function(n,t){n.set_$k(t)};_ex._TI.$8=function(n,t){n.set_$17(t)};_ex._TI.$Z=function(n,t){n.set_$4k(t)};_ex._TI.$2m=function(n,t){n.set_$4E(t)};_ex._TI.$6d=function(n,t){n.set_$19(t)};_ex._TI.$1V=function(n,t){n.set_$1K(t)};_ex._TI.$H=function(n,t){n.set_$1K(t)};_ex._TI.$1m=function(n,t){n.set_$4E(t)};_ex._TI.$16=function(n,t){n.set_$2P(t)};_ex._TI.$LW=function(n,t){n.set_$Br(t)};_ex._TI.$x=function(n,t){n.set_$BP(t)};_ex._TI.$1p=function(n,t){n.set_$F0(t)};_ex._TI.$5m=function(n,t){n.set_$aX(t)};_ex._TI.$1c=function(n,t){n.set_$3u(t)};_ex._TI.$2n=function(n,t){n.set_$20(t)};_ex._TI.$CyF=function(n,t){n.set_$505(t)};_ex._TI.$vt=function(n,t){n.set_$Ca(t)};_ex._TI.$6gW=function(n,t){n.set_$486(t)};_ex._TI.$6gY=function(n,t){n.set_$CE(t)};_ex._TI.$6gX=function(n,t){n.set_$1tT(t)};_ex._TI.$8t3=function(n,t){n.$3JS=t};_ex._TI.$ve=function(n,t){n.set_$SU(t)};_ex._TI.$3p=function(n,t){n.set_$KU(t)};_ex._TI.$3l=function(n,t){n.set_$1C(t)};_ex._TI.$CyN=function(n,t){n.set_$2Zp(t)};_ex._TI.$6H=function(n,t){n.set_$1E(t)};_ex._TI.$CyM=function(n,t){n.$p4=t};_ex._TI.$CyV=function(n,t){n.set_$2Q4(t)};_ex._TI.$CyT=function(n,t){n.$Ii=t};_ex._TI.$CyW=function(n,t){n.set_$6te(t)};_ex._TI.$CyL=function(n,t){n.set_$505(t)};_ex._TI.$CyU=function(n,t){n.$3Ht=t};_ex._TI.$CyX=function(n,t){n.$l=t};_ex._TI.get_$23=function(){_ex._TI.$47||(_ex._TI.$47=new _fc.$6Q);return _ex._TI.$47};_ex._TI.get_$K=function(){_ex._TI.$2M||(_ex._TI.$2M=new _fc.$45);return _ex._TI.$2M};_ex._TI.get_$2e=function(){_ex._TI.$4Y||(_ex._TI.$4Y=new _fc.$6o);return _ex._TI.$4Y};ExtensibilityComponent.registerClass("ExtensibilityComponent",null,_a.$1XU);_ex.$lG.registerClass("_ex.$lG",_h.$19q.$$(_g.$UY));_ex.$la.registerClass("_ex.$la",_h.$TO.$$(_g.$V4,_g.$lc));_ex.$lg.registerClass("_ex.$lg",_h.$TO.$$(_g.$O9,_g.$WD));_ex.$4V.registerClass("_ex.$4V",_h.$19q.$$(_g.$O0));_ex.$Vc.registerClass("_ex.$Vc",_h.$TO.$$(_g.$V4,_g.$lc));_ex.$WN.registerClass("_ex.$WN",_h.$19q.$$(_g.$WP));_ex.$17V.registerClass("_ex.$17V",_h.$19q.$$(String));_ex.$p6.registerClass("_ex.$p6",_h.$19q.$$(_g.$XY));_ex.$p7.registerClass("_ex.$p7",_h.$19q.$$(_g.$Xa));_ex.$5K.registerClass("_ex.$5K");_ex.$5K.$3hn.registerClass("_ex.$5K.$3hn");_ex.$Ub.registerClass("_ex.$Ub");_ex.$11R.registerClass("_ex.$11R",null,_ex.$1VL);_ex.$6E.registerClass("_ex.$6E",null,_ex.$1VL);_ex.$1Z1.registerClass("_ex.$1Z1");_ex.$j7.registerClass("_ex.$j7",_ex.$1Z1);_ex.$yP.registerClass("_ex.$yP",_ex.$j7);_ex.$yQ.registerClass("_ex.$yQ",_ex.$j7);_ex.$jD.registerClass("_ex.$jD",_ex.$1Z1);_ex.$1Zw.registerClass("_ex.$1Zw",_ex.$1Z1);_ex.$zE.registerClass("_ex.$zE",_ex.$1Zw);_ex.$zF.registerClass("_ex.$zF",_ex.$1Zw);_ex.$1Z0.registerClass("_ex.$1Z0");_ex.$1R.registerClass("_ex.$1R");_ex.$1Zx.registerClass("_ex.$1Zx",_ex.$1R);_ex.$11P.registerClass("_ex.$11P",_ex.$1Zx);_ex.$4e.registerClass("_ex.$4e",_ex.$1R);_ex.$1Ed.registerClass("_ex.$1Ed",_ex.$4e);_ex.$Ud.registerClass("_ex.$Ud");_ex.$11V.registerClass("_ex.$11V",_ex.$1Zx);_ex.$11W.registerClass("_ex.$11W",_ex.$4e);_ex.$11v.registerClass("_ex.$11v",_ex.$1Z1);_ex.$124.registerClass("_ex.$124",_ex.$1Z1);_ex.$VX.registerClass("_ex.$VX",_ex.$1Z1);_ex.$12G.registerClass("_ex.$12G",_ex.$1Z1);_ex.$12E.registerClass("_ex.$12E",_ex.$1Z1);_ex.$12J.registerClass("_ex.$12J",_ex.$1Z1);_ex.$14T.registerClass("_ex.$14T",_ex.$1Z1);_ex.$17F.registerClass("_ex.$17F",_ex.$1Z1);_ex.$LB.registerClass("_ex.$LB",_ex.$1Z1);_ex.$183.registerClass("_ex.$183",_ex.$1Z1);_ex.$18A.registerClass("_ex.$18A",_ex.$1Z1);_ex.$189.registerClass("_ex.$189",_ex.$1Zw);_ex.$18B.registerClass("_ex.$18B",_ex.$1Z1);_ex.$27.registerClass("_ex.$27");_ex.$19a.registerClass("_ex.$19a",null,_y.$mg,_a.$1Ik);_ex.$kQ.registerClass("_ex.$kQ",_y.$1aq,_bc.$Ki,_bc.$dz,_bc.$m7,_a.$1Xr,_js.$13h,Sys.IDisposable,_y.$tZ);_ex.$2G.registerClass("_ex.$2G",_a.$Em,_y.$1Ij);_ex.$KL.registerClass("_ex.$KL",_ex.$2G,_y.$1Ud,_y.$1Ij);_ex.$11S.registerClass("_ex.$11S",_a.$AX);_ex.$F4.registerClass("_ex.$F4");_ex.$BG.registerClass("_ex.$BG",_a.$Em);_ex.$lI.registerClass("_ex.$lI",_y.$1aq,_bc.$Ki,_bc.$dz,_bc.$m7,_a.$1Xr,_js.$13h,Sys.IDisposable,_y.$tZ);_ex.$Uf.registerClass("_ex.$Uf");_ex.$11X.registerClass("_ex.$11X",null,IExtensibilityStatistics);_ex.$11X.$4Nu.registerClass("_ex.$11X.$4Nu");_ex.$11X.$7Wz.registerClass("_ex.$11X.$7Wz");_ex.$11X.$4dO.registerClass("_ex.$11X.$4dO");_ex.$11X.$7of.registerClass("_ex.$11X.$7of");_ex.$11Y.registerClass("_ex.$11Y",null,_y.$1Xz);_ex.$sk.registerClass("_ex.$sk",_ex.$2G);_ex.$11Z.registerClass("_ex.$11Z",null,IExtensibilityViewModelFactory);_ex.$11a.registerClass("_ex.$11a",_a.$AX);_ex.$bT.registerClass("_ex.$bT",_js.$Cs);_ex.$7a.registerClass("_ex.$7a",_a.$Em,_y.$1Ua);_ex.$17P.registerClass("_ex.$17P",_ex.$11Y);_ex.$B6.registerClass("_ex.$B6");_ex.$101.registerClass("_ex.$101",_ex.$B6);_ex.$lC.registerClass("_ex.$lC");_ex.$3k.registerClass("_ex.$3k");_ex.$147.registerClass("_ex.$147",_ex.$B6);_ex.$3l.registerClass("_ex.$3l",_ex.$B6);_ex.$Dq.registerClass("_ex.$Dq",_ex.$B6);_ex.$F9.registerClass("_ex.$F9",_ex.$B6);_ex.$Gz.registerClass("_ex.$Gz");_ex.$107.registerClass("_ex.$107",_js.$F);_ex.$kP.registerClass("_ex.$kP",_fce.$m);_ex.$kR.registerClass("_ex.$kR",_js.$7);_ex.$11U.registerClass("_ex.$11U",_b.$J3);_ex.$3q.registerClass("_ex.$3q",_fce.$m);_ex.$1.registerClass("_ex.$1");_ex.$CE.registerClass("_ex.$CE",_js.$F);_ex._TI.registerClass("_ex._TI");_ex.$4V.$ei=null;_ex.$4V.$2P3=0;_ex.$5K.$1Q=null;_ex.$6E.$2Sc=null;_ex.$6E.$1rW=null;_ex.$1R.$1Rr={wasSuccessful:!1};_ex.$1R.$1w5=new RegExp(" ","g");_ex.$1R.$2Da=null;_ex.$1R.$2Db=null;_ex.$1R.$2De=null;_ex.$1R.$2Dc=null;_ex.$LB.$4YR={wasSuccessful:!0};_ex.$F4.$L0={};_ex.$BG.$4qP="HideExtensionContextMenu";_ex.$BG.$3bo="TabSelectedExtension";_ex.$2G.$8MC="HighlightedTerms";_ex.$2G.$7oW="ExtensionBecomeActiveTestOnly";_ex.$2G.$469="NoActiveExtensions";_ex.$2G.$40U="MarketplaceUrl";_ex.$2G.$5E2="OnGetExtensibilityContextCompleted";_ex.$2G.$8Lf="HideExtensionContainer";_ex.$2G.$7Pt="ActiveExtensionsCount";_ex.$2G.$2Na=!1;_ex.$2G.$12o=null;_ex.$7a.$4rb=window.matchMedia&&window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 2)").matches;_ex.$3q.$1Bo=0;_ex.$3q.$2EB={};_ex.$3q.$wW=null;_ex.$CE.$2TZ=0;_ex._TI._hf=_ex._TI.$9V();_ex._TI.$47=null;_ex._TI.$2M=null;_ex._TI.$4Y=null;_ex._TI.$1={};_ex._TI.$$cctor();
window.scriptsLoaded['microsoft.exchange.clients.owa2.client.extensibility.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.exchange.clients.owa2.client.extensibility.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
