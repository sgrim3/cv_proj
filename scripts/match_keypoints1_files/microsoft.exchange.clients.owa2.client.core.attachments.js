try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.exchange.clients.owa2.client.core.attachments.js'] = (new Date()).getTime();
Type.registerNamespace("_at");_at.$1Cw=function(n,t,i,r){_at.$1Cw.initializeBase(this);this.$5i=n;this.$1ZH=t;this.$3C=i;this.$MI=r};_at.$1Cw.prototype={$1ZH:null,$3C:null,$MI:null,$5i:null,$3F7:null,$6NV:function(n){var t=new _g.$1Cx(this.$2i);n.$5sx(this.$5i,this.$1ZH,this.$3C,this.$MI,t,this.$$d_$6pk,this.$$d_$1Mo)},$6uq:function(n,t,i){try{_a.$4.$1s(n,"result");this.$3F7=n;t()}catch(r){i(r)}}};function AttachmentsComponent(){}AttachmentsComponent.prototype={$2FB:function(n,t,i){var r=n.$2(_g.$O).get_$2dM();if(t.get_$8Z()){var e=this;n.$r(_at.$Vn).$1I().$t(function(){var t=_bc.$Oe.isInstanceOfType(_g.$1H.$1Q)?_g.$1H.$1Q:null;return new _at.$4Z(n.$2(_a.$3G),t?t.get_$4O().get_$2Dl():null,t?t.get_$A6y():null)})}else{var o=this;n.$r(_at.$Vn).$1I().$t(function(){return new _at.$1PR})}var u=this;n.$r(IAttachmentViewModelFactory).$t(function(){return new _at.$1Ax(n.$2(IInferenceTracker),n.$2(_y.$W),n.$2(_at.$Vn),n.$2(_a.$t),n.$2(_a.$3G),n.$37(IAttachmentProviderItemViewModelFactory),n.$2(_a.$1d),n.$37(IAttachmentPreviewViewModelFactory),n.$37(IItemStoreGetterFactory),n.$2(IUriFileAttachmentViewModelFactory),n.$3O(ISmimeCommandFactory),n.$2(_a.$Ke),r)});var f=this;n.$r(_at.$19b).$2a(IUriFileAttachmentViewModelFactory).$1I().$t(function(){return new _at.$19b(n.$2(_a.$Oc),n.$2(_a.$2b),n.$2(IInferenceTracker),n.$2(_a.$1d),n.$37(IAttachmentPreviewViewModelFactory),n.$37(IItemStoreGetterFactory),n.$3O(ISmimeCommandFactory),n.$2(_a.$Ke),r,n.$2(_a.$3G))})},$BjW:function(){return null}};_at.$4v=function(n){this.$$d_$6Ix=Function.createDelegate(this,this.$6Ix);this.$$d_$7o4=Function.createDelegate(this,this.$7o4);this.$$d_$Ewx=Function.createDelegate(this,this.$Ewx);this.$$d_$Ewy=Function.createDelegate(this,this.$Ewy);this.$$d_$Bwj=Function.createDelegate(this,this.$Bwj);_at.$4v.initializeBase(this,[n]);this.set_$Br("about:blank");this.set_$g(-1);this.get_$S().load(this.$$d_$Bwj)};_at.$4v.prototype={$1Ri:null,$ZZ:null,$Bs:0,$4xe:!1,$2H:null,$qT:0,$4IS:null,$4U8:!1,$5ep:null,get_$9M:function(){return this.$w(_at.$4v.$5lk)},set_$9M:function(n){this.$P(_at.$4v.$5lk,n);return n},get_$F4:function(){return this.$w(_at.$4v.$6rW)},set_$F4:function(n){this.$P(_at.$4v.$6rW,n);return n},set_$2r:function(n){n||(this.$Bs=-1);this.$P(_at.$4v.$2NU,n);return n},get_$4dl:function(){return this.$w(_at.$4v.$628)},set_$4dl:function(n){this.$P(_at.$4v.$628,n);return n},get_$3dj:function(){return this.$w(_at.$4v.$5eq)},set_$3dj:function(n){this.$P(_at.$4v.$5eq,n);return n},set_$9vb:function(n){if(this.$5ep===n)return n;this.$5ep=n;this.$4("UploadAndShareAttachmentCommand");return n},get_$5er:function(){return this.$w(_at.$4v.$7My)},set_$5er:function(n){this.$P(_at.$4v.$7My,n);return n},set_$Kq:function(n){this.$2H=n;this.$4("Error");return n},set_$31s:function(n){this.$qT=n;this.$4("AttachmentError");return n},set_$5aB:function(n){this.$4IS=n;this.$4("SuccessResponse");return n},$8g:function(){_js.$F.prototype.$8g.call(this);this.$P(_at.$4v.$5eq,new _C(this.$$d_$Ewy,_at.$4v.$L));this.set_$9vb(new _C(this.$$d_$Ewx,_at.$4v.$L))},$Bwj:function(n){if(this.$Bs){if(this.$Bs===2){_js.Trace.logInfo(_at.$4v.$L,"Response received.");var t="";try{t=this.get_$S()[0].contentWindow.document.body.innerText}catch(u){if(!(_a.UserAgent.getInstance().$Ea&&u.number===-2146828218)){_js.Trace.logException(_at.$4v.$L,u,"Unhandled exception while executing HandleCreateAttachmentResponse");return}}if(this.$4xe)_js.$9.$o(t)&&this.$6nw(null,"Error sending the attachment upload form",1);else{var r=this,i=this;_at.$Ct.$Bw5(t,this.get_$9M(),this.get_$F4(),_g.$1H.$1Q,function(n){_js.Trace.logInfo(_at.$4v.$L,"HandleCreateAttachmentResponse completed.");r.$6nw(n,null,0)},function(n,t){_js.Trace.logInfo(_at.$4v.$L,"HandleCreateAttachmentResponse failed: {0}",n.message);var r=1;if(n.ResponseCode){var u=n.ResponseCode.toString();i.get_$9M().get_$C9()&&u==="ErrorInvalidOperation"?r=4:u==="ErrorMessageSizeExceeded"&&(r=3)}var f=_at.$6b.$8Dj(t)||_at.$6b.$3rs(n);i.$6nw(null,f,r)})}}}else{_js.Trace.logInfo(_at.$4v.$L,"Initializing.");this.$Bs=1;this.$C3L();_js.$D.get_$Q().$2V(_at.$4v.$L,"ExecuteOpenFilePicker",this.$$d_$7o4,0)}},$6nw:function(n,t,i){this.set_$5aB(n);this.set_$Kq(t);this.set_$31s(i);this.$Bs=3;this.get_$5er().$11();this.$4U8=!1},$C3L:function(){var n=this.get_$S()[0];n.contentWindow.document.body.innerHTML="";this.$1Ri=n.contentWindow.document.createElement("form");this.$1Ri.method="POST";this.$1Ri.encType="multipart/form-data";this.$1Ri.encoding="multipart/form-data";this.$A1b(this.$1Ri);this.$ZZ=$(n.contentWindow.document.createElement("input"));this.$ZZ.attr("type","file");this.$ZZ.attr("name","fileInput");var t=this;this.$ZZ.change(function(n){t.$6Ix()});_a.UserAgent.getInstance().$Ea&&this.$ZZ[0].attachEvent("onchange",this.$$d_$6Ix);this.$1Ri.appendChild(this.$ZZ[0])},$A1b:function(n){this.get_$S()[0].contentWindow.document.body.appendChild(n)},$6Ix:function(){if(!this.$4U8){this.$4U8=!0;var n=this.$ZZ[0].value;if(!_js.$9.$o(n)){this.get_$9M().set_$1x(this.$EoS(n));this.get_$4dl().$11()}}},$EoS:function(n){var t=n.lastIndexOf("\\");return n.substr(t+1)},$7o4:function(){this.$ZZ[0].click()},$Ewy:function(){this.$4xe=!1;this.$1Ri.action=_g.$3U.get_$7Vo();this.$7nx()},$Ewx:function(){this.$4xe=!0;this.$1Ri.action=_g.$3U.get_$A72();this.$30J("subscriptionId",this.get_$k().get_$VQ());this.$7nx()},$7nx:function(){_js.Trace.logInfo(_at.$4v.$L,"Uploading attachment via form submit.");this.$30J("parentItemId",this.get_$F4().Id);this.$30J("parentChangeKey",this.get_$F4().ChangeKey);this.$30J("isInline",this.get_$9M().get_$C9().toString());this.$30J("cancellationId",this.get_$k().get_$1Bw());this.$30J(_a.$2B.$1nJ(),_a.$2B.$21e());this.$1Ri.submit();this.$Bs=2},$30J:function(n,t){var i=$(this.$1Ri.ownerDocument.createElement("input"));i.attr("type","hidden");i.attr("name",n);i.val(t);this.$1Ri.appendChild(i[0])}};_at.AttachmentPolicyLevel=function(){};_at.AttachmentPolicyLevel.prototype={undefined:0,block:1,forceSave:2,allow:3};_at.AttachmentPolicyLevel.registerEnum("_at.AttachmentPolicyLevel",!1);_at.$1WR=function(){};_at.$1WR.registerInterface("_at.$1WR");_at.$64=function(n,t){this.$CX=n||_at.$64.$Bt3();this.$3a0=t;this.$1R0=this.$3a0?this.$CX.DirectFileAccessOnPublicComputersEnabled:this.$CX.DirectFileAccessOnPrivateComputersEnabled;if(this.$1R0){this.$62B=_at.$64.$7hS(this.$CX.BlockedFileTypes,this.$CX.ForceSaveFileTypes,this.$CX.AllowedFileTypes);this.$6k0=_at.$64.$7hS(this.$CX.BlockedMimeTypes,this.$CX.ForceSaveMimeTypes,this.$CX.AllowedMimeTypes)}this.$6tG=_at.$64.$AIe(this.$CX.ActionForUnknownFileAndMIMETypes)};_at.$64.get_$Q=function(){_at.$64.$1Q||(_at.$64.$1Q=new _at.$64(_g.$O.get_$Q().get_$2dM(),_g.$O.get_$Q().get_$Eah()));return _at.$64.$1Q};_at.$64.$AIe=function(n){var t;try{t=_js.$1I.$Ba(_at.AttachmentPolicyLevel,n)}catch(i){t=1}return t};_at.$64.$8GU=function(n,t){return n[t]||0};_at.$64.$7hS=function(n,t,i){var r={};_at.$64.$5iQ(r,i,3);_at.$64.$5iQ(r,t,2);_at.$64.$5iQ(r,n,1);return r};_at.$64.$5iQ=function(n,t,i){if(t)for(var u=t,e=u.length,r=0;r<e;++r){var f=u[r];n[f]=i}};_at.$64.$Bt3=function(){var n=new _g.$ZF;return JsonParser.deserialize('{"AllowedFileTypes":[".rpmsg", ".xlsx", ".xlsm", ".xlsb", ".tiff", ".pptx", ".pptm", ".ppsx", ".ppsm", ".docx", ".docm", ".zip", ".xls", ".wmv", ".wma", ".wav", ".vsd", ".vss", ".vst",  ".vdx", ".vsx", ".vtx", ".vsdx", ".vssx", ".vstx", ".vsdm", ".vssm", ".vstm",".txt", ".tif", ".rtf", ".pub", ".ppt", ".png", ".pdf", ".one", ".mp3", ".jpg", ".gif", ".doc", ".bmp", ".avi"],"AllowedMimeTypes":["image/jpeg", "image/png", "image/gif", "image/bmp"],"ForceSaveFileTypes":[".swf", ".spl", ".dir", ".dcr"],"ForceSaveMimeTypes":["Application/x-shockwave-flash", "Application/octet-stream", "Application/futuresplash", "Application/x-director"],"BlockedFileTypes":[".vsmacros", ".msh2xml", ".msh1xml", ".ps2xml", ".ps1xml", ".mshxml", ".gadget", ".mhtml", ".psc2", ".psc1", ".msh2", ".msh1", ".aspx", ".xml", ".wsh", ".wsf", ".wsc", ".vsw", ".vbs", ".vbp", ".vbe", ".url", ".tmp", ".shs", ".shb", ".sct", ".scr", ".scf", ".reg", ".pst", ".ps2", ".ps1", ".prg", ".prf", ".plg", ".pif", ".pcd", ".osd", ".ops", ".mst", ".msp", ".msi", ".msh", ".msc", ".mht", ".mdz", ".mdw", ".mdt", ".mde", ".mdb", ".mda", ".maw", ".mav", ".mau", ".mat", ".mas", ".mar", ".maq", ".mam", ".mag", ".maf", ".mad", ".lnk", ".ksh", ".jse", ".its", ".isp", ".ins", ".inf", ".htc", ".hta", ".hpj", ".hlp", ".fxp", ".exe", ".der", ".csh", ".crt", ".cpl", ".com", ".cnt", ".cmd", ".chm", ".cer", ".bat", ".bas", ".asx", ".asp", ".app", ".adp", ".ade", ".ws", ".vb", ".js"],"BlockedMimeTypes":["application/x-javascript", "application/javascript", "application/msaccess", "x-internet-signup", "text/javascript", "application/xml", "application/prg", "application/hta", "text/scriplet", "text/xml"], "ActionForUnknownFileAndMIMETypes":"ForceSave","BlockWacViewingThroughUI":false,"WacViewableFileTypes":[".doc", ".docx", ".ppt", ".pptx", "xls", ".xlsx"],"WacViewingOnPublicComputersEnabled":true,"WacViewingOnPrivateComputersEnabled":true,"ForceWacViewingFirstOnPublicComputers":false,"ForceWacViewingFirstOnPrivateComputers":false,"ForceWebReadyDocumentViewingFirstOnPublicComputers":false,"ForceWebReadyDocumentViewingFirstOnPrivateComputers":false,"DirectFileAccessOnPrivateComputersEnabled":true,"DirectFileAccessOnPublicComputersEnabled":true,"WebReadyDocumentViewingOnPublicComputersEnabled":true,"WebReadyDocumentViewingOnPrivateComputersEnabled":true,"WebReadyDocumentViewingForAllSupportedTypes":false,"WebReadyFileTypes":[".xlsx", ".pptx", ".docx", ".xls", ".rtf", ".ppt", ".pps", ".pdf", ".dot", ".doc"],"WebReadyMimeTypes":["application/vnd.openxmlformats-officedocument.presentationml.presentation", "application/vnd.openxmlformats-officedocument.wordprocessingml.document", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "application/vnd.ms-powerpoint", "application/x-mspowerpoint", "application/vnd.ms-excel", "application/x-msexcel", "application/msword", "application/pdf"],"WebReadyDocumentViewingSupportedFileTypes":[".xlsx", ".pptx", ".docx", ".xls", ".rtf", ".ppt", ".pps", ".pdf", ".dot", ".doc"],"WebReadyDocumentViewingSupportedMimeTypes":["application/vnd.openxmlformats-officedocument.presentationml.presentation", "application/vnd.openxmlformats-officedocument.wordprocessingml.document", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "application/vnd.ms-powerpoint", "application/x-mspowerpoint", "application/vnd.ms-excel", "application/x-msexcel", "application/msword", "application/pdf"]}')};_at.$64.$38t=function(n,t){if(!n)return!1;for(var r=n,f=r.length,i=0;i<f;++i){var u=r[i];if(u===t)return!0}return!1};_at.$64.prototype={$3a0:!1,$1R0:!1,$6tG:0,$CX:null,$62B:null,$6k0:null,$4ny:function(n,t,i,r){$C(i)&&(i=!0);$C(n)||(n=n.toLowerCase());var e;e=this.$1R0?this.$Bla(n,t):1;var f=!1;var u=!1;var s=!1;var o=!1;if(i&&!r){this.$CEa(n)&&(u=!0);this.$CDf(n,t)&&(f=!0);s=this.$C9I(this.$3a0,u,f);u&&this.$CX.WacEditableFileTypes&&n&&(o=_at.$64.$38t(this.$CX.WacEditableFileTypes,n))}return new _at.$1At(this.$1R0,e,u,f,s,o)},$Bla:function(n,t){var r=_at.$64.$8GU(this.$62B,n);if(r===1)return 1;var i=_at.$64.$8GU(this.$6k0,t);return i===1?1:r===2||i===2?2:r===3||i===3?3:this.$6tG},$CEa:function(n){var t=this.$3a0?this.$CX.WacViewingOnPublicComputersEnabled:this.$CX.WacViewingOnPrivateComputersEnabled;return t&&this.$EyZ(n)},$CDf:function(n,t){var i=this.$3a0?this.$CX.WebReadyDocumentViewingOnPublicComputersEnabled:this.$CX.WebReadyDocumentViewingOnPrivateComputersEnabled;return i&&this.$EiB(n,t)},$C9I:function(n,t,i){return!t&&!i?!1:n?t?this.$CX.ForceWacViewingFirstOnPublicComputers:this.$CX.ForceWebReadyDocumentViewingFirstOnPublicComputers:t?this.$CX.ForceWacViewingFirstOnPrivateComputers:this.$CX.ForceWebReadyDocumentViewingFirstOnPrivateComputers},$EyZ:function(n){return _at.$64.$38t(this.$CX.WacViewableFileTypes,n)},$EiB:function(n,t){if(_js.$9.$o(n)){if(!_js.$9.$o(t))return this.$CX.WebReadyDocumentViewingForAllSupportedTypes?_at.$64.$38t(this.$CX.WebReadyDocumentViewingSupportedMimeTypes,t):_at.$64.$38t(this.$CX.WebReadyMimeTypes,t)}else return this.$CX.WebReadyDocumentViewingForAllSupportedTypes?_at.$64.$38t(this.$CX.WebReadyDocumentViewingSupportedFileTypes,n):_at.$64.$38t(this.$CX.WebReadyFileTypes,n);return!1}};_at.$1At=function(n,t,i,r,u,f){!n;this.$1R0=n;this.$1Ik=t;this.$2zI=i;this.$1ZL=r;this.$39W=u;this.$2zT=f};_at.$1At.prototype={$1Ik:0,$1R0:!1,$39W:!1,$2zI:!1,$1ZL:!1,$2zT:!1,get_$4yN:function(){return this.$1ZL||this.$2zI},toString:function(){return String.format("Attachment PolicyLevel: {0}, DirectFileAccessEnabled: {1}, WAC: {2}, Stellent: {3}, ForceBrowserView: {4}, WacEdit: {5}",this.$1Ik,this.$1R0,this.$2zI,this.$1ZL,this.$39W,this.$2zT)}};_at.$so=function(){this.$329=new FileReader};_at.$so.prototype={$329:null,$60x:null,get_$Kq:function(){return this.$329.error},get_$38P:function(){return this.$60x},get_$4d:function(){return this.$329.result},set_$995:function(n){this.$329.onloadend=n;return n},$9J4:function(n){var t=n;this.$329.readAsDataURL(t.$328)},$5KK:function(n,t,i,r){var u=this;this.set_$995(function(){if(!u.get_$Kq()&&u.get_$4d()){var f=u.get_$4d().indexOf(",");var n=u.get_$4d().substring(f+1,u.get_$4d().length);_js.Trace.logInfo(r,"No error - Reading the file.");u.get_$4d().substring(0,f).indexOf("base64")!==-1?t(n):t(_a.$5u.$Jc(n))}else{_js.Trace.logWarning(r,"File reader failed with error code {0}",u.get_$Kq());i()}});try{this.$9J4(n)}catch(f){this.$60x=f;_a.UserAgent.getInstance().$a3&&f.name==="NS_ERROR_FILE_ACCESS_DENIED"?_js.Trace.logInfo(r,"Firefox: failed to read an attachment. Exception: {0}",f.message):_js.Trace.logWarning(r,"Unexpected exception was thrown by FileReader.ReadAsDataURL: "+f.message);i()}}};_at.$11f=function(){};_at.$11f.prototype={$5tR:function(){return new _at.$so}};_at.$1C5=function(n){_at.$1C5.initializeBase(this);this.$xg=n};_at.$1C5.prototype={$xg:null,$6NV:function(n){var t=new _g.$1C6(this.$2i);n.$4TR(this.$xg,t,this.$$d_$6pk,this.$$d_$1Mo)},$6uq:function(n,t,i){n?t():i(null)}};_at.$Ct=function(n,t,i,r){_at.$Ct.initializeBase(this);this.$nj=n;this.$1w=t;this.$HH=i;this.$xg=r};_at.$Ct.$Bw5=function(n,t,i,r,u,f){try{var o=JsonParser.deserialize(n);if(o&&o.Body)if(o.Body.ResponseMessages){var s=o.Body.ResponseMessages.Items[0];if(s.ResponseCode!=="NoError"){_js.Trace.logError(_at.$Ct.$L,"Got a attachment error response with {0}",s.ResponseCode);var l=s.MessageText;var h={};h.ResponseCode=s.ResponseCode;f(Error.create(l,h),null)}else{var e=s.Attachments[0];t.set_$6I(e.AttachmentId);i.Id=e.AttachmentId.RootItemId;i.ChangeKey=e.AttachmentId.RootItemChangeKey;t.set_$8A(e.Size||0);t.set_$KK(e.ContentType);t.get_$C9()&&t.set_$SA(e.ContentId);u(o)}}else{_js.Trace.logError(_at.$Ct.$L,"Got no response message in the body; assuming it is a fault response");var c=o;f(Error.create(c.Body.FaultMessage),c.Body)}else{_js.Trace.logError(_at.$Ct.$L,"Got no response or response without body");f(Error.create(""),null)}}catch(a){_js.Trace.logError(_at.$Ct.$L,"Got exception processing response: {0}, exception: {1}",n,a);n===""&&(a=Error.create(""));f(a,null)}};_at.$Ct.$9H8=function(n,t,i){if(!n.IsCancelled){t.set_$6I(n.Attachments[0].AttachmentId);t.get_$C9()&&t.set_$SA(n.Attachments[0].ContentId);n.Attachments[0].Size>0&&t.set_$8A(n.Attachments[0].Size);i.Id=n.Attachments[0].AttachmentId.RootItemId;i.ChangeKey=n.Attachments[0].AttachmentId.RootItemChangeKey}};_at.$Ct.prototype={$nj:0,$1w:null,$HH:null,$Ce:null,$xg:null,$Bsi:function(){if(this.$2H||!this.$67||!this.$67.response){_js.Trace.logInfo(_at.$Ct.$L,"No success response because there's an error, or action is not complete.  Error: {0}",this.$2H);return null}return this.$67.response.result},$6NV:function(n){this.$Ce=this.$tt();var i=new _g.$10V(this.$2i);if(this.$xg){var t=new _g.$1Cv(this.$2i);t.clientStoreItem=this.$nj;t.isQueued=!1;t.palContext=new _g.$o9(!1);n.$5sw(this.$Ce,t,this.$$d_$6pk,this.$$d_$1Mo)}else{i.clientStoreItem=this.$nj;i.isQueued=!1;i.palContext=new _g.$o9(!1);n.$2FR(this.$Ce,i,this.$$d_$6pk,this.$$d_$1Mo)}},$wL:function(n){this.$9H9(n)},$9H9:function(n){_at.$Ct.$9H8(n,this.$1w,this.$HH)},$tt:function(){var i=new _g.$1T(this.$HH.Id);i.ChangeKey=this.$HH.ChangeKey;var t=this.$1w.$3rV();var n=new _g.$UB(i);n.Attachments=[t];n.RequireImageType=t.IsInline;n.IncludeContentIdInResponse=t.IsInline;n.ClientSupportsIrm=!0;n.CancellationId=this.$xg;return new _g.$UA(this.get_$7g(),n)}};_at.$1Cy=function(n,t,i,r){_at.$1Cy.initializeBase(this,[n,t,i,r]);var u=t.$LI;this.$5vs=u};_at.$1Cy.prototype={$5vs:null,$6NV:function(n){var u=this.$tt();var t=new _g.$10V(this.$2i);t.clientStoreItem=this.$nj;t.isQueued=!0;for(var r=u.Body.Attachments,e=r.length,i=0;i<e;++i){var f=r[i];if(f.IsInline){t.isQueued=!1;break}}t.palContext=new _g.$o9(!0);t.dataFile=this.$5vs.$TU();n.$2FR(u,t,this.$$d_$6pk,this.$$d_$1Mo)},$wL:function(n){this.$9H9(n)}};_at.$1DU=function(n,t,i){_at.$1DU.initializeBase(this);this.$nj=n;this.$1w=t;this.$HH=i;this.$D3=t.get_$6I()||t.get_$au()};_at.$1DU.prototype={$nj:0,$1w:null,$D3:null,$HH:null,$wL:function(n){this.$HH.Id=n.RootItemId.RootItemId;this.$HH.ChangeKey=n.RootItemId.RootItemChangeKey;this.$1w.get_$au()&&this.$1w.set_$6I(this.$1w.get_$au())},$6NV:function(n){var r=new _g.$UH;r.ClientSupportsIrm=!0;var i=new _g.$1DV(this.$2i);i.itemContexts=new Array(1);var t=new _g.$1DW;t.clientStoreItem=this.$nj;t.parentItemId=new _g.$1T(this.$HH.Id);t.parentItemId.ChangeKey=this.$HH.ChangeKey;r.AttachmentIds=[new _g.$DC(this.$D3.Id)];var u=new _g.$ah(this.get_$7g());u.Body=r;i.itemContexts[0]=t;n.$2fY(u,i,this.$$d_$6pk,this.$$d_$1Mo)}};_at.$Ux=function(n){_at.$Ux.initializeBase(this);this.$37V=_a.$6.$1f(_at.$Ux.$L,"DownloadAttachment");this.$D3=n};_at.$Ux.prototype={$D3:null,$35W:null,$37V:null,$6NV:function(n){var i=new _g.$1FS(this.$2i);var t=new _g.$c4(this.get_$7g());t.Body.AttachmentIds=[new _g.$DC(this.$D3)];t.Body.ShapeName="ItemAttachment";t.Body.AttachmentShape=_h.$f.get_$CEl();n.$6EZ(t,i,this.$$d_$6pk,this.$$d_$1Mo)},$wL:function(n){var u=n.Attachments.length;if(u!==1){var f=String.format("GetAttachment response length = {0}",u);_a.$6.$1F(this.$37V,"DownloadAttachment",f);_js.Trace.logWarning(_a.$0.$1l,f);return}var e=n.Attachments[0];if(!e){var t="GetAttachment response contained null attachment";_a.$6.$1F(this.$37V,"DownloadAttachment",t);_js.Trace.logWarning(_a.$0.$1l,t);return}var i=_a.$1A.$C4(_g.$7c,e);this.$35W=i.get_$E();if(!this.$35W){var r="GetAttachment response contained null item";_a.$6.$1F(this.$37V,"DownloadAttachment",r);_js.Trace.logWarning(_a.$0.$1l,r);return}_js.Trace.logInfo(_a.$0.$1l,"GetAttachment succeeded for '{0}' on '{1}'",i.get_$1x(),this.$35W.get_$3n());_a.$6.$1F(this.$37V,"DownloadAttachment")}};_at.$1FR=function(n,t){_at.$1FR.initializeBase(this);this.$2D=n;this.$1w=t;this.$D3=t.get_$6I()||t.get_$au();if(!_g.$54.isInstanceOfType(t)&&!_g.$7c.isInstanceOfType(t)&&!_g.$7Q.isInstanceOfType(t))throw Error.notImplemented("Only FileAttachment, ItemAttachment and ItemIdAttachment are supported to get content.");};_at.$1FR.prototype={$2D:null,$1w:null,$D3:null,$96z:function(){if(_g.$54.isInstanceOfType(this.$1w)){var n=this.$1w;if(_a.$1Ik.isInstanceOfType(n.$LI)){var u=n.$LI;var r=new _at.$11f;var f=r.$5tR();var t=this,i=this;f.$5KK(u,function(i){n.set_$DX(t.$63s(i));t.$Pa(null)},function(){var t=String.format("Unable to read content of file {0}.",n.get_$1x());_js.Trace.logWarning(i.$2D,t);i.$Pa(Error.create(t))},this.$2D);return 1}else return this.$8Ds()}else return _g.$7c.isInstanceOfType(this.$1w)?this.$8Ds():_h.$1ap.prototype.$96z.call(this)},$6uq:function(n,t,i){var r=this.$1w;if(_js.$9.$o(n))i(Error.create(String.format("The MIME content of item {0} cannot be retrieved.",r.get_$y().Id)));else{r.set_$c0(this.$63s(n));t()}},$6NV:function(n){var t=new _g.$1T(this.$1w.get_$y().Id);n.$6GM(t,null,this.$$d_$6pk,this.$$d_$1Mo)},$8Ds:function(){var t=new XMLHttpRequest;var i=String.format(_g.$7c.isInstanceOfType(this.$1w)?_g.$3U.get_$31r():_g.$3U.get_$7Vl(),encodeURIComponent(this.$D3.Id));var n=this;t.onreadystatechange=function(){if(t.readyState===4)if(t.status===200){var r=n.$63s(t.responseText);_g.$54.isInstanceOfType(n.$1w)?n.$1w.set_$DX(r):_g.$7c.isInstanceOfType(n.$1w)&&n.$1w.set_$c0(r);n.$Pa(null)}else{var i=String.format("Unable to get file attachment content.\nAttachmentId = {0}\nResponseBody = {1}\nStatusText = {2}",n.$D3.Id,t.responseText,t.statusText);_js.Trace.logError(n.$2D,i);n.$Pa(Error.create(i))}};t.open("GET",i,!0);_a.$c.$9m8(t);t.send(null);return 1},$63s:function(n){if(n.startsWith("data:")){var t=";base64,";var i=n.indexOf(t);return n.substr(i+t.length)}else return n}};var IAttachmentDataProviderMap=function(){};IAttachmentDataProviderMap.registerInterface("IAttachmentDataProviderMap");_at.$1Vc=function(){};_at.$1Vc.registerInterface("_at.$1Vc");var IAttachmentPreviewViewModelFactory=function(){};IAttachmentPreviewViewModelFactory.registerInterface("IAttachmentPreviewViewModelFactory");_at.$Vn=function(){};_at.$Vn.registerInterface("_at.$Vn");_at.$1Vb=function(){};_at.$1Vb.registerInterface("_at.$1Vb");_at.$AR=function(n,t,i,r,u){this.$Xw=_js.$9.$o(n)?"#":n;this.$g4=t;this.$Lp=i;this.$88=r;this.$8V9=u;this.$3S=u?_nbs.NonBootStrings.l_OpenInBrowser_Text:_nbs.NonBootStrings.l_Download_Text;_js.Trace.logInfo(_a.$0.$1l,'AttachmentDownloadLinkViewModel isHidden={0}, preventNavigation={1}, text="{2}", URL={3}',this.$88,this.$g4,this.$3S,this.$Xw)};_at.$AR.get_$8LP=function(){_at.$AR.$4qB||(_at.$AR.$4qB=new _at.$AR("#",!0,null,!0,!1));return _at.$AR.$4qB};_at.$AR.$9=function(n,t,i){_a.$4.$X(n,"viewModel");_a.$4.$X(i,"owaShell");var r;var f;var u;if(t){var h,c,l;_at.$AR.$AAr(n,h={val:f},c={val:r},l={val:u}),f=h.val,r=c.val,u=l.val}else{var e,o,s;_at.$AR.$7Y0(n,e={val:f},o={val:r},s={val:u}),f=e.val,r=o.val,u=s.val}if(_at.$34.isInstanceOfType(n)){var a=n;a.$sT.get_$1Q2()&&(r=!0)}return new _at.$AR(f,r,u,!1,t)};_at.$AR.$7Y0=function(n,t,i,r){var u=!1;if(_at.$34.isInstanceOfType(n)){var f=n;u=f.$sT.get_$1Q2()}if(!n.$PC.$1R0||u||n.$PC.$39W||n.$1w.get_$X2()){i.val=!0;t.val="#";r.val=n.$19g;return}switch(n.$PC.$1Ik){case 3:i.val=!1;t.val=n.$Xw;r.val=n.$7BV;break;case 2:i.val=!0;r.val=n.$19g;t.val=n.$Xw;break;case 1:i.val=!0;t.val="#";r.val=n.$19g;break;case 0:default:i.val=!0;t.val="#";r.val=n.$19g;break}};_at.$AR.$AAr=function(n,t,i,r){if(n.$1w.get_$X2()){i.val=!0;t.val="#";r.val=n.$19g;return}switch(n.get_$HN()){case 5:i.val=!0;t.val="#";r.val=n.$6pu;break;case 3:i.val=!0;t.val="#";r.val=n.$27b;break;case 1:case 2:i.val=!0;t.val="#";r.val=n.$PC.$1Ik===3?new _C(function(){n.$9h&&n.$9h.$EcQ(n)},_a.$0.$1l):n.$19g;break;default:_at.$AR.$7Y0(n,t,i,r);break}};_at.$AR.prototype={$g4:!1,$Xw:null,$Lp:null,$3S:null,$88:!1,$8V9:!1};_at.$qy=function(n,t,i,r,u){_at.$qy.initializeBase(this,[_at.$qy.$3Di(),"AttachmentUploadDatapoint"]);this.$P("S",n);this.$P("T",t.toString());this.$P("E",i);this.$P("X",r);this.$P("Z",u.toString())};_at.$qy.$3Di=function(){return 1};_at.$GS=function(){};_at.$GS.$$cctor=function(){_at.$GS.$3gr={}};_at.$GS.$A16=function(n){if(n){var t=_a.$5U.$4s(n);var i=t.$Z6.toString();_at.$GS.$3gr[i]=t}};_at.$GS.$A15=function(n,t,i,r){if(n){var u=n;var f=u.$Z6.toString();u=_at.$GS.$3gr[f];if(u){_at.$GS.$3gr[f]=null;u.$31a();var e=new _at.$qy(u.$3C,u.$1dC,t,i,r);_a.$i.$qm.$JT(e)}}};_at.$1j=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$625=Function.createDelegate(this,this.$625);this.$$d_$738=Function.createDelegate(this,this.$738);this.$$d_$ABd=Function.createDelegate(this,this.$ABd);this.$$d_$ABe=Function.createDelegate(this,this.$ABe);this.$$d_$34l=Function.createDelegate(this,this.$34l);this.$$d_$4WQ=Function.createDelegate(this,this.$4WQ);this.$$d_$5wn=Function.createDelegate(this,this.$5wn);this.$$d_$ATO=Function.createDelegate(this,this.$ATO);this.$$d_$7Vs=Function.createDelegate(this,this.$7Vs);this.$$d_$Ex2=Function.createDelegate(this,this.$Ex2);this.$$d_$AJv=Function.createDelegate(this,this.$AJv);this.$$d_$DVp=Function.createDelegate(this,this.$DVp);this.$$d_$2fY=Function.createDelegate(this,this.$2fY);this.$$d_$Dlc=Function.createDelegate(this,this.$Dlc);this.$$d_$WP=Function.createDelegate(this,this.$WP);this.$$d_$5Fa=Function.createDelegate(this,this.$5Fa);this.$$d_$EX5=Function.createDelegate(this,this.$EX5);this.$$d_$4b3=Function.createDelegate(this,this.$4b3);this.$$d_$aQ=Function.createDelegate(this,this.$aQ);this.$627=new _at.$11f;_at.$1j.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;_at.$1j.initializeBase(this);this.$2Y=f;this.$1G=o;this.$1Bf=s;this.$Pb=h;this.$6R=c;this.set_$9M(n);this.$I=t;this.set_$Dmv(u);this.$1D=e;this.$Qr_4=a;this.$l_4=y;_g.$54.isInstanceOfType(n)&&(this.$yG=n.get_$DX());u&&(this.$99=u.get_$1ag());this.$7t=i;this.$Df=r;this.$CX=v;this.set_$1Iw(!this.$7t);this.set_$7p1(_a.$69.$ld(n.get_$1x()));this.set_$9Fe(_at.$64.get_$Q().$4ny(this.$1Jg,this.$1w.get_$KK(),_y.$6j.$6Ta(this.$I,this.$1D),this.get_$3JA()));this.$1w&&this.$1w.get_$6I()&&this.set_$3S0(this.$PC.get_$4yN());this.$4KD();this.$3db();this.$9uE();this.$9v3();this.$7MC();this.$19g=new _C(this.$$d_$aQ,_at.$1j.$L);this.$1yy=new _C(this.$$d_$4b3,_at.$1j.$L);this.$7BV=new _C(this.$$d_$EX5,_at.$1j.$L);this.$6pu=new _C(this.$$d_$5Fa,_at.$1j.$L);this.$27b=new _C(this.$$d_$WP,_at.$1j.$L);this.$6Wx=new _C(this.$$d_$Dlc,_at.$1j.$L);if(!this.get_$C7K()){this.$IB=new _C(this.$$d_$2fY,_at.$1j.$L);this.$470=new _C(this.$$d_$DVp,_at.$1j.$L);this.$473=new _C(this.$$d_$AJv,_at.$1j.$L)}this.$QS=new _y.$NH;this.$Bq=l;this.$3dK();this.$wS()};_at.$1j.prototype={$19g:null,$1yy:null,$7BV:null,$6pu:null,$27b:null,$IB:null,$470:null,$473:null,$6Wx:null,$QS:null,$7t:!1,$Df:!1,$I:null,$1D:null,$l_4:null,$99:null,$1G:null,$1Bf:null,$2Y:null,$1w:null,$Xw:null,$3JO:!1,$2e9:!1,$4RT:!1,$7N0:!1,$6ps:!1,$PC:null,$9h:null,$3o:!1,$q7:!1,$3bK:null,$5Zu:null,$1j9:0,$1lY:null,$2IF:0,$3dk:null,$D3:null,$2sK:!1,$Yo:!1,$2EN:!1,$qT:0,$5lZ:null,$hW:!1,$4wL:!1,$1Jg:null,$3Tl:null,$22M:null,$5WY:!1,$5XF:!1,$3u5:null,$2a0:null,$KL:null,$3w7:!1,$yG:null,$2Dm:null,$31l:null,$2dP:null,$27o:null,$1da:!1,$5vK:null,$u5:null,$2G:null,$mP:2,$236:!1,$Pb:null,$6R:null,$4HX:null,$Bq:null,$Qr_4:null,$3vY:!1,$jW:!1,$xg:null,$CX:null,$5Kp:null,$7Fp:function(){_js.Trace.logInfo(_at.$1j.$L,"Starting attachment upload.");var t=this,n=this;_g.$1H.$1Q.$4d4("CreateAttachment",this.$$d_$Ex2,this.$AOA(),function(n){_js.Trace.logInfo(_at.$1j.$L,"Upload attachment enqueued. UploadOnlineOnlyAttachment will be called when we have connection to the server.")},function(t){_js.Trace.logWarning(_at.$1j.$L,"Enqueueing upload attachment failed: {0}",t.message);n.$2dL(1,_at.$6b.$3rs(t),!0);n.$4RH(null)})},add_$1G2:function(n){this.$31("OnUploadCompleteEvent",n)},remove_$1G2:function(n){this.$5d("OnUploadCompleteEvent",n)},add_$5FR:function(n){this.$31("OnUploadFailedEvent",n)},remove_$5FR:function(n){this.$5d("OnUploadFailedEvent",n)},add_$1ro:function(n){this.$31("OnDeleteCompleteEvent",n)},remove_$1ro:function(n){this.$5d("OnDeleteCompleteEvent",n)},add_$96f:function(n){this.$31("OnDownloadCompleteEvent",n)},remove_$96f:function(n){this.$5d("OnDownloadCompleteEvent",n)},add_$95S:function(n){this.$31("OnCancelCompleteEvent",n)},remove_$95S:function(n){this.$5d("OnCancelCompleteEvent",n)},set_$5lS:function(n){this.$31l=n;return n},get_$HN:function(){this.$1j9||(this.$1j9=this.$6Ea());return this.$1j9},get_$9M:function(){return this.$1w},set_$9M:function(n){var t=this.$1w;if(t!==n){$C(t)||t.remove_$ED(this.$$d_$7Vs);this.$1w=n;var i=$C(n);if(!i){n.add_$ED(this.$$d_$7Vs);_js.Trace.logInfo(_a.$0.$1l,"Attachment: {0}",n.get_$1x())}this.$8JU(i?null:n.get_$6I());this.$4("Attachment");this.$4("ReferenceAttachment");this.$4("ReferenceAttachmentProviderTypeInfo");this.$7MC();this.$9v2()}return n},get_$R0:function(){return this.$mP},set_$R0:function(n){if(this.$mP!==n){this.$mP=n;this.$7MC()}return n},get_$2tU:function(){return _g.$7i.isInstanceOfType(this.$1w)?this.$1w:null},get_$DvZ:function(){return this.get_$2tU()&&this.get_$2tU().get_$14a()?String.format(_nbs.NonBootStrings.l_ReferenceLinkShared_Text,_nbs.NonBootStrings.l_OneDriveProviderName_Text):""},get_$6I:function(){return this.$1w?this.$1w.get_$6I().Id:null},get_$8VT:function(){return!!this.get_$2tU()&&(this.get_$HN()===1||this.get_$HN()===2)},get_$CCg:function(){return this.get_$8VT()&&this.$1D.get_$8Z()},set_$2g:function(n){this.$3o=n;this.$4("IsSelected");return n},set_$5ys:function(n){if(this.$Xw!==n){this.$Xw=n;_js.Trace.logInfo(_at.$1j.$L,"Attachment download URL: {0}",this.$Xw);this.$4("DownloadUrl")}return n},set_$CE7:function(n){if(this.$3JO!==n){this.$3JO=n;this.$4("IsTriggeredPolicyTip")}return n},set_$1Iw:function(n){this.$2e9=n;this.$3h("CanDelete","ShowDeleteButton");return n},set_$4RU:function(n){this.$4RT=n;this.$3h("AttachmentWellPendingRefresh","ShowDeleteButton");return n},get_$5X7:function(){return this.$2e9||this.$4RT},set_$7N1:function(n){this.$7t||this.get_$5pO()||this.set_$1Iw(!n);this.$7N0=n;this.$4("UploadInProgress");return n},get_$3S0:function(){return this.$6ps},set_$3S0:function(n){this.$6ps=n;this.$4("OpenDocumentInBrowserLinkVisible");return n},set_$9Fe:function(n){this.$PC=n;this.$1j9=this.$6Ea();return n},get_$C6W:function(){return this.$9h},set_$Dmv:function(n){this.$9h=n;this.$4("ParentWell");return n},get_$ka:function(){return this.$q7},set_$ka:function(n){if(this.$q7!==n){this.$q7=n;this.$9h&&this.$9h.$ByO(this);this.$4("ShouldBeHidden")}return n},set_$6rt:function(n){if(this.$2sK!==n){this.$2sK=n;this.$4("PendingNonHtml5Upload")}return n},get_$4GU:function(){return this.$5WY},set_$4GU:function(n){if(this.$5WY!==n){this.$5WY=n;this.$4("ShouldSizeBeHidden")}return n},get_$9ii:function(){return!this.$1w||!this.$1w.get_$6I()||!this.get_$2eu()||!this.get_$2eu().$1a.get_$A()},get_$3y6:function(){return!1},get_$9Dg:function(){return!1},set_$9js:function(n){if(this.$5XF!==n){this.$5XF=n;this.$4("ShowEditPermissionsInCompose")}return n},set_$7p1:function(n){if(this.$1Jg!==n){this.$1Jg=n;this.$4("FileExtension")}return n},set_$7GR:function(n){this.$3bK=n;this.$4("SubmitUploadFormCommand");return n},set_$Eiu:function(n){this.$5Zu=n;this.$4("SubmitUploadAndShareFormCommand");return n},get_$VQ:function(){throw Error.notImplemented("This getter must be overridden");},get_$IQ:function(){this.$2G||(this.$2G=new _bc.$3e);return this.$2G},get_$6pp:function(){return this.$19g},get_$1CW:function(){return this.$IB},set_$63z:function(n){this.$1lY=n;_js.Trace.logWarning(_at.$1j.$L,"Attachment form upload error: {0}",this.$1lY);this.$4("FormUploadError");return n},set_$63y:function(n){this.$2IF=n;_js.Trace.logWarning(_at.$1j.$L,"Attachment form upload error code: {0}",this.$2IF);this.$4("FormUploadAttachmentError");return n},set_$5es:function(n){this.$3dk=n;this.$4("UploadSuccessResponse");return n},get_$94O:function(){return!1},get_$3S6:function(){return this.$Yo},get_$31s:function(){return this.$qT},get_$oj:function(){return this.$22M},set_$oj:function(n){this.$22M=n;return n},get_$v1:function(){var n=_y.$6j.$4mJ(this.$1w.get_$6I(),this.$Df,_g.$3U.get_$8Mv());_js.Trace.logInfo(_at.$1j.$L,"Image preview URL: {0}",n);return n},get_$jb:function(){return this.$1D.get_$1LH()},get_$4tv:function(){return this.$1D.get_$22Z()},get_$3Ha:function(){return this.get_$HN()!==2&&this.get_$HN()!==1||this.$1w.get_$C9()?!1:this.$PC.$1Ik===3},get_$6Oy:function(){return this.get_$HN()!==2?!1:this.$PC.$1Ik===3},get_$Bz7:function(){return this.get_$HN()!==2&&this.get_$HN()!==4},get_$Bz9:function(){return!this.$1w.get_$X2()&&(this.get_$HN()===2||this.get_$HN()===1)},get_$6LC:function(){if(this.$3u5)return this.$3u5;var n;n=OwaApplication.$Ou&&this.get_$HN()===5?!1:this.get_$33F()?this.get_$HN()===5||!this.get_$4GA()&&(!this.$Df||this.$Df&&this.get_$HN()!==3):this.get_$HN()===5||this.$I.get_$U()==="Mouse"&&this.get_$HN()!==3;_js.Trace.logInfo(_at.$1j.$L,"IconLinkViewModel preview = {0}",n);this.$3u5=_at.$AR.$9(this,n,this.$I);return this.$3u5},get_$ElZ:function(){if(this.$2a0)return this.$2a0;if(this.$I.get_$U()!=="Mouse"){this.$2a0=_at.$AR.get_$8LP();return this.$2a0}var t=!1;var n=!1;if(this.$1w.get_$X2()){n=_g.$7c.isInstanceOfType(this.$1w);t=n}else switch(this.get_$HN()){case 3:n=!1;t=this.get_$6P0()?!1:!this.$Df;break;case 6:n=!1;t=!1;break;case 1:case 2:t=!1;n=!1;break;case 5:if(OwaApplication.$Ou){t=!1;n=!1}else n=!0;break;case 4:n=!0;break;case 0:default:n=!0;break}if(n){_js.Trace.logInfo(_at.$1j.$L,"TextLinkViewModel is hidden");this.$2a0=_at.$AR.get_$8LP()}else{_js.Trace.logInfo(_at.$1j.$L,"TextLinkViewModel preview = {0}",t);this.$2a0=_at.$AR.$9(this,t,this.$I)}return this.$2a0},get_$2eu:function(){if(!this.$KL){var n=new Array(0);this.$KL=new _fm.$1t(n)}return this.$KL},set_$2eu:function(n){this.$KL=n;this.$4("ContextMenu");return n},get_$16a:function(){return this.$I.get_$U()!=="Mouse"},get_$1ag:function(){return this.$99},get_$3u:function(){var n=this.get_$HN();switch(n){case 4:return _nbs.NonBootStrings.l_BlockedContent_Text;case 1:case 2:return _nbs.NonBootStrings.l_ClickForPreview_Text;case 6:case 3:return this.$1w.get_$1x();case 5:return OwaApplication.$Ou?this.$1w.get_$1x():_nbs.NonBootStrings.l_ClickForPreview_Text;default:break}return""},set_$4uW:function(n){if(this.$3w7!==n){this.$3w7=n;this.$3db()}return n},get_$1dQ:function(){return this.$hW},set_$1dQ:function(n){if(this.$hW!==n){this.$hW=n;this.$4("IsDeleted")}return n},set_$lr:function(n){this.$jW!==n&&(this.$jW=n);return n},set_$8Rp:function(n){if(this.$3vY!==n){this.$3vY=n;this.$4("IsCancelling")}return n},get_$2gH:function(){_a.$4.$FX(this.get_$HN()===5,"Invalid Operation: EmbeddedItemClass should only be invoked when the Attachment is an ItemAttachment");return this.$1w.get_$HN()},get_$6P0:function(){return!!this.$1G&&(this.$1G.$2u("DocCollab")||this.$1G.$2u("ModernAttachments"))},get_$C8z:function(){return!!this.$1G&&!!this.$CX&&this.$1G.$2u("AttachmentsFilePicker")&&this.$CX.AttachmentDataProviderAvailable},get_$33F:function(){return this.get_$6P0()&&this.$I.get_$U()!=="TouchNarrow"&&(this.$PC.$2zI||this.get_$HN()===1||this.get_$HN()===2)&&!this.get_$3JA()},get_$4GA:function(){return this.$1D.get_$fJ()||this.$1D.get_$JK()||this.$I.get_$U()==="TouchNarrow"||!this.$7t&&this.$I.get_$U()==="TouchWide"},set_$A7B:function(n){if(this.$2Dm!==n){this.$2Dm=n;this.$4("AttachmentPreviewViewModel")}return n},get_$1LS:function(){return this.$1da},set_$1LS:function(n){this.$1da=n;n&&this.set_$3S0(!1);return n},set_$4wT:function(n){this.$236=n;this.$4("IsOpenedInLightBox");this.$4("IsComposedInLightBox");this.get_$6OU()&&this.set_$1Iw(!1);return n},get_$6OU:function(){_js.Trace.logInfo(_a.$0.$15,"AttachementName={4}, IsComposedInLightBox={5}, ParentWellIsNULL={0}, isOpenedInLightBox = {1}, this.parentWell.IsReadOnly={2}, WacEdit={3}",!this.$9h,this.$236,this.$9h.get_$HA(),this.$PC.$2zT,this.$1w?this.$1w.get_$1x():"null",this.$236&&!this.$9h.get_$HA()&&this.$PC.$2zT);return this.$9h?this.$236&&!this.$9h.get_$HA()&&this.$PC.$2zT:!1},get_$1Bw:function(){!this.$xg&&this.get_$5pO()&&(this.$xg=(+new Date).toString());return this.$xg},get_$5pO:function(){var n=!!this.$1G&&this.$1G.$2u("ModernAttachments");return!n||this.$1D.get_$8Z()||this.$1D.get_$4RK()?!1:!this.$9h.get_$12v()||!!this.$Qr_4&&this.$Qr_4.$2lO(this.$9h.get_$12v(),"AttachmentUploadCancellation")},get_$5p7:function(){var n=!!this.$1w.get_$6I();var i=n?this.$1w.get_$6I().Id:null;var t=i?_bc.$9E.$8Rs(i):!1;var r=this.$PC.$1Ik===1;_js.Trace.logInfo(_at.$1j.$L,"UpdateDownloadUrl: idExists={0}, isClientId={1}, policyInfo: {2}",n,t,this.$PC.toString());return n&&!r&&!t&&!this.$1w.get_$23S()},get_$C7K:function(){return!this.$9h},get_$ACR:function(){_js.Trace.logInfo(_at.$1j.$L,"Attachment class: {0}",this.$1j9);var n;switch(this.get_$HN()){case 0:n=!0;break;case 5:_js.Trace.logInfo(_at.$1j.$L,"Embedded item class: {0}",this.get_$2gH());switch(this.get_$2gH()){case 6:case 3:case 1:case 2:case 5:case 7:n=!0;break;default:n=!1;break}break;default:n=!1;break}_js.Trace.logInfo(_at.$1j.$L,"Can open: {0}",n);return n},get_$3JA:function(){return this.$1w.get_$X2()||this.$1w.get_$23S()},$3db:function(){this.$9h?this.set_$ka(this.$3w7||this.$1w.get_$C9()&&this.$9h.get_$C0a()&&!_g.$7i.isInstanceOfType(this.$1w)):this.set_$ka(this.$3w7||this.$1w.get_$C9());this.set_$ka(this.$q7||this.$1w.get_$2mO())},$DVp:function(){_js.Trace.logInfo(_at.$1j.$L,"File selected.");this.set_$4uW(!1);this.$9h&&this.$9h.$DVo(this)},$2bE:function(){_js.Trace.logInfo(_at.$1j.$L,"submitting upload to server");this.$Yo=!1;if(_g.$54.isInstanceOfType(this.$1w)){var n=this.$1w;this.$9vd(n)}else(_g.$7Q.isInstanceOfType(this.$1w)||_g.$7c.isInstanceOfType(this.$1w)||_g.$7i.isInstanceOfType(this.$1w))&&this.$7Fp()},$7GK:function(){_js.Trace.logInfo(_at.$1j.$L,"submitting delete to server");this.$Yo=!1;var n=new _at.$1DU(2,this.$1w,this.$9h.get_$F4());n.add_$2b(this.$$d_$ATO);n.add_$4T(this.$$d_$5wn);OwaApplication.$2B.$1U(n)},$6Fm:function(){var i=this.$1w;var r=i.$LI;var n=this.$627.$5tR();var t=this;n.set_$995(function(){if(n.get_$Kq())_js.Trace.logWarning(_at.$1j.$L,"HTML5 file reader attach failed with error code {0}",n.get_$Kq());else{var r=n.get_$4d().indexOf(",");var i=n.get_$4d().substring(r+1,n.get_$4d().length);t.$yG=n.get_$4d().substring(0,r).indexOf("base64")!==-1?i:_a.$5u.$Jc(i);t.$AQ("OnUploadCompleteEvent",t)}});try{n.$9J4(r)}catch(u){this.$1D.get_$1LH()&&u.name==="NS_ERROR_FILE_ACCESS_DENIED"?_js.Trace.logInfo(_at.$1j.$L,"Firefox: failed to read an attachment. Exception: {0}",u.message):_js.Trace.logException(_at.$1j.$L,u,"Unexpected exception was thrown by FileReader.ReadAsDataURL.")}},$6vQ:function(){this.$yG=null;this.$AQ("OnDeleteCompleteEvent",this);if(this.$u5){_a.$6.$1F(this.$u5,null,"",null,this.$35k(1));this.$u5=null}},$7Jp:function(){this.$27o=_a.$6.$1f(_a.$0.$1l,"AttachmentUploadQueue",!0)},$5cN:function(n){if(this.$27o){_a.$6.$1F(this.$27o,null,n,null,this.$Ls());this.$27o=null}},$7Jq:function(){if(this.$27o){_a.$6.$1F(this.$27o,null,null,null,this.$Ls());this.$27o=null}if(this.$31l){this.$2dP=_a.$6.$1f(_a.$0.$1l,this.$31l,!0);_at.$GS.$A16(this.$2dP)}},$5cO:function(){if(this.$2dP){var n="";this.$Yo&&(n=this.$5lZ);_a.$6.$1F(this.$2dP,null,n,null,this.$Ls());_at.$GS.$A15(this.$2dP,n,this.$1Jg,this.$1w.get_$8A());this.$2dP=null}},$1kv:function(){_js.Trace.logInfo(_at.$1j.$L,"Getting attachment content from server");this.$Yo=!1;var n=new _at.$1FR(_at.$1j.$L,this.$1w);var i=this;n.add_$4T(function(){i.$AQ("OnDownloadCompleteEvent",i);i.set_$3S0(!1)});var t=this;n.add_$2b(function(){_js.Trace.logWarning(_at.$1j.$L,"Download failed with error: {0}",n.$2H.message);t.$Yo=!0;t.$1da||t.$4WQ(n)});OwaApplication.$2B.$1U(n)},$8QC:function(n){if(_g.$7Q.isInstanceOfType(this.$1w)||_g.$7c.isInstanceOfType(this.$1w)){_js.Trace.logInfo(_at.$1j.$L,"Uploading item or id attachment.");this.$Ex0()}else if(_g.$54.isInstanceOfType(this.$1w)){var t=this.$1w;if(this.$yG){_js.Trace.logInfo(_at.$1j.$L,"Uploading file attachment with pasted image from clipboard.");this.$738(this.$yG)}else if(t.get_$DX()){_js.Trace.logInfo(_at.$1j.$L,"Uploading file attachment with content.");this.$738(null)}else if(t.get_$C9()&&_a.$RS.isInstanceOfType(this.$1w.$LI)&&_at.$34.isInstanceOfType(this)){_js.Trace.logInfo(_at.$1j.$L,"Uploading inline PAL image with content.");this.$9vg()}else if(this.$1D.get_$5lb()){_js.Trace.logInfo(_at.$1j.$L,"Uploading HTML5 file attachment.");this.$9ve(t.$LI)}else{_js.Trace.logInfo(_at.$1j.$L,"Uploading Non-HTML5 file attachment.");this.$9vf()}}else if(_g.$7i.isInstanceOfType(this.$1w)){this.$4wL=!0;if(this.$1D.get_$5lb()){_js.Trace.logInfo(_at.$1j.$L,"Uploading HTML5 reference attachment.");var i=this.$1w;this.$9ve(i.$LI)}else{_js.Trace.logInfo(_at.$1j.$L,"Uploading Non-HTML5 reference attachment.");this.$9vf()}}else{_js.Trace.logError(_at.$1j.$L,"Unsupported upload type.");n(null)}},$6Ea:function(){var n=0;if(_g.$54.isInstanceOfType(this.$1w))if(this.$PC.get_$4yN())n=3;else{var i,t;(t=_y.$6j.$7Ci(this.$1w,i={val:n}),n=i.val,t)||(n=this.$PC.$1Ik===1?4:6)}else n=_g.$7c.isInstanceOfType(this.$1w)?5:_g.$7Q.isInstanceOfType(this.$1w)?0:4;return n},$4KD:function(){this.get_$5p7()?this.set_$5ys(_y.$6j.$4mJ(this.$1w.get_$6I(),this.$Df)):this.set_$5ys(null)},$4WQ:function(n){this.$2dL(1,_at.$6b.$2jg(n),!0)},$2dL:function(n,t,i){this.$Yo=!0;if(this.$jW)_js.Trace.logInfo(_at.$1j.$L,"Attachment create failed callback after cancellation with cancellationId:{0} error: {1}, {2}",this.get_$1Bw(),n,t);else{_js.Trace.logWarning(_at.$1j.$L,"Attachment create failed with cancellationId: {0} error: {1}, {2}",this.get_$1Bw(),n,t);this.$qT=n;this.$5lZ=t;this.$9h&&this.$9h.$3xz(this.$99)&&this.$9h.$1Wv(this,!1)}this.$AQ("OnUploadFailedEvent",this)},$34l:function(n){this.$4RH(n)},$9uE:function(){this.set_$6rt(!this.$7t&&this.$1D.get_$4RK()&&$C(this.$1w.get_$6I())&&!_g.$7Q.isInstanceOfType(this.$1w))},$7Vs:function(n,t){if(t==="ContentType"||t==="Name"||t==="AttachmentId"){t==="Name"&&this.set_$7p1(_a.$69.$ld(this.$1w.get_$1x()));if(t==="ContentType"||t==="Name"){this.set_$9Fe(_at.$64.get_$Q().$4ny(this.$1Jg,this.$1w.get_$KK(),this.$I.get_$U()==="Mouse"||this.$1D.get_$2Oj(),this.get_$3JA()));this.$3db()}if(t==="AttachmentId"){this.$8JU(this.$1w.get_$6I());this.$9uE();this.$9v2()}this.$4KD()}},$738:function(n){var t=this.$1w;n&&t.set_$DX(n);this.$E7P(t)},$9vf:function(){this.$3bK.$11()},$AJv:function(){_js.$9.$o(this.$1lY)||this.$2dL(this.$2IF,this.$1lY,!1);this.$4RH(null)},$44:function(n){this.$2G?this.get_$IQ().$44(0,n,null):_a.$3t.$44(n,1)},$9vd:function(n){this.$7Fp()},$9vg:function(){_js.Trace.logInfo(_at.$1j.$L,"Submitting action for PAL attachment upload.");var n=new _at.$1Cy(2,this.$1w,this.$9h.get_$F4(),this.get_$1Bw());n.add_$2b(this.$$d_$4WQ);n.add_$4T(this.$$d_$34l);OwaApplication.$2B.$1U(n)},$7jP:function(n){_js.Trace.logInfo(_at.$1j.$L,"Not a PAL file attachment.")},$6po:function(){_js.Trace.logWarning(_at.$1j.$L,"Opening attachment with download URL {0}",this.$Xw);if(this.$1D.get_$8Z())if(this.$l_4.$8D(this.$l_4.get_$IE())&&this.$l_4.get_$IE().get_$2Gn().get_$2PB()){_js.Trace.logInfo(_at.$1j.$L,"Launch URL from nativeBridge");this.$l_4.get_$IE().$2PA(this.$Xw)}else{_js.Trace.logInfo(_at.$1j.$L,"Creating an anchor element to download file as OpenInTarget doesn't work in PAL");var t=document.createElement("a");t.href=this.$Xw;var n=document.createEvent("MouseEvent");n.initMouseEvent("click",!1,!1,window.self,0,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,0,null);t.dispatchEvent(n)}else this.$7t?this.$QS.$3S1(this.$Xw,"_self"):this.$QS.$3S1(this.$Xw,"_blank")},$94s:function(n,t){this.$D3=t;_js.Trace.logInfo(_at.$1j.$L,"Attachment ID: {0}",this.$D3?this.$D3.Id:"null")},$3dK:function(){var n=new _fm.$1t(new Array(0));this.get_$C8z()&&this.get_$2tU()&&!this.$7t&&n.$1a.$F(new _fm.$d(_u.Strings.l_ContextMenu_ManagePermissions_Text,null,this.$6Wx));if(this.get_$HN()===4||this.$PC.$1Ik===2||this.get_$4GA())this.get_$4GA()&&this.get_$33F()&&!this.get_$CCg()&&n.$1a.$F(new _fm.$d(_nbs.NonBootStrings.l_Preview_Text,null,this.$27b));else{var i=this.get_$8VT()?_nbs.NonBootStrings.l_OpenInBrowser_Text:_nbs.NonBootStrings.l_Download_Text;var t=this.$1D.get_$8Z()?_nbs.NonBootStrings.l_OpenInDevice_Text:i;n.$1a.$F(new _fm.$d(t,null,this.$1yy))}this.set_$2eu(n)},$Dlc:function(){this.$9h.$Dlj(this)},$E7P:function(n){_js.Trace.logInfo(_at.$1j.$L,"Submitting server action for file attachment with content.");var t=new _at.$Ct(2,n,this.$9h.get_$F4(),this.get_$1Bw());t.add_$2b(this.$$d_$4WQ);t.add_$4T(this.$$d_$34l);OwaApplication.$2B.$1U(t)},set_$6wP:function(n){this.$5Kp=n;return n},$2fY:function(){if(!this.$8K1(0)){_js.Trace.logInfo(_at.$1j.$L,"Deleting attachment.");this.$u5=_a.$6.$1f(_a.$0.$1l,"AttachmentDeleteAttachment",!0);this.set_$1dQ(!0);var n="";var i=!!this.$1w.get_$6I()&&!!this.$1w.get_$6I().Id&&!this.$1w.get_$6I().Id.startsWith("smime-");if(i){_js.Trace.logInfo(_at.$1j.$L,"Deleting attachment from server.");this.$9h.$1Wv(this,!1);this.$9h.$5K6(this)}else if(this.$7N0)if(this.get_$5pO())this.$4TR();else{_js.Trace.logError(_at.$1j.$L,"Somehow a user was able to try to delete an attachment in the process of being uploaded.");_a.$6.$1F(this.$u5,null,n="DeleteInProcessAttachment",null,this.$35k(0));this.$u5=null}else{if(_g.$54.isInstanceOfType(this.$1w)){var t=this.$1w;this.$7jP(t)}else _js.Trace.logInfo(_at.$1j.$L,"Not a file attachment.");this.$9h.$1Wv(this,!0);_a.$6.$1F(this.$u5,null,"",null,this.$35k(0));this.$u5=null;n="DeletedWhileInQueue"}this.$27o&&this.$5cN(n)}},$4TR:function(){if(!this.$3vY){_js.Trace.logInfo(_at.$1j.$L,"Cancel attachment with cancellationId {0}",this.get_$1Bw());this.$2EN=!1;this.set_$8Rp(!0);var n=new _at.$1C5(this.get_$1Bw());n.add_$2s(this.$$d_$ABe);n.add_$2b(this.$$d_$ABd);OwaApplication.$2B.$1U(n)}},$Ex2:function(n,t,i){this.set_$7N1(!0);if(this.$hW){_js.Trace.logInfo(_at.$1j.$L,"Attachment skipped because it's been deleted while it was pending.",this.$1w.get_$1x());t(null);return}var u=n;var r=u.Body.ParentItemId;this.$9h.get_$F4().Id=r.Id;this.$9h.get_$F4().ChangeKey=r.ChangeKey;this.$3Tl=t;this.$8QC(t)},$9ve:function(n){var t=this.$5vK=this.$627.$5tR();t.$5KK(n,this.$$d_$738,this.$$d_$625,_at.$1j.$L)},$625:function(){this.$2dL(2,_at.$6b.$BlP(this.$5vK),!1);this.$4RH(null)},$Ex0:function(){_js.Trace.logInfo(_at.$1j.$L,"Submitting action for item or id attachment.");var n=new _at.$Ct(2,this.$1w,this.$9h.get_$F4(),this.get_$1Bw());n.add_$2b(this.$$d_$4WQ);n.add_$4T(this.$$d_$34l);OwaApplication.$2B.$1U(n)},$AOA:function(){var t=this.$9h.get_$F4();var n=new _g.$1T(t.Id);n.ChangeKey=t.ChangeKey;var i=new _g.$UB(n);return new _g.$UA(null,i)},$4RH:function(n){var t=this.$Yo?_y.$La.toString(this.$qT):"";_js.Trace.logInfo(_at.$1j.$L,"Attachment create completed. Status: {0} CancellationId: {1}",t,this.get_$1Bw());if(!this.$jW){if(this.$3Tl){n&&this.set_$5es(n.$Bsi());this.$3Tl(this.$3dk)}this.set_$7N1(!1);this.set_$3S0(!this.$Yo&&this.$PC.get_$4yN());this.$3dK();if(_g.$7c.isInstanceOfType(this.$1w)){this.$9h.$1Wv(this,!1);this.set_$9M(n.$1w);this.$4KD();this.$9h.$1in(this)}if(this.$EZm()){_js.Trace.logInfo(_at.$1j.$L,"Incrementing parent well size.");(!n||this.$9h.$3xz(this.$99))&&this.$9h.$hU(this.$1w.get_$8A());this.$9v3()}}this.$AQ("OnUploadCompleteEvent",this)},$EZm:function(){if(this.$Yo||this.$jW)return!1;if(this.$1D.get_$4RK()||_g.$7Q.isInstanceOfType(this.$1w)||_g.$7i.isInstanceOfType(this.$1w))return!0;if(_g.$54.isInstanceOfType(this.$1w)){var n=this.$1w.$LI;if(_y.$mg.isInstanceOfType(n))return!0;if(_y.$HR.isInstanceOfType(n))return n.get_$8W9()}return!1},$ABe:function(n){_js.Trace.logInfo(_at.$1j.$L,"Cancel attachment succeeded with cancellationId {0}",this.get_$1Bw());this.set_$7N1(!1);this.$9h&&this.$9h.$3xz(this.$99)&&this.$9h.$1Wv(this,!1);this.$7Yk(n)},$ABd:function(n){_js.Trace.logWarning(_at.$1j.$L,"cancel failed with error: {0} and cancellationId: {1}",n&&n.$2H?n.$2H.message:"N/A",this.get_$1Bw());this.$2EN=!0;this.$7Yk(n)},$7Yk:function(n){this.$3Tl&&this.$3Tl(null);this.set_$8Rp(!1);this.set_$lr(!this.$2EN);this.$AQ("OnCancelCompleteEvent",this);var t=this.$2EN?_at.$6b.$2jg(n):"";if(this.$u5){_a.$6.$1F(this.$u5,null,t,n?n.$FG():null,this.$35k(2));this.$u5=null}},$ATO:function(n){_js.Trace.logWarning(_at.$1j.$L,"delete failed with error: {0}",n.$2H.message);this.$Yo=!0;this.set_$1dQ(!1);this.$9h.$3xz(this.$99)&&!this.$1da&&this.$9h.$1in(this);if(this.$u5){_a.$6.$1F(this.$u5,null,_at.$6b.$2jg(n),n?n.$FG():null,this.$35k(1));this.$u5=null}},$5wn:function(n){this.$AQ("OnDeleteCompleteEvent",this);if(this.$u5){_a.$6.$1F(this.$u5,null,"",n?n.$FG():null,this.$35k(1));this.$u5=null}},$EX5:function(){_y.$9P.$4GX=this.$I.get_$U()==="Mouse"&&this.$I.get_$Cp()&&!this.get_$3y6();this.$2Y&&this.$9h&&this.$9h.get_$F4()&&this.$2Y.$5FV(this.$9h.get_$F4())},$aQ:function(){(this.$7t||this.$1w.get_$6I())&&(this.$8K1(1)||(this.get_$33F()&&!this.get_$4GA()?this.$WP():this.$4b3()))},$8K1:function(n){if(this.$4RT&&this.$5Kp){_js.Trace.logInfo(_at.$1j.$L,"AttachmentWellPendingRefresh was true, so triggering refresh of the attachment well with operation: "+n);this.set_$4RU(!1);this.$5Kp(this.$1w,n);return!0}return!1},$4b3:function(){this.get_$6P0()&&(_y.$9P.$4GX=this.$I.get_$U()==="Mouse"&&this.$I.get_$Cp()&&!this.get_$3y6());if(this.$1w.get_$6I())if(OwaApplication.$Ou){_js.Trace.logInfo(_at.$1j.$L,"GenericMailMode, always download the attachment.");this.$5NU()}else if(_g.$7c.isInstanceOfType(this.$1w))this.$5Fa();else if(_g.$54.isInstanceOfType(this.$1w))this.$5NU();else if(_g.$7Q.isInstanceOfType(this.$1w)){var n=this.$1w;n.get_$y()?this.$5Fa():n.get_$a2()?this.$5Fa():this.$5NU()}else this.$5NU()},$5Fa:function(){if(!this.get_$ACR()){_js.Trace.logInfo(_at.$1j.$L,"Unsupported item.");this.$44(_nbs.NonBootStrings.l_ItemAttachmentNotSupported_Text);return}if(this.$1w.get_$23S()){var n=this;this.$uE(function(t){t.$A2D();n.$9Cd()})}else this.$9Cd()},$9Cd:function(){var n={};n.AttachmentItemID=this.$1w.get_$6I().Id;_js.Trace.logInfo(_at.$1j.$L,"Opening item attachment in pop-out window.");this.$I.$9y(IItemAttachmentPopOutFactory,null,n,_bc.$2I.get_$s0())},$5NU:function(){this.$ErM();this.$1w?this.$1w.get_$6I()?_js.Trace.logInfo(_at.$1j.$L,"SafeOpenAttachment: Name={0}, ID={1}",this.$1w.get_$1x(),this.$1w.get_$6I().Id):_js.Trace.logWarning(_at.$1j.$L,"SafeOpenAttachment: AttachmentId is null"):_js.Trace.logWarning(_at.$1j.$L,"SafeOpenAttachment: Attachment is null");_js.Trace.logInfo(_at.$1j.$L,"SafeOpenAttachment: Policy={0}",this.$PC.toString());if(this.$PC.$39W){_js.Trace.logInfo(_at.$1j.$L,"Attachment policy forces browser viewing.");this.$I.get_$U()==="Mouse"?this.$44(_nbs.NonBootStrings.l_ForceBrowserViewingFirstAlert_Text):this.$44(_nbs.NonBootStrings.l_ForceBrowserViewingFirstAlertNonMouse_Text);return}if(!this.$PC.$1R0){this.$44(_nbs.NonBootStrings.l_DirectFileAccessDisabled_Text);return}if(this.$PC.$1Ik===1){this.$44(_nbs.NonBootStrings.l_BlockedAlert_Text);return}if(this.get_$3JA()){var n=this;this.$uE(function(n){n.$E4N()});return}if(this.$PC.$1Ik===2){this.$EcH();return}this.$1w&&this.get_$5p7()&&this.$6po()},$EcH:function(){if(this.$I.get_$U()==="Mouse"){_js.Trace.logInfo(_at.$1j.$L,"Attachment policy forces save.");this.$1D.get_$De()?this.$44(_nbs.NonBootStrings.l_IE_ForceSaveAlert_Text):this.$44(_nbs.NonBootStrings.l_Default_ForceSaveAlert_Text)}else{_js.Trace.logInfo(_at.$1j.$L,"Attachment policy forces save, but device doesn't support download.");this.$44(_nbs.NonBootStrings.l_UnsupportedAttachment_Text)}},$WP:function(){if(this.$2Dm){this.$2Dm.$3vM()&&this.$9h.$4FV(this.$1w.get_$6I());this.$2Dm.$WP();return}if(this.$1Bf){var n=this;this.$1Bf.$9(function(t){if(!n.$9h){_js.Trace.logError(_a.$0.$1l,"Preview: Parent well is null.");return}n.set_$A7B(t.$9(n,n.$9h.get_$7Vx(),n.$Pb,n.$6R));n.$2Dm.$3vM()&&n.$9h.$4FV(n.$1w.get_$6I());n.$2Dm.$WP()})}},$8JU:function(n){var t=this.$D3;t!==n&&this.$94s(t,n)},$9v3:function(){this.set_$4GU(this.$2sK||_g.$7Q.isInstanceOfType(this.$1w)&&!this.$1w.get_$8A()||_g.$54.isInstanceOfType(this.$1w)&&_y.$mg.isInstanceOfType(this.$1w.$LI)&&!this.$1w.get_$8A()||_g.$54.isInstanceOfType(this.$1w)&&_y.$HR.isInstanceOfType(this.$1w.$LI)&&!this.$1w.get_$8A())},$7MC:function(){this.get_$2tU()&&(this.$mP===2?this.set_$9js(!0):this.set_$9js(!1))},$ErM:function(){if(!this.get_$3JA()&&this.get_$94O()){var n=_g.$1H.$1Q.$1cx(this.$1w.get_$6I());this.$1w.get_$6I().Id!==n.Id&&this.$1w.set_$6I(n)}},$Ls:function(){var n=new _a.$3z;n.$5H("S",this.$1w.get_$8A());n.$5H("W",this.$9h.get_$12v()?1:0);n.$5H("C",this.$jW?1:0);n.$CW("E",this.$1Jg);return n.toString()},$35k:function(n){var t=new _a.$3z;t.$5H("S",this.$1w.get_$8A());var i="A";_at.$Ug.isInstanceOfType(this)?i="C":this.get_$HN()===5?i="T":this.$1w.get_$C9()&&(i="I");t.$CW("T",i);t.$5H("O",n);t.$5H("W",this.$9h.get_$12v()?1:0);this.$31l&&t.$CW("Q",this.$31l);t.$CW("E",this.$1Jg);return t.toString()},$9v2:function(){this.$4("ShouldAffordanceMenuBeHidden")},$uE:function(n){if(this.get_$3JA()){_js.Trace.logInfo(_a.$0.$52,"[AttachmentViewModel] Creating Smime command factory.");var t=this;this.$Bq.$9(function(i){if(!t.$4HX){_js.Trace.logInfo(_a.$0.$52,"[AttachmentViewModel] Creating smimeAttachmentViewModelCommand instance.");t.$4HX=i.$AK3();t.$4HX.$3e(t.$1w)}_js.Trace.logInfo(_a.$0.$52,"[AttachmentViewModel] Executing smime operation.");n(t.$4HX)})}}};_at.$1Ax=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.$9x4=_at.$1j;_a.$4.$X(t,"owaShell");_a.$4.$X(i,"palDownloadManager");_a.$4.$X(r,"userAgent");_a.$4.$X(u,"nativeBridge");_a.$4.$X(s,"itemStoreGetterFactory");this.$2Y=n;this.$I=t;this.$sT=i;this.$1D=r;this.$l=u;this.$31u=f;this.$9P=e;this.$1Bf=o;this.$1dw=s;this.$5eu=h;this.$Bq=c;this.$Qr=l;this.$CX=a};_at.$1Ax.prototype={$I:null,$1D:null,$sT:null,$l:null,$9P:null,$1Bf:null,$1dw:null,$2Y:null,$Qr:null,$31u:null,$3gw:null,$9x4:null,$5eu:null,$Bq:null,$CX:null,$9:function(n,t,i,r,u,f){if(this.$8RP()&&(_g.$7i.isInstanceOfType(n)||_g.$54.isInstanceOfType(n)&&_y.$HR.isInstanceOfType(n.$LI))){if(!this.$3gw&&this.$31u){var e=this;this.$31u.$9(function(n){e.$3gw=n})}_a.$4.$z(this.$3gw,"attachmentProviderItemViewModelFactory");return this.$3gw.$9(n,this.$I,t,i,r,this.$1D)}else if(_g.$54.isInstanceOfType(n)&&_y.$mg.isInstanceOfType(n.$LI)){_a.$4.$z(this.$5eu,"uriFileAttachmentViewModelFactory");return this.$5eu.$9(n,this.$I,t,i,r,this.$1D)}else return new _at.$34(n,this.$I,t,i,r,this.$sT,this.$2Y,this.$l,this.$1D,this.$9P,this.$1Bf,this.$1dw,u,f,this.$Bq,this.$Qr,this.$CX)},$4WP:function(n,t,i,r,u,f,e){if(this.$8RP()&&this.$31u&&(_g.$7i.isInstanceOfType(n)||_g.$54.isInstanceOfType(n)&&_y.$HR.isInstanceOfType(n.$LI))){var o=this;var h=function(f){var e=f.$9(n,o.$I,t,i,r,o.$1D);u(e)};this.$31u.$9(h)}else{var s=new _at.$34(n,this.$I,t,i,r,this.$sT,this.$2Y,this.$l,this.$1D,this.$9P,this.$1Bf,this.$1dw,f,e,this.$Bq,this.$Qr,this.$CX);u(s)}},$AJo:function(n,t,i,r,u,f,e){if(!n){u(null);return}if(!n.length){u(new Array(0));return}this.$7hB(n,0,new Array(0),t,i,r,u,f,e)},$7hB:function(n,t,i,r,u,f,e,o,s){var h=this;this.$4WP(n[t],r,u,f,function(c){Array.add(i,c);t<n.length-1?h.$7hB(n,t+1,i,r,u,f,e,o,s):e(i)},o,s)},$8RP:function(){return!this.$9P||!this.$CX?!1:this.$9P.$2u("AttachmentsFilePicker")&&this.$CX.AttachmentDataProviderAvailable}};_at.$TL=function(n){this.$3gz=n};_at.$TL.prototype={$3gz:null};_at.$6b=function(){};_at.$6b.$2jg=function(n){var t;if(n){if(_h.$12g.isInstanceOfType(n)&&(t=n.get_$2CP())){if(t.responseCode)return t.responseCode;if(t.response){if(t.response.fault){var r=t.response.fault;var i=_at.$6b.$8Dj(r);if(i)return i}if(t.response.statusCode)return _at.$6b.$63t(t.response.statusCode)}}if(n.$2H)return _at.$6b.$3rs(n.$2H)}return"UnknownError_Action"};_at.$6b.$3rs=function(n){if(n){var t;if(t=n.responseCode)return t.toString();if(t=n.StackTrace)return _at.$6b.$8Dk(t.toString());if(t=n.ErrorCode)return _at.$6b.$63t(t);if(t=n.name){var i=t.toString();if(i!=="Error")return i;else if(n.message)return n.message}}return"UnknownError_Exception"};_at.$6b.$8Dj=function(n){if(n){if(n.ResponseCode)return n.ResponseCode;if(n.StackTrace)return _at.$6b.$8Dk(n.StackTrace);if(n.ErrorCode)return _at.$6b.$63t(n.ErrorCode)}return null};_at.$6b.$8Dk=function(n){var i;var t;if((i=n.indexOf(":"))!==-1||(i=n.indexOf("\n"))!==-1){t=n.substr(0,i);if((i=n.indexOf("\n"))!==-1){var u=new RegExp("[_a-zA-Z0-9.]+\\(");var r=u.exec(n.substr(i));r&&(t=t+"@"+r[0].substr(0,r[0].length-1))}}else t=n;return t};_at.$6b.$63t=function(n){return"HTTP_"+n};_at.$6b.$BlP=function(n){var i=n.get_$Kq();if(i){var t;t=Number.isInstanceOfType(i)?i:i.code;return t>=1&&t<_at.$6b.$626.length?_at.$6b.$626[t]:_at.$6b.$3rs(i)}return n.get_$38P()?_at.$6b.$3rs(n.get_$38P()):"UnknownError_FileReader"};_at.$Ug=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){this.$$d_$AJu=Function.createDelegate(this,this.$AJu);this.$$d_$AK1=Function.createDelegate(this,this.$AK1);this.$$d_$A6h=Function.createDelegate(this,this.$A6h);_at.$Ug.initializeBase(this,[n,t,i,r,u,s,f,h,c,l,a,v,y,p,w]);this.$P9=e;this.$n=o};_at.$Ug.$AIT=function(n){return n&&n.ResultCode===10?5:1};_at.$Ug.prototype={$n:null,$P9:null,$5Ky:function(){var n=_g.$1H.$Yr;n?n.$DwJ(this.get_$VQ(),this.$$d_$A6h,this.get_$Br()):this.$P9.$288(this.get_$VQ(),_a.$0.$4U,this.get_$Br(),this.$$d_$A6h,0)},$9rs:function(){var n=_g.$1H.$Yr;n?n.$EqN(this.get_$VQ(),this.$$d_$A6h):this.$P9.$2yv(this.get_$VQ(),this.$$d_$A6h)},$34l:function(n){this.$9rs();_at.$1j.prototype.$34l.call(this,n)},$AK1:function(n){},$AJu:function(n){this.$4WQ(n);this.$34l(null)},$A6h:function(n){var i=null;var t=n;i=n?this.$9HF(t.Response):"The notification received is null";if(i){t&&(i+=". AttachmentProviderResultCode = "+t.ResultCode);this.$2dL(_at.$Ug.$AIT(t),i,!0)}else this.$9Hc(t);this.$34l(null)},$9Hc:function(n){},$9HF:function(n){var r=null;if(n&&n.ResponseMessages&&n.ResponseMessages.Items&&n.ResponseMessages.Items.length)if(n.ResponseMessages.Items[0].ResponseCode!=="NoError")r="ResponseMessages response code = "+n.ResponseMessages.Items[0].ResponseCode;else{var i=n.ResponseMessages.Items[0];this.$1w.set_$8A(i.Attachments[0].Size);_at.$Ct.$9H8(i,this.$1w,this.$9h.get_$F4());if(_g.$7i.isInstanceOfType(this.$1w)&&i.Attachments.length>=1&&i.ResponseCode==="NoError"){var t=i.Attachments[0];if(t.AttachLongPathName){this.$1w.set_$2dK(t.AttachLongPathName);this.$1w.set_$14a(t.ProviderType);this.$1w.set_$1sY(t.ProviderEndpointUrl);this.$1w.set_$SA(t.ContentId)}this.$1w.set_$1x(t.Name)}}else r="The response message received is null";return r}};_at.$y3=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){_at.$y3.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,null,null,l,a,v,y])};_at.$y3.$4fV=function(){return"UriFileAttachmentNotification"+(_a.$8.get_$36().$8Y()+_ff.$8c.$3Ty(0,1e3)).toString()};_at.$y3.prototype={$MI:null,get_$VQ:function(){this.$MI||(this.$MI=_at.$y3.$4fV());return this.$MI},set_$VQ:function(n){this.$MI=n;return n},get_$Br:function(){return"UriFileAttachmentViewModel"},get_$5pO:function(){return!1},$8QC:function(n){if(_g.$54.isInstanceOfType(this.$1w)&&_y.$mg.isInstanceOfType(this.$1w.$LI)){_js.Trace.logInfo(_a.$0.$4U,"Uploading attachment from URL");var i=this.$1w.$LI;this.$5Ky();var t=new _at.$1Cw(this.$9h.get_$F4(),i.get_$ExA(),i.get_$1x(),this.get_$VQ());t.add_$2s(this.$$d_$AK1);t.add_$2b(this.$$d_$AJu);this.$n.$1U(t)}else{_js.Trace.logError(_a.$0.$4U,"Unsupported upload type detected in addFileAttachment");n(null)}},$9uE:function(){this.set_$6rt(!1)}};_at.$19b=function(n,t,i,r,u,f,e,o,s,h){this.$P9=n;this.$n=t;this.$2Y=i;this.$1G=r;this.$1Bf=u;this.$Bq=e;this.$CX=s;this.$l=h};_at.$19b.prototype={$P9:null,$n:null,$2Y:null,$1G:null,$Qr:null,$1Bf:null,$l:null,$Bq:null,$CX:null,$9:function(n,t,i,r,u,f){return new _at.$y3(n,t,i,r,u,f,this.$P9,this.$n,this.$2Y,this.$1G,this.$1Bf,this.$Bq,this.$Qr,this.$CX,this.$l)}};_at.$1Eh=function(n){this.$2D=n;this.$3K5={};this.$23x=new(_ff.$18.$$(_at.$PH))};_at.$1Eh.prototype={$2D:null,$3K5:null,$23x:null,get_$A:function(){return this.$23x.get_$A()},$5o:function(n){_a.$4.$1s(n,"attachmentId");return n in this.$3K5},$F:function(n){this.$5pm(n);if(!this.$5o(n.$D3)){this.$3eR("FastLookupQueue. Adding {0}",n);this.$23x.$F(n);this.$3K5[n.$D3]=""}},$76:function(n,t){this.$5pm(t);if(!this.$5o(t.$D3)){this.$3eR("FastLookupQueue. InsertAt {0}",t);this.$23x.$1ER(n,t);this.$3K5[t.$D3]=""}},$AUL:function(){this.$3eR("FastLookupQueue. DeQueue. Current count {0}",this.get_$A());if(this.get_$A()>0){var n=this.$23x.get_$E(0);this.$3K(n);return n}else return null},$3K:function(n){this.$5pm(n);this.$3eR("FastLookupQueue. Remove. Current count {0}",this.get_$A());if(this.$5o(n.$D3)){this.$3eR("FastLookupQueue. Remove. Found {0}",n);delete this.$3K5[n.$D3];for(var i=-1,t=0;t<this.$23x.get_$A();t++)if(this.$23x.get_$E(t).$D3===n.$D3){i=t;break}if(i!==-1){this.$23x.$5W(i);this.$3eR("FastLookupQueue. Returning from remove after removal. Current Count {0}",this.get_$A())}}},$5pm:function(n){_a.$4.$X(n,"parameter");_a.$4.$X(n.$D3,"AttachmentId")},$3eR:function(n,t){}};_at.$Ad=function(){};_at.$Ad.$6po=function(n,t,i,r,u,f,e){_a.$4.$X(n,"initNativeBridge");_a.$4.$X(t,"initClientStore");_a.$4.$X(i,"initAttachmentInfoRecord");_a.$4.$1s(r,"initMimeType");_a.$4.$1s(u,"fileName");_a.$4.$X(f,"initOnOpenAttachmentSuccess");_a.$4.$X(e,"initOnOpenAttachmentError");if(_at.$Ad.$4wV){_js.Trace.logInfo(_at.$Ad.$L,"Already opening an attachment so returning.");return}_js.Trace.logInfo(_at.$Ad.$L,"OpenAttachment with record DataID {0}, Size {1}, id {2}",i.AttachmentId,i.DataID,i.Size);_at.$Ad.$4wV=!0;n.get_$IE().$DlM(i.DataID,r,u,function(n){_at.$Ad.$DcZ(n,i,t,f,e)});t.$8C2(i.AttachmentId,function(n){},null)};_at.$Ad.$BlO=function(n){var t=null;switch(n){case 0:break;case 1:case 3:t=_nbs.NonBootStrings.l_UnableToFindActivity_Text;break;case 2:t=_nbs.NonBootStrings.l_DownloadAttachmentAgain_Text;break;default:break}_js.Trace.logInfo(_at.$Ad.$L,"OpenPalAttachment error code {0}, string: {1}",n,t);return t};_at.$Ad.$DcZ=function(n,t,i,r,u){_at.$Ad.$4wV=!1;var f=!0;switch(n){case 0:f=!1;break;case 1:case 3:break;case 2:i.$7jE(t.AttachmentId);break;default:break}if(f){_js.Trace.logWarning(_at.$Ad.$L,"OnOpenDocument failed with errorCode {0}",n);u(n)}else{_js.Trace.logInfo(_at.$Ad.$L,"OnOpenDocument succeeded");r()}};_at.$4Z=function(n,t,i){this.$$d_$DUb=Function.createDelegate(this,this.$DUb);this.$$d_$Dbf=Function.createDelegate(this,this.$Dbf);this.$$d_$9Aq=Function.createDelegate(this,this.$9Aq);_a.$4.$X(n,"initNativeBridge");var r=t?t.get_$4I9():null;this.$l=n;this.$4UZ=i;this.$43=n.get_$6rK().$6RC(r);this.$3e(t)};_at.$4Z.prototype={$43:!1,$1JQ:null,$UO:null,$1aN:null,$3kG:0,$2g2:null,$l:null,$4UZ:null,$9j:null,get_$1Q2:function(){if(!this.$43&&_g.$1H.$1Q){var n=_bc.$Oe.isInstanceOfType(_g.$1H.$1Q)?_g.$1H.$1Q:null;this.$43=this.$l.get_$6rK().$6RC(n?n.get_$9u():null);this.$3e(n?n.get_$4O().get_$2Dl():null)}return this.$43},$1k:function(n,t){_a.$4.$1s(n,"attachmentId");_a.$4.$X(t,"callbacks");if(this.get_$1Q2()){this.$2g2[n]=t;this.$Ap1(n,t)}else _js.Trace.logInfo(_at.$4Z.$L,"PAL does not support download.")},$2au:function(n){_a.$4.$1s(n,"attachmentId");this.get_$1Q2()&&n in this.$2g2&&delete this.$2g2[n]},$4b3:function(n){_a.$4.$X(n,"parameters");_a.$4.$X(n.$D3,"AttachmentId");_a.$4.$X(n.$Xw,"DownloadUrl");_js.Trace.logInfo(_at.$4Z.$L,"DownloadAttachment:Begin download Attachment for parameters {0}",n);if(this.get_$1Q2()){if(!(n.$D3 in this.$2g2))throw Error.invalidOperation("Subscribe must be called before calling DownloadAttachment.");var t=this.$EZX(n);if(_js.$9.$o(t)){if((!this.$UO||this.$UO.$D3!==n.$D3)&&!this.$1JQ.$5o(n.$D3)){_js.Trace.logInfo(_at.$4Z.$L,"Starting download for {0}",n);if(n.$6Pp){this.$1JQ.$76(0,n);if(this.$UO){this.$7Yo();this.$1JQ.$76(1,this.$1aN);this.$2Up(this.$1aN,2)}else{this.$2Up(n,2);this.$5ZL()}}else{this.$1JQ.$F(n);this.$2Up(n,2);this.$5ZL()}}}else this.$6va(n,t)}},$Gd:function(n){_a.$4.$X(n,"parameters");_a.$4.$X(n.$D3,"AttachmentId");_js.Trace.logInfo(_at.$4Z.$L,"Cancel download for parameters {0}",n);if(this.get_$1Q2())if(this.$1JQ.$5o(n.$D3)){this.$1JQ.$3K(n);_js.Trace.logInfo(_at.$4Z.$L,"Found and removed from queue {0}. Pending Items in queue {1}",n,this.$1JQ.get_$A());this.$2Up(n,1)}else if(this.$UO&&this.$UO.$D3===n.$D3){_js.Trace.logInfo(_at.$4Z.$L,"Current Download was canceled. {0}",this.$UO);this.$7Yo();this.$2Up(this.$1aN,1)}},$BwJ:function(n){var t=null;switch(n){case 0:break;case 7:break;case 3:t=_nbs.NonBootStrings.l_SpeechInvalidCredentials_Text;break;case 8:break;case 1:case 4:var r=this,i=this;this.$4UZ.$AEJ(this.$9j,this.$l,function(){_js.Trace.logInfo(_at.$4Z.$L,"Successfully completed CleanAllPalAttachmentInfoAndAttachments")},function(n){_js.Trace.logWarning(_at.$4Z.$L,"CleanAllPalAttachmentInfoAndAttachments failed due to error {0}",n)});t=_nbs.NonBootStrings.l_SpeechServerBusy_Text;break;case 5:t=_nbs.NonBootStrings.l_SpeechNoNetworkAction_Text;break;case 6:t=_nbs.NonBootStrings.l_SpeechServerBusy_Text;break;case 9:t=_nbs.NonBootStrings.l_UnableToDownload_Text;break;case 2:t=_nbs.NonBootStrings.l_UnknownDataIDType_Text;break;default:break}return t},$3e:function(n){if(this.$43){this.$9j=n;this.$1JQ=new _at.$1Eh(_at.$4Z.$L);this.$2g2={};this.$1aN=null;this.$UO=null;this.$3kG=0}},$7Yo:function(){_js.Trace.logInfo(_at.$4Z.$L,"CancelCurrentDownload, canceling the current download");this.$l.get_$1rN().$ABn();this.$1aN=this.$UO;this.$UO=null},$5ZL:function(){_js.Trace.logInfo(_at.$4Z.$L,"Inside StartDownloadInternal");if(this.$1aN)_js.Trace.logInfo(_at.$4Z.$L,"Still waiting for the canceled download to get canceled.");else if(this.$UO)_js.Trace.logInfo(_at.$4Z.$L,"Still waiting for the current download to finish.");else{_js.Trace.logInfo(_at.$4Z.$L,"StartDownloadInternal, pending items in queue {0}",this.$1JQ.get_$A());this.$UO=this.$1JQ.$AUL();this.$3kG=0;if(this.$UO){_js.Trace.logInfo(_at.$4Z.$L,"Starting download {0}",this.$UO);this.$2Up(this.$UO,3);var n=this;this.$4UZ.$EhT(this.$9j,this.$l,this.$$d_$9Aq,function(t){_js.Trace.logWarning(_at.$4Z.$L,"Scheduled cleanup failed due to error {0}",t);n.$9Aq()})}else _js.Trace.logInfo(_at.$4Z.$L,"Download queue is empty.")}},$9Aq:function(){_js.Trace.logInfo(_at.$4Z.$L,"Starting the download now for {0}",this.$UO);if(this.$1aN){this.$1aN=null;this.$5ZL()}else this.$l.get_$1rN().$AXG(this.$UO.$Xw,1,this.$UO.$1Jg,this.$UO.$2Rx,this.$$d_$Dbf,this.$$d_$DUb)},$Dbf:function(n){if(this.$UO){this.$3kG+=n;var t=this;this.$4dq(this.$UO,function(n){n.$96K(t.$3kG)})}},$2Up:function(n,t){var i=this;this.$4dq(n,function(n){n.$2rk(t)})},$6va:function(n,t){var i=this;this.$4dq(n,function(i){_js.Trace.logWarning(_at.$4Z.$L,"Raising OnError event with error {0} for attachment {1}",t,n);i.$XH(t)})},$4dq:function(n,t){var i=this.$2g2[n.$D3];i&&t(i)},$DUb:function(n,t,i){_js.Trace.logInfo(_at.$4Z.$L,"OnDownloadComplete with errorCode = {0} httpStatusCode = {1} dataID = {2} for attachment {3}",n,t,i,this.$UO);if(this.$1aN)this.$1aN=null;else if(n||t!==200){var f=this.$BwJ(n);_js.$9.$o(f)||this.$6va(this.$UO,f);this.$2Up(this.$UO,1)}else{var r=this.$UO;var u=new AttachmentInfoRecord(this.$UO.$D3,i,this.$UO.$4RO,_a.$8.get_utcNow().$8Y(),this.$UO.$5Gf,0,_a.$8.$AsS(_a.$8.get_utcNow()),!0);var e=this,s=this;this.$9j.$9Ow(u,function(n){_js.Trace.logInfo(_at.$4Z.$L,"Successfully saved attachment in DB with dataID {0} and parameters {1}",i,r)},function(n){_js.Trace.logWarning(_at.$4Z.$L,"Unable to save the attachment in DB with parameters {0} error {1}",r,n)});this.$2Up(r,4);var o=this;this.$4dq(r,function(n){_js.Trace.logInfo(_at.$4Z.$L,"Raising OnAttachmentInfoRecordAvailable with record {0} for attachment {1}",u,r);n.$94t(u)})}this.$UO=null;this.$5ZL()},$EZX:function(n){var t=null;if(_bc.$9E.$8Rs(n.$D3)){_js.Trace.logInfo(_at.$4Z.$L,"The attachment is not uploaded to the server yet. {0}",n);t=_nbs.NonBootStrings.l_AttachmentOfflineViewingUnsupported_Text}else if(_js.$9.$o(n.$5Gf)){_js.Trace.logInfo(_at.$4Z.$L,"Attachment is a quick message {0}",n);t=_nbs.NonBootStrings.l_AttachmentOfflineViewingUnsupported_Text}else if(_js.$9.$o(n.$2Rx)){_js.Trace.logInfo(_at.$4Z.$L,"Attachment does not have content type set. {0}",n);t=_nbs.NonBootStrings.l_UnknownDataIDType_Text}else if(_js.$9.$o(n.$1Jg)){_js.Trace.logInfo(_at.$4Z.$L,"Attachment does not have a valid file name {0}.",n);t=_nbs.NonBootStrings.l_UnknownDataIDType_Text}else if(this.$1JQ.get_$A()===10){_js.Trace.logInfo(_at.$4Z.$L,"download queue max size reached. Rejecting attachment with params {0}.",n);t=String.format(_nbs.NonBootStrings.l_DownloadAttachmentQueueMaxSizeReached_Text,10)}return t},$Ap1:function(n,t){if(this.$UO&&n===this.$UO.$D3){_js.Trace.logInfo(_at.$4Z.$L,"FindStatusAndFireCallback. currently downloading attachment with id {0}",n);t.$2rk(3)}else if(this.$1JQ.$5o(n)){_js.Trace.logInfo(_at.$4Z.$L,"FindStatusAndFireCallback. Found in the queue. attachment with id {0}",n);t.$2rk(2)}else{var r=this,i=this;this.$9j.$9OD(n,function(i){if(i){_js.Trace.logInfo(_at.$4Z.$L,"FindStatusAndFireCallback Found the record in db {0} and AttachmentId {1}",i.DataID,i.AttachmentId);t.$2rk(4);t.$94t(i)}else{_js.Trace.logInfo(_at.$4Z.$L,"FindStatusAndFireCallback. Did not find attachment with id {0} in the db.",n);t.$2rk(1)}},function(i){_js.Trace.logWarning(_at.$4Z.$L,"FindStatusAndFireCallback. Got error {0} from DB while retreiving record with id {1}",i,n);t.$2rk(1)})}}};_at.$PH=function(){};_at.$PH.$AOH=function(n){_a.$4.$X(n,"viewModel");_a.$4.$X(n.$Xw,"DownloadUrl should not be empty");var t=null;n.$9h&&n.$9h.get_$F4()&&(t=n.$9h.get_$F4().Id);return _at.$PH.$7gg(n.$1w,n.$1w.get_$1x(),n.$1w.get_$KK(),n.$Xw,t,!1)};_at.$PH.$7gg=function(n,t,i,r,u,f){_a.$4.$X(n,"attachment");_a.$4.$X(n.get_$6I(),"attachmentId");_a.$4.$X(r,"downloadUrl");_a.$4.$X(r,"destinationFileName");var e=new _at.$PH;e.$D3=n.get_$6I().Id;e.$4RO=n.get_$8A();e.$1Cn=t;e.$1Jg=_a.$69.$ld(e.$1Cn);e.$2Rx=i;e.$Xw=_a.Uri.$2u4(r);e.$5Gf=u;e.$6Pp=f;_js.$9.$o(e.$2Rx)&&!_a.UserAgent.getInstance().$YH&&(e.$2Rx="fakeMimeType");return e};_at.$PH.prototype={$2Rx:null,$1Cn:null,$1Jg:null,$D3:null,$5Gf:null,$Xw:null,$4RO:0,$6Pp:!1,toString:function(){return String.format("Attachment with Name {0} Size {1} ContentType {2} AttachmentId{3}",this.$1Cn,this.$4RO,this.$2Rx,this.$D3)}};_at.$34=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){_at.$34.initializeBase(this,[n,t,i,r,u,e,s,h,c,a,v,y,p,w,o]);_a.$4.$z(f,"palDownloadManager");_a.$4.$z(o,"nativeBridge");_a.$4.$z(l,"itemStoreGetter");this.$sT=f;this.$l=o;this.$1dw=l;this.$Qr=p;this.$1w&&this.$9nM(null,this.$1w.get_$6I())};_at.$34.prototype={$l:null,$sT:null,$Qr:null,$1dw:null,$5lg:null,$2s8:0,$48G:null,set_$6rJ:function(n){this.$2s8=n;this.$4("PALAttachmentDownloadStatus");return n},set_$Dmm:function(n){this.$48G=n;this.$4("PALAttachmentCurrentDowloadedBytes");return n},get_$94O:function(){return _at.$1j.prototype.get_$94O.call(this)||_g.$54.isInstanceOfType(this.$1w)&&_a.$RS.isInstanceOfType(this.$1w.$LI)},get_$33F:function(){var n=_at.$1j.prototype.get_$33F.call(this);if(n&&this.$l&&this.$l.$8D(this.$l.get_$IE())){var t=this.$l.$2r(_a.$10z,2);_js.Trace.logInfo(_at.$34.$L,"SetOneTimeAllowedUrlSupported is {0}",t);n=!!(n&t)}return n},get_$9Dg:function(){return this.$1D.get_$8Z()&&this.$7t},get_$7CO:function(){return this.get_$33F()&&!this.get_$4GA()?!1:this.$sT.get_$1Q2()&&this.$7t},get_$pb:function(){return!this.$PC.$1R0||this.$sT.get_$1Q2()||this.$PC.$39W||this.$1w.get_$X2()?!0:!1},$7LL:function(){this.$Eqj()},$2rk:function(n){_js.Trace.logInfo(_at.$34.$L,"Got attachment status {0}",n);this.set_$6rJ(n)},$96K:function(n){this.set_$Dmm(String.format(_nbs.NonBootStrings.l_DownloadAttachmentProgress_Text,this.$7e2(n,1),this.$7e2(this.$1w.get_$8A(),0)))},$XH:function(n){_js.Trace.logWarning(_at.$34.$L,"Unable to download attachment with name {0} and error is {1}",this.$1w.get_$1x(),n);this.$44(n)},$94t:function(n){_js.Trace.logInfo(_at.$34.$L,"Found/Saved the record in offline db {0} {1}",n.DataID,n.AttachmentId);this.$5lg=n},$9vd:function(n){_a.$RS.isInstanceOfType(n.$LI)?n.get_$C9()?this.$7Fp():this.$9vg():_at.$1j.prototype.$9vd.call(this,n)},$7jP:function(n){if(_a.$RS.isInstanceOfType(n.$LI)){_js.Trace.logInfo(_at.$34.$L,"Deleting file attachment via PAL.");var t=n.$LI;this.$l.get_$2f().$1kg(t.get_$1yX())}else _at.$1j.prototype.$7jP.call(this,n)},$6po:function(){if(this.$sT.get_$1Q2()){_js.Trace.logInfo(_at.$34.$L,"Will use PAL to open attachment.");this.$DlG()}else _at.$1j.prototype.$6po.call(this)},$94s:function(n,t){this.$9nM(n,t);_at.$1j.prototype.$94s.call(this,n,t)},$DlG:function(){_js.Trace.logInfo(_at.$34.$L,"OpenAttachmentUsingPAL, download status={0}",this.$2s8);if(!this.$9h.$3xz(this.$99)){_js.Trace.logWarning(_at.$34.$L,"The context has changed from "+this.$99+" to "+this.$9h.get_$1ag()+", opening attachment using PAL has been skipped.");return}if(this.$9h.get_$6OV()||!this.$7t){_js.Trace.logInfo(_at.$34.$L,"Returning because the attachment is a fake message. IsComposeReadOnlyWell = {0} and IsReadOnly {1}",this.$9h.get_$6OV(),this.$7t);return}this.$EuR();var t=_at.$PH.$AOH(this);_js.Trace.logInfo(_at.$34.$L,"PAL attachment download parameters: {0}",t.toString());switch(this.$2s8){case 0:case 1:this.$96K(0);_js.Trace.logInfo(_at.$34.$L,"Starting PAL attachment download.");this.$sT.$4b3(t);break;case 3:case 2:_js.Trace.logInfo(_at.$34.$L,"Canceling PAL attachment download.");this.$sT.$Gd(t);break;case 4:_js.Trace.logInfo(_at.$34.$L,"PAL attachment download complete.");var n=this;this.$1dw.$9(function(){var i=n.$1dw.get_$1Z().$9(_g.$O.get_$Q().get_$1j().get_$HL());_at.$Ad.$6po(n.$l,i.get_$2Dl(),n.$5lg,t.$2Rx,t.$1Cn,function(){_js.Trace.logInfo(_at.$34.$L,"Attachment opened successfully.")},function(t){_js.Trace.logWarning(_at.$34.$L,"Attachment open failed with errorCode {0}",t);t===2&&n.set_$6rJ(1);var i=_at.$Ad.$BlO(t);n.$44(i)})});break;default:break}},$9nM:function(n,t){if(this.$sT)if(_g.$7c.isInstanceOfType(this.$1w)){_js.Trace.logInfo(_at.$34.$L,"ItemAttachment for PAL status:Downloaded");this.set_$6rJ(4)}else if(this.$sT.get_$1Q2()){!$C(n)&&n.Id&&this.$sT.$2au(n.Id);!$C(t)&&t.Id&&this.$sT.$1k(t.Id,this)}},$Eqj:function(){if(this.$sT.get_$1Q2()&&this.$1w&&this.$1w.get_$6I()&&!_g.$7c.isInstanceOfType(this.$1w)){_js.Trace.logInfo(_at.$34.$L,"Unsubscribing for attachment with name {0} and id {1}",this.$1w.get_$1x(),this.$1w.get_$6I());this.$sT.$2au(this.$1w.get_$6I().Id)}},$7e2:function(n,t){var i;var r=n;if(n>=1073741824){r/=1073741824;i=_u.Strings.l_SizeWithGigabyteAbbreviation_Text}else if(n>=1048576){r/=1048576;i=_u.Strings.l_SizeWithMegabyteAbbreviation_Text}else if(n>=1024){r/=1024;i=_u.Strings.l_SizeWithKilobyteAbbreviation_Text}else i=_u.Strings.l_SizeWithByteAbbreviation_Text;return String.format(i,Math.round(r*Math.pow(10,t))/Math.pow(10,t))},$EuR:function(){if(this.$1D.get_$fJ()&&(_js.$9.$1g(this.$1w.get_$KK())||_at.$34.$4fa===this.$1w.get_$KK().toLowerCase())){var t=_a.$69.$ld(this.$1w.get_$1x());var n;if(_js.$9.$1g(t))n=_at.$34.$4fa;else{n=_at.$34.$7oZ[t.toLowerCase()];_js.$9.$o(n)&&(n=_at.$34.$4fa)}_js.Trace.logInfo(_at.$34.$L,"PAL GetMimeType File(Name:'{0}', Ext='{1}'), MimeType:(original:'{2}' is replaced with:'{3}')",this.$1w.get_$1x()||"<NULL>",t||"<NULL>",this.$1w.get_$KK()||"<NULL>",n);this.$1w.set_$KK(n)}}};_at.$1PR=function(){};_at.$1PR.prototype={get_$1Q2:function(){return!1},$1k:function(n,t){throw Error.invalidOperation("This method is not implemented for BOWA.");},$2au:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");},$4b3:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");},$Gd:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");}};var IWellKnownFileTypes=function(){};IWellKnownFileTypes.registerInterface("IWellKnownFileTypes");_at.$j8=function(){};_at.$j8.prototype={$4L:function(n,t){return String.format(_nbs.NonBootStrings.l_AttachmentParenthesisFormat_Text,n)},$7dj:function(n,t){throw Error.notImplemented();}};_at.$1E4=function(){};_at.$1E4.prototype={};_at.$1E4.registerEnum("_at.$1E4",!1);_at.$1Aj=function(){};_at.$1Aj.prototype={$4L:function(n,t){var r=n;var i=_js.$1I.$1GG(_a.$C2,t.toString());return r!==i},$7dj:function(n,t){throw Error.notImplemented();}};_at.$r1=function(){};_at.$r1.prototype={$4L:function(n,t){var i=n;return!i||!i.$1w?"":i.get_$HN()!==1&&i.get_$HN()!==2?"":_js.$9.$o(i.$1w.get_$5bI())?i.get_$v1():"data:"+i.$1w.get_$9p1()+";base64,"+i.$1w.get_$5bI()},$7dj:function(n,t){throw Error.notImplemented();}};_at.$vo=function(){};_at.$vo.prototype={$4L:function(n,t){var i=n;var r=!0;try{var u=_js.$1I.$1GG(_at.$1E4,t.toString());switch(u){case 1:i&&i!==1||(r=!1);break;case 2:i&&i!==1&&i!==4||(r=!1);break;case 3:i===3&&(r=!1);break;case 4:(i===3||i===2)&&(r=!1);break;case 5:i===2&&(r=!1);break;case 6:i!==1&&i||(r=!1);break}}catch(f){r=!0}return r},$7dj:function(n,t){throw Error.notImplemented();}};_at.$1Cw.registerClass("_at.$1Cw",_h.$19q.$$(String));AttachmentsComponent.registerClass("AttachmentsComponent",null,_a.$1XU);_at.$4v.registerClass("_at.$4v",_b.$G5);_at.$64.registerClass("_at.$64");_at.$1At.registerClass("_at.$1At");_at.$so.registerClass("_at.$so",null,_at.$1WR);_at.$11f.registerClass("_at.$11f");_at.$1C5.registerClass("_at.$1C5",_h.$19q.$$(Boolean),_a.$13I);_at.$Ct.registerClass("_at.$Ct",_h.$TO.$$(_g.$Ly,_g.$ZD));_at.$1Cy.registerClass("_at.$1Cy",_at.$Ct);_at.$1DU.registerClass("_at.$1DU",_h.$TO.$$(_g.$Qn,_g.$aj));_at.$Ux.registerClass("_at.$Ux",_h.$TO.$$(_g.$Uy,_g.$ZD));_at.$1FR.registerClass("_at.$1FR",_h.$19q.$$(String));_at.$AR.registerClass("_at.$AR");_at.$qy.registerClass("_at.$qy",_a.$AX);_at.$GS.registerClass("_at.$GS");_at.$1j.registerClass("_at.$1j",_a.$Em,_y.$OS,_js.$13h);_at.$1Ax.registerClass("_at.$1Ax",null,IAttachmentViewModelFactory);_at.$TL.registerClass("_at.$TL");_at.$6b.registerClass("_at.$6b");_at.$Ug.registerClass("_at.$Ug",_at.$1j);_at.$y3.registerClass("_at.$y3",_at.$Ug);_at.$19b.registerClass("_at.$19b",null,IUriFileAttachmentViewModelFactory);_at.$1Eh.registerClass("_at.$1Eh");_at.$Ad.registerClass("_at.$Ad");_at.$4Z.registerClass("_at.$4Z",null,_at.$Vn);_at.$PH.registerClass("_at.$PH");_at.$34.registerClass("_at.$34",_at.$1j,_at.$1Vb);_at.$1PR.registerClass("_at.$1PR",null,_at.$Vn);_at.$j8.registerClass("_at.$j8",null,_js.$1K7);_at.$1Aj.registerClass("_at.$1Aj",null,_js.$1K7);_at.$r1.registerClass("_at.$r1",null,_js.$1K7);_at.$vo.registerClass("_at.$vo",null,_js.$1K7);_at.$4v.$5lk=new _H("Attachment",_g.Attachment,_at.$4v);_at.$4v.$6rW=new _H("ParentItemId",_g.$1T,_at.$4v);_at.$4v.$2NU=new _H("IsEnabled",Boolean,_at.$4v);_at.$4v.$628=new _H("FileSelectedCommand",_js.$Cs,_at.$4v);_at.$4v.$5eq=new _H("UploadAttachmentCommand",_js.$Cs,_at.$4v);_at.$4v.$7My=new _H("UploadCompletedCommand",_js.$Cs,_at.$4v);_at.$4v.$L=_a.$0.$1l;_at.$64.$1Q=null;_at.$Ct.$L=_a.$0.$1l;_at.$Ux.$L=_a.$0.$1l;_at.$AR.$4qB=null;_at.$GS.$3gr=null;_at.$GS.$$cctor();_at.$1j.$L=_a.$0.$1l;_at.$6b.$626=["","NOT_FOUND_ERR","SECURITY_ERR","ABORT_ERR","NOT_READABLE_ERR","ENCODING_ERR","NO_MODIFICATION_ALLOWED_ERR","INVALID_STATE_ERR","SYNTAX_ERR","INVALID_MODIFICATION_ERR","QUOTA_EXCEEDED_ERR","TYPE_MISMATCH_ERR","PATH_EXISTS_ERR"];_at.$Ad.$L=_a.$0.$1l;_at.$Ad.$4wV=!1;_at.$4Z.$L=_a.$0.$1l;_at.$34.$L=_a.$0.$1l;_at.$34.$4fa="application/octet-stream";_at.$34.$1Ma="application/vnd.ms-excel";_at.$34.$6kr="application/msword";_at.$34.$2qa="application/vnd.ms-powerpoint";_at.$34.$7oZ={".abc":"text/vnd.abc",".acgi":"text/html",".afl":"video/animaflex",".aif":"audio/aiff",".aifc":"audio/aiff",".aiff":"audio/aiff",".aip":"text/x-audiosoft-intra",".art":"image/x-jg",".asf":"video/x-ms-asf",".asm":"text/x-asm",".asp":"text/asp",".asx":"video/x-ms-asf",".au":"audio/basic",".avi":"video/avi",".avs":"video/avs-video",".bm":"image/bmp",".bmp":"image/bmp",".c":"text/plain",".c++":"text/plain",".cat":"application/vnd.ms-pki.seccat",".cc":"text/plain",".chm":"application/vnd.ms-htmlhelp",".conf":"text/plain",".cpp":"text/x-c",".cs":"text/plain",".css":"text/css",".csv":_at.$34.$1Ma,".cxx":"text/plain",".def":"text/plain",".dif":"video/x-dv",".dl":"video/dl",".doc":_at.$34.$6kr,".docm":"application/vnd.ms-word.document.macroEnabled.12",".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".dot":_at.$34.$6kr,".dotm":"application/vnd.ms-word.template.macroEnabled.12",".dotx":"application/vnd.openxmlformats-officedocument.wordprocessingml.template",".dv":"video/x-dv",".dwg":"image/vnd.dwg",".dxf":"image/vnd.dwg",".el":"text/x-script.elisp",".etx":"text/x-setext",".f":"text/plain",".f77":"text/x-fortran",".f90":"text/plain",".fif":"image/fif",".fli":"video/fli",".flo":"image/florian",".flx":"text/vnd.fmi.flexstor",".fmf":"video/x-atomic3d-feature",".for":"text/x-fortran",".fpx":"image/vnd.fpx",".funk":"audio/make",".g":"text/plain",".g3":"image/g3fax",".gif":"image/gif",".gl":"video/gl",".gsd":"audio/x-gsm",".gsm":"audio/x-gsm",".h":"text/plain",".hh":"text/plain",".hlb":"text/x-script",".htc":"text/x-component",".htm":"text/html",".html":"text/html",".htmls":"text/html",".htt":"text/webviewhtml",".htx":"text/html",".hxx":"text/plain",".ico":"image/x-icon",".idc":"text/plain",".ief":"image/ief",".iefs":"image/ief",".isu":"video/x-isvideo",".it":"audio/it",".jam":"audio/x-jam",".jav":"text/plain",".java":"text/plain",".jfif":"image/jpeg",".jfif-tbnl":"image/jpeg",".jpe":"image/jpeg",".jpeg":"image/jpeg",".jpg":"image/jpeg",".jps":"image/x-jps",".jut":"image/jutvision",".kar":"audio/midi",".la":"audio/nspaudio",".lam":"audio/x-liveaudio",".list":"text/plain",".lma":"audio/nspaudio",".log":"text/plain",".lst":"text/plain",".lsx":"text/x-la-asf",".m":"text/plain",".m1v":"video/mpeg",".m2a":"audio/mpeg",".m2v":"video/mpeg",".m3u":"audio/x-mpequrl",".mar":"text/plain",".mcf":"text/mcf",".mid":"audio/midi",".midi":"audio/midi",".mjf":"audio/x-vnd.audioexplosion.mjuicemediafile",".mjpg":"video/x-motion-jpeg",".mod":"audio/mod",".moov":"video/quicktime",".mov":"video/quicktime",".movie":"video/x-sgi-movie",".mp2":"audio/mpeg",".mp3":"audio/mpeg",".mp4":"video/mp4",".mpa":"audio/mpeg",".mpe":"video/mpeg",".mpeg":"video/mpeg",".mpg":"video/mpeg",".mpga":"audio/mpeg",".mpp":"application/vnd.ms-project",".mpt":"application/vnd.ms-project",".mpv":"application/vnd.ms-project",".mpx":"application/vnd.ms-project",".mv":"video/x-sgi-movie",".my":"audio/make",".nap":"image/naplps",".naplps":"image/naplps",".nif":"image/x-niff",".niff":"image/x-niff",".ogg":"video/ogg",".ogv":"video/ogg",".p":"text/x-pascal",".pas":"text/pascal",".pbm":"image/x-portable-bitmap",".pct":"image/x-pict",".pcx":"image/x-pcx",".pdf":"application/pdf",".pfunk":"audio/make",".pgm":"image/x-portable-greymap",".pic":"image/pict",".pict":"image/pict",".pko":"application/vnd.ms-pki.pko",".pl":"text/plain",".pm":"image/x-xpixmap",".png":"image/png",".pot":_at.$34.$2qa,".potm":"application/vnd.ms-powerpoint.template.macroEnabled.12",".potx":"application/vnd.openxmlformats-officedocument.presentationml.template",".ppa":_at.$34.$2qa,".ppam":"application/vnd.ms-powerpoint.addin.macroEnabled.12",".ppm":"image/x-portable-pixmap",".pps":_at.$34.$2qa,".ppsm":"application/vnd.ms-powerpoint.slideshow.macroEnabled.12",".ppsx":"application/vnd.openxmlformats-officedocument.presentationml.slideshow",".ppt":_at.$34.$2qa,".pptm":"application/vnd.ms-powerpoint.presentation.macroEnabled.12",".pptx":"application/vnd.openxmlformats-officedocument.presentationml.presentation",".ppz":_at.$34.$2qa,".pwz":_at.$34.$2qa,".py":"text/x-script.phyton",".qcp":"audio/vnd.qcelp",".qif":"image/x-quicktime",".qt":"video/quicktime",".qtc":"video/x-qtc",".qti":"image/x-quicktime",".qtif":"image/x-quicktime",".ra":"audio/x-pn-realaudio",".ram":"audio/x-pn-realaudio",".rast":"image/cmu-raster",".rexx":"text/x-script.rexx",".rf":"image/vnd.rn-realflash",".rgb":"image/x-rgb",".rmi":"audio/mid",".rmm":"audio/x-pn-realaudio",".rmp":"audio/x-pn-realaudio",".rp":"image/vnd.rn-realpix",".rpm":"audio/x-pn-realaudio-plugin",".rt":"text/richtext",".rtf":"text/richtext",".rtx":"text/richtext",".rv":"video/vnd.rn-realvideo",".s":"text/x-asm",".s3m":"audio/s3m",".sdml":"text/plain",".sgm":"text/sgml",".sgml":"text/sgml",".shtml":"text/html",".sid":"audio/x-psid",".sldm":"application/vnd.ms-powerpoint.slide.macroEnabled.12",".sldx":"application/vnd.openxmlformats-officedocument.presentationml.slide",".snd":"audio/basic",".spc":"text/x-speech",".ssi":"text/x-server-parsed-html",".sst":"application/vnd.ms-pki.certstore",".svf":"image/vnd.dwg",".talk":"text/x-speech",".tcsh":"text/x-script.tcsh",".text":"text/plain",".tif":"image/tiff",".tiff":"image/tiff",".tsi":"audio/tsp-audio",".tsv":"text/tab-separated-values",".turbot":"image/florian",".txt":"text/plain",".uil":"text/x-uil",".uni":"text/uri-list",".unis":"text/uri-list",".uri":"text/uri-list",".uris":"text/uri-list",".uue":"text/x-uuencode",".vcs":"text/x-vcalendar",".vdo":"video/vdo",".viv":"video/vivo",".vivo":"video/vivo",".voc":"audio/voc",".vos":"video/vosaic",".vox":"audio/voxware",".vqe":"audio/x-twinvq-plugin",".vqf":"audio/x-twinvq",".vql":"audio/x-twinvq-plugin",".vsd":"application/x-visio",".vst":"application/x-visio",".vsw":"application/x-visio",".w6w":"application/msword",".wav":"audio/wav",".wbmp":"image/vnd.wap.wbmp",".webm":"video/webm",".wiz":"application/msword",".wm":"video/x-ms-wm",".wma":"audio/x-ms-wma",".wmf":"windows/metafile",".wml":"text/vnd.wap.wml",".wmls":"text/vnd.wap.wmlscript",".wmp":"video/x-ms-wmp",".wmv":"video/x-ms-wmv",".wmx":"video/x-ms-wmx",".word":"application/msword",".wsc":"text/scriplet",".wvx":"video/x-ms-wvx",".xbm":"image/x-xbitmap",".xdr":"video/x-amt-demorun",".xif":"image/vnd.xiff",".xl":"application/excel",".xla":_at.$34.$1Ma,".xlam":"application/vnd.ms-excel.addin.macroEnabled.12",".xlb":_at.$34.$1Ma,".xlc":_at.$34.$1Ma,".xld":_at.$34.$1Ma,".xlk":_at.$34.$1Ma,".xll":_at.$34.$1Ma,".xlm":_at.$34.$1Ma,".xls":_at.$34.$1Ma,".xlsb":"application/vnd.ms-excel.sheet.binary.macroEnabled.12",".xlsm":"application/vnd.ms-excel.sheet.macroEnabled.12",".xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",".xlt":_at.$34.$1Ma,".xltm":"application/vnd.ms-excel.template.macroEnabled.12",".xltx":"application/vnd.openxmlformats-officedocument.spreadsheetml.template",".xlv":_at.$34.$1Ma,".xlw":_at.$34.$1Ma,".xm":"audio/xm",".xpm":"image/xpm",".xps":"application/vnd.ms-xpsdocument",".x-png":"image/png",".xsr":"video/x-amt-showrun",".xwd":"image/x-xwd",".zsh":"text/x-script.zsh"};
window.scriptsLoaded['microsoft.exchange.clients.owa2.client.core.attachments.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.exchange.clients.owa2.client.core.attachments.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
