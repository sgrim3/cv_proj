try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.exchange.clients.owa2.client.mail.compose.js'] = (new Date()).getTime();
Type.registerNamespace("_mcp");function MailComposeComponent(){}MailComposeComponent.$9nd=function(n,t,i){var o=n==="Mouse";var s=!(t.get_$De()&&t.get_$gp().get_$5A()<9);var r=i.get_$4X().get_$CE();var e=!!r&&r.startsWith("en");var f=!!i.get_$b5()&&i.get_$b5().get_$5po();var u=!!i.get_$1j()&&i.get_$1j().get_$1aR();return o&&f&&u&&s&&e};MailComposeComponent.prototype={$2FB:function(n,t,i){var e=this;n.$r(_mcp.$mr).$2a(IMailComposeActionFactory).$1I().$t(function(){return new _mcp.$mr});var o=this;n.$r(_mcp.$14l).$2a(IMailResponseViewModelFactory).$1I().$t(function(){return new _mcp.$14l(n.$2(IInferenceTracker),n.$2(_g.$O),n.$2(IMailComposeContextFactory),n.$2(_mcp.$mr),n.$3O(ISmimeCommandFactory))});var s=this;n.$r(IMailComposeContextFactory).$1I().$t(function(){return new _mcp.$1Km(n.$2(_y.$mu),n.$2(_a.$AE))});var r=this;n.$r(_mcp.$14h).$2a(IMailComposeViewModelFactory).$1I().$t(function(){var u=n.$2(_a.$t);var f=n.$2(_g.$2c);var e=MailComposeComponent.$9nd(i.get_$A9(),u,f);var t=n.$2(_a.$1d);var r=i.get_$A9()==="Mouse"&&t.$2u("ComposeBread1");return new _mcp.$14h(n.$3O(IExtensibilityViewModelFactory),n.$2(_rw.$XK),e?n.$3O(IForgottenAttachmentDetectorFactory):null,n.$3O(IRichPeoplePickerViewModelFactory),n.$2(IMailComposeContextFactory),n.$2(_mcp.$mr),n.$2(_pe.$Cg),n.$2(_y.$W),n.$3O(IOfflineHelpProvider),n.$2(_mcp.$ua),n.$2(_y.$Do),n.$2(_ff.$M),n.$3O(IAttachmentWellViewModelFactory),t,n.$2(_a.$AE),n.$37(IAttachmentsFilePickerPanelViewModel),n.$2(IInferenceTracker),n.$2(_g.$Ln),n.$2(_a.$3G),n.$2(_g.$AL).get_$9vx(),n.$37(IMyLocationBuilder),n.$3O(IMailTipsHandlerFactory),n.$3O(IPolicyTipsHandlerFactory),i.get_$A9()==="Mouse"?n.$2(_cmc.$kO):null,r?n.$3O(ISendNotificationProviderViewModel):null,r?n.$3O(ISendFailureNotificationProviderViewModel):null,n.$3O(IFindRecipientMailComposeViewModelFactory),n.$37(IComponentOverrideFactory),n.$2(_g.$O).get_$2dM(),n.$3O(IIntroductionControllerFactory))});var u=this;n.$r(_mcp.$ua).$2a(IMailComposeDiscardManager).$1I().$t(function(){return new _mcp.$ua(n.$2(IMailComposeActionFactory))});var f=this;n.$r(_mcp.$mv).$t(function(){return new _mcp.$mv(window.document.createElement("div"),i.get_$A9(),n.$2(_a.$t),n.$2(_a.$AE),n.$2(_a.$1d),n.$2(_a.$3G))})},$BjW:function(){return null}};_mcp.$sG=function(n){_mcp.$sG.initializeBase(this);this.$1kE=n};_mcp.$sG.prototype={$1kE:null,$6NV:function(n){var i=this.$tt();var t=new _g.$1DD(this.$2i);t.explicitLogonUser=this.$1kE.$RK;$C(this.$1kE.$Ho)||t.actionName||(t.actionName=this.$1kE.$Ho);n.$7gw(i,t,this.$$d_$6pk,this.$$d_$1Mo)},$tt:function(){var t=this.$1kE.$APK();var i=new _g.$aX(this.get_$7g());var n=new _g.$UF;n.Items=t.Items;n.ItemShape=t.ItemShape;n.ShapeName=t.ShapeName;n.SubjectPrefix=t.SubjectPrefix;n.ClientSupportsIrm=t.ClientSupportsIrm;n.ComplianceId=t.ComplianceId;n.ComposeOperation=t.ComposeOperation;n.IsNonDraft=t.IsNonDraft;n.MessageDisposition=t.MessageDisposition;n.OutboundCharset=t.OutboundCharset;n.SavedItemFolderId=t.SavedItemFolderId;n.SendOnNotFoundError=t.SendOnNotFoundError;n.ShouldSuppressReadReceipt=t.ShouldSuppressReadReceipt;n.UseGB18030=t.UseGB18030;n.UseISO885915=t.UseISO885915;n.TimeFormat=t.TimeFormat;i.Body=n;return i},$1Mo:function(n){_h.$19q.prototype.$1Mo.call(this,n)},$wL:function(n){this.$1kE.$DtA(n)}};var IMailComposeOverridable=function(){};IMailComposeOverridable.registerInterface("IMailComposeOverridable");_mcp.$Gn=function(n,t,i,r,u,f,e,o){this.$$d_$8PP=Function.createDelegate(this,this.$8PP);this.$$d_$DYq=Function.createDelegate(this,this.$DYq);this.$$d_$96Z=Function.createDelegate(this,this.$96Z);this.$$d_$DUK=Function.createDelegate(this,this.$DUK);this.$$d_$9sW=Function.createDelegate(this,this.$9sW);this.$$d_$1tH=Function.createDelegate(this,this.$1tH);this.$$d_$E4q=Function.createDelegate(this,this.$E4q);this.$$d_$DV0=Function.createDelegate(this,this.$DV0);this.$$d_$26R=Function.createDelegate(this,this.$26R);this.$$d_$1rl=Function.createDelegate(this,this.$1rl);this.$$d_$BiU=Function.createDelegate(this,this.$BiU);this.$$d_$8PI=Function.createDelegate(this,this.$8PI);this.$$d_$1PY=Function.createDelegate(this,this.$1PY);_mcp.$Gn.initializeBase(this,[5,n]);this.$3a=i;this.$N2=u;this.$Ex=t;this.$16B=new _C(this.$$d_$1PY,this.get_$m());this.$1G=r;this.$5BF=f;this.$tm=e;this.$CX=o};_mcp.$Gn.prototype={$3a:null,$1G:null,$N2:null,$Ex:null,$5BF:null,$WF:null,$tm:null,$16B:null,$1dK:null,$4sW:null,$49B:null,$3uv:null,$4yE:!1,$r7:null,$1a6:null,$3yY:!1,$9j2:!1,$CX:null,get_$Tb:function(){return this.$w(_mcp.$Gn.$24N)},set_$Tb:function(n){this.$P(_mcp.$Gn.$24N,n);return n},get_$8PK:function(){this.$4sW||(this.$4sW=new _C(this.$$d_$8PI,this.get_$m()));return this.$4sW},add_$6mf:function(n){this.$31("AttachmentWellInitialized",n)},remove_$6mf:function(n){this.$5d("AttachmentWellInitialized",n)},get_$9Z:function(){return this.$w(_mcp.$Gn.$5lv)},set_$9Z:function(n){this.$P(_mcp.$Gn.$5lv,n);return n},get_$Pz:function(){return(this.get_$9Z()?this.get_$9Z().get_$Pz():!1)||(this.$WF?this.$WF.get_$E1a():!1)},get_$Oz:function(){return this.get_$9Z()&&this.get_$9Z().get_$1l()?this.get_$9Z().get_$1l().get_$A()>0:!1},$2wg:function(){if(this.$v.get_$4Km()&&!this.$1a6){_js.Trace.logInfo(_a.$0.$15,"Setting attachment component override");this.$1a6=this.$v.get_$4Hb().$AJs();this.$1a6.$3e(this.$$d_$BiU)}},$2Ek:function(){if(this.$1a6){this.$1a6.$AU();this.$1a6=null}},$3e:function(){var t=this.$1n.$v.$c;this.$2wg();this.$8OI();var i=!t.get_$OS()||t.get_$3tm();var r=t.get_$EU();var u=!((t.get_$6W()===4||t.get_$6W()===13)&&!this.$1G.get_$NB());if(this.get_$9Z()){this.get_$9Z().$5L2(t.get_$Fc(),r,i,t.get_$D1(),t.get_$2Dn());this.$7c7(t,i)}else{var n=this;this.$Ex.$9(function(f){if(_y.$z.$1Q.get_$U()==="TouchNarrow")n.set_$9Z(f.$2Fc(t.get_$Fc(),r,i,u,t.get_$2Dn(),!0,n.$1n.$v.$1d,t.get_$D1()));else{var e=f.$3jf(t.get_$Fc());e.set_$E(t.get_$ix());e.set_$CJ(1);n.set_$9Z(f.$4XL(e,r,i,_y.$z.$1Q.get_$U()==="Mouse"?3:0,u,t.get_$2Dn(),!0,n.$1n.$v.$1d,t.get_$D1(),n.$1n.$v.$6R,n.$1n.$v.$mX))}n.get_$9Z().add_$1rl(n.$$d_$1rl);n.get_$9Z().add_$26R(n.$$d_$26R);n.get_$9Z().apcl("EditorCallContext",n.$$d_$DV0);var o=n.$1n.$5k(14);o&&n.get_$9Z().add_$7O5(o.$$d_$kK);n.$AQ("AttachmentWellInitialized",n);n.$7c7(t,i)})}},$BiU:function(){return this.get_$9Z()},$DV0:function(n,t){if(t==="EditorCallContext"){var i=this.$1n.$5k(27);i.set_$Nb(this.get_$9Z().get_$Nb())}},$7E0:function(n){this.$49B&&this.$49B.set_$17(!n)},$7Dp:function(n){this.$3uv&&this.$3uv.set_$17(!n)},$26R:function(n){if(_a.$5N.$43){var t=this;_js.$D.get_$Q().$6F(_a.$0.$PD,"TriggerPolicyTipsIfNeeded",function(){var n=t.$1n.$5k(25);n.$2BC(8)})}},$1rl:function(){var i=this.$1n.$v;var n=i.$c;if(n.get_$Fc()){this.$4WR(n);this.get_$9Z()&&this.get_$9Z().$1NJ(n.get_$Fc(),n.get_$EU(),n.get_$2Dn())}else{var t=this.$1n.$5k(8);t.$2Mu("Attach",this.$$d_$E4q,this.$$d_$1tH,!1)}},$iW:function(){if(!this.$4yE&&this.get_$9Z()){var n=this.$1n.$v.$c;if(_y.$z.$1Q.get_$U()==="Mouse")this.get_$9Z().$1NJ(n.get_$Fc(),n.get_$EU(),n.get_$2Dn());else{_js.Trace.logInfo(_a.$0.$15,"Delaying attachment refresh because we're in not in mouse layout.");this.get_$9Z().$ASn(n.get_$Fc(),n.get_$EU(),n.get_$2Dn(),this.$$d_$9sW)}this.$9sW();this.$1n.$v.$N.$1o(_y.$ms,new _y.$ms);this.$4yE=!0}},$9sW:function(){var n=this.$1n.$v.$c;if(n.$jS)if(n.get_$EU()){var t=new _js.$X;t.$3x(n.get_$EU().$3T());n.$jS.set_$EU(t);n.get_$T5()&&n.get_$T5().set_$EU(t)}else{n.$jS.set_$EU(null);n.get_$T5()&&n.get_$T5().set_$EU(null)}},$AU:function(){var n=this.get_$9Z();if(n){n.remove_$1rl(this.$$d_$1rl);n.remove_$26R(this.$$d_$26R);n.rpcl("EditorCallContext",this.$$d_$DV0);_mcp.$3s.$Js(this.$1n)}this.$4yE=!1;this.$2Ek();_mcp.$14e.prototype.$AU.call(this)},$8Tc:function(){var n=_a.UserAgent.getInstance();return n.get_$8Z()&&!!this.$3a&&this.$1G.get_$NB()&&(this.$3a.$2u("iOSSharePointRichTextEditor")&&n.get_$JK()||this.$3a.$2u("AndroidCED")&&n.$YH)},$8Br:function(){var n=[];var t=this.$1n.$5k(15);var i=this.$1n.$5k(22);if(t){t.$1a4.$3r&&Array.add(n,new _y.$2Y(_u.CommonStrings.l_NewPhotoSubmenuItemText_Text,t.$1a4));t.$1a5.$3r&&Array.add(n,new _y.$2Y(_u.CommonStrings.l_PhotoFromGallerySubmenuItemText_Text,t.$1a5));this.$2NW()&&Array.add(n,new _y.$2Y(this.$4mI(),this.$16B))}else if(i)Array.add(n,new _y.$2Y(this.$4mI(),i.$5FY));else if(_a.UserAgent.getInstance().get_$31t()){Array.add(n,new _y.$2Y(this.$4mI(),this.$16B));this.$1G.get_$pm()&&this.$1n.$v.$c.get_$6P()==="HTML"&&!_a.UserAgent.getInstance().get_$8Z()&&Array.add(n,new _y.$2Y(_u.CommonStrings.l_PictureSubmenuItem_LowerCase_Text,this.$1dK))}return n},$7Mz:function(){var n=this.$1n.$v.$c;if(!_js.$9.$o(n.get_$36v())&&!this.$3yY&&n.get_$Fc()&&this.get_$9Z()){this.$3yY=!0;var t=!1;try{this.get_$9Z().$A1Z(n.get_$36v(),this.$$d_$DUK,this.$$d_$96Z);t=!0}finally{t||(this.$3yY=!1)}}},$Ex1:function(n){this.$tm&&this.get_$9Z()&&this.$tm.$9(this.get_$9Z(),this.get_$m()).$1PY(n)},$1PY:function(){var t=this.$1n.$v;var i=t.$c;_js.Trace.logInfo(_a.$0.$15,"Insert attachment start");if(this.$3IA()&&this.get_$9Z())if(this.$1a6)this.$1a6.$1G3(!1);else if(this.$2NW()){var n=_a.$6.$1f(_a.$0.$1l,"AttachmentsFilePickerPanelOpen",!0);_js.Trace.logInfo(_a.$0.$15,"Opening OWA's file picker");this.$5Xg(n)}else{_js.Trace.logInfo(_a.$0.$15,"Opening OS's file picker");this.get_$9Z().$1G3(!1,null,null)}_js.Trace.logInfo(_a.$0.$15,"Insert attachment end")},$8PP:function(){var n=this.$1n.$v;var t=n.$c;_js.Trace.logInfo(_a.$0.$15,"Insert picture start");this.$3IA()&&this.get_$9Z()&&(this.$1a6?this.$1a6.$1G3(!0):this.get_$9Z().$1G3(!0,null,null));_js.Trace.logInfo(_a.$0.$15,"Insert picture end")},$8PI:function(){if(this.$WF)this.$8PJ(this.$WF);else if(this.$5BF){var n=this;this.$5BF.$9(function(t){n.$WF=t;n.$8PJ(n.$WF)})}},$8PJ:function(n){_js.Trace.logInfo(_a.$0.$15,"Inserting location");var i=_a.$6.$1f(_a.$0.$sH,"BeamMeUpPlaceholderPopulated",!0);var t=this;n.$8PI(function(i){var r=t.$1n.$5k(27);r.set_$Nb(i);n.$A22(t.get_$9Z(),i.get_$C4r())},this.$$d_$DYq,i)},$DYq:function(n){if(n){var t=this.$1n.$v;t.$2G.$44(0,n,null)}},$8OI:function(){if(!this.get_$Tb()){var n=[];var t=new _fm.$d(this.$4mI(),null,this.$16B,!1,null,_nbs.NonBootStrings.l_InsertAttachment_AT_MenuItem_Text);Array.add(n,t);if(this.$1G.get_$pm()){this.$1dK=new _C(this.$$d_$8PP,this.get_$m());this.$49B=new _fm.$d(_u.CommonStrings.l_PictureSubmenuItem_LowerCase_Text,null,this.$1dK,!1,null,_nbs.NonBootStrings.l_InsertPicture_AT_MenuItem_Text);Array.add(n,this.$49B);this.$7E0(this.$1n.$v.$c.get_$6P()==="HTML");if(_a.UserAgent.getInstance().get_$8Z()&&this.$3a&&this.$3a.$2u("iOSSharePointRichTextEditor")){this.$3uv=new _fm.$d(_nbs.NonBootStrings.l_LocationSubmenuItem_LowerCase_Text,null,this.get_$8PK(),!1,null,_nbs.NonBootStrings.l_InsertLocation_AT_MenuItem_Text);Array.add(n,this.$3uv)}this.$7Dp(this.$1n.$v.$c.get_$6P()==="HTML")}this.set_$Tb(new _fm.$1t(n))}},$7c7:function(n,t){this.get_$9Z().set_$6OV(!n.get_$OS());_js.Trace.logInfo(_a.$0.$15,"Attachment component initialized, ReadOnly={0}",t);n.get_$OS()&&this.$iW();_mcp.$14e.prototype.$3e.call(this)},$4WR:function(n){n.get_$EU()||n.set_$EU(new _js.$X)},$3IA:function(){var t=this.$1n.$v;var n=t.$c;if($C(n)||!n.get_$OS()){_js.Trace.logInfo(_a.$0.$15,"Show not allowed to add attachment due to context="+(n?"non-null":"null")+"; Upgraded="+n.get_$OS());t.$2G.$44(0,_nbs.NonBootStrings.l_AddingAttachmentNotAllowed_Text,null);return!1}return!0},$E4q:function(n){var i=this.$1n.$v;var t=i.$c;if(n.$99===t.get_$D1()){this.$4WR(t);this.get_$9Z()&&this.get_$9Z().$1NJ(t.get_$Fc(),t.get_$EU(),t.get_$2Dn());this.$7Mz()}},$1tH:function(n){var t=this.$1n.$v;var i=t.$c;if(this.get_$9Z()&&n.$99===i.get_$D1()){this.get_$9Z().$9LE();t.$2G.$44(0,_nbs.NonBootStrings.l_WarningFileCanNotBeAttachedDisconnected_Text,null);this.$7Mz()}},$5Xg:function(n){if(this.$N2){var t=this;this.$N2.$9(function(i){t.$r7=i;if(t.$r7){var r=t.$v.$c.get_$6P()==="Text";t.$r7.$NQ(t.get_$9Z(),n,r,t.$1n.$v.$sO,t.$1n.$v.$6R)}})}},$Dqx:function(){if(this.$2NW()&&this.$N2){var n=this;this.$N2.$9(function(t){n.$r7=t;n.$r7&&n.$r7.$Dqv()})}},$2NW:function(){return!!this.$1G&&!!this.$CX&&this.$1G.$4RN(this.$CX.AttachmentDataProviderAvailable)},$DUK:function(n){this.$1n.$v.$c.set_$36v(null);this.$96Z(n)},$96Z:function(n){n.remove_$1G2(this.$$d_$DUK);n.remove_$5FR(this.$$d_$96Z);this.$3yY=!1;this.$9j2&&this.$1n.$5k(7).$3WY()},$4mI:function(){return this.$2NW()?_u.CommonStrings.l_AttachmentSubmenuItem_LowerCase_Text:_u.CommonStrings.l_AttachmentLegacySubmenuItem_LowerCase_Text}};_mcp.$1Ki=function(n,t,i){this.$$d_$A7j=Function.createDelegate(this,this.$A7j);this.$$d_$A7k=Function.createDelegate(this,this.$A7k);this.$$d_$DPj=Function.createDelegate(this,this.$DPj);this.$$d_$A7i=Function.createDelegate(this,this.$A7i);_mcp.$1Ki.initializeBase(this,[n,t,i]);this.$2Aw=new _mcp.$1Kz(this.$$d_$A7i,6e4)};_mcp.$1Ki.prototype={$2Aw:null,$3e:function(){var n=this.$1n.$v;var t=n.$c;_js.Trace.logInfo(_a.$0.$15,"Enabling timer during initialization of auto save component");this.$2Aw.$4y0=!0;if(!t.get_$4GV()){this.$1T();_js.Trace.logInfo(_a.$0.$15,"Auto save timer started")}_mcp.$Kl.prototype.$3e.call(this);n.$N.$1k(_a.$LW,this.$$d_$DPj)},$A7i:function(){var u=this.$1n;var r=u.$v;var n=r.$c;if(!n.get_$4GV()){if(!n.get_$6SL()){_js.Trace.logInfo(_a.$0.$15,"Auto Save not supported for the current operation {0}",n.get_$6W());return}var f=u.$5k(5);_js.Trace.logInfo(_a.$0.$15,"Checking dirty before auto save");var t=r.$IN();var i=f.get_$Pz();if(t&&!i){_js.Trace.logInfo(_a.$0.$15,"AutoSave:Context:"+n.toString());this.$2Aw.$1u();this.$2Mu("AutoSave",this.$$d_$A7k,this.$$d_$A7j,!1)}else{this.$2Aw.$1T();_js.Trace.logInfo(_a.$0.$15,"Skip auto save since IsDirty={0}, AttachmentInProgress={1}",t,i)}}},$1T:function(){var n=this.$1n.$v.$c;!n.get_$4GV()&&n.get_$6SL()&&this.$2Aw.$1T()},$AU:function(){_js.Trace.logInfo(_a.$0.$15,"Disabling the timer on reset");this.$2Aw.$370();var n=this.$1n.$v;n.$N.$4A(_a.$LW,this.$$d_$DPj);_mcp.$Kl.prototype.$AU.call(this)},$2A:function(){var n=this.$1n.$v;n.$N.$4A(_a.$LW,this.$$d_$DPj)},$DPj:function(n){_js.$D.get_$Q().$6F(_a.$0.$15,"Autosave triggered for PAL OnPause event",this.$$d_$A7i)},$A7k:function(n){var r=this.$1n;var i=r.$v;var t=i.$c;t.get_$4GV()||this.$2Aw.$1T()},$A7j:function(n){_js.Trace.logInfo(_a.$0.$15,"AutoSaveActionFailed: Error: {0}",n.$2H.message);this.$1n.$v.$c.get_$4GV()||this.$2Aw.$1T()}};_mcp.$JP=function(n){this.$$d_$EWV=Function.createDelegate(this,this.$EWV);this.$$d_$Ecg=Function.createDelegate(this,this.$Ecg);this.$$d_$DWo=Function.createDelegate(this,this.$DWo);this.$$d_$7M5=Function.createDelegate(this,this.$7M5);_mcp.$JP.initializeBase(this,[3,n])};_mcp.$JP.$7eV=function(n,t){return new _y.$2Y(n,t)};_mcp.$JP.$4Ww=function(n,t){return new _fm.$d(n,null,t,!0)};_mcp.$JP.prototype={$KL:null,$tP:null,$2Nh:!1,$4Gt:null,$E5:null,$3Gu:null,$2Nc:!1,set_$3wp:function(n){if(this.$2Nh!==n){this.$2Nh=n;this.$4("IsIrmProtected")}return n},set_$Ech:function(n){if(this.$4Gt!==n){this.$4Gt=n;this.$4("ShowIrmInformationCommand")}return n},set_$ns:function(n){if(this.$E5!==n){this.$E5=n;this.$4("DialogViewModel")}return n},$3e:function(){var n=this.$1n.$v;var u=n.$c;var o=n.$5w;var r=n.$l4;if(this.$5pF())if(_g.$1H.$Yr){_js.Trace.logInfo(_a.$0.$15,"Checking main window for compliance configuration");this.$tP=_mcp.$JP.$6Vv;_g.$1H.$Yr.$Bnu(this.$$d_$7M5)}else if(r.WasLoadedFromServer)this.$7M5(r);else{_js.Trace.logInfo(_a.$0.$15,"Adding the loading permissions menu item");this.$tP=_mcp.$JP.$6Vv;if(!r.IsLoadingFromServer){_js.Trace.logInfo(_a.$0.$15,"Submitting GetComplianceConfigurationAction");var e=n.$N;e.$1k(_a.$V6,this.$$d_$DWo);var s=new _h.$V5(r,n.$N);s.$11()}}else if(this.$tP&&this.$2Nc&&o.$1a){n.$5w.$5Lm(this.$tP);this.$2Nc=!1}var t=u.get_$9i();this.set_$3wp(!!t&&!t.get_$R9());if(this.$2Nh&&"Mouse"===_y.$z.$1Q.get_$U()){var i=n.$1ao();i.$4r.apply(i,[4499].concat([t.get_$2yM(),t.get_$2yK()]));i.$4r.apply(i,[4500].concat([t.get_$2FI()]))}else if(u.get_$a4()){var f=n.$1ao();f.$4r.apply(f,[3800].concat([u.get_$gv(),u.get_$eR()]))}"Mouse"===_y.$z.$1Q.get_$U()||this.$4Gt||this.set_$Ech(new _C(this.$$d_$Ecg,this.get_$m()));_mcp.$14e.prototype.$3e.call(this)},$AU:function(){this.set_$3wp(!1);_mcp.$14e.prototype.$AU.call(this)},$5pF:function(){var i=_g.$O.get_$Q();if(!$C(i.get_$9K())&&!i.get_$9K().get_$3vC()){_js.Trace.logInfo(_a.$0.$15,"IRM segmentation flag has been turned off, user cannot set compliance.");return!1}var n=this.$1n.$v.$c.get_$9i();var t=!n||!!n.get_$R9()||n.get_$KR()||n.get_$4dJ();_js.Trace.logInfo(_a.$0.$15,"CanSetCompliance="+t);return t},$3jy:function(n,t){var i=this.$1n.$v.$l4;var o=i.RmsTemplates?i.RmsTemplates.length:0;var s=i.MessageClassifications?i.MessageClassifications.length:0;if(0===o&&0===s){_js.Trace.logInfo(_a.$0.$15,"There are neither RmsTemplates nor message classifications available, skip setup of the compliance sub context menu.");return null}var r=new Array(1+o+s);var e=0;r[e++]=t(_nbs.NonBootStrings.l_NoRestriction_Text,new _C(this.$$d_$EWV,this.get_$m()));for(var f=0,u=0;f<o||u<s;)if(f===o){var l=i.MessageClassifications[u++];r[e++]=t(l.Name,new _C(this.$7et(l.Id),this.get_$m()))}else if(u===s){var a=i.RmsTemplates[f++];r[e++]=t(a.Name,new _C(this.$7g4(a.Id),this.get_$m()))}else{var h=i.MessageClassifications[u];var c=i.RmsTemplates[f];if(0<c.Name.localeCompare(h.Name)){r[e++]=t(h.Name,new _C(this.$7et(h.Id),this.get_$m()));u++}else{r[e++]=t(c.Name,new _C(this.$7g4(c.Id),this.get_$m()));f++}}return r},$2Fd:function(){if("Mouse"===_y.$z.$1Q.get_$U()){var i=this.$3jy(_fm.$d,_mcp.$JP.$4Ww);i&&(this.$KL=new _fm.$1t(i))}else if(!this.$2Nc){if(!this.$tP){var r=this.$3jy(_y.$2Y,_mcp.$JP.$7eV);r&&(this.$tP=new _y.$2Y(_nbs.NonBootStrings.l_SetPermissions_LowerCase_Text,null,r))}if(this.$tP){var u=this.$1n.$v.$5w;var t=u.$1a;if(t)for(var n=0;n<t.length;n++)if(_nbs.NonBootStrings.l_ImportanceMenuItem_LowerCase_Text===t[n].$3S){u.$4Oj(this.$tP,n+1);this.$2Nc=!0}}}},$DWo:function(n){var t=this.$1n.$v;this.$7M5(t.$l4);t.$N.$4A(_a.$V6,this.$$d_$DWo)},$7M5:function(n){var r=this.$1n.$v;r.$l4=n;_js.Trace.logInfo(_a.$0.$15,"Updating menu with complete compliance configuration.");if("Mouse"!==_y.$z.$1Q.get_$U()){this.$tP&&r.$5w.$5Lm(this.$tP);this.$tP=null;this.$2Nc=!1}n.WasLoadedFromServer&&this.$2Fd();if("Mouse"===_y.$z.$1Q.get_$U()){var t=this.$1n.$5k(18);if(t.get_$Tb()){var i=t.$3E3(_u.CommonStrings.l_LoadingPermissions_LowerCase_Text);i>=0&&t.get_$Tb().$1a.$5W(i);n.WasLoadedFromServer&&t.$A3K()}}},$EWV:function(){var i=this.$1n.$v;var n=i.$c;_js.Trace.logInfo(_a.$0.$15,"Set no restriction");n.set_$gz("0");var t=i.$1ao();if($C(n.get_$9i())){if(n.get_$a4()){t.$9T(3800);n.set_$a4(!1);n.set_$gv(null);n.set_$eR(null);n.set_$l1(null)}}else{if("Mouse"===_y.$z.$1Q.get_$U()){t.$9T(4499);t.$9T(4500)}n.set_$9i(null);this.set_$3wp(!1)}},$7g4:function(n){var t=this;return function(){_a.$6.stPT(_a.$0.$15,"MailComposeSetIRM",3);var h=_a.$6.$1f(_a.$0.$15,"MailComposeSetIRM",!0);var e=t.$1n.$v;var r=e.$c;r.set_$gz(n);if(r.get_$a4()){e.$1d.$9T(3800);_mcp.$3s.$Js(t.$1n);r.set_$a4(!1);r.set_$gv(null);r.set_$eR(null);r.set_$l1(null)}for(var s=e.$l4.RmsTemplates,o=0;o<s.length;o++){var u=s[o];if(n.toLowerCase()===u.Id.toLowerCase()){var i=new _g.$gj;i.set_$6zx(n);i.set_$2FI(_g.$O.get_$Q().get_$4X().get_$Fu());i.set_$KR(!0);i.set_$R9(0);i.set_$2yM(u.Name);i.set_$2yK(u.Description);i.set_$6P(r.get_$6P());r.set_$9i(i);if("Mouse"===_y.$z.$1Q.get_$U()){var f=e.$1ao();f.$9T(4499);f.$9T(4500);f.$4r.apply(f,[4499].concat([u.Name,u.Description]));f.$4r.apply(f,[4500].concat([i.get_$2FI()]))}t.set_$3wp(!0);_js.Trace.logInfo(_a.$0.$15,"Set IRM "+u.Name);break}}_a.$6.$1F(h);_a.$6.endPT("MailComposeSetIRM")}},$7et:function(n){var t=this;return function(){var u=t.$1n.$v;var r=u.$c;r.set_$gz(n);if(!$C(r.get_$9i())&&"Mouse"===_y.$z.$1Q.get_$U()){var s=u.$1ao();s.$9T(4499);s.$9T(4500);r.set_$9i(null);t.set_$3wp(!1)}for(var o=u.$l4.MessageClassifications,f=0;f<o.length;f++){var i=o[f];if(n.toLowerCase()===i.Id.toLowerCase()){r.set_$a4(!0);r.set_$gv(i.Name);r.set_$eR(i.Description);r.set_$l1(i.Id);var e=u.$1ao();e.$9T(3800);e.$4r.apply(e,[3800].concat([i.Name,i.Description]));_js.Trace.logInfo(_a.$0.$15,"Set class "+i.Name);break}}}},$Ecg:function(){var t=this.$1n.$v.$c;if(t.get_$9i()){var n=t.get_$9i();this.$Eci(n.get_$2yM(),n.get_$2yK(),n.get_$2FI())}else _js.Trace.logError(_a.$0.$15,"ShowIrmInformation was triggered without pre-existing license data or compliance entry selected.")},$Eci:function(n,t,i){if($C(this.$E5)){this.set_$ns(new _bc.$DH);this.$E5.$9B.$F(new _ff.$1l(this.$E5.$5a,_nbs.NonBootStrings.l_Close1_Text))}this.$E5.set_$3u(n);$C(this.$3Gu)&&(this.$3Gu=new _mcp.$13y);this.$3Gu.set_$it(t);this.$3Gu.set_$AIL(String.format(_nbs.NonBootStrings.l_IrmConversationOwner_Text,i));this.$E5.set_$FA(this.$3Gu);this.$E5.set_$1C(!0)}};_mcp.$14e=function(n,t){_mcp.$14e.initializeBase(this);this.$7cY=n;this.$1n=t;if(t&&t.$v){this.$v=t.$v;this.$c_2=this.$v.$c;this.$v2=this.$v.$1d}};_mcp.$14e.prototype={$7cY:0,$1n:null,$v:null,$c_2:null,$v2:null,$A8:!1,get_$G6:function(){return this.$A8},set_$G6:function(n){this.$A8=n;return n},get_$m:function(){return _a.$0.$15},$3e:function(){this.$A8=!0},$AU:function(){this.$A8=!1},$5if:function(n){var t=this.$6FO(n);this.$v2.$4r(t,null);if(t===55||t===50){var i=this;this.$v.$2Ss.$9(function(n){n.$7RJ(i.$v2);_mcp.$3s.$Js(i.$1n)})}else _mcp.$3s.$Js(this.$1n)},$3fe:function(n){this.$v2.$2Cm(n);_mcp.$3s.$Js(this.$1n)},$7Rj:function(n,t){for(var u=[],i=2;i<arguments.length;++i)u[i-2]=arguments[i];var r;(r=this.$v2).$eD.apply(r,[t,n].concat(u));_mcp.$3s.$Js(this.$1n)},$3Ul:function(){this.$v2.$E0N();this.$v2.$ad(_mcp.$Kl.$wI);this.$v2.$ad(_mcp.$G6.$wI);this.$v2.$ad(_mcp.$MX.$wI);var n=this;this.$v.$2Ss.$9(function(t){t.$Dz4(n.$v2);_mcp.$3s.$Js(n.$1n)})},$7CK:function(){if(!this.$c_2.$jS)return!0;_js.Trace.logInfo(_a.$0.$15,"Comparing initial baseline to baseline. Context:"+this.$c_2.toString());if(!this.$c_2.$jS.$5b(this.$c_2.get_$T5()))return!0;_js.Trace.logInfo(_a.$0.$15,"Checking dirty before showing discard confirmation.");return this.$v.$IN()?!0:this.$c_2.get_$1TJ()?!0:!1},$6FO:function(n){throw Error.notImplemented(String.format("GetErrorInfoBarMessageId is not implemented for type {0}",Object.getType(this)));}};_mcp.$1Kk=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$$d_$AEl=Function.createDelegate(this,this.$AEl);this.$$d_$EUE=Function.createDelegate(this,this.$EUE);this.$$d_$E28=Function.createDelegate(this,this.$E28);this.$$d_$C2m=Function.createDelegate(this,this.$C2m);this.$2F6=[];this.$5re=new _mcp.$1Kj(this,t,i,r,u,f,e,o,s,h,c,l);this.$v=n};_mcp.$1Kk.prototype={$2F6:null,$v:null,$5re:null,$5k:function(n){var t=n;$C(this.$2F6[t])&&(this.$2F6[t]=this.$5re.$AKe(n,this.$v.$I.get_$U()));return this.$2F6[t]},$3e:function(){this.$4ex(this.$$d_$C2m)},$AU:function(){_js.Trace.logInfo(_a.$0.$15,"Component Map Reset start.");this.$4ex(this.$$d_$E28,!0);_js.Trace.logInfo(_a.$0.$15,"Component Map Reset end.")},$2wg:function(){_js.Trace.logInfo(_a.$0.$15,"Component Map set override start.");this.$4ex(this.$$d_$EUE);_js.Trace.logInfo(_a.$0.$15,"Component Map set override end.")},$2Ek:function(){_js.Trace.logInfo(_a.$0.$15,"Component Map clear override start.");this.$4ex(this.$$d_$AEl);_js.Trace.logInfo(_a.$0.$15,"Component Map clear override end.")},$4ex:function(n,t){if($C(t)||!t)for(var r=0;r<this.$2F6.length;r++)this.$9EY(n,r);else for(var i=this.$2F6.length-1;i>=0;i--)this.$9EY(n,i)},$9EY:function(n,t){var i=this.$2F6[t];$C(i)||n(i,t)},$C2m:function(n,t){_mcp.$14f.isInstanceOfType(n)||n.get_$G6()||n.$3e()},$E28:function(n,t){var i=Object.getType(n).getName();if(n.get_$G6()){_js.Trace.logInfo(_a.$0.$15,"Reset "+i+" at index "+t);n.$AU()}else _js.Trace.logInfo(_a.$0.$15,"Skip uninitialized "+i+" at index "+t)},$EUE:function(n,t){IMailComposeOverridable.isInstanceOfType(n)&&n.$2wg()},$AEl:function(n,t){IMailComposeOverridable.isInstanceOfType(n)&&n.$2Ek()}};_mcp.$1Kl=function(n,t){this.$$d_$EnG=Function.createDelegate(this,this.$EnG);this.$$d_$EnB=Function.createDelegate(this,this.$EnB);this.$$d_$EnF=Function.createDelegate(this,this.$EnF);_mcp.$1Kl.initializeBase(this,[17,n]);this.$6R=t};_mcp.$1Kl.prototype={$5bs:null,$5by:null,$7HA:null,$7H8:null,$6R:null,$1x1:null,set_$7HB:function(n){this.$7HA=n;this.$4("SwitchToPlainTextContent");return n},set_$7H9:function(n){this.$7H8=n;this.$4("SwitchToHtmlContent");return n},$3e:function(){this.$5by||(this.$5by=new _C(this.$$d_$EnF,this.get_$m()));this.$5bs||(this.$5bs=new _C(this.$$d_$EnB,this.get_$m()));_mcp.$14e.prototype.$3e.call(this)},$EnF:function(){_js.Trace.logInfo(this.get_$m(),"User chose to convert to plain text");if(this.$8SA(_nbs.NonBootStrings.l_CannotConvertToPlainTextUntilMessageIsLoaded_Text)){this.$1n.$v.$c.get_$3rn().$11();var r=this.$1n.$v.$c.get_$MT();var n;var i,t;var f=(t=_a.$1J.$4W6(r,i={val:n}),n=i.val,t);if(!f){n=r;_js.Trace.logInfo(this.get_$m(),"Using html due to failed conversion")}if(n.length>0){var u=this.$1n.$v.$2G;u.$RH(1,[_nbs.NonBootStrings.l_ConvertToPlainTextWarning_Text],this.$$d_$EnG,!1,null,null,null,this.$6R)}else this.$8QW()}},$EnG:function(n,t){n&&this.$8QW()},$8QW:function(){var t=null;var i,r;if(r=_a.$1J.$1y4(_a.UserAgent.getInstance(),this.$1n.$v.$c.get_$MT(),i={val:t}),t=i.val,r){if(this.$1x1&&this.$1x1.$3r){this.$1x1.$11();this.$1x1=null}this.$1n.$v.$c.set_$dk(t);this.set_$7HB(t);this.set_$7HB(null);this.$1n.$v.get_$1k2().get_$G6()&&this.$1n.$v.get_$1k2().$9l1();var n=this.$1n.$5k(5);n.$7E0(!1);n.$7Dp(!1);n.get_$9Z()&&n.get_$9Z().$Ecd();this.$1n.$v.$c.set_$6P("Text");_js.Trace.logInfo(this.get_$m(),"MailComposeContentConversionComponent.ToPlainText succeeded.")}else _js.Trace.logWarning(this.get_$m(),"MailComposeContentConversionComponent.ToPlainText failed because of ConvertFromHtmlToText error.")},$EnB:function(){_js.Trace.logInfo(this.get_$m(),"User chose to convert to html");if(this.$8SA(_nbs.NonBootStrings.l_CannotConvertToHtmlUntilMessageIsLoaded_Text)){var u=this.$1n;var n=u.$v;var t=n.$c;t.get_$8IE().$11();var f=n.$c.get_$1vK();t.set_$6P("HTML");var i=_a.$1J.$1y5(f);t.set_$dk(i);this.set_$7H9(i);this.set_$7H9(null);n.get_$1k2().$9l2();var r=u.$5k(5);r.$7E0(!0);r.$7Dp(!0);_js.Trace.logInfo(this.get_$m(),"MailComposeContentConversionComponent.ToHtml succeeded.")}},$8SA:function(n){_js.Trace.logInfo(this.get_$m(),"Checking if the email has been upgraded which is a pre-requisite of content conversion.");if(!this.$1n.$v.$c.get_$OS()){this.$1n.$v.$2G.$44(0,n,null);_js.Trace.logInfo(this.get_$m(),"Conversion is not available because the email has not yet been upgraded.");return!1}return!0}};_mcp.$Ov=function(n){_mcp.$Ov.initializeBase(this,[18,n]);this.$6n=_g.$O.get_$Q().get_$1j();this.$c=this.$1n.$v.$c};_mcp.$Ov.prototype={$4JS:null,$4JR:null,$6n:null,$c:null,get_$Tb:function(){return this.$w(_mcp.$Ov.$24N)},set_$Tb:function(n){this.$P(_mcp.$Ov.$24N,n);return n},$9l1:function(){this.$4JR.set_$17(!1);this.$4JS.set_$17(!0)},$9l2:function(){this.$4JR.set_$17(!0);this.$4JS.set_$17(!1)},$3e:function(){if("Mouse"===_y.$z.$1Q.get_$U()){var t=[];var n;if(this.$c.get_$6W()!==8&&!this.$c.get_$1Ed()&&!_y.$z.$1Q.get_$lJ()){var e=this.$1n.$5k(8);n=new _fm.$d(_nbs.NonBootStrings.l_SaveMenuItem_LowerCase_Text,null,e.$Dz);Array.add(t,n)}var i=this.$1n.$5k(1);if(!this.$c.get_$1Ed()){n=new _fm.$d(_nbs.NonBootStrings.l_ShowBccMenuItemText_LowerCase_Text,null,i.$4Gc);_g.$O.get_$Q().get_$1j().get_$1Ie()&&n.set_$17(!0);Array.add(t,n);n=new _fm.$d(_nbs.NonBootStrings.l_HideBccMenuItemText_LowerCase_Text,null,i.$4qG);_g.$O.get_$Q().get_$1j().get_$1Ie()||n.set_$17(!0);Array.add(t,n)}if(this.$c.get_$3J3()||this.$c.get_$ru()){var l=this.$1n.$5k(1);n=new _fm.$d(_nbs.NonBootStrings.l_ShowFromMenuItemText_LowerCase_Text,null,i.$3a8);(_g.$O.get_$Q().get_$1j().get_$tN()||this.$c.get_$ot())&&n.set_$17(!0);Array.add(t,n);i.$3a8.set_$8F(!this.$c.get_$ru());n=new _fm.$d(_nbs.NonBootStrings.l_HideFromMenuItemText_LowerCase_Text,null,i.$4qR);_g.$O.get_$Q().get_$1j().get_$tN()||this.$c.get_$ot()||n.set_$17(!0);Array.add(t,n)}if(!this.$c.get_$1Ed()&&!_y.$z.$1Q.get_$lJ()){n=new _fm.$d(_nbs.NonBootStrings.l_CheckNamesMenuItem_LowerCase_Text,null,i.$1NR);Array.add(t,n)}var f=this.$1n.$5k(6);if(!$C(f.$KL)){n=new _fm.$CL(_nbs.NonBootStrings.l_ImportanceMenuItem_LowerCase_Text,null,f.$KL);Array.add(t,n)}var r=this.$1n.$5k(3);if(r.$KL){n=new _fm.$CL(_nbs.NonBootStrings.l_SetPermissions_LowerCase_Text,null,r.$KL);Array.add(t,n)}else if(r.$5pF()&&this.$1n.$v.$l4.IsLoadingFromServer){n=new _fm.$d(_u.CommonStrings.l_LoadingPermissions_LowerCase_Text,null,null);Array.add(t,n)}if(!_y.$z.$1Q.get_$lJ()){var c=this.$1n.$5k(12);var h=this.$1n.$5k(5);n=new _fm.$d(_nbs.NonBootStrings.l_SignatureMenuItem_LowerCase_Text,null,c.$4Oz);n.set_$4E(_nbs.NonBootStrings.l_InsertSignatureMenuItem_LowerCase_Text);h.get_$Tb().$1a.$F(n)}var u=this.$1n.$5k(17);this.$4JS=new _fm.$d(_nbs.NonBootStrings.l_ConvertToPlainText_LowerCase_Text,null,u.$5by);Array.add(t,this.$4JS);this.$4JR=new _fm.$d(_nbs.NonBootStrings.l_ConvertToHtml_Text,null,u.$5bs,!0);Array.add(t,this.$4JR);this.$c.get_$6P()==="HTML"?this.$9l2():this.$9l1();if(!this.$c.get_$1Ed()){var o=this.$1n.$5k(10);n=new _fm.$d(_nbs.NonBootStrings.l_ShowMessageOptions_Text,null,o.$3aH);Array.add(t,n)}var s=this.$1n.$5k(18);s.set_$Tb(new _fm.$1t(t))}_mcp.$14e.prototype.$3e.call(this)},$7Ma:function(){var t=this.get_$Tb().$1a.get_$E(this.$3E3(_nbs.NonBootStrings.l_ShowBccMenuItemText_LowerCase_Text));var n=this.get_$Tb().$1a.get_$E(this.$3E3(_nbs.NonBootStrings.l_HideBccMenuItemText_LowerCase_Text));t.set_$17(this.$c.get_$1LG());n.set_$17(!this.$c.get_$1LG())},$7Mb:function(){var t=this.get_$Tb().$1a.get_$E(this.$3E3(_nbs.NonBootStrings.l_ShowFromMenuItemText_LowerCase_Text));var n=this.get_$Tb().$1a.get_$E(this.$3E3(_nbs.NonBootStrings.l_HideFromMenuItemText_LowerCase_Text));t.set_$17(this.$c.get_$ot());n.set_$17(!this.$c.get_$ot())},$3E3:function(n){var i=this.get_$Tb().$1a;if(i)for(var t=0;t<i.get_$A();t++)if(n===i.get_$E(t).$3S)return t;return-1},$A3K:function(){var t=this.$1n.$5k(3);if(!$C(t.$KL)){var n=this.$3E3(_nbs.NonBootStrings.l_ImportanceMenuItem_LowerCase_Text);if(n>=0){var i=new _fm.$CL(_nbs.NonBootStrings.l_SetPermissions_LowerCase_Text,null,t.$KL);this.get_$Tb().$1a.$76(n+1,i)}}}};_mcp.$1Kn=function(n){this.$$d_$4qM=Function.createDelegate(this,this.$4qM);this.$$d_$5xv=Function.createDelegate(this,this.$5xv);this.$$d_$Ebv=Function.createDelegate(this,this.$Ebv);_mcp.$1Kn.initializeBase(this,[21,n]);this.$Fp=new _C(this.$$d_$Ebv,this.get_$m());this.$Lu=n.$v.$Lu};_mcp.$1Kn.prototype={$Fp:null,$Lu:null,$1kn:null,$22g:!1,set_$5xx:function(n){if(n!==this.$1kn){this.$1kn=n;this.$4("DiscardConfirmDialogButtonData")}return n},set_$2lJ:function(n){if(n!==this.$22g){this.$22g=n;this.$4("IsDiscardConfirmDialogShown")}return n},$5xv:function(){var i=this.$1n;var t=i.$v;var n=t.$c;_js.Trace.logInfo(_a.$0.$15,"Discard and close");t.set_$1Ea(!0);if(n.get_$6W()||!n.get_$6W()&&(n.get_$Fc()||t.get_$1X8().get_$G7())){_js.Trace.logInfo(_a.$0.$15,"Discard");this.$4aJ(n.get_$D1(),n.get_$Fc())}n.set_$T5(null);var r=i.$5k(2);r.get_$5F().$2SG(t,!1);_js.Trace.logInfo(_a.$0.$15,"Navigated away from compose")},$5N0:function(n,t){if(this.$Lu.$1EF(n)){_js.Trace.logInfo(_a.$0.$15,"Resuming discard of "+_h.$D0.$1cu(t));this.$4aJ(n,t)}else _js.Trace.logInfo(_a.$0.$15,"User had already discarded.")},$4aJ:function(n,t){this.$4qM();var i=this.$1n.$v;var r=i.$c.get_$22x()||i.$c.get_$1TJ();this.$Lu.$5xy(n,t,i.$n,r)},$Ebv:function(){var t=this.$1n.$v;var n=t.$c;_js.Trace.logInfo(_a.$0.$15,"User chose to discard");if(this.$7CK()){this.$9iM();_js.Trace.logInfo(_a.$0.$15,"Toggle IsDiscardConfirmDialogShown flag to show the dialog. Context:"+n.toString());this.set_$2lJ(!0)}else{_js.Trace.logInfo(_a.$0.$15,"User hit discard, we determined there's no need to show confirmation dialog, calling discard and navigating away. Context:"+n.toString());this.$5xv()}},$4qM:function(){_js.Trace.logInfo(_a.$0.$15,"Toggle IsDiscardConfirmDialogShown flag to hide the dialog. Context:"+this.$1n.$v.$c.toString());this.set_$2lJ(!1)},$9iM:function(){if($C(this.$1kn)){_js.Trace.logInfo(_a.$0.$15,"Creating discard confirm dialog.");var n=new _js.$X;n.$F(new _ff.$1l(new _C(this.$$d_$5xv,this.get_$m()),_u.Strings.l_ConfirmDialog_Discard_Text,_u.Strings.l_DeleteConfirmDialogButtonDescription_Text));n.$F(new _ff.$1l(new _C(this.$$d_$4qM,this.get_$m()),_u.Strings.l_ConfirmDialog_DontDiscard_Text,_u.Strings.l_ReturnToMessageForEditing_Text));this.set_$5xx(n)}}};_mcp.$1Ko=function(n){this.$$d_$6HX=Function.createDelegate(this,this.$6HX);this.$$d_$Bmx=Function.createDelegate(this,this.$Bmx);this.$$d_$2jX=Function.createDelegate(this,this.$2jX);_mcp.$1Ko.initializeBase(this,[27,n]);this.$1Sw=new _C(this.$$d_$2jX,_a.$0.$15);this.$6Fu=new _C(this.$$d_$Bmx,_a.$0.$15);this.$3sR=new _C(this.$$d_$6HX,_a.$0.$15);var t=n.$v.$c;t.set_$Bqq(this.$1Sw);t.set_$3rn(this.$6Fu);t.set_$8IE(this.$3sR)};_mcp.$1Ko.prototype={$1Sw:null,$6Fu:null,$3sR:null,$qy:null,set_$Nb:function(n){this.$qy=n;this.$4("EditorCallContext");return n},$2jX:function(){var n=new _cmc.$s0(!1,!1);this.set_$Nb(n)},$Bmx:function(){var n=new _cmc.$s0(!0,!1);this.set_$Nb(n)},$6HX:function(){var n=new _cmc.$s0(!1,!0);this.set_$Nb(n)}};_mcp.$eR=function(n){this.$$d_$EWJ=Function.createDelegate(this,this.$EWJ);this.$$d_$EWW=Function.createDelegate(this,this.$EWW);this.$$d_$EVe=Function.createDelegate(this,this.$EVe);_mcp.$eR.initializeBase(this,[6,n])};_mcp.$eR.$7eV=function(n,t){return new _y.$2Y(n,t)};_mcp.$eR.$4Ww=function(n,t){return new _fm.$d(n,null,t,!0)};_mcp.$eR.prototype={$KL:null,$tP:null,$6Pn:!1,$4wP:!1,$6Qb:!1,set_$C9V:function(n){if(n!==this.$6Pn){this.$6Pn=n;this.$4("IsHighImportance")}return n},set_$CBK:function(n){if(n!==this.$4wP){this.$4wP=n;this.$4("IsNormalImportance")}return n},set_$CAf:function(n){if(n!==this.$6Qb){this.$6Qb=n;this.$4("IsLowImportance")}return n},$3e:function(){var i=this.$1n.$v.$c.get_$Bv();this.$5Uu(i);_js.Trace.logInfo(_a.$0.$15,"Importance component initialized and importance set to {0}",i);if("Mouse"===_y.$z.$1Q.get_$U()){if(!this.$KL){var t=this.$3jy(_fm.$d,_mcp.$eR.$4Ww);t&&(this.$KL=new _fm.$1t(t))}}else if(!this.$tP){var n=this.$3jy(_y.$2Y,_mcp.$eR.$7eV);n&&(this.$tP=new _y.$2Y(_nbs.NonBootStrings.l_ImportanceMenuItem_LowerCase_Text,null,n))}_mcp.$14e.prototype.$3e.call(this)},$EVe:function(){var n=_a.$6.$1f(_a.$0.$15,"MailComposeSetImp",!0);_js.Trace.logInfo(_a.$0.$15,"User sets high importance");this.$5Uu("High");_a.$6.$1F(n)},$EWW:function(){_js.Trace.logInfo(_a.$0.$15,"User sets normal importance");this.$5Uu("Normal")},$EWJ:function(){var n=_a.$6.$1f(_a.$0.$15,"MailComposeSetImp",!0);_js.Trace.logInfo(_a.$0.$15,"User sets low importance");this.$5Uu("Low");_a.$6.$1F(n)},$5Uu:function(n){this.$1n.$v.$c.set_$Bv(n);this.set_$C9V("High"===n);this.set_$CBK("Normal"===n);this.set_$CAf("Low"===n)},$3jy:function(n,t){return[t(_nbs.NonBootStrings.l_HighImportanceButtonText_Text,new _C(this.$$d_$EVe,this.get_$m())),t(_nbs.NonBootStrings.l_NormalImportanceButtonText_Text,new _C(this.$$d_$EWW,this.get_$m())),t(_nbs.NonBootStrings.l_LowImportanceButtonText_Text,new _C(this.$$d_$EWJ,this.get_$m()))]}};_mcp.$1Kr=function(n,t){this.$$d_$4aF=Function.createDelegate(this,this.$4aF);this.$$d_$7BG=Function.createDelegate(this,this.$7BG);this.$$d_$7Dt=Function.createDelegate(this,this.$7Dt);this.$$d_$7Eh=Function.createDelegate(this,this.$7Eh);_mcp.$1Kr.initializeBase(this,[26,n]);this.$SW=_h.$3r.$6Fx(t)};_mcp.$1Kr.prototype={$rW:null,$23w:null,$SW:!1,$1YQ:!1,$1YN:!1,$1Za:null,$1Vw:null,$cg:null,$c3:null,$VU:null,set_$2Nn:function(n){if(n!==this.$SW){this.$SW=n;this.$4("IsLinkPreviewEnabled")}return n},set_$4nP:function(n){if(n!==this.$rW){this.$rW=n;this.$7GL()}return n},set_$1ZP:function(n){if(n!==this.$VU){this.$VU=n;this.$4("VideoPlayerHtmlLookup")}return n},set_$3KY:function(n){this.$23w=n;this.$4("LinkPreviewResponse");return n},set_$1wB:function(n){if(n!==this.$cg){this.$cg=n;this.$cg&&_h.$3r.$3FC(this.$cg,null,this.$$d_$7Eh,null)}return n},set_$1rj:function(n){if(n!==this.$c3){this.$c3=n;this.$c3&&_h.$3r.$3FC(this.$c3,null,this.$$d_$7Dt,null)}return n},set_$3aY:function(n){if(this.$1YQ!==n){this.$1YQ=n;this.$4("ShowYouTubePlayer")}return n},set_$3aL:function(n){if(this.$1YN!==n){this.$1YN=n;this.$4("ShowOEmbedVideoPlayer")}return n},set_$7P7:function(n){this.$1Za=n;this.$4("YouTubePlayerUrl");return n},set_$3R6:function(n){this.$1Vw=n;this.$4("OEmbedVideoPlayerHtml");return n},$7GL:function(){if(_h.$3r.$3vD){_js.Trace.logInfo(_a.$0.$6c,"Link preview feature is disabled.  Skipping GetLinkPreview action for {0}",this.$rW.Url);this.$4aF();return}if(this.$rW){var i=1;var r=_a.$6.$1f(_a.$0.$6c,"GetComposeLinkPreview",!0);var n=[];Array.add(n,this.$rW);_js.Trace.logInfo(_a.$0.$6c,"Preparing GetLinkPreview action for {0}",this.$rW.Url);this.$rW.Autoplay=!0;var u=new _h.$3r(this.$rW);_js.Trace.logInfo(_a.$0.$6c,"Submitting GetLinkPreview action for {0}",this.$rW.Url);var t=this,f=this;this.$1n.$v.$n.$t4(u,function(u){_h.$3r.$9gX(u,t.$$d_$7BG,t.$$d_$4aF,i,r,"GetComposeLinkPreview",n)},function(t){_h.$3r.$7nv(t,i,r,"GetComposeLinkPreview",n)},null)}},$7BG:function(n){this.set_$3KY(n)},$4aF:function(){this.set_$2Nn(!1)},$7Eh:function(n){this.set_$7P7(n);this.set_$3aY(!!this.$1Za)},$7Dt:function(n){var t=this.$6Hs(n);t?this.set_$3R6(t):this.set_$3R6(n);this.set_$3aL(!!this.$1Vw)},$6Hs:function(n){return n in this.$VU?this.$VU[n]:null}};_mcp.$eQ=function(n){_mcp.$eQ.initializeBase(this,[16,n])};_mcp.$eQ.prototype={$1d:null,$3j9:0,$1Pu:null,$3e:function(){_mcp.$14e.prototype.$3e.call(this);this.$1Pu=this.$Bmf();var n=this.$1n.$v;this.$1d=n.$1ao();this.$3j9=n.$c.get_$6W();_mcp.$7x.$8WQ(n.$c)&&!n.$c.get_$6SK()&&this.$1IK()},$1IK:function(){this.$1d.$ad(_mcp.$eQ.$3TF);this.$7rg()},$Bmf:function(){var n=this.$1n.$v.$c;var t=n.get_$IU()||n.get_$ix();return t&&n.get_$ov()?t:null},$BnA:function(){if(_g.$2g.isInstanceOfType(this.$1Pu))return this.$1Pu.get_$Vb();else if(_g.$Md.isInstanceOfType(this.$1Pu)){var n=this.$1Pu;return n.get_$Px().get_$Vb()==="RecurringMaster"?n.get_$Q2()?"RecurringMaster":"Occurrence":n.get_$Px().get_$Vb()}else throw Error.argument("this.Item","Unsupported calendaring type:"+Object.getType(this.$1Pu).getName());},$7rg:function(){if(this.$1Pu){this.$AsX();if(!_g.$Me.isInstanceOfType(this.$1Pu)){this.$1d.$4r(6800);switch(this.$BnA()){case"Occurrence":case"Exception":this.$Asc();break;case"RecurringMaster":this.$AsV();break}}}},$Bmt:function(n){var t;switch(n){case 8:t=3200;break;case 3:t=3205;break;case 5:t=3210;break;case 6:t=3215;break;case 7:t=3220;break;default:throw Error.argument("operation","Unsupported mail compose operation on an occurrence: "+n);}return t},$Bmu:function(n){var t;switch(n){case 8:t=3100;break;case 3:t=3105;break;case 5:t=3110;break;case 6:t=3115;break;case 7:t=3120;break;default:throw Error.argument("operation","Unsupported mail compose operation on a series: "+n);}return t},$AsV:function(){var n=this.$Bmu(this.$3j9);this.$1d.$4r(n)},$Asc:function(){var i=new _cc.$Tl;var t=i.$4L(this.$1Pu,null);var n=this.$Bmt(this.$3j9);this.$1d.$4r(n,t)},$AsX:function(){if(_g.$9y.isInstanceOfType(this.$1Pu)){var t=this.$1Pu;var i=t.get_$4uF()&&!!t.get_$2Ux();if(i){var n=-1;switch(this.$3j9){case 5:n=3250;break;case 7:n=3260;break;case 6:n=3255;break}n!==-1&&this.$1d.$4r(n,t.get_$2Ux().Mailbox.Name)}}}};_mcp.$14f=function(n,t,i){this.$$d_$Brh=Function.createDelegate(this,this.$Brh);this.$$d_$DWs=Function.createDelegate(this,this.$DWs);this.$$d_$AnI=Function.createDelegate(this,this.$AnI);this.$$d_$lC=Function.createDelegate(this,this.$lC);this.$$d_$6MC=Function.createDelegate(this,this.$6MC);this.$$d_$ApF=Function.createDelegate(this,this.$ApF);this.$$d_$DXF=Function.createDelegate(this,this.$DXF);this.$$d_$94T=Function.createDelegate(this,this.$94T);this.$$d_$DXE=Function.createDelegate(this,this.$DXE);this.$$d_$3R9=Function.createDelegate(this,this.$3R9);this.$$d_$DWr=Function.createDelegate(this,this.$DWr);this.$$d_$DSy=Function.createDelegate(this,this.$DSy);this.$$d_$DV2=Function.createDelegate(this,this.$DV2);_mcp.$14f.initializeBase(this,[0,n]);this.$Lu=n.$v.$Lu;this.$1G=t;this.set_$5pA(!0);this.$6Q5=i};_mcp.$14f.prototype={$Lu:null,$4xU:!1,$4Ti:!1,$5eo:!1,$62k:null,$71M:null,$3zh:null,$1G:null,$6Q5:!1,$2Mh:null,get_$G6:function(){return _mcp.$14e.prototype.get_$G6.call(this)},set_$G6:function(n){if(n!==_mcp.$14e.prototype.get_$G6.call(this)){_mcp.$14e.prototype.set_$G6.call(this,n);this.$4("IsInitialized")}this.$1n.$v.$c.set_$CEW(n);return n},set_$8Vw:function(n){if(n!==this.$4xU){this.$4xU=n;this.$4("IsSecondInitializationComplete")}return n},set_$5pA:function(n){if(this.$4Ti!==n){this.$4Ti=n;this.$4("CanLoadPopoutSuccessfully")}return n},$2Ek:function(){if(this.$2Mh){this.$2Mh.$AU();this.$2Mh=null}},$3e:function(){this.$62k=_a.$6.acsa(_a.$0.$15,"VM.MailCompose.FirstInit",!0);var i=this.$1n.$v;var n=i.$c;n.$p("IsEditorReady",this.$$d_$DV2);if(!n.$jS&&!n.get_$Fc()){_js.Trace.logInfo(_a.$0.$15,"Capture initial baseline for a non draft without existing initial baseline, context: "+n.toString());n.$jS=_mcp.$1W.$33M(n);n.get_$23H()||n.set_$1Op(!0)}if(n.get_$rn()){_js.Trace.logInfo(_a.$0.$15,"Finish 1st init for complete context");this.$3nG();_js.Trace.logInfo(_a.$0.$15,"Check begin upgrade for complete context");this.$5mq()}else{var e=i.$n;var r=n.get_$Fc();var t=n.get_$14N();var o=n.get_$9my();if(!r&&o){var u;var f=_g.$O.get_$Q().get_$4X();u=_js.$9.$o(f.get_$1uX())?f.get_$Fu()||"":f.get_$s4()||"";var l=new _g.$QE("StoreId",o,u);var c=new _c.$10T([l],"EwsId");e.$t4(c,this.$$d_$DSy,this.$$d_$DWr,this.$$d_$3R9);_js.Trace.logInfo(_a.$0.$15,"Calling server to convert id, storeId="+o)}else if(r)if(n.get_$3eD()&&n.get_$23H()){_js.Trace.logInfo(_a.$0.$15,"The message was saving prior to popout, check for save result from main window");this.$9HX()}else{_js.Trace.logInfo(_a.$0.$15,"Load draft "+_h.$D0.$1cu(r));this.$6Vp(r)}else if((4===n.get_$6W()||13===n.get_$6W())&&n.get_$23H()){_js.Trace.logInfo(_a.$0.$15,"Loading draft without id for the popout from inline case, check id from main window");this.$9HX()}else if(t){i.$1d.$9T(3400);i.$1d.$4r(3400,null);if(n.get_$1oS()){var a=_cc.$Di.$H0(t,n.get_$1LT());var s=new _cc.$Di(200,a);s.$99=n.get_$D1();e.$t4(s,this.$$d_$DXE,this.$$d_$94T,this.$$d_$3R9);_js.Trace.logInfo(_a.$0.$15,"Loading original calendar item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)}else{var h=i.$Xe.$5tZ(t);h.$99=n.get_$D1();e.$t4(h,this.$$d_$DXF,this.$$d_$94T,this.$$d_$3R9);_js.Trace.logInfo(_a.$0.$15,"Loading original message item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)}}else if(0===n.get_$6W()||11===n.get_$6W()){n.set_$OS(!0);n.set_$rn(!0);_js.Trace.logInfo(_a.$0.$15,"Finish 1st init for new mail");this.$3nG()}else{this.$lC("ErrorNoDraftOrOriginalItemId",null,null);throw Error.invalidOperation(String.format("Cannot perform operation {0} without either draft ID or original item ID",_js.$1I.$Gr(_y.$1m,n.get_$6W())));}}_js.$9.$o(_g.$O.get_$Q().get_$4X().get_$1uX())||i.$1d.$4r(95,null)},$AU:function(){this.set_$G6(!1);this.set_$8Vw(!1);this.set_$5pA(!0);this.$5eo=!1;this.$2Ek()},$7Wf:function(){this.$Al9();this.$71M=_a.$6.acsa(_a.$0.$15,"VM.MailCompose.SecondInit",!0);var t=this.$1n;var n=t.$v;var i=n.$c;_js.Trace.logInfo(_a.$0.$15,"Queue 2nd init task, context:"+i.toString());_js.$D.get_$Q().$6F(_a.$0.$15,"Delayed MailCompose Secondary Init",this.$$d_$ApF);if(n.get_$3vH()&&!n.$5w.$1a){var f=t.$5k(11);_js.Trace.logInfo(_a.$0.$15,"Queue appbar setup task");_js.$D.get_$Q().$6F(_a.$0.$15,"SetupApplicationBarMenu",f.$$d_$EY4)}if(i.get_$36v()){var u=this.$1n.$5k(8);_js.Trace.logInfo(_a.$0.$15,"Queue diagnostics save to trigger uploading of the diagnostics attachment");_js.$D.get_$Q().$6F(_a.$0.$15,"Diagnostics save:",u.$$d_$E4S)}var r=t.$5k(19);_js.Trace.logInfo(_a.$0.$15,"Queue GetMailTips if needed task");_js.$D.get_$Q().$6F(_a.$0.$15,"TriggerMailTipsIfNeeded",r.$$d_$EoN)},$DWs:function(n){var f=_a.$6.acss(_a.$0.$15,"VM.MailCompose.ProcessDraft");var o=this.$1n.$v.$c;var e=this.$v.get_$5xw();var i=n;var t=n.$99;_js.Trace.logInfo(_a.$0.$15,"Got draft, checking pending discards for "+t);if(this.$Lu.$1EF(t))e.$5N0(t,i.get_$y());else if(t===this.$c_2.get_$D1()){var r=i.$Os;if(_g.$Sg.isInstanceOfType(r)){this.$c_2.$6MG(r);this.$5jM(!0);this.$96g(i)}else _a.$c.$43&&r.get_$Mg()?this.$C38(r,i):this.$6MC(r,i);if(_a.$5N.$43){var u=this;_js.$D.get_$Q().$6F(_a.$0.$15,"TriggerPolicyTipsIfNeeded",function(){var n=u.$1n.$5k(25);n.$2BC(32)})}}else _js.Trace.logInfo(_a.$0.$15,"Skipping get draft processing since action context "+t+" doesn't match current context "+this.$c_2.toString());_a.$6.aces(f);_a.$6.acea(this.$3zh)},$C38:function(n,t){var i=this;this.$v.$5uY(function(){i.$7g0();i.$2Mh.$6MC(n,t)})},$7g0:function(){if(!this.$2Mh){_js.Trace.logInfo(_a.$0.$15,"Setting initializer component override");this.$2Mh=this.$v.get_$4Hb().$7g0();var n=this.$1n.$5k(29);this.$2Mh.$3e(this.$$d_$6MC,n.$$d_$7Rk,this.$$d_$lC,this.$v.$n)}},$6MC:function(n,t){this.$c_2.$4rz(n);this.$5jM(!1);this.$96g(t)},$96g:function(n){if(this.$c_2.get_$23H()&&this.$c_2.get_$1Op()){_js.Trace.logInfo(_a.$0.$15,"Capture initial baseline for a loaded draft.");this.$c_2.$jS=_mcp.$1W.$33M(this.$c_2)}_js.Trace.logInfo(_a.$0.$15,"Finish 1st init for a loaded draft.");this.$3nG();var t=this;_js.$D.get_$Q().$6F(_a.$0.$15,"TriggerPolicyTipsIfNeeded",function(){var n=t.$1n.$5k(25);n.$2BC(32)})},$DXE:function(n){var u=this.$1n;var f=u.$v;var t=f.$c;var i=n.$99;if(i===t.get_$D1()&&!this.$Lu.$1EF(i)){var r=n;t.$1Ta(r.$1W);t.set_$1LT(!1);_js.Trace.logInfo(_a.$0.$15,"Got original cal item, finish 1st init with context:"+t.toString());this.$3nG();_js.Trace.logInfo(_a.$0.$15,"Check begin upgrade on original cal item");this.$5mq()}},$DXF:function(n){var u=this.$1n;var f=u.$v;var t=f.$c;var i=n.$99;if(i===t.get_$D1()&&!this.$Lu.$1EF(i)){var r=n;t.$1Ta(r.$Os);_js.Trace.logInfo(_a.$0.$15,"Got original message, finish 1st init with context: "+t.toString());this.$3nG();_js.Trace.logInfo(_a.$0.$15,"Check begin upgrade on original message item");this.$5mq()}},$DWr:function(n){var e=this.$1n;var u=e.$v;var f=u.$c;var t=n.$99;t!==f.get_$D1()||this.$Lu.$1EF(t)||u.$n.$sw(n,_nbs.NonBootStrings.l_OpenDraftFailureMessage_Text,_nbs.NonBootStrings.l_OpenDraftFailureMessageDisconnected_Text,_nbs.NonBootStrings.l_OpenDraftFailureMessage_Text,_bms.BootModelsStrings.l_ErrorRequestTimeout_Text,this.$$d_$AnI);var i="GetDraftFailure_UnknownError";var r="";if(_g.$4k.$1dV(n.$2H)){i=_g.$4k.$2Kq(n.$2H)||"GetDraftFailure_UnknownError";r=n.$2H.FaultMessage}_a.$6.acea(this.$3zh);this.$lC(i,n.$FG(),r)},$94T:function(n){var e=this.$1n;var u=e.$v;var f=u.$c;var t=n.$99;t!==f.get_$D1()||this.$Lu.$1EF(t)||u.$n.$9jL(n,this.$$d_$AnI);var i="GetItemFailure_UnknownError";var r="";if(_g.$4k.$1dV(n.$2H)){i=_g.$4k.$2Kq(n.$2H)||"GetItemFailure_UnknownError";r=n.$2H.FaultMessage}_a.$6.acea(this.$3zh);this.$lC(i,n.$FG(),r)},$AnI:function(n,t){var i=this.$1n.$5k(2);i.get_$5F().$2SG(this.$1n.$v,!1);_js.Trace.logInfo(_a.$0.$15,"Navigate away on action failure")},$3R9:function(n){var t=this.$1n.$v;var i=t.$c;if(n.$99===i.get_$D1()){t.$1d.$9T(3400);_mcp.$3s.$Js(this.$1n)}},$3nG:function(){var f=_a.$6.acss(_a.$0.$15,"VM.MailCompose.ComponentInit");var n=this.$1n;var r=n.$v;var t=r.$c;var i=t.get_$6W();n.$5k(7).$3e();n.$5k(8).$3e();n.$5k(1).$3e();t.get_$ov()&&n.$5k(16).$3e();var u=_y.$z.$1Q.get_$U();i&&i!==11||!this.$1G.get_$NB()||t.get_$dk()||t.set_$dk("");t.get_$XV()&&n.$5k(12).$3e();u!=="Mouse"?n.$5k(11).$3e():n.$5k(24).$3e();_a.$6.aces(f);_a.$6.acea(this.$62k);if(r.$hZ){_js.Trace.logInfo(_a.$0.$15,"Begin 2nd init in finish 1st because we are already in view.");this.$7Wf()}this.set_$G6(!0)},$ApF:function(){var t=this.$1n;var i=t.$v;var n=i.$c;n.get_$6W()||n.get_$dk()||n.set_$dk("");t.$5k(2);t.$3e();n.get_$T5()||n.$7nZ();this.set_$8Vw(!0);_js.Trace.logInfo(_a.$0.$15,"Finish 2nd init, context:"+n.toString());_a.$6.acea(this.$71M)},$6Vp:function(n){this.$3zh=_a.$6.acsa(_a.$0.$15,"VM.MailCompose.LoadDraft",!0);var i=this.$1n.$v;var t=i.$c;var f=i.$n;if(t.get_$23H()){if(t.get_$1Op()){_js.Trace.logInfo(_a.$0.$15,"Capture initial baseline since message was a clean new message before popout, context: "+t.toString());t.$jS=_mcp.$1W.$33M(t)}t.get_$1LY()&&!t.get_$OS()&&this.$5jM(!0)}else t.set_$22x(!0);i.$1d.$9T(3400);i.$1d.$4r(3400,null);t.get_$3xF()&&i.$1d.$4r(3480);var r=this.$1G.get_$NB()&&t.get_$6P()==="HTML"?_h.$f.get_$24B():_h.$f.get_$3L6();var e="MailCompose";var u=i.$Xe.$5tZ(n,r,e);u.$99=t.get_$D1();f.$t4(u,this.$$d_$DWs,this.$$d_$DWr,this.$$d_$3R9);_js.Trace.logInfo(_a.$0.$15,"Loading draft with ID="+_h.$D0.$1cu(n)+"; Shape="+r.BodyType+"; Layout="+_y.$z.$1Q.get_$U()+"; ContextBodyType="+t.get_$6P())},$5jM:function(n){if(n!==this.$5eo){var t=this.$1n.$v.$1d;t.$9T(3440);n&&t.$4r(3440,null);_mcp.$3s.$Js(this.$1n);this.$5eo=n}},$DSy:function(n){var i=n;var t=new _g.$1T(i.get_$7dp().Id);this.$1n.$v.$c.set_$Fc(t);this.$6Vp(t)},$5mq:function(){var i=this.$1n;var t=i.$v.$c;var n=t.get_$6W();var u=1===n||2===n||3===n||12===n;if(u&&!t.get_$Fc()&&!t.get_$OS()){var r=i.$5k(13);r.$A89()}},$9HX:function(){var n=this.$1n.$v.$c.get_$D1();if(this.$6Q5){_js.Trace.logInfo(_a.$0.$15,"Processing save result on main window for popout projection compose window "+n);var t=window.self.windowServiceEndPoint;t.getSaveResultForPopout(n,_a.$3A.$1ZX,this.$$d_$Brh)}else{_js.Trace.logInfo(_a.$0.$15,"Calling main window to process save result "+n);_g.$1H.$Yr.$Brg(n,_a.$3A.$1ZX,this.$$d_$Brh)}},$Brh:function(n){var t=this.$1n.$v.$c;if(n){var i=JsonParser.deserialize(n);_js.Trace.logInfo(_a.$0.$15,"Resume loading draft after main window successfully saved item: "+i.Id);t.get_$1LY()&&!t.get_$OS()&&t.set_$OS(!0);this.$6Vp(i)}else{_js.Trace.logInfo(_a.$0.$15,"Save failed on the main window for this popout, show failure message.");this.set_$5pA(!1);this.$lC("ErrorSaveFailedOnMainWindow",null,null)}},$DV2:function(n,t){var r=this.$1n.$v;var i=r.$c;if(i.$3w8){if(i.get_$T5()&&!i.$7CX){i.$Vx.$11();i.get_$T5().set_$MT(i.get_$MT());i.$jS&&i.$jS.set_$MT(i.get_$MT())}this.$AlI()}},$AlI:function(){var t=this.$1n.$v;var n=t.$c;if(n.get_$1N4()){_y.$2E.$1F(n.get_$1N4(),null,"",null,t.get_$7iA());n.set_$1N4(null)}this.$4cA()},$lC:function(n,t,i){var u=this.$1n.$v;var r=u.$c;if(r.get_$di()){_y.$2E.$1F(r.get_$di(),null,n,t,i);r.set_$di(null)}if(r.get_$1N4()){_y.$2E.$1F(r.get_$1N4(),null,n,t,i);r.set_$1N4(null)}this.$4cA()},$Al9:function(){var t=this.$1n.$v;var n=t.$c;if(n.get_$di()){_y.$2E.$1F(n.get_$di(),null,"",null,t.get_$7iA());n.set_$di(null)}},$4cA:function(){var i=this.$1n.$v;var t=i.$c;if(t.get_$2Bg()){var n=null;switch(t.get_$6W()){case 0:n="MailComposeNewLoad";break;case 1:n="MailComposeReplyLoad";break;case 2:n="MailComposeReplyAllLoad";break;case 3:n="MailComposeForwardLoad";break;case 4:n="MailComposeEditDraftLoad";break}if(n){_a.$6.endPT(n);t.set_$2Bg(!1)}}}};_mcp.$MX=function(n,t){this.$$d_$7oo=Function.createDelegate(this,this.$7oo);this.$$d_$E4p=Function.createDelegate(this,this.$E4p);this.$$d_$6tU=Function.createDelegate(this,this.$6tU);this.$$d_$1tH=Function.createDelegate(this,this.$1tH);this.$$d_$2W3=Function.createDelegate(this,this.$2W3);this.$$d_$DMX=Function.createDelegate(this,this.$DMX);this.$$d_$DlK=Function.createDelegate(this,this.$DlK);_mcp.$MX.initializeBase(this,[9,n]);this.$6pq=new _C(this.$$d_$DlK,this.get_$m());this.$Lu=n.$v.$Lu;this.$1G=t};_mcp.$MX.prototype={$Lu:null,$1G:null,$6pq:null,$3xc:!1,$3y1:!1,$2mE:!1,$3eC:!1,$4pq:!1,$2Mo:null,get_$DlL:function(){return this.$6pq},set_$3xd:function(n){this.$3xc!==n&&(this.$3xc=n);return n},get_$3y2:function(){return this.$3y1},set_$3y2:function(n){if(this.$3y1!==n){this.$3y1=n;this.$7Ww(n)}return n},get_$4xJ:function(){return this.$2mE},set_$4xJ:function(n){if(this.$2mE!==n){this.$2mE=n;this.$7Ww(n)}return n},$4Tg:function(){var n=!0;var u=this.$1n;var i=u.$v;var t=i.$c;var r=i.get_$iD();var o=i.get_$1X8();var e=t.get_$D1();var s=t.get_$6W();if(this.$Lu.$1EF(e))_js.Trace.logInfo(_a.$0.$15,"User had chose to discard, simply navigate away.");else if(t.get_$1LY()&&this.$Lu.$7ko(u,!1))_js.Trace.logInfo(_a.$0.$15,"User had navigated away on an unused response, the unused response was discarded.");else if(this.$7Zv())n=!1;else if(r.$bk){_js.Trace.logInfo(_a.$0.$15,"We're sending the message, can't exit yet.");n=!1}else if(r.$3xt){_js.Trace.logInfo(_a.$0.$15,"We're resolving the recipients, can't exit yet.");r.$7oL();n=!1}else if(t.get_$1Ed()){var f=u.$5k(21);f.$Fp.$11();n=!1}else{_js.Trace.logInfo(_a.$0.$15,"Checking dirty before inline navigating away from compose. Context:"+t.toString());if(i.$IN()){this.$4pq=!1;_js.$D.get_$Q().$2V(_a.$0.$15,"NavigatingAwaySaveTimeout",this.$$d_$DMX,1e4);this.$3Ul();if(o.$2Mu("InlineExit",this.$$d_$2W3,this.$$d_$1tH,!1)){this.set_$4xJ(!0);_js.Trace.logInfo(_a.$0.$15,"Save is in progress or failed, can't exit yet.");n=!1}}}return n},$ANv:function(){return new _y.$Cb},$7Ww:function(n){var t=this.$1n.$v;t.set_$9pf(_u.CommonStrings.l_Saving_Text);t.set_$9jD(n);t.set_$EZR(n)},$DlK:function(){var i=this.$1n;var t=i.$v;var n=t.$c;var u=n.get_$D1();var l=i.$5k(7);_js.$D.get_$Q().$1Yd(_a.$0.$15,"MailComposePopOut");if(this.$3xc){_js.Trace.logInfo(_a.$0.$15,"Skipped pop out because another pop out is in progress.");return}if(l.$bk){_js.Trace.logInfo(_a.$0.$15,"Skipped pop out because send is in progress.");return}if(this.$7Zv()||this.$Lu.$1EF(u)){_js.Trace.logInfo(_a.$0.$15,"Skipped pop out because attachment is currently uploading or user had discarded");return}n.set_$di(this.$2Mo=_y.$2E.$1f(_a.$0.$15,"MailComposeInlinePopOut",!0));this.set_$3xd(!0);var s=!1;try{var a=this.$1n.$v.$1d;a.$ad(_mcp.$MX.$wI);_mcp.$3s.$Js(i);var r=i.$5k(8);_js.Trace.logInfo(_a.$0.$15,"Checking dirty before popping out from inline. Context:"+n.toString());var e=t.$IN();var f=t.$c.get_$6Ov();var c=i.$5k(12);if(!n.get_$Fc()||e||c.$7CH||f){this.set_$3y2(!0);(n.get_$Fc()&&!f||e||r.$1Tl)&&n.set_$1Op(!1);_js.Trace.logInfo(_a.$0.$15,"Set WasCleanNewMessageBeforePopout = "+n.get_$1Op());this.$3eC=!1;_js.$D.get_$Q().$2V(_a.$0.$15,"PopoutSaveTimeout",this.$$d_$6tU,1e4);n.set_$3eD(!0);this.$3Ul();t.$Lc.get_saveForPopoutMap()[u]=new _y.$1Mx;this.$6q6();r.$2Mu("Popout",this.$$d_$E4p,this.$$d_$7oo,!1)}else{if(n.get_$22x())n.set_$1Op(!1);else if(n.get_$1TJ())n.set_$1Op(!1);else if(r.$1Tl)n.set_$1Op(!1);else if(n.$jS){_js.Trace.logInfo(_a.$0.$15,"Comparing initial baseline with baseline. Context:"+n.toString());n.$jS.$5b(n.get_$T5())||n.set_$1Op(!1)}else n.set_$1Op(!1);n.set_$3eD(!1);_a.$4.$z(t.$Lc,"PopoutManager");_a.$4.$z(t.$Lc.get_saveForPopoutMap(),"PopoutManager.SaveForPopoutMap");delete t.$Lc.get_saveForPopoutMap()[u];this.$6q6()}var h=t.get_$2qj();if(h){var o=h.get_$5F();if(o){_js.Trace.logInfo(_a.$0.$15,"MailComposeInlineComponent::OpenComposeWindow - setting composeConductor.HasNavigatedFromInlineToPopoutCompose = true");o.set_$3t9(!0)}}s=!0}catch(v){_y.$2E.$1F(this.$2Mo,null,v.toString(),null,v.message);n.set_$di(this.$2Mo=null);throw v;}finally{if(!s){this.set_$3xd(!1);this.set_$3y2(!1)}}},$7Zv:function(){var n=this.$1n.$v;var t=this.$1n.$5k(5);if(t.get_$Pz()){if(!n.$2G.$3U){_js.Trace.logInfo(_a.$0.$15,"Show attachment in progress error dialog");n.$2G.$44(0,_u.Strings.l_MailComposeCannotOperateWhileAttachmentInProgress_Text,null)}return!0}return!1},$6q6:function(){var i=this.$1n.$v;var t=i.$c;var n=new _mcp.$V;if(this.$1G){n.set_$pm(this.$1G.get_$pm());n.set_$NB(this.$1G.get_$NB())}n.set_$5j(0);n.set_$XV(!1);if(t.get_$6W()===11||t.get_$6W()===12){n.set_$6W(13);n.set_$19l(t.get_$19l());n.set_$2sA(t.get_$2sA())}else n.set_$6W(4);n.set_$Fc(t.get_$Fc());n.set_$6P(t.get_$6P());var r=this.$ANv();n.set_$23H(!0);n.set_$OS(t.get_$OS());n.set_$1ZE(t.get_$1ZE());n.set_$1LY(t.get_$1LY());n.set_$22x(t.get_$22x());n.set_$1TJ(t.get_$1TJ());n.set_$1Op(t.get_$1Op());n.set_$3eD(t.get_$3eD());n.set_$D1(t.get_$D1());n.set_$3n(t.get_$3n());n.set_$di(t.get_$di());t.get_$OS()||t.get_$6W()!==3||t.$6S4()||!t.get_$IU().get_$1l()||n.set_$EU(t.get_$IU().get_$1l().get_$7U());r.$WH(n);if(!t.get_$3eD()){i.set_$1Ea(!0);this.$2SG();this.set_$3xd(!1)}},$E4p:function(n){this.set_$3y2(!1);if(this.$3eC){_js.Trace.logInfo(_a.$0.$15,"Popout was cancelled by timer, skipping save succeeded processing for popout.");_y.$2E.$1F(this.$2Mo,null,_mcp.$MX.$QL.toString(3));this.$2Mo=null}else{var i=n.$99;var t=this.$1n.$v;if(i in t.$Lc.get_saveForPopoutMap()){var u=_mcp.$Kl.$7oi(n);var r=t.$Lc.get_saveForPopoutMap()[i];if(r.$33c.length){var f=JsonParser.serialize(u);t.$Lc.pushSaveResultToPopout(f,r.$33c);delete t.$Lc.get_saveForPopoutMap()[i]}else r.$y=u}if(t.$c.get_$D1()===i){_js.Trace.logInfo(_a.$0.$15,"Save succeeded for popout, navigating away from the main window.");t.set_$1Ea(!0);this.$2SG();this.set_$3xd(!1)}else _js.Trace.logInfo(_a.$0.$15,"Skipped navigating away since contextId="+i+"; viewModelId="+t.$c.get_$D1())}},$2W3:function(n){this.$2mE&&this.set_$4xJ(!1);if(this.$4pq){_js.Trace.logInfo(_a.$0.$15,"Navigation away was cancelled by timer, skipping navigating from compose.");return}this.$1n.$v.set_$1Ea(!0);this.$2SG()},$1tH:function(n){if(this.$2mE){_js.Trace.logInfo(_a.$0.$15,"Save failed, reset IsSavingForNavigatingAway flag to false");this.set_$4xJ(!1)}},$2SG:function(){var n=this.$1n;var t=n.$5k(2);t.get_$5F().$2SG(n.$v,!1);_js.Trace.logInfo(_a.$0.$15,"Navigated away from inline compose")},$7oo:function(n){if(this.$3xc){this.set_$3xd(!1);this.set_$3y2(!1);var f=this.$1n;var i=f.$v;var t;t=n?n.$99:i.$c.get_$D1();if(t in i.$Lc.get_saveForPopoutMap()){var r=i.$Lc.get_saveForPopoutMap()[t];r.$33c.length>0&&i.$Lc.pushSaveResultToPopout(null,r.$33c);delete i.$Lc.get_saveForPopoutMap()[t]}}var u=this.$3eC?2:1;_y.$2E.$1F(this.$2Mo,null,_mcp.$MX.$QL.toString(u));this.$2Mo=null},$6tU:function(){_js.Trace.logInfo(_a.$0.$15,"Attempt to popout expired since save did not come back in time");if(this.$3y1){this.$3eC=!0;this.$7oo(null);var n=this.$1n;var t=n.$v.$1d;this.$3Ul();t.$4r(84);_mcp.$3s.$Js(n)}},$DMX:function(){_js.Trace.logInfo(_a.$0.$15,"Attempt to navigate away expired since save did not come back in time");if(this.$2mE){this.$4pq=!0;this.$1tH(null);var n=this.$1n;var t=n.$v.$1d;this.$3Ul();t.$4r(86);_mcp.$3s.$Js(n)}}};_mcp.$MX.$QL=function(){};_mcp.$MX.$QL.prototype={popoutSaveFailed:1,popoutSaveExpired:2,popoutSaveSucceededExpired:3};_mcp.$MX.$QL.registerEnum("_mcp.$MX.$QL",!1);_mcp.$7x=function(n){_mcp.$7x.initializeBase(this,[4,n])};_mcp.$7x.$8WQ=function(n){switch(n.get_$6W()){case 4:return n.get_$6SK();case 8:case 3:case 5:case 7:case 6:return!0;default:return!1}};_mcp.$7x.prototype={get_$4f8:function(){return this.$w(_mcp.$7x.$64A)},set_$4f8:function(n){this.$P(_mcp.$7x.$64A,n);return n},get_$2v5:function(){return this.$w(_mcp.$7x.$72k)},set_$2v5:function(n){this.$P(_mcp.$7x.$72k,n);return n},get_$50Z:function(){return this.$w(_mcp.$7x.$6WD)},set_$50Z:function(n){this.$P(_mcp.$7x.$6WD,n);return n},get_$6Qj:function(){return this.$w(_mcp.$7x.$6Qk)},set_$6Qj:function(n){this.$P(_mcp.$7x.$6Qk,n);return n},$3e:function(){var n=this.$1n.$v.$c;var i=this.$1n.$v.$4x;n.get_$3FJ()?this.set_$50Z(new _cc.$Ca(n.get_$6D(),null,this.$1n.$v.$4x,this.$1n.$v.$I)):this.set_$50Z(null);if(n.get_$ov()&&n.get_$230()){var t=1;var f=_pc.$q.$7ff(n.get_$5Q());var e=i.$NW(f,_bc.$6Z.$11Y,!0,t);this.set_$4f8(e);this.set_$6Qj(!!n.get_$Ek()&&!!n.get_$Ek().Mailbox&&!!n.get_$5Q()&&!!n.get_$5Q().Mailbox&&!_g.$1Y.$5b(n.get_$5Q().Mailbox,n.get_$Ek().Mailbox));if(this.get_$6Qj()){var r=_pc.$q.$7ff(n.get_$Ek());var u=i.$NW(r,_bc.$6Z.$11Y,!0,t);this.set_$2v5(u)}else this.get_$2v5()&&this.set_$2v5(null)}else{this.get_$4f8()&&this.set_$4f8(null);this.get_$2v5()&&this.set_$2v5(null)}_js.Trace.logInfo(_a.$0.$15,"Meeting component initialized, IsMeeting={0}, IsMeetingForward={1}",n.get_$ov(),n.get_$230());_mcp.$14e.prototype.$3e.call(this)}};_mcp.$1Kt=function(n,t,i){this.$$d_$2qT=Function.createDelegate(this,this.$2qT);this.$$d_$2qS=Function.createDelegate(this,this.$2qS);this.$$d_$7cP=Function.createDelegate(this,this.$7cP);this.$$d_$9yR=Function.createDelegate(this,this.$9yR);this.$$d_$nk=Function.createDelegate(this,this.$nk);this.$$d_$2UJ=Function.createDelegate(this,this.$2UJ);this.$$d_$Ecq=Function.createDelegate(this,this.$Ecq);_mcp.$1Kt.initializeBase(this,[10,n]);this.$6R=t;this.$3a=i};_mcp.$1Kt.prototype={$6R:null,$3a:null,$3aH:null,$E5:null,$hj:null,$9B:null,set_$Ecr:function(n){if(this.$3aH!==n){this.$3aH=n;this.$4("ShowMessageOptionsCommand")}return n},set_$ns:function(n){if(this.$E5!==n){this.$E5=n;this.$4("DialogViewModel")}return n},$3e:function(){this.$3aH||this.set_$Ecr(new _C(this.$$d_$Ecq,this.get_$m()));this.$7Sv();_mcp.$14e.prototype.$3e.call(this)},$Ecq:function(){_js.Trace.logInfo(_a.$0.$15,"User chose to show message options");$C(this.$hj)&&(this.$hj=new _mcp.$nK);this.$hj.$1TZ(this.$c_2);if($C(this.$E5)){var t=new _bc.$DH;t.set_$c8(this.$6R);this.set_$ns(t);this.$E5.set_$3u(_nbs.NonBootStrings.l_MessageOptions_Text);this.$9B=[new _ff.$1l(new _C(this.$$d_$2UJ,this.get_$m()),_u.CommonStrings.l_Ok_LowerCase_Text,null),new _ff.$1l(new _C(this.$$d_$nk,this.get_$m()),_u.Strings.l_CancelButtonLabel_LowerCase_Text,null)];this.$E5.$9B.$3x(this.$9B)}this.$E5.set_$FA(this.$hj);if("TouchNarrow"===_y.$z.$1Q.get_$U()){var n=this.$1n.$v.get_$5F();this.$hj.set_$5F(n);n.get_$6j().add_$21(this.$$d_$9yR)}this.$E5.set_$1C(!0)},$2UJ:function(){if(this.$E5.$G5){_js.Trace.logInfo(_a.$0.$15,"User tried to click OK button more than once.");return}var n=this.$v.$c;if(n.get_$ER()!==this.$hj.$3WZ){"Normal"!==n.get_$ER()&&this.$E0I();n.set_$ER(this.$hj.$3WZ);"Normal"!==n.get_$ER()&&this.$7Sv()}n.set_$Qk(this.$hj.$3vx);n.set_$Q1(this.$hj.$3xj);this.$hj.$1YX&&!n.get_$PO()||this.$hj.$1YY&&!n.get_$St()?this.$v.$5uY(this.$$d_$7cP):this.$7cP()},$7cP:function(){var t=this.$v.$c;var o=this.$1n.$v;var n=this.$v.get_$eH();var i=n.get_$9Z();if(t.get_$PO()!==this.$hj.$1YX){t.set_$PO(this.$hj.$1YX);this.$4("SmimeEncryptMessage");_js.Trace.logInfo(_a.$0.$52,"SmimeEncryptMessage option is changed to {0} by user.",this.$hj.$1YX)}if(t.get_$St()!==this.$hj.$1YY){t.set_$St(this.$hj.$1YY);this.$4("SmimeSignMessage");_js.Trace.logInfo(_a.$0.$52,"SmimeSignMessage option is changed to {0} by user.",this.$hj.$1YY)}var r=this.$hj.$1YX||this.$hj.$1YY;r&&o.$7EW();i&&i.set_$ru(t.get_$ru());if(this.$hj.$5fy&&!r&&n.get_$Oz())if(n.get_$Pz()){_js.Trace.logInfo(_a.$0.$52,"Waiting to move attachments because the attachment well is currently in progress.");this.$E5.set_$7f(!0);i.add_$ED(this.$$d_$2qS)}else this.$2qS(null,null);else if(!this.$hj.$5fy&&r){var u=this.$c_2.get_$6W();var e=u===1||u===2||u===3;var f=e&&this.$3a.$2u("ComposeBread1");f&&this.$v.get_$7Mt().get_$7cK().$11();if(n.get_$Oz())if(n.get_$Pz()){_js.Trace.logInfo(_a.$0.$52,"Waiting to move attachments because the attachment well is currently in progress.");this.$E5.set_$7f(!0);i.add_$ED(this.$$d_$2qT)}else this.$2qT(null,null);else this.$5Cr()}else this.$5Cr()},$2qS:function(n,t){if(this.$8VO(n,t)){_js.Trace.logInfo(_a.$0.$52,"Started MoveAttachmentsFromClientToServer due to user turned off S/MIME for current message.");if(n){n.remove_$ED(this.$$d_$2qS);this.$E5.set_$7f(!1)}var i=this.$v.get_$eH().get_$9Z();if(this.$v.$c.get_$Fc())i.$2qS();else{var r=this.$v.get_$1X8();var u=this;r.$2Mu("Attach",function(){i.$2qS()},null,!1)}this.$5Cr()}},$2qT:function(n,t){if(this.$8VO(n,t)){_js.Trace.logInfo(_a.$0.$52,"Started MoveAttachmentsFromServerToClient due to user turned on S/MIME for current message.");if(n){n.remove_$ED(this.$$d_$2qT);this.$E5.set_$7f(!1)}this.$v.get_$eH().get_$9Z().$2qT();this.$5Cr()}},$8VO:function(n,t){return!n&&!t?!0:t==="IsInProgress"&&!n.get_$Pz()},$5Cr:function(){_js.Trace.logInfo(_a.$0.$15,"User hit OK on message options dialog, setting Sensitivity="+this.$c_2.get_$ER()+"; DeliveryReceipt="+this.$c_2.get_$Qk()+"; ReadReceipt="+this.$c_2.get_$Q1()+"; SmimeEncryptMessage="+this.$c_2.get_$PO()+"; SmimeSignMessage="+this.$c_2.get_$St());this.$nk()},$nk:function(){if(this.$E5.$G5){_js.Trace.logInfo(_a.$0.$15,"User tried to close dialog when busy.");return}var t=this.$1n.$v.$c;var i=this.$v.$1ao();if(t.get_$ru()&&t.get_$ot()){_a.$3t.$44(_u.Strings.l_Smime_NotSupportedWithFromRecipientWell_Text,1);i.$4r(750)}else i.$9T(750);this.$v.get_$aa().$3a8.set_$8F(!t.get_$ru());var n=this.$v.get_$eH();if(n.get_$9Z()){n.get_$9Z().remove_$ED(this.$$d_$2qS);n.get_$9Z().remove_$ED(this.$$d_$2qT)}"TouchNarrow"===_y.$z.$1Q.get_$U()&&this.$hj.$48.get_$6j().remove_$21(this.$$d_$9yR);_js.Trace.logInfo(_a.$0.$15,"Close message options dialog");this.$E5.$5a.$11()},$9yR:function(n,t){_mcp.$8m.isInstanceOfType(this.$1n.$v.get_$5F().get_$8p())?this.$E5.set_$1C(!0):this.$E5.set_$1C(!1)},$E0I:function(){var t=this.$1n.$v;var n=t.$1ao();switch(t.$c.get_$ER()){case"Personal":n.$9T(8900);break;case"Confidential":n.$9T(8901);break;case"Private":n.$9T(8902);break}_mcp.$3s.$Js(this.$1n)},$7Sv:function(){var t=this.$1n.$v;var n=t.$1ao();switch(t.$c.get_$ER()){case"Personal":n.$4r(8900,null);break;case"Confidential":n.$4r(8901,null);break;case"Private":n.$4r(8902,null);break}_mcp.$3s.$Js(this.$1n)}};_mcp.$1Ku=function(n){this.$$d_$9NS=Function.createDelegate(this,this.$9NS);this.$$d_$47e=Function.createDelegate(this,this.$47e);_mcp.$1Ku.initializeBase(this,[2,n]);this.$Lu=n.$v.$Lu};_mcp.$1Ku.prototype={$Lu:null,$48:null,$1OF:!1,get_$5F:function(){$C(this.$48)&&(this.$48=new _y.$Cb);return this.$48},set_$5F:function(n){this.$48=n;return n},$3e:function(){var n=_y.$z.$1Q;"Mouse"!==n.get_$U()||n.get_$Cp()||n.add_$1vk(this.$$d_$47e);_mcp.$14e.prototype.$3e.call(this)},$4Vb:function(n){this.$1n.$v.$1db&&(this.$1OF=!0);if(!this.$1OF){_js.Trace.logInfo(_a.$0.$15,"Checking dirty before prompting user for before unload confirmation. Context: "+this.$1n.$v.$c.toString());this.$1n.$v.$IN()&&n.$1Zw(_nbs.NonBootStrings.l_MailComposeBeforeUnloadConfirmation_Text)}this.$1OF=!0;_js.$D.get_$Q().$2V(_a.$0.$15,"ResetSkipBeforeUnloadConfirmationFlag",this.$$d_$9NS,100)},$9NS:function(){this.$1OF=!1},$47e:function(){_y.$z.$1Q.remove_$1vk(this.$$d_$47e);this.$Lu.$7ko(this.$1n,!0)}};_mcp.$1Kv=function(n,t){this.$$d_$1G3=Function.createDelegate(this,this.$1G3);_mcp.$1Kv.initializeBase(this,[15,n]);this.$5FY=new _C(this.$$d_$1G3,this.get_$m());this.$5FY.set_$8F(t.get_$JN().get_$147().get_$5BJ())};_mcp.$1Kv.prototype={$5FY:null,$1G3:function(){_js.Trace.logInfo(_a.$0.$15,"OpenFilePicker on PAL.");var n=this.$1n.$5k(5);if(!n){_js.Trace.logError(_a.$0.$15,"Unable to open file picker, attachment component is null.");return}if(!n.get_$9Z()){_js.Trace.logError(_a.$0.$15,"Unable to open file picker, attachment well ViewModel is null.");return}if(!_mcp.$MY.$3IA(this.$1n.$v)){_js.Trace.logError(_a.$0.$15,"Unable to open file picker, ViewModel is not upgraded.");return}n.get_$9Z().$Dlh();_js.Trace.logInfo(_a.$0.$15,"OpenFilePicker on PAL end.")}};_mcp.$MY=function(n,t){this.$$d_$7Vg=Function.createDelegate(this,this.$7Vg);this.$$d_$7Vf=Function.createDelegate(this,this.$7Vf);_mcp.$MY.initializeBase(this,[15,n]);var i;i=t.$8D(t.get_$JN())?t.get_$JN().get_$147():this;var u=this;this.$1a4=new _C(this.$$d_$7Vf,this.get_$m(),i,"CameraAvailable",function(){return t.$8D(t.get_$JN())&&t.get_$JN().get_$147().get_$4TN()});var r=this;this.$1a5=new _C(this.$$d_$7Vg,this.get_$m(),i,"GalleryAvailable",function(){return t.$8D(t.get_$JN())&&t.get_$JN().get_$147().get_$4fM()})};_mcp.$MY.$3IA=function(n){var t=n.$c;if($C(t)||!t.get_$OS()){_js.Trace.logInfo(_a.$0.$15,"Show attachment not allowed dialog, Upgraded="+t.get_$OS());n.$2G.$44(0,_nbs.NonBootStrings.l_AddingAttachmentNotAllowed_Text,null);return!1}return!0};_mcp.$MY.prototype={$1a4:null,$1a5:null,$7Vf:function(){_js.Trace.logInfo(_a.$0.$15,"User chose to attach from camera");var n=this.$1n.$5k(5);if(!n){_js.Trace.logError(_a.$0.$15,"Unable to open camera, attachment component is null.");return}if(!n.get_$9Z()){_js.Trace.logError(_a.$0.$15,"Unable to open camera, attachment well ViewModel is null.");return}if(!_mcp.$MY.$3IA(this.$1n.$v)){_js.Trace.logError(_a.$0.$15,"Unable to open camera, ViewModel is not upgraded.");return}n.get_$9Z().$9CT(n.$8Tc());_js.Trace.logInfo(_a.$0.$15,"Attach from camera end")},$7Vg:function(){_js.Trace.logInfo(_a.$0.$15,"User chose to attach from gallery");var n=this.$1n.$5k(5);if(!n){_js.Trace.logError(_a.$0.$15,"Unable to open gallery, attachment component is null.");return}if(!n.get_$9Z()){_js.Trace.logError(_a.$0.$15,"Unable to open gallery, attachment well ViewModel is null.");return}if(!_mcp.$MY.$3IA(this.$1n.$v)){_js.Trace.logError(_a.$0.$15,"Unable to open gallery, ViewModel is not upgraded.");return}n.get_$9Z().$47l(n.$8Tc());_js.Trace.logInfo(_a.$0.$15,"Attach from gallery end")}};_mcp.$HY=function(n){this.$$d_$Bho=Function.createDelegate(this,this.$Bho);this.$$d_$BtI=Function.createDelegate(this,this.$BtI);this.$$d_$BtJ=Function.createDelegate(this,this.$BtJ);this.$$d_$BtL=Function.createDelegate(this,this.$BtL);this.$$d_$AYM=Function.createDelegate(this,this.$AYM);this.$$d_$DfT=Function.createDelegate(this,this.$DfT);this.$$d_$4ev=Function.createDelegate(this,this.$4ev);this.$$d_$7qm=Function.createDelegate(this,this.$7qm);this.$$d_$3Rj=Function.createDelegate(this,this.$3Rj);this.$$d_$1rt=Function.createDelegate(this,this.$1rt);this.$$d_$7qn=Function.createDelegate(this,this.$7qn);this.$$d_$DdL=Function.createDelegate(this,this.$DdL);this.$$d_$6pL=Function.createDelegate(this,this.$6pL);this.$$d_$A2w=Function.createDelegate(this,this.$A2w);this.$$d_$9Ak=Function.createDelegate(this,this.$9Ak);this.$$d_$E6j=Function.createDelegate(this,this.$E6j);this.$$d_$ATa=Function.createDelegate(this,this.$ATa);this.$$d_$C0Y=Function.createDelegate(this,this.$C0Y);this.$$d_$9k2=Function.createDelegate(this,this.$9k2);this.$$d_$C0G=Function.createDelegate(this,this.$C0G);this.$$d_$Eb8=Function.createDelegate(this,this.$Eb8);_mcp.$HY.initializeBase(this,[1,n]);this.$GH=this.$5uH();this.$GL=this.$5uH();this.$Gb=this.$5uH();this.$4Gc=new _C(this.$$d_$Eb8,this.get_$m());this.$4qG=new _C(this.$$d_$C0G,this.get_$m());this.$3a8=new _C(this.$$d_$9k2,this.get_$m());this.$4qR=new _C(this.$$d_$C0Y,this.get_$m());this.$5wv=new _C(this.$$d_$ATa,this.get_$m());this.$5qS=new _C(this.$$d_$E6j,this.get_$m());this.$1NR=new _C(this.$$d_$9Ak,this.get_$m());this.$1gH=new(_ff.$18.$$(_y.$mS));this.$A31()};_mcp.$HY.$DqN=function(n,t){n.set_$77(t)};_mcp.$HY.$Dpr=function(n,t){n.set_$7x(t)};_mcp.$HY.$Dpo=function(n,t){n.set_$AO(t)};_mcp.$HY.$DqM=function(n,t){n.set_$10q(t)};_mcp.$HY.$Dpq=function(n,t){n.set_$xl(t)};_mcp.$HY.$Dpn=function(n,t){n.set_$qX(t)};_mcp.$HY.prototype={$GH:null,$GL:null,$Gb:null,$4Gc:null,$4qG:null,$3a8:null,$4qR:null,$5wv:null,$5qS:null,$1NR:null,$5bi:null,$4U5:null,$4S0:null,$5XN:null,$4qS:null,$5Wr:null,$4qF:null,$o1:null,$1Jp:null,$5W7:!1,$NE:!1,$4v2:!1,$5l4:!1,$cO:null,$35S:null,$4qo:null,$2OS:!1,$6RU:!1,$7Co:!1,$5WK:!1,$5WI:!1,$1gH:null,add_$9Aj:function(n){this.$31("ResolveOperationSucceeded",n)},remove_$9Aj:function(n){this.$5d("ResolveOperationSucceeded",n)},add_$9Ai:function(n){this.$31("ResolveOperationCanceled",n)},remove_$9Ai:function(n){this.$5d("ResolveOperationCanceled",n)},set_$4fB:function(n){if(this.$o1!==n){this.$o1=n;this.$4("FromPersonaViewModel")}return n},get_$ArX:function(){return this.$o1&&this.$o1.get_$3F()?this.$o1.get_$3F().get_$2Z():null},get_$1Rl:function(){if(!this.$1Jp){var n=this;this.$v.$38y.$9(function(t){var i=t.$7fT();i.set_$bm(!0);i.set_$17(!1);i.set_$2BE(100);i.set_$25v(0);i.set_$2u6("PersonaDetailedView");i.$1jL();i.set_$15G(!0);i.set_$7IK(new _C(n.$$d_$A2w,_a.$0.$15));_y.$z.$1Q.get_$U()!=="Mouse"&&i.set_$Qd(new _C(n.$$d_$A2w,_a.$0.$15));i.add_$1AJ(n.$$d_$6pL);n.$1Jp=i;if(n.$5WK){n.$9k2();n.$5WK=!1}else if(n.$5WI){n.$6MD();n.$5WI=!1}})}return this.$1Jp},set_$9iy:function(n){if(this.$5W7!==n){this.$5W7=n;this.$4("ShouldHighlightFromAsInvalid")}return n},get_$18M:function(){var n=this.$1n.$v.$c.get_$ot()&&(!!this.$o1&&this.$o1.get_$18M()||!!this.$1Jp&&this.$1Jp.get_$18M());return n||this.$GH.get_$18M()||this.$GL.get_$18M()||this.$Gb.get_$18M()},set_$3Ir:function(n){this.$NE=n;this.$4("IsReadWrite");return n},set_$6RV:function(n){this.$6RU=n;this.$4("IsPeoplePickerShown");return n},get_$4v3:function(){var n=this.$1n.$v.$c;return!!n.get_$5Q()&&!!n.get_$5Q().Mailbox&&!_a.$2i.$YN(n.get_$5Q().Mailbox.EmailAddress)},get_$3a9:function(){this.$5XN||(this.$5XN=new _y.$2Y(_nbs.NonBootStrings.l_ShowFromMenuItemText_LowerCase_Text,this.$3a8));return this.$5XN},get_$4qT:function(){this.$4qS||(this.$4qS=new _y.$2Y(_nbs.NonBootStrings.l_HideFromMenuItemText_LowerCase_Text,this.$4qR));return this.$4qS},get_$7DC:function(){this.$5Wr||(this.$5Wr=new _y.$2Y(_nbs.NonBootStrings.l_ShowBccMenuItemText_LowerCase_Text,this.$4Gc));return this.$5Wr},get_$6KI:function(){this.$4qF||(this.$4qF=new _y.$2Y(_nbs.NonBootStrings.l_HideBccMenuItemText_LowerCase_Text,this.$4qG));return this.$4qF},get_$C7Z:function(){return!this.$1n.$v.$c.get_$1Ed()},get_$CE1:function(){return!this.$1n.$v.$c.get_$1Ed()},get_$CCC:function(){return this.$1n.$v.$c.get_$1Ed()},get_$BzI:function(){return this.$5pt(this.$NE?this.$GH.$5X.$GZ:this.$GH.$R5.get_$xO())||this.$5pt(this.$NE?this.$GL.$5X.$GZ:this.$GL.$R5.get_$xO())||this.$5pt(this.$NE?this.$Gb.$5X.$GZ:this.$Gb.$R5.get_$xO())},$3dO:function(){this.$GH.$3dO();this.$GL.$3dO();this.$Gb.$3dO()},$EVg:function(n){this.$4qo=n},$A8v:function(n,t,i){if(this.$cO){this.$cO.remove_$2Vz(this.$35S);this.$cO.add_$2Vz(i);this.$35S=i;this.$cO.set_$6w2(t);this.$cO.$9un(n);this.set_$6RV(!0);this.$1n.$v.$sO(this.$cO)}else{var r=this;this.$v.$3VS.$9(function(u){r.$cO=u.$5uR(n,t);r.$cO.add_$2Vz(i);r.$cO.add_$6sf(r.$$d_$DdL);r.$35S=i;r.set_$6RV(!0);r.$1n.$v.$sO(r.$cO)})}},$A30:function(){if(this.$GH.$5X){this.$GH.$5X.remove_$1Mi(this.$$d_$7qn);this.$GH.$5X.remove_$1rt(this.$$d_$1rt);this.$GH.$5X.$3V.remove_$21(this.$$d_$3Rj);this.$GH.$5X.add_$1Mi(this.$$d_$7qn);this.$GH.$5X.add_$1rt(this.$$d_$1rt);this.$GH.$5X.$3V.add_$21(this.$$d_$3Rj)}if(this.$GL.$5X){this.$GL.$5X.remove_$1Mi(this.$$d_$7qm);this.$GL.$5X.remove_$1rt(this.$$d_$1rt);this.$GL.$5X.$3V.remove_$21(this.$$d_$3Rj);this.$GL.$5X.add_$1Mi(this.$$d_$7qm);this.$GL.$5X.add_$1rt(this.$$d_$1rt);this.$GL.$5X.$3V.add_$21(this.$$d_$3Rj)}},get_$wN:function(){return this.$1gH},$3e:function(){var n=this.$1n.$v.$c;var t=n.get_$9i();this.set_$3Ir(!t||!!t.get_$R9()||t.get_$6kH()||t.get_$KR());if(n.get_$4Ho()&&n.get_$4Ho().get_$A()>0){this.$GH.$C4E(n.get_$4Ho(),this.$NE,_u.Strings.l_ToRecipientsLabel_Text);n.set_$4Ho(null)}else this.$GH.$3e(n.get_$77(),n.get_$10q(),this.$NE,_u.Strings.l_ToRecipientsLabel_Text);this.$GL.$3e(n.get_$7x(),n.get_$xl(),this.$NE,_u.Strings.l_CcRecipientsLabel_Text);_y.$z.$1Q.get_$lJ()&&this.$9pY(!0);this.$A30();var i=_g.$O.get_$Q().get_$4X();if(!_js.$9.$o(i.get_$1uX())&&!_js.$9.$o(i.get_$s4())){var r=new _g.$8v;r.Mailbox=this.$Ja(i.get_$s4());n.set_$5Q(r)}("Mouse"===_y.$z.$1Q.get_$U()||n.get_$5Q()||_g.$O.get_$Q().get_$1j().get_$tN()||!$C(n.get_$AO())&&n.get_$AO().get_$A()>0||_g.$O.get_$Q().get_$1j().get_$1Ie())&&this.$1lA();this.$9v6(n);_mcp.$14e.prototype.$3e.call(this)},$AU:function(){if(this.$o1){this.$o1.$1v();this.$o1=null}if(this.$cO){this.$cO.remove_$2Vz(this.$35S);this.$cO.remove_$6sf(this.$$d_$DdL);this.$cO.dispose();this.$cO=null;this.$35S=null}this.$9M2();if(this.$1Jp){this.$1Jp.remove_$1AJ(this.$$d_$6pL);this.$1Jp.$1v();this.$1Jp=null}this.$9M2();this.$E02();this.$1gH.$1u();this.$GH.$1v();this.$GL.$1v();this.$Gb.$1v();_mcp.$14e.prototype.$AU.call(this)},$2yz:function(){this.$1lA();var n=this.$1n.$v.$c;this.$5du();this.$2UJ(n,this.$GH,_mcp.$HY.$DqN,_mcp.$HY.$DqM);this.$2UJ(n,this.$GL,_mcp.$HY.$Dpr,_mcp.$HY.$Dpq);this.$2UJ(n,this.$Gb,_mcp.$HY.$Dpo,_mcp.$HY.$Dpn)},$4Fk:function(n,t){var u=_a.$2i.$YN(n);if(u){this.get_$1Rl().set_$Bx("");var f=this.$Ja(n);var e=_pc.$q.$Ja(f);var o=this.$1n.$v.$9J.$1az;var i=o.$nl(e,4,!0,1);i.set_$4k(this.$5qS);i.set_$O6(!0);i.$2uu=!0;this.set_$4fB(i);this.$AMB()}else{this.get_$1Rl().set_$Bx(n);this.set_$4fB(null)}if(t){var r=this.$1n.$v.get_$6Ws();r.get_$G6()||r.$3e();r.$2xt()}this.set_$9iy(!u);this.$2yz()},$21j:function(){this.$1lA();return this.$GH.$21j()+this.$GL.$21j()+this.$Gb.$21j()},$BtL:function(){this.$1lA();return this.$GH.$21j()},$BtJ:function(){this.$1lA();return this.$GL.$21j()},$BtI:function(){this.$1lA();return this.$Gb.$21j()},$3VK:function(n){this.$1lA();this.$5du();this.$ABr();this.$7Co=n;this.$Ar6()},$Bhn:function(){var n=new(_ff.$18.$$(String));this.$GH.$5X?n.$3x(this.$GH.$5X.$2Ke()):this.$GH.$R5&&n.$3x(this.$GH.$R5.$2Ke());this.$GL.$5X?n.$3x(this.$GL.$5X.$2Ke()):this.$GL.$R5&&n.$3x(this.$GL.$R5.$2Ke());this.$Gb.$5X?n.$3x(this.$Gb.$5X.$2Ke()):this.$Gb.$R5&&n.$3x(this.$Gb.$R5.$2Ke());return n.$3T()},$Ar6:function(){this.$GH.$NE?this.$GH.$39Y():this.$7qn(!0)},$7qn:function(n){n?this.$GL.$NE?this.$GL.$39Y():this.$7qm(!0):this.$4ev(!1)},$7qm:function(n){n?this.$Gb.$NE?this.$Gb.$39Y():this.$4ev(!0):this.$4ev(!1)},$4ev:function(n){if(this.$7Co)if(n){_js.Trace.logInfo(_a.$0.$15,"Force resolve completed");this.$6S("ResolveOperationSucceeded")}else{_js.Trace.logInfo(_a.$0.$15,"Force resolve cancelled");this.$6S("ResolveOperationCanceled")}},$1zb:function(){this.$1lA();this.$5du();this.$GH.$1zb();this.$GL.$1zb();this.$Gb.$1zb()},$1lA:function(){if(!this.$5l4){this.$5l4=!0;var n=this.$1n.$v.$c;this.$Gb.$3e(n.get_$AO(),n.get_$qX(),this.$NE,_u.Strings.l_BccRecipientsLabel_Text);if(!$C(n.get_$AO())&&0<n.get_$AO().get_$A()||!_js.$9.$o(n.get_$qX())||_g.$O.get_$Q().get_$1j().get_$1Ie()){n.set_$1LG(!0);_js.Trace.logInfo(_a.$0.$15,"Showing BCC field due to: BccCount={0}, HasBccQueryString={1}, AlwaysShowBcc={2}",$C(n.get_$AO())?0:n.get_$AO().get_$A(),!_js.$9.$o(n.get_$qX()),_g.$O.get_$Q().get_$1j().get_$1Ie())}if(this.$Gb.$5X){this.$Gb.$5X.remove_$1Mi(this.$$d_$4ev);this.$Gb.$5X.remove_$1rt(this.$$d_$1rt);this.$Gb.$5X.$3V.remove_$21(this.$$d_$3Rj);this.$Gb.$5X.add_$1Mi(this.$$d_$4ev);this.$Gb.$5X.add_$1rt(this.$$d_$1rt);this.$Gb.$5X.$3V.add_$21(this.$$d_$3Rj)}_js.Trace.logInfo(_a.$0.$15,"Recipient component initialized, ShouldValidate={0}, From={1}, ToCount={2}, CcCount={3}, BccCount={4}",!0,!n.get_$5Q()||!n.get_$5Q().Mailbox?"<not set>":n.get_$5Q().Mailbox.EmailAddress,$C(n.get_$77())?0:n.get_$77().get_$A(),$C(n.get_$7x())?0:n.get_$7x().get_$A(),$C(n.get_$AO())?0:n.get_$AO().get_$A());this.$9v6(n);if(n.get_$3J3()&&(n.get_$5Q()||_g.$O.get_$Q().get_$1j().get_$tN()))if(this.get_$1Rl()){this.$6MD();_js.Trace.logInfo(_a.$0.$15,"Showing From field due to: From={0}, AlwaysShowFrom={1}",!n.get_$5Q()||!n.get_$5Q().Mailbox?"<not set>":n.get_$5Q().Mailbox.EmailAddress,_g.$O.get_$Q().get_$1j().get_$tN())}else this.$5WI=!0;else if(_g.$O.get_$Q().get_$1j().get_$tN()&&!$C(n.get_$9i())&&!n.get_$9i().get_$KR()){var t=this.$1n.$v.$1d;t.$9T(4525);t.$4r(4525);_mcp.$3s.$Js(this.$1n)}}},$50d:function(){this.$GH.$50d();this.$GL.$50d();this.$Gb.$50d()},$Bho:function(){_js.Trace.logInfo(_a.$0.$52,"MailComposeRecipientComponent.GetAllEmailAddresses");var e=this.$1n.$v.$c;var t=new(_ff.$18.$$(_g.$1K));var u=this.$NE?this.$GH.$5X.$GZ:this.$GH.$R5.get_$xO();var f=this.$NE?this.$GL.$5X.$GZ:this.$GL.$R5.get_$xO();var r=this.$NE?this.$Gb.$5X.$GZ:this.$Gb.$R5.get_$xO();if(u){_js.Trace.logInfo(_a.$0.$52,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding to addresses");t.$3x(u.$3T())}if(f){_js.Trace.logInfo(_a.$0.$52,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding cc addresses");t.$3x(f.$3T())}if(r){_js.Trace.logInfo(_a.$0.$52,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding bcc addresses");t.$3x(r.$3T())}_js.Trace.logInfo(_a.$0.$52,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding from address");var n=e.$3rz();if(!n){var i=_g.$O.get_$Q().get_$4X();n=new _g.$1K;n.Name=i.get_$Lh();n.EmailAddress=i.get_$Fu()||i.get_$s4();n.MailboxType="Mailbox";n.RoutingType="SMTP"}t.$F(n);return t},$E6j:function(){if(this.$o1){_js.Trace.logInfo(_a.$0.$15,"User selected from persona");this.$o1.set_$2g(!0);this.$4qo&&this.$4qo()}else _js.Trace.logInfo(_a.$0.$15,"User tries to select from persona, but it is null")},$9Ak:function(){this.$3VK(!1)},$ATa:function(){_js.Trace.logInfo(_a.$0.$15,"User chose to delete from persona");this.set_$4fB(null);this.get_$1Rl().set_$Qm(!0)},$A2w:function(){this.$4Fk(this.get_$1Rl().get_$Bx(),!0)},$6pL:function(n,t){this.$7Sb()},$5uH:function(){return new _mcp.$JQ(this.$1n.$v.$9J,this)},$DfT:function(n,t){this.$1gH.$1u();this.$7MN(this.$GH);this.$7MN(this.$GL);this.$7MN(this.$Gb)},$7MN:function(n){n.$5X?this.$1gH.$F(n.$5X):n.$R5&&this.$1gH.$F(n.$R5)},$A31:function(){this.$GH.$p("ReadWriteRecipientWellViewModel",this.$$d_$DfT);this.$GL.$p("ReadWriteRecipientWellViewModel",this.$$d_$DfT);this.$Gb.$p("ReadWriteRecipientWellViewModel",this.$$d_$DfT);this.$GH.$p("ReadOnlyRecipientWellViewModel",this.$$d_$DfT);this.$GL.$p("ReadOnlyRecipientWellViewModel",this.$$d_$DfT);this.$Gb.$p("ReadOnlyRecipientWellViewModel",this.$$d_$DfT)},$E02:function(){this.$GH.$1B("ReadWriteRecipientWellViewModel",this.$$d_$DfT);this.$GL.$1B("ReadWriteRecipientWellViewModel",this.$$d_$DfT);this.$Gb.$1B("ReadWriteRecipientWellViewModel",this.$$d_$DfT);this.$GH.$1B("ReadOnlyRecipientWellViewModel",this.$$d_$DfT);this.$GL.$1B("ReadOnlyRecipientWellViewModel",this.$$d_$DfT);this.$Gb.$1B("ReadOnlyRecipientWellViewModel",this.$$d_$DfT)},$3Rj:function(n,t){this.$GH.get_$1Kv()||this.$GL.get_$1Kv()||this.$Gb.get_$1Kv()||this.$1n.$v.$1d.$9T(65);this.$GH.get_$Iu()&&this.$GL.get_$Iu()&&this.$Gb.get_$Iu()||this.$1n.$v.$1d.$9T(70);_y.$z.$1Q.get_$lJ()&&this.$9pY(!1);if(t&&t.$3P===2){var r=this.$1n.$v.get_$6Ws();r.get_$G6()||r.$3e();r.$9Lo();if(_a.$5N.$43){var i=this;_js.$D.get_$Q().$6F(_a.$0.$PD,"TriggerPolicyTipsIfNeeded",function(){if(i.$1n&&i.$1n.$v){var n=i.$1n.$v.get_$9Fg();n.$2BC(1)}})}}},$ABr:function(){this.$GH.$5X&&this.$GH.$5X.$337();this.$GL.$5X&&this.$GL.$5X.$337();this.$Gb.$5X&&this.$Gb.$5X.$337()},$DdL:function(){this.set_$6RV(!1)},$9M2:function(){if(this.$GH.$5X){this.$GH.$5X.remove_$1Mi(this.$$d_$7qn);this.$GH.$5X.remove_$1rt(this.$$d_$1rt);this.$GH.$5X.$3V.remove_$21(this.$$d_$3Rj)}if(this.$GL.$5X){this.$GL.$5X.remove_$1Mi(this.$$d_$7qm);this.$GL.$5X.remove_$1rt(this.$$d_$1rt);this.$GL.$5X.$3V.remove_$21(this.$$d_$3Rj)}if(this.$Gb.$5X){this.$Gb.$5X.remove_$1Mi(this.$$d_$4ev);this.$Gb.$5X.remove_$1rt(this.$$d_$1rt);this.$Gb.$5X.$3V.remove_$21(this.$$d_$3Rj)}},$1rt:function(){_mcp.$3s.$Js(this.$1n)},$Eb8:function(){_a.$6.stPT(_a.$0.$15,"MailComposeShowBcc",3);var t=_a.$6.$1f(_a.$0.$15,"MailComposeShowBcc",!0);_js.Trace.logInfo(_a.$0.$15,"User chose to show bcc");this.$1lA();var n=this.$1n.$v.$c;if(!n.get_$1LG()){n.set_$1LG(!0);_mcp.$3s.$Js(this.$1n);this.$7Ma()}_a.$6.$1F(t);_a.$6.endPT("MailComposeShowBcc")},$C0G:function(){_a.$6.stPT(_a.$0.$15,"MailComposeHideBcc",3);var t=_a.$6.$1f(_a.$0.$15,"MailComposeHideBcc",!0);_js.Trace.logInfo(_a.$0.$15,"User chose to hide bcc");this.$1lA();var n=this.$1n.$v.$c;if(n.get_$1LG()){n.set_$1LG(!1);_mcp.$3s.$Js(this.$1n);this.$7Ma()}_a.$6.$1F(t);_a.$6.endPT("MailComposeHideBcc")},$7Ma:function(){if(_y.$z.$1Q.get_$U()==="Mouse"){var r=this.$1n.$5k(18);r.$7Ma()}else{var n=this.$1n.$v.$c;var u=n.get_$1LG()?this.get_$6KI():this.get_$7DC();var t=n.get_$1LG()?this.get_$7DC():this.get_$6KI();var i=this.$1n.$v.$5w;i.$6yD(t,u)}},$9v6:function(n){if("Mouse"!==_y.$z.$1Q.get_$U()){var f=this.$1n;var u=f.$v;var r=u.$5w;if(r){var i=r.$1a;if(i)if(n.get_$3J3()){if(!this.$2OS)for(var t=0;t<i.length;t++)if(_nbs.NonBootStrings.l_ShowBccMenuItemText_LowerCase_Text===i[t].$3S){r.$4Oj(this.get_$3a9(),t+1);this.$2OS=!0}}else if(this.$2OS){u.$5w.$5Lm(this.get_$3a9());this.$2OS=!1}}}},$5du:function(){var i=this.$1n.$v.$c;var n=null;if(i.get_$ot()){var t=null;this.$o1?t=this.$o1.get_$3F().get_$2Z():this.$1Jp&&!_js.$9.$o(this.$1Jp.get_$Bx())&&(t=this.$Ja(this.$1Jp.get_$Bx()));n=new _g.$8v;n.Mailbox=t;i.set_$5Q(n);this.get_$4v3()||this.$1n.$v.$1d.$9T(66)}return n},$Ja:function(n){var t=new _g.$1K;t.MailboxType="Mailbox";t.RoutingType="SMTP";t.EmailAddress=n;return t},$AMB:function(){var t=_mcp.$JQ.$2tK;var n=[];(t&4)==4&&Array.add(n,new _fm.$d(_u.Strings.l_EditRecipient_LowerCase_Text,null,new _C(this.$$d_$AYM,_a.$0.$15)));(t&2)==2&&Array.add(n,new _fm.$d(_u.Strings.l_RemoveRecipient_LowerCase_Text,null,new _C(this.$$d_$ATa,_a.$0.$15)));$C(this.$o1.$1k3)||(t&1)!=1||Array.addRange(n,this.$o1.$1k3);this.$o1.set_$1J4(n)},$6MD:function(){var n=this.$1n.$v.$c;var i=null;var t=_g.$O.get_$Q().get_$4X();i=_js.$9.$o(t.get_$1uX())||_js.$9.$o(t.get_$s4())?null!==n.get_$5Q()&&n.get_$5Q().Mailbox?n.get_$5Q().Mailbox.EmailAddress:_h.$2j.$4mh(null)||t.get_$Fu():t.get_$s4();this.$4Fk(i,!1);n.set_$ot(!0);var u=this.$5du();n.get_$T5()&&n.get_$T5().set_$5Q(u);var r=this.$1n.$5k(20);$C(r.get_$Tb())&&r.$3e()},$AYM:function(){var n=this.$o1.get_$3F().get_$2Z().EmailAddress;this.set_$4fB(null);this.get_$1Rl().set_$Bx(n);this.get_$1Rl().set_$Qm(!0)},$7Sb:function(){var n=this.get_$1Rl().get_$kR();if($C(n)||$C(n.get_$A1())||$C(n.get_$A1().get_$2Z()))_js.Trace.logWarning(_a.$0.$15,"User selected from but the SelectedResultItem persona is invalid");else{var t=n.get_$A1().get_$2Z().EmailAddress;_js.Trace.logInfo(_a.$0.$15,"User selected from="+t);this.$4Fk(t,!0)}},$9k2:function(){if(!this.get_$1Rl()){this.$5WK=!0;return}_a.$6.stPT(_a.$0.$15,"MailComposeShowFrom",3);var t=_a.$6.$1f(_a.$0.$15,"MailComposeShowFrom",!0);var n=this.$1n.$v.$c;if(n.get_$ot())_js.Trace.logInfo(_a.$0.$15,"Skip show from since it is already shown");else{_js.Trace.logInfo(_a.$0.$15,"User chose to show from");this.$4v2=!0;this.$6MD();_mcp.$3s.$Js(this.$1n);this.$7Mb()}_a.$6.$1F(t);_a.$6.endPT("MailComposeShowFrom")},$C0Y:function(){_a.$6.stPT(_a.$0.$15,"MailComposeHideFrom",3);var r=_a.$6.$1f(_a.$0.$15,"MailComposeHideFrom",!0);var n=this.$1n.$v.$c;if(n.get_$ot()){n.set_$ot(!1);this.$4v2=!1;_mcp.$3s.$Js(this.$1n);if(_y.$z.$1Q.get_$U()==="Mouse"){var i=this.$1n.$5k(18);i.$7Mb()}else{var t=this.$1n.$v.$5w;t.$6yD(this.get_$4qT(),this.get_$3a9())}}else _js.Trace.logInfo(_a.$0.$15,"Skip hide from since it is already hidden");this.$1n.$v.$1d.$9T(750);_a.$6.$1F(r);_a.$6.endPT("MailComposeHideFrom")},$7Mb:function(){if(_y.$z.$1Q.get_$U()==="Mouse"){var r=this.$1n.$5k(18);r.$7Mb()}else{var n=this.$1n.$v.$c;var u=n.get_$ot()?this.get_$4qT():this.get_$3a9();var t=n.get_$ot()?this.get_$3a9():this.get_$4qT();var i=this.$1n.$v.$5w;i.$6yD(t,u)}},$2UJ:function(n,t,i,r){var u=this.$NE?t.$5X:t.$R5;if(!$C(u)){i(n,u.get_$xO());if(_rw.$82.isInstanceOfType(u)){var f=u;f.get_$9O()&&r(n,f.get_$9O().get_$Bx())}}},$9pY:function(n){var e=this.$1n.$v.$c;var i=!1;var u=e.$3rz();if(u){var t=this.$GL.$5X.$GZ;if(t)for(var r=0;r<t.get_$A();r++){var f=t.get_$E(r);if(u.EmailAddress.toLowerCase()===f.EmailAddress.toLowerCase()){i=!0;break}}}if(n&&i){this.$1n.$v.$1d.$9T(4450);this.$1n.$v.$1d.$4r(4450)}else n||i||this.$1n.$v.$1d.$9T(4450)},$5pt:function(n){if(!n||!n.get_$A())return!1;for(var t=0;t<n.get_$A();t++){var i=n.get_$E(t);if(i&&i.MailboxType==="GroupMailbox")return!0}return!1},$ZW:function(n){var t=this.$GH.$62E()||this.$GL.$62E()||this.$Gb.$62E();t&&n.$5X.$3V.$F(t)},get_$Emf:function(){if(!this.$5bi){var n=this;this.$5bi=new _C(function(){n.$ZW(n.$GH)},_a.$0.$15)}return this.$5bi},get_$ACy:function(){if(!this.$4U5){var n=this;this.$4U5=new _C(function(){n.$ZW(n.$GL)},_a.$0.$15)}return this.$4U5},get_$A84:function(){if(!this.$4S0){var n=this;this.$4S0=new _C(function(){n.$ZW(n.$Gb)},_a.$0.$15)}return this.$4S0}};_mcp.$JQ=function(n,t){this.$$d_$5EZ=Function.createDelegate(this,this.$5EZ);this.$$d_$6ne=Function.createDelegate(this,this.$6ne);this.$$d_$8YL=Function.createDelegate(this,this.$8YL);_mcp.$JQ.initializeBase(this);this.$9J=n;this.$6Wf=t};_mcp.$JQ.prototype={$9J:null,$5N8:null,$5X:null,$R5:null,$NE:!1,$6Wf:null,$1sm:null,$3av:null,$5L:null,set_$i4:function(n){if(this.$5X!==n){this.$5X=n;this.$4("ReadWriteRecipientWellViewModel")}return n},get_$E3n:function(){this.$5N8||(this.$5N8=new _C(this.$$d_$8YL,_a.$0.$g1));return this.$5N8},set_$3U5:function(n){if(n!==this.$R5){this.$R5=n;this.$4("ReadOnlyRecipientWellViewModel")}return n},get_$Iu:function(){var o=this.$NE&&_rw.$4c.$Iu(this.$5X);if(this.$NE){var f;var n;var s="";var t="";var i="";var r="";if(this.$5X){for(var u=0;u<this.$5X.$3V.get_$A();u++){f=this.$5X.$3V.get_$E(u);if(f){s=f.$8k.get_$mf();i=i+" "+s}}for(var e=0;e<this.$5X.$GZ.get_$A();e++){n=this.$5X.$GZ.get_$E(e);if(n){t="";_js.$9.$1g(n.EmailAddress)?_js.$9.$1g(n.Name)||(t=n.Name):t=n.EmailAddress;r=r+" "+t}}}_js.Trace.logInfo(_a.$0.$mb,"{0} Well Is empty? {1} \n Recipients are: {2} \n Addresses are: {3} \n",this.$1sm,o,i,r)}return o},get_$1Kv:function(){return this.$NE&&!$C(this.$5X)&&this.$5X.$2N7},$2BD:function(){this.$NE&&this.$5X&&this.$5X.$EpO()},$C4E:function(n,t,i){this.$3av=n;this.$NE=t;this.$5X?this.$5X.$5L2(null):this.set_$i4(this.$7gr(null));var r=this.$5X.get_$9O();if(r){r.set_$Bx("");r.$8KC(this.$3av)}else this.$5X.$p("FindRecipientViewModel",this.$$d_$6ne);this.$1sm=i},$3e:function(n,t,i,r){this.$NE=i;this.$5L=t;if(i){this.$5X?this.$5X.$5L2(n):this.set_$i4(this.$7gr(n));var u=this.$5X.get_$9O();if(u){!_js.$9.$o(u.get_$Bx())&&_js.$9.$o(t)&&u.set_$Bx(t);_js.$9.$o(t)||u.set_$Bx(t)}else this.$5X.$p("FindRecipientViewModel",this.$$d_$6ne);this.$1sm=r}else this.$R5?this.$R5.$5L2(n):this.set_$3U5(this.$AP3(n))},$39Y:function(){$C(this.$5X)||this.$5X.$39Y()},$1zb:function(){this.$5X&&this.$5X.$1zb()},$3dO:function(){if(!$C(this.$5X)){this.$5X.set_$3dO(!0);this.$5X.set_$3dO(!1)}},$21j:function(){var n;n=this.$NE?$C(this.$5X)?0:!this.$5X.get_$9O()||_js.$9.$o(this.$5X.get_$9O().get_$Bx())?this.$5X.$GZ.get_$A():this.$5X.$GZ.get_$A()+1:$C(this.$R5)?0:this.$R5.get_$xO().get_$A();return n},$50d:function(){if(this.$5X){for(var f="",u="",r="",i,n,t=0,o=this.$5X.$3V.get_$A();t<o;t++){i=this.$5X.$3V.get_$E(t);if(i&&!i.$K6){n=this.$5X.$GZ.get_$E(t);if(n){u=_js.$9.$1g(n.Name)?"":n.Name;f=_js.$9.$1g(n.EmailAddress)?"":n.EmailAddress;var e=String.format("( {0} , {1} ),",u,f);r+=e}}}r!==""&&_js.Trace.logInfo(_a.$0.$15,"{0} Well Invalid Recipients are: {1} \n",this.$1sm,r)}},$2A:function(){if(!$C(this.$5X)){this.$5X.set_$7Cp(!1);this.$5X.$1v();this.$5X=null}},$7gr:function(n){return this.$9J.$4XE(_mcp.$JQ.$2tK,_pe.$1k.$1wz,n,!0)},$AP3:function(n){return this.$9J.$1CJ(_mcp.$JQ.$5KR,_bc.$6Z.$11Y,n,1)},$6ne:function(n,t){var r=n;var i=r.get_$9O();if(this.$3av&&this.$3av.get_$A()>0){i.set_$Bx("");i.$8KC(this.$3av)}_js.$9.$1g(this.$5L)||i.set_$Bx(this.$5L);r.$1B("FindRecipientViewModel",this.$$d_$6ne)},$8YL:function(){if(this.$NE&&!OwaApplication.$Ou){_js.Trace.logInfo(_a.$0.$15,"User chose to launch rich people picker");this.$5X.$1zb();_a.$i.$Ih.$F("VM.PeoplePicker.Launched",_a.$8.get_$36());_a.$6.stPT(_a.$0.$g1,"PeoplePicker",3);_a.$6.$1f(_a.$0.$g1,"PeoplePicker");this.$6Wf.$A8v(this.$5X.$3V,this.$1sm,this.$$d_$5EZ)}},$5EZ:function(n){_y.$z.$1Q.get_$U()!=="TouchNarrow"&&this.$5X.$3V.$1u();var t=this;n.$Cj(function(n){var i=n;i.$K6?t.$5X.$30b(i.$I2):t.$5X.$3fS(i.$I2)})},$62E:function(){for(var t=this.$5X.$3V,r=null,n=0;n<t.get_$A();n++){var i=t.get_$E(n);if(i.$4te){r=i;t.$5W(n);break}}return r}};_mcp.$3s=function(n,t){this.$$d_$6np=Function.createDelegate(this,this.$6np);this.$$d_$kK=Function.createDelegate(this,this.$kK);_mcp.$3s.initializeBase(this,[14,n]);this.$6R=t};_mcp.$3s.$Js=function(n){var i=n.$5k(14);i&&i.$kK();var t=n.$5k(1);t&&t.$3dO()};_mcp.$3s.prototype={$6R:null,$5ft:!1,get_$3VH:function(){return this.$w(_mcp.$3s.$6z9)},set_$3VH:function(n){this.$P(_mcp.$3s.$6z9,n);return n},$3e:function(){if(!this.$5ft){this.$EjR();this.$5ft=!0;_g.$O.get_$Q().get_$6o().add_$1zY(this.$$d_$6np);_g.$O.get_$Q().get_$6o().add_$3Eg(this.$$d_$6np)}this.$kK();_js.Trace.logInfo(_a.$0.$15,"Resize editor component initialized and resize editor called");_mcp.$14e.prototype.$3e.call(this)},$kK:function(){this.$C5u()},$AU:function(){this.$Eqv();this.$5ft=!1;_g.$O.get_$Q().get_$6o().remove_$1zY(this.$$d_$6np);_g.$O.get_$Q().get_$6o().remove_$3Eg(this.$$d_$6np);_js.Trace.logInfo(_a.$0.$15,"Editor resize component reset");_mcp.$14e.prototype.$AU.call(this)},$C5u:function(){!$C(this.get_$3VH())&&this.get_$3VH().$3r?this.get_$3VH().$11():this.$1n.$5k(27).set_$Nb(new _cmc.$1CZ)},$6np:function(n,t){this.$kK()},$EjR:function(){if(this.$6R){var t=_js.$2q.$39i(this.$6R);var n=this;t.$8j("resize",function(t){n.$kK()},"EditorResizeComponent")}else _y.$z.$1Q.add_$1Ge(this.$$d_$kK)},$Eqv:function(){if(this.$6R){var n=_js.$2q.$39i(this.$6R);n.$Be("resize","EditorResizeComponent")}else _y.$z.$1Q.remove_$1Ge(this.$$d_$kK)}};_mcp.$Kl=function(n,t,i){this.$$d_$AVm=Function.createDelegate(this,this.$AVm);this.$$d_$AVn=Function.createDelegate(this,this.$AVn);this.$$d_$8QK=Function.createDelegate(this,this.$8QK);this.$$d_$7GP=Function.createDelegate(this,this.$7GP);this.$$d_$Az=Function.createDelegate(this,this.$Az);this.$$d_$E4S=Function.createDelegate(this,this.$E4S);this.$WQ={};_mcp.$Kl.initializeBase(this,[8,n]);this.$2Y=t;this.$Dz=new _C(this.$$d_$Az,this.get_$m());this.$Lu=n.$v.$Lu;this.$1G=i};_mcp.$Kl.$7oi=function(n){var t=null;_h.$49.isInstanceOfType(n)?t=n.$5i:_h.$48.isInstanceOfType(n)&&(t=n.$5i);return t};_mcp.$Kl.prototype={$Lu:null,$Dz:null,$1G:null,$GP:!1,$1Tl:!1,$3tA:!1,$4Hh:null,$2YV:!1,$14p:null,$4Bu:null,$2Y:null,$1gf:null,get_$1AE:function(){return this.$Dz},get_$G7:function(){return this.$GP},set_$G7:function(n){if(n!==this.$GP){this.$GP=n;this.$4("IsSaving")}return n},get_$C7z:function(){return this.$1Tl},$Az:function(){this.$7NO(null)},$7NO:function(n){var i=this.$1n;var r=i.$5k(5);var u=i.$v.$2G;var t=i.$v.$c;_js.Trace.logInfo(_a.$0.$15,"SaveStart:Context:"+t.toString());this.$3Ul();if(!t.get_$6SL()){_js.Trace.logInfo(_a.$0.$15,"Save not supported for the current operation {0}",t.get_$6W());return}if(r.get_$Pz()){_js.Trace.logInfo(_a.$0.$15,"Skip save and show attachment in progress dialog");u.$44(0,_u.Strings.l_MailComposeCannotOperateWhileAttachmentInProgress_Text,null);return}this.$1Tl=!0;this.$2Mu("Save",n,null,!1)},$3e:function(){this.$2wg();_mcp.$14e.prototype.$3e.call(this)},$2wg:function(){if(this.$v.get_$4Km()&&!this.$1gf){_js.Trace.logInfo(_a.$0.$15,"Setting save component override");this.$1gf=this.$v.get_$4Hb().$APW();var n=this.$1n.$5k(29);this.$1gf.$3e(this.$$d_$7GP,this.$$d_$8QK,n.$$d_$A9c,n.$$d_$7Rk)}},$2Ek:function(){if(this.$1gf){this.$1gf.$AU();this.$1gf=null}},$2Mu:function(n,t,i,r){if(this.$1gf&&!this.$1gf.$8VN()){_js.Trace.logInfo(_a.$0.$15,"saveComponentOverride.IsReadyForSmimeOperation() == false.  Save ignored.");return!0}var f=this.$1n;var s=f.$v;var u=s.$c;var h=s.$1d;var e=u.get_$D1();var a=this.$1n.$v.get_$eH();var c=f.$5k(7);if(c.$bk&&!r){_js.Trace.logInfo(_a.$0.$15,"Send is in progress, this "+n+" save is ignored. ContextId="+e);return!0}if(this.$Lu.$1EF(e)){_js.Trace.logInfo(_a.$0.$15,"User already discarded, clearing all save processors to ignore save effects. ContextId="+e);this.$WQ={};return!1}var o=f.$5k(1);o.$1zb();if(_g.$O.get_$Q().get_$6Xc()<o.$21j()){h.$4r(800,null);_mcp.$3s.$Js(f);return!0}o.$2yz();u.get_$3rn().$11();this.$WQ[n]=new _mcp.$1My(t,i);if(!this.$GP||r){this.$4Hh=_mcp.$1W.$33M(u);this.set_$G7(!0)}else{this.$3tA=!this.$4Hh.$7nQ(u);return!0}if(!u.get_$OS()&&!u.get_$Fc()&&!u.get_$1ZE()){_js.Trace.logInfo(_a.$0.$15,"Save was attempted during upgrade, remembering this save attempt and waiting for upgrade completion to resume this save. ContextId="+e);return!0}_a.$6.stPT(_a.$0.$15,"MailComposeSave",5);this.$14p=_y.$2E.$1f(_a.$0.$15,"MailComposeSave",!0);this.$4Bu=n;_js.$D.get_$Q().$1Yd(_a.$0.$15,"MailComposeSave");_js.Trace.logInfo(_a.$0.$15,"Started new task runner context before starting save.");try{this.$1gf?this.$1gf.$7GP(n):this.$7GP(n);return!0}catch(l){this.$8QK(l);throw l;}},$AU:function(){this.$GP=!1;this.$3tA=!1;this.$1Tl=!1;this.$2YV=!1;this.$WQ={};this.$4Hh=null;this.$2Ek();_mcp.$14e.prototype.$AU.call(this)},$5N3:function(){this.$GP=!1;this.$3tA=!1;_js.Trace.logInfo(_a.$0.$15,"ResumeSave:Context:"+this.$1n.$v.$c.toString());var i=this.$WQ;for(var r in i){var n={key:r,value:i[r]};var t=n.value;this.$2Mu(n.key,t.$2xy,t.$3n1,!0);break}},$E4S:function(){this.$2Mu("Diagnostics",null,null,!1)},$6FO:function(n){return _y.$5y.$4So(n.$2H,40,50,60,700,88,89,43,57)},$5if:function(n){if("InlineExit"in this.$WQ||"Popout"in this.$WQ){var u=this.$1n.$v;var t=u.$1d;var r=this.$6FO(n);var e=new _y.$tr;var i=e.$4L(r,null);t.$ad(_mcp.$MX.$wI);"InlineExit"in this.$WQ?t.$4r(87,i):t.$4r(85,i);if(r===50){var f=this;u.$2Ss.$9(function(n){n.$7RJ(t);_mcp.$3s.$Js(f.$1n)})}else _mcp.$3s.$Js(this.$1n)}else"Save"in this.$WQ&&_mcp.$14e.prototype.$5if.call(this,n)},$7GP:function(n){_js.Trace.logInfo(_a.$0.$dO,"Setup save action, context:"+this.$c_2.toString()+"; OriParentFolderId="+(this.$c_2.get_$IU()&&this.$c_2.get_$IU().get_$3G()&&_g.$b.$2K?_g.$b.$2K.idToName(this.$c_2.get_$IU().get_$3G()):"null"));var t=this.$v.$Xe.$5t8(this.$v,0,this.$1G);if((_h.$2j.isInstanceOfType(t)||_h.$48.isInstanceOfType(t))&&("Attach"===n||"Popout"===n)&&this.$c_2.get_$1Ed()){var i=t;i.$14o=new _g.$8b(new _g.$7P("internalsubmission"))}this.$v.$n.$t4(t,this.$$d_$AVn,this.$$d_$AVm,null);_js.Trace.logInfo(_a.$0.$15,"Save action submitted")},$8QK:function(n){this.set_$G7(!1);this.$1Tl=!1;var t=n.toString();_y.$2E.$1F(this.$14p,null,t,null,this.$6F8(this.$4Bu,n.message));this.$14p=null;_a.$6.endPT("MailComposeSave");_js.Trace.logWarning(_a.$0.$15,"Save failed due to an error before action was submitted: "+t)},$9Hl:function(n){var f=this.$1n;var o=f.$v;var u=o.$c;var t=n.$99;var r=!1;if(this.$Lu.$1EF(t)){u.get_$D1()===t&&(this.$WQ={});this.$3l4(n);var e=_mcp.$Kl.$7oi(n);if(e){_js.Trace.logInfo(_a.$0.$15,"Resume discard for context "+t);f.$5k(21).$5N0(t,e)}r=!0}else if(t===u.get_$D1()){if(this.$2YV){this.$2YV=!1;_js.Trace.logInfo(_a.$0.$15,"User issued send while save was in progress, now the save had come back, resume the send and cancel any pending saves. ContextId="+t);this.$WQ={};this.$3l4(n);var i=null;_h.$49.isInstanceOfType(n)?i=n.$5i:_h.$48.isInstanceOfType(n)&&(i=n.$5i);i&&u.set_$Fc(i);var s=f.$5k(7);s.$3WY();r=!0}else if(this.$3tA){_js.Trace.logInfo(_a.$0.$15,"Saving new content per user's request. ContextId="+t);this.$5N3();r=!0}}else _js.Trace.logInfo(_a.$0.$15,"Skipping default save processing due to ContextId="+t+"; viewModelId="+o.$c.get_$D1());return r},$AVn:function(n){var r=this.$1n;var o=r.$v;var f=o.$c;var s=r.$5k(21);var u=n.$99;_js.Trace.logInfo(_a.$0.$15,"Save action returned success, ContextId="+u+"; Context:"+f.toString());if(!this.$9Hl(n)&&u===f.get_$D1()){this.$ASj(n);this.$8a1();var i=!1;var t=null;if("Attach"in this.$WQ){if("AutoSave"in this.$WQ){t=this.$WQ.AutoSave;t&&t.$2xy(n)}t=this.$WQ.Attach}else if("Popout"in this.$WQ){t=this.$WQ.Popout;var e=r.$5k(9);if(e&&e.$3eC&&"InlineExit"in this.$WQ){t&&t.$2xy(n);t=this.$WQ.InlineExit}}else if("InlineExit"in this.$WQ)t=this.$WQ.InlineExit;else if("AutoSave"in this.$WQ){t=this.$WQ.AutoSave;i=!0}else if("Save"in this.$WQ){t=this.$WQ.Save;i=!0}else"Diagnostics"in this.$WQ&&(i=!0);t&&t.$2xy&&t.$2xy(n);i&&r.$5k(5).$7Mz();this.$WQ={}}_y.$2E.$1F(this.$14p,null,"",this.$FG(n),this.$6F8(this.$4Bu,""));this.$14p=null},$8a1:function(){var i="";var t=this.$WQ;for(var n in t){var r={key:n,value:t[n]};i+=r.key+":"}_js.Trace.logInfo(_a.$0.$15,"ProcessorKeys:"+i)},$AVm:function(n){var o=this.$1n.$v.$c;var e=n.$99;_js.Trace.logInfo(_a.$0.$15,"Save action returned a failure, ContextId="+e+"; Context:"+o.toString());if(!this.$9Hl(n)&&e===o.get_$D1()){this.$8a1();var t=!1;var h=this.$WQ;for(var s in h){var i={key:s,value:h[s]};var u=i.value;if(u.$3n1){u.$3n1(n);if((i.key==="InlineExit"||i.key==="Popout")&&!t){this.$7j5(n);t=!0}}else if(!t){this.$7j5(n);t=!0}}t||this.$3l4(n);this.$WQ={}}var r="SaveFailure_UnknownError";var f="";if(_g.$4k.$1dV(n.$2H)){r=_g.$4k.$2Kq(n.$2H)||"SaveFailure_UnknownError";f=n.$2H.FaultMessage}_y.$2E.$1F(this.$14p,null,r,this.$FG(n),this.$6F8(this.$4Bu,f));this.$14p=null},$ASj:function(n){var r=this.$1n;var i=r.$v;var t=i.$c;var f=n.$99;var o=this.$1Tl;if(f===t.get_$D1()){this.$Es9(n);t.set_$6Ov(!1);i.$9vX()}this.$6S("MailSaveSucceeded");if(f===t.get_$D1()&&o){var s=_a.$8.get_$36();var u=i.$1d;u.$ad(_mcp.$Kl.$wI);u.$4r(1001,s.$4I(0));_mcp.$3s.$Js(r)}if(_a.$5N.$43){var e=r.$5k(25);e.$2BC(this.$1Tl?4:2)}this.$3l4(n)},$7j5:function(n){_js.Trace.logInfo(_a.$0.$15,"SaveActionFailed: Error: {0}",n.$2H.message);n.$99===this.$1n.$v.$c.get_$D1()&&this.$5if(n);var t=this.$1n.$v;t.$1db&&t.set_$1Ea(!1);this.$3l4(n)},$3l4:function(n){var i=this.$1n;var t=i.$v.$c;if(n.$99===t.get_$D1()){this.set_$G7(!1);this.$1Tl=!1}_a.$6.endPT("MailComposeSave")},$FG:function(n){var t=null;_h.$49.isInstanceOfType(n)&&n.$67?t=n.$67.correlationId:_h.$48.isInstanceOfType(n)&&n.$67&&(t=n.$67.correlationId);return t},$6F8:function(n,t){var i=new _a.$3z;i.$CW("Ctx",n||"");i.$CW("Err",t||"");return i.toString()},$Es9:function(n){var t=this.$1n.$v.$c;t.set_$T5(this.$4Hh);if(this.$1Tl){t.set_$1TJ(!0);this.$1Tl=!1;_js.Trace.logInfo(_a.$0.$15,"Explicit save recorded. ContextId="+t.get_$D1())}if(_h.$2j.isInstanceOfType(n)){var u=n;var r=u.$5i;u.$b.set_$y(r);t.set_$Fc(r);t.set_$ix(u.$b);_js.Trace.logInfo(_a.$0.$15,"Updated context from create action. Context:"+t.toString());this.$2Y.$AXK(r)}else if(_h.$48.isInstanceOfType(n)){var i=n;var s=i.$5i;i.$Fs.set_$y(s);t.set_$Fc(s);t.set_$ix(i.$Fs);_js.Trace.logInfo(_a.$0.$15,"Updated context from update action. Context:"+t.toString())}else if(_h.$Bi.isInstanceOfType(n)){var y=n;var v=y.$5i;t.set_$Fc(v);_js.Trace.logInfo(_a.$0.$15,"Updated context from create response action. Context:"+t.toString())}else if(_mcp.$sG.isInstanceOfType(n)){var p=n;var b=p.$1kE.$5i;t.set_$Fc(b);_js.Trace.logInfo(_a.$0.$15,"Updated context from create response from modern group action. Context:"+t.toString())}else if(_cc.$10Z.isInstanceOfType(n)){var e=n;var w=e.meetingResponseMessageId;t.set_$Fc(w);t.set_$ix(e.$Os);_js.Trace.logInfo(_a.$0.$15,"Updated context from create meeting response message. Context:"+t.toString())}else if(_c.$sF.isInstanceOfType(n)){var a=n;var c=a.$5i;t.set_$Fc(c);_js.Trace.logInfo(_a.$0.$15,"Updated context from create approval response action. Context:"+t.toString())}if(_h.$49.isInstanceOfType(n)&&t.get_$ix()){var l=n;var f=l.$3gu;var o=t.get_$ix().get_$EU();if(f&&o){var h=0;var k=this;o.$Cj(function(n){var t=n;t.set_$6I(f[h]);h++});_js.Trace.logInfo(_a.$0.$15,"Attachment IDs have been updated.")}}}};_mcp.$IF=function(n){this.$$d_$ATo=Function.createDelegate(this,this.$ATo);_mcp.$IF.initializeBase(this,[20,n])};_mcp.$IF.$4Ww=function(n,t){return new _fm.$d(n,null,t,!0)};_mcp.$IF.prototype={get_$Tb:function(){return this.$w(_mcp.$IF.$24N)},set_$Tb:function(n){this.$P(_mcp.$IF.$24N,n);return n},$3e:function(){if($C(this.get_$Tb())){var n=this.$3jy(_fm.$d,_mcp.$IF.$4Ww);if(n){this.set_$Tb(new _fm.$1t(n));this.get_$Tb().set_$AI5(new _C(this.$$d_$ATo,this.get_$m()))}}_mcp.$14e.prototype.$3e.call(this)},$AU:function(){this.get_$Tb()&&this.set_$Tb(null);_mcp.$14e.prototype.$AU.call(this)},$4Oj:function(n,t){if(this.get_$Tb()){for(var u=_mcp.$IF.$4Ww(n,new _C(this.$4XN(n),this.get_$m())),i=this.get_$Tb().$1a,r=i.get_$A()-1;r>0;r--)if(_fm.$6a.isInstanceOfType(i.get_$E(r))){i.$76(r+1,u);var f=i.get_$A()-r-1;f>t&&i.$5W(i.get_$A()-1);return}i.$F(new _fm.$6a);i.$F(u)}},$ATo:function(){if(this.get_$Tb()&&this.get_$Tb().$1Y){var f=this.get_$Tb().$1Y;var r=_g.$O.get_$Q().get_$1j().get_$4Cl();var e=r.$3K(f.$3S);if(e){for(var n=this.get_$Tb().$1a,t=n.get_$A()-1;t>0;t--)if(n.get_$E(t).$3S===f.$3S){n.$5W(t);var u=n.get_$A();_fm.$6a.isInstanceOfType(n.get_$E(u-1))&&n.$5W(u-1);break}var i=new(_a.$u.$$(String));r.get_$A()>0?i.$1y6(r):i.$F("");_g.$O.get_$Q().get_$1j().set_$4Cl(i);_h.$1z.$Kn(_g.$O.get_$Q().get_$1j().$Hl,OwaApplication.$2B)}}},$3jy:function(n,t){var o=_g.$O.get_$Q().get_$4X().get_$2et();var c=$C(o)?0:o.get_$A();var f=_g.$O.get_$Q().get_$1j().get_$4Cl();var r=$C(f)?0:f.get_$A();if(r===1&&f.get_$E(0)===""){f.$5W(0);r=0}var l=r>0?1:0;var u=new Array(1+c+r+l);var e=0;var i=_g.$O.get_$Q().get_$4X().get_$Fu();u[e++]=t(i,new _C(this.$4XN(i),this.get_$m()));for(var s=0;s<c;s++){i=o.get_$E(s).EmailAddress;u[e++]=t(i,new _C(this.$4XN(i),this.get_$m()))}if(r>0){u[e++]=new _fm.$6a;for(var h=0;h<r;h++){i=f.get_$E(h);u[e++]=t(i,new _C(this.$4XN(i),this.get_$m()))}}return u},$4XN:function(n){var t=this;return function(){_js.Trace.logInfo(_a.$0.$15,"User chose from="+n);t.$1n.$v.get_$aa().$4Fk(n,!0)}}};_mcp.$G6=function(n,t,i,r){this.$$d_$Bwa=Function.createDelegate(this,this.$Bwa);this.$$d_$9R6=Function.createDelegate(this,this.$9R6);this.$$d_$9RD=Function.createDelegate(this,this.$9RD);this.$$d_$E7O=Function.createDelegate(this,this.$E7O);this.$$d_$E7J=Function.createDelegate(this,this.$E7J);this.$$d_$DfR=Function.createDelegate(this,this.$DfR);this.$$d_$8HW=Function.createDelegate(this,this.$8HW);this.$$d_$8HX=Function.createDelegate(this,this.$8HX);this.$$d_$EXY=Function.createDelegate(this,this.$EXY);this.$$d_$EXZ=Function.createDelegate(this,this.$EXZ);this.$$d_$7Yy=Function.createDelegate(this,this.$7Yy);this.$$d_$3WY=Function.createDelegate(this,this.$3WY);this.$$d_$E7k=Function.createDelegate(this,this.$E7k);this.$$d_$E7t=Function.createDelegate(this,this.$E7t);_mcp.$G6.initializeBase(this,[7,n]);this.$LA=new _C(this.$$d_$E7t,this.get_$m());this.$1Zv=new _C(this.$$d_$E7k,this.get_$m());this.$Lu=n.$v.$Lu;this.$1G=t;this.$3a=i;this.$N=r};_mcp.$G6.prototype={$Lu:null,$1Zv:null,$1G:null,$3a:null,$N:null,$733:null,$72o:null,$LA:null,$bk:!1,$3xt:!1,$1lV:null,$2Wm:null,$3WV:null,$5g0:!1,$6lC:!1,$1Nh:null,get_$7F5:function(){return this.$1Nh?this.$1Nh.get_$7F5():null},get_$2Wk:function(){return this.$LA},set_$2Wk:function(n){this.$LA=n;return n},get_$lw:function(){return this.$bk},set_$lw:function(n){if(n!==this.$bk){this.$bk=n;this.$4("IsSending");var t=this.$1n.$v;t.set_$9pf(_u.CommonStrings.l_Sending_Text);t.set_$9jD(n)}return n},get_$DMh:function(){return this.get_$6SW()&&this.$6lC},get_$6SW:function(){return this.$3a.$2u("ComposeBread1")&&this.$v.$I.get_$U()==="Mouse"&&!this.$v.get_$3xb()&&!this.$c_2.get_$ru()&&!!this.$v.$1th&&!!this.$v.$sl},get_$72h:function(){return this.$3WV},$2wg:function(){if(this.$v.get_$4Km()&&!this.$1Nh){_js.Trace.logInfo(_a.$0.$15,"Setting send component override");this.$1Nh=this.$v.get_$4Hb().$APh();var t=this.$1n.$5k(29);var n=this.$1n.$5k(1);this.$1Nh.$3e(this.$v.get_$D1(),this.$$d_$3WY,this.$$d_$7Yy,this.$$d_$EXZ,this.$$d_$EXY,this.$$d_$8HX,this.$$d_$8HW,this.$v.$n,this.$1n.$v.$9J,n.$$d_$BtL,n.$$d_$BtJ,n.$$d_$BtI,n.$$d_$Bho,t.$$d_$A9c,t.$$d_$A26,t.$$d_$7Rk)}},$2Ek:function(){if(this.$1Nh){this.$1Nh.$AU();this.$1Nh=null}},$3e:function(){this.$2wg();var n=this.$1n.$5k(1);if(n){n.remove_$9Aj(this.$$d_$DfR);n.remove_$9Ai(this.$$d_$7Yy);n.add_$9Aj(this.$$d_$DfR);n.add_$9Ai(this.$$d_$7Yy)}_mcp.$14e.prototype.$3e.call(this)},$AU:function(){this.set_$lw(!1);this.$2Ek();_mcp.$14e.prototype.$AU.call(this)},$3WY:function(){var u=this.$1n;var i=u.$v;var n=i.$c;var r=u.$5k(8);u.$5k(25).$EWP();if(r.$GP){r.$2YV=!0;_js.Trace.logInfo(_a.$0.$15,"Send deferred due to in progress save.")}if(n.get_$OS()||n.get_$Fc()||n.get_$1ZE()){if(!r.$2YV){var o=this.$1n.$5k(1);o.$2yz();_js.Trace.logInfo(_a.$0.$15,"Send without pending saves, context:"+n.toString()+"; OriParentFolderId="+(n.get_$IU()&&n.get_$IU().get_$3G()&&_g.$b.$2K?_g.$b.$2K.idToName(n.get_$IU().get_$3G()):"null"));var t=i.$Xe.$5t8(i,1,this.$1G);_js.Trace.logInfo(_a.$0.$15,"Submitting send action");var f=_g.$1H.$1Q;_bc.$Oe.isInstanceOfType(f)&&(_h.$48.isInstanceOfType(t)?t.add_$28N(this.$$d_$E7J):_h.$2j.isInstanceOfType(t)&&t.add_$28N(this.$$d_$E7J));i.$n.$t4(t,this.$8HX(),this.$8HW(),this.$$d_$E7O);_js.Trace.logInfo(_a.$0.$15,"Send action submitted")}}else{var e=n.get_$D1();_js.Trace.logInfo(_a.$0.$15,"Send was attempted during upgrade for context "+e+", keeping the IsSending state and waiting for upgrade to finish. Upgrade component will resume send.")}},$7Yy:function(){var i=this.$1n.$v.$1d;var t=this.$1n.$v.get_$aa();var n=null;this.set_$lw(!1);if(t.$GH.get_$1Kv()||t.$GL.get_$1Kv()||t.$Gb.get_$1Kv()){i.$4r(65,null);n=_js.$1I.$Gr(_bc.InfoBarMessageId,65);this.$N.$1o(_a.$CF,new _a.$CF(_u.Strings.l_MailComposeInvalidRecipientsError_Text))}if(t.get_$4v3()){i.$4r(66,null);n=_js.$1I.$Gr(_bc.InfoBarMessageId,66)}_mcp.$3s.$Js(this.$1n);this.$7oL();n=n||"CancelSend_UnknownError";this.$lC(n,null,null)},$7oL:function(){var n=this;_js.$D.get_$Q().$2V(_a.$0.$15,"ExitResolvingRecipientsMode",function(){n.$3xt=!1},2e3)},$7St:function(n){if(n&&n.Mailbox){var r=n.Mailbox.EmailAddress;if(r!==_g.$O.get_$Q().get_$4X().get_$Fu()&&!_h.$2j.$4mU(n)){var i=_g.$O.get_$Q().get_$1j().get_$4Cl();if(!$C(i)){if(i.$5o(r))return;i.get_$A()===1&&i.get_$E(0)===""&&i.$5W(0)}var t=new(_a.$u.$$(String));t.$F(r);t.$1y6(i);t.get_$A()>_mcp.$G6.$6Xd&&t.$5W(t.get_$A()-1);_g.$O.get_$Q().get_$1j().set_$4Cl(t);_h.$1z.$Kn(_g.$O.get_$Q().get_$1j().$Hl,OwaApplication.$2B);var u=this.$1n.$5k(20);u.$4Oj(r,_mcp.$G6.$6Xd)}}},$6FO:function(n){var t;var i=_a.$4.$4o9(n.$2H);if(i==="ErrorSendAsDenied")t=80;else{var u,r;i==="ErrorRightsManagementPermanentException"&&(r=this.$Ep3(n.$2H,u={val:t}),t=u.val,r)||(t=i==="ErrorSubmissionQuotaExceeded"?47:_y.$5y.$4So(n.$2H,45,55,62,700,88,89,46,58))}return t},$8HX:function(){return this.$733||this.$$d_$9RD},$8HW:function(){return this.$72o||this.$$d_$9R6},$EXZ:function(n){this.$733=n},$EXY:function(n){this.$72o=n},$Ep3:function(n,t){var u=n.MessageXml;if(u)for(var f=Sys.Net.XMLDOM(u),r=0;r<f.firstChild.childNodes.length;r++){var i=f.firstChild.childNodes[r];if(i.nodeType===1&&_a.$3D.$rX(i)==="Value"&&_a.$3D.$8C9(i,"Name")==="HResult"&&-2147168383===Number.parseInvariant(_a.$3D.$YD(i))){t.val=48;return!0}}t.val=-1;return!1},$E7t:function(){if(this.$1Nh&&!this.$1Nh.$8VN()){_js.Trace.logInfo(_a.$0.$15,"saveComponentOverride.IsReadyForSmimeOperation() == false. Exiting SendStart().");return}_a.$6.stPT(_a.$0.$15,"MailComposeSend",5);this.$5g0=!0;this.$2Wm=_y.$2E.$1f(_a.$0.$15,"MailComposeSend",!0);this.get_$6SW()&&(this.$3WV=_y.$2E.$1f(_a.$0.$15,"MailComposeSendClose",!0));_js.Trace.logInfo(_a.$0.$15,"SendStart:Context:"+this.$c_2.toString());this.$3Ul();this.$c_2.get_$St()?this.$Dr9():this.$9Ni()},$Dr9:function(){var n=this;var t=function(t){n.$lC(_js.$1I.$Gr(_bc.InfoBarMessageId,t),null,null);n.$c_2.set_$4Hd(null);n.$7Yy();t!==-1&&n.$7Rj(_u.Strings.l_Smime_CannotSend_Text,t)};if(this.$c_2.get_$4Hd())this.$9wZ(t);else{var i=this;this.$v.get_$Egx().$AED(13,function(n){if(i.$c_2.set_$4Hd(n))i.$9wZ(t);else{t(-1);_js.Trace.logWarning(_a.$0.$52,"The send is canceled due to unavailable cert.")}})}},$9wZ:function(n){var t=new _h.$lZ(200,this.$c_2.get_$4Hd(),!0);var i=this,r=this;this.$1n.$v.$n.$t4(t,function(){_js.Trace.logInfo(_a.$0.$52,"Retrieving certs info completed.");if(t.get_$4d().IsValid)i.$9Ni();else{_js.Trace.logWarning(_a.$0.$52,"Retrieving certs info determined the certificate is INVALID.");switch(t.get_$4d().ChainValidityStatus){case 2148204809:case 2148204813:case 2148204810:case 1:n(746);break;case 2148081680:case 2148204812:n(745);break;case 2148081682:case 2148204814:case 2148081683:case 2148098052:n(743);break;default:n(744);break}}},function(){_js.Trace.logWarning(_a.$0.$52,"Retrieving certs info failed. "+t.$2H.message);n(743)},null)},$9Ni:function(){_js.Trace.logInfo(_a.$0.$15,"User chose to send, start force resolve recipients");this.$3xt=!0;var n=this.$1n.$5k(1);n.$3VK(!0)},$DfR:function(){if(this.$bk){_js.Trace.logInfo(_a.$0.$15,"Skip send since another send is in progress");return}this.set_$lw(!0);this.$3xt=!0;_js.$D.get_$Q().$1Yd(_a.$0.$15,"MailComposeSend");_js.Trace.logInfo(_a.$0.$15,"Started new task runner context before starting send.");var r=!0;try{var n;var i,t;(t=this.$CES(i={val:n}),n=i.val,t)?n?_js.Trace.logInfo(_a.$0.$15,"waiting for a pending validation decision, once decided, send will resume"):this.$7Fs():this.set_$lw(!1);r=!1}finally{if(r){this.set_$lw(!1);_js.Trace.logWarning(_a.$0.$15,"Send failed due to an unhandled exception thrown before the action was submitted");this.$lC("SendFailure_UnhandledException",null,null)}}},$7Fs:function(){this.$c_2.set_$3FQ(!1);if(this.$1Nh)this.$1Nh.$A9O();else{this.$3WY();var n=!1;if(this.get_$6SW()&&!this.$c_2.get_$3xv()){if(this.$v.$sl.get_$bo()){var i=this;this.$v.$sl.$9(function(t){t.get_$3ns()>0&&(n=!0)})}if(!n&&this.$v.$1th.get_$bo()){var r=this;this.$v.$1th.$9(function(t){t.get_$E7b()>0&&(n=!0)})}if(!n){_js.Trace.logInfo(_a.$0.$15,"Navigating away after submitting action for send via notification");this.$c_2.set_$3FQ(!0);this.$6lC=!0;this.$92v();var t=this;this.$v.$1th.$9(function(){t.$N.$1o(ISendEvent,new _mcp.$1PK(t.$v))})}}}},$CES:function(n){n.val=!1;var f=this.$1n;var r=f.$v;var t=f.$5k(1);var o=f.$5k(5);var u=r.$1d;var h=f.$5k(25);if(this.$Lu.$1EF(r.$c.get_$D1())){_js.Trace.logInfo(_a.$0.$15,"User had already discarded, skipping send.");this.$lC("InvalidToSend",null,"User has already discarded, skipping send");return!1}else if(t.get_$4v3()){_js.Trace.logInfo(_a.$0.$15,"Not valid to send since sender's address is invalid");u.$4r(66,null);_mcp.$3s.$Js(this.$1n);this.$lC("InvalidToSend",null,"Sender's address is invalid, not valid to send");return!1}else if(!r.$c.get_$1Ed()&&t.$GH.get_$Iu()&&t.$GL.get_$Iu()&&t.$Gb.get_$Iu()){_js.Trace.logInfo(_a.$0.$15,"Not valid to send since no recipients were specified");u.$4r(70,null);_mcp.$3s.$Js(this.$1n);this.$lC("InvalidToSend",null,"No recipients were specified, not valid to send");return!1}else if(t.$GH.get_$1Kv()||t.$GL.get_$1Kv()||t.$Gb.get_$1Kv()){_js.Trace.logInfo(_a.$0.$15,"Not valid to send since invalid recipients are present, IsFromRecipientInvalid={0}, InvalidTo={1}, InvalidCc={2}, InvalidBcc={3}",t.get_$4v3(),t.$GH.get_$1Kv(),t.$GL.get_$1Kv(),t.$Gb.get_$1Kv());t.$50d();u.$4r(65,null);_mcp.$3s.$Js(this.$1n);this.$lC("InvalidToSend",null,"Invalid recipients are present, not valid to send");return!1}else if(o.get_$Pz()){_js.Trace.logInfo(_a.$0.$15,"Not valid to send since attachment is in progress");var c=r.$2G;c.$44(0,_u.Strings.l_MailComposeCannotOperateWhileAttachmentInProgress_Text,null,!1,null,null,null,c.$6R);this.$lC("InvalidToSend",null,"Attachment is in progress, not valid to send");return!1}else if(_g.$O.get_$Q().get_$6Xc()<t.$21j()){u.$4r(800,null);_mcp.$3s.$Js(this.$1n);this.$lC("InvalidToSend",null,"Max recipients exceeded, not valid to send");return!1}else if(_a.$5N.$43&&h.$CDK()){_js.Trace.logInfo(_a.$0.$15,"Not valid to send since policy violation detected");var l=r.$2G;l.$44(0,h.$Bs4(),null,!1,null,null,null,l.$6R);this.$lC("InvalidToSend",null,"PolicyTip violation detected, not valid to send");return!1}else if(_js.$9.$o(this.$v.$c.get_$3n())){n.val=!0;var s=r.$2G;s.$RH(2,[_nbs.NonBootStrings.l_MailComposeForgottenSubjectMessage_Text],this.$$d_$Bwa,!1,_nbs.NonBootStrings.l_MailComposeForgottenSubjectSendAnyway_Text,_nbs.NonBootStrings.l_MailComposeForgottenSubjectDontSend_Text,_nbs.NonBootStrings.l_MailComposeForgottenSubjectTitle_Text,s.$6R);return!1}else if(o&&o.get_$9Z()&&this.$v.$1Ct)if(this.$1lV)return this.$7a6();else{n.val=!0;var i=this;this.$v.$1Ct.$9(function(n){i.$1lV=n.$7fY(i.$v.$2G,i.$LA);i.$7a6()?i.$7Fs():i.set_$lw(!1)})}else if(this.$c_2.get_$ru())if(this.$c_2.get_$ot()){_a.$3t.$44(_u.Strings.l_Smime_NotSupportedWithFromRecipientWell_Text,0);this.$lC("InvalidToSend",null,"User attempted to send an S/MIME message using the SendAs (From) feature");return!1}else if(t.get_$BzI()){_a.$3t.$44(_u.Strings.l_Smime_NotSupportedWithModernGroups_Text,0);this.$lC("InvalidToSend",null,"User attempted to send an S/MIME message to modern groups.");return!1}else if(this.$c_2.get_$EU()){var e=new(_ff.$18.$$(String));var a=this;this.$c_2.get_$EU().$Cj(function(n){_g.$54.isInstanceOfType(n)||_g.$7c.isInstanceOfType(n)||_g.$7Q.isInstanceOfType(n)||e.$F(n.get_$1x())});if(e.get_$A()>0){_a.$3t.$44(String.format(_u.Strings.l_Smime_NotSupportedWithCloudAttachments_Text,e.get_$1z().join(", ")),0);this.$lC("InvalidToSend",null,"User attempted to send an S/MIME message with cloud attachments.");return!1}}return!0},$7a6:function(){var n=this.$v.get_$eH();try{if(this.$1lV.$4pc(this.$v.$c,n.get_$9Z().get_$1l())){this.$lC("InvalidToSend",null,"Forgotten attachment detected, not valid to send");return!1}}catch(t){_js.Trace.logException(_a.$0.$15,t,"An exception has been caught for FAD check; keep sending",this.$1lV,this.$v.$c,n.get_$9Z().get_$1l())}return!0},$9RD:function(n){var o=this.$1n;var i=o.$v;var t=i.$c;var f=n.$99;_js.Trace.logInfo(_a.$0.$15,"Send action succeeded, ContextId="+f+"; Context:"+t.toString());this.$7AZ();var e=!1;var h=_g.$1H.$1Q;_bc.$Oe.isInstanceOfType(h)&&(e=!0);t.get_$3J3()&&!e&&this.$7St(t.get_$5Q());if(t.$32F&&t.$32F.length>0){var s=this.$1n.$v.$1d;s.$4r(742,t.$32F);_js.Trace.logInfo(_a.$0.$15,"Showing infobar message for Bcc forking failed");this.set_$lw(!1);i.$n.$6vZ(n);this.$lC(_js.$1I.$Gr(_bc.InfoBarMessageId,742),null,null)}else{if(f===t.get_$D1()){t.set_$T5(null);if(this.$c_2.get_$3FQ()){_js.Trace.logInfo(_a.$0.$15,"skip navigating away from compose for send via notification since the navigation was already done at send time, raise send succeeded event instead");var c=this;this.$v.$1th.$9(function(){c.$N.$1o(ISendSucceededEvent,new _mcp.$1PQ(i))})}else{_js.Trace.logInfo(_a.$0.$15,"Context match, navigating away from compose at the end of send success. ContextId="+f);this.$92v()}}else _js.Trace.logInfo(_a.$0.$15,"Context does not match, skipping navigating away from compose.");this.$6S("MailSendSucceeded");var u=!i.get_$eH()||!i.get_$eH().get_$9Z()?null:i.get_$eH().get_$9Z().$BiP();var r=this.$BjY(t);r?u&&(r=r+"|"+u):r=u;this.$AlC(r)}this.$N.$1o(_a.$CF,new _a.$CF(_nbs.NonBootStrings.l_MailComposeSendComponent_AT_LiveRegion_Text))},$92v:function(){var t=this.$1n;var n=t.$v;var i=t.$5k(2);n.set_$1Ea(!0);i.get_$5F().$2SG(n,!0)},$9R6:function(n){var r=this.$1n.$v;var t=r.$c;var f=n.$99;_js.Trace.logInfo(_a.$0.$15,"Send action failed, ContextId="+f+"; Context:"+t.toString());var i="SendFailure_UnknownError";var u="";if(_g.$4k.$1dV(n.$2H)){i=_g.$4k.$2Kq(n.$2H);u=n.$2H.FaultMessage}if(f===t.get_$D1()){if(t.get_$1x0()&&t.get_$1x0().length>0){var o=this.$1n.$v.$1d;o.$4r(65,t.get_$1x0())}this.set_$lw(!1);_js.Trace.logInfo(_a.$0.$15,"Context match. Showing infobar message for ResponseCode="+i);this.$5if(n);if(this.$c_2.get_$3FQ()){_js.Trace.logInfo(_a.$0.$15,"Raise send failed event for send via notification");t.set_$9R7(this.$6FO(n));var e=this;this.$v.$sl.$9(function(){e.$N.$1o(ISendFailedEvent,new _mcp.$1PL(r))})}}else _js.Trace.logInfo(_a.$0.$15,"Context does not match. Skip showing infobar message for ResponseCode="+i);this.$lC(i,this.$FG(n),u);r.$n.$6vZ(n)},$E7O:function(n){this.$4cA();this.$8Mk()&&this.$N.$1o(_y.$ts,new _y.$ts(6))},$8Mk:function(){return this.$3a.$2u(_mcp.$G6.$8ac)||_a.$2B.$4of(window.location.href,"survey")==="1"?!0:!1},$FG:function(n){var t=null;_h.$49.isInstanceOfType(n)&&n.$67?t=n.$67.correlationId:_h.$48.isInstanceOfType(n)&&n.$67&&(t=n.$67.correlationId);return t},$E7k:function(){this.$1n.$v.get_$5yb()&&this.$LA.$3r&&this.$LA.$11()},$7AZ:function(){var t=this.$v.get_$aa();var n=this.$v.get_$eH();_js.Trace.logInfo(_a.$0.$15,"Check to see if we have attachments to set permissions for");n.get_$9Z()&&n.get_$9Z().get_$4pn()&&n.get_$9Z().$9ey(t.$Bhn())},$BjY:function(n){if(!n)return null;var r=n.get_$6P()==="HTML"?"html":"text";var i;i=n.get_$6W()===1||n.get_$6W()===2||n.get_$6W()===3?n.get_$OS()?"yes":"no":"na";var u=n.$51w;var t=new _a.$3z;t.$CW("BT",r);t.$CW("U",i);t.$5H("S",u);t.$5H("O",n.get_$6W());return t.toString()},$lC:function(n,t,i){if(this.$2Wm){_y.$2E.$1F(this.$2Wm,null,n,t,i);this.$2Wm=null}if(this.$3WV){_y.$2E.$1F(this.$3WV,null,n,t,i);this.$3WV=null}this.$4cA()},$AlC:function(n){if(this.$2Wm){_y.$2E.$1F(this.$2Wm,null,null,null,n);this.$2Wm=null}},$4cA:function(){if(this.$5g0){_a.$6.endPT("MailComposeSend");this.$5g0=!1}},$Bwa:function(n,t){n&&this.$7Fs()},$E7J:function(n){var i=this.$1n;var r=i.$v;var t=r.$c;_h.$2j.isInstanceOfType(n)&&n.remove_$28N(this.$$d_$E7J);_h.$48.isInstanceOfType(n)&&n.remove_$28N(this.$$d_$E7J);t.get_$3J3()&&this.$7St(t.get_$5Q())}};_mcp.$1Ky=function(n){this.$$d_$A26=Function.createDelegate(this,this.$A26);this.$$d_$A9c=Function.createDelegate(this,this.$A9c);this.$$d_$7Rk=Function.createDelegate(this,this.$7Rk);_mcp.$1Ky.initializeBase(this,[29,n])};_mcp.$1Ky.prototype={$A26:function(n,t){this.$7Rj(n,t)},$7Rk:function(n){this.$3fe(n)},$AED:function(n,t){var e=this;var f=function(i){_js.Trace.logWarning(_a.$0.$52,i.message);if(_a.$2f.$1UB(i)){_a.$2f.$1HQ(i,n);e.$3fe(i);t(null)}else{_js.Trace.logException(_a.$0.$52,i,"An error occurred when choosing cert.");throw i;}};try{var i=_a.$c.$49b(!0,!0,!1,!1,!1);if(i)if(_a.$2f.$3yf(i))this.$3fe(i);else throw i;_js.Trace.logInfo(_a.$0.$52,"S/MIME choosing a cert...");var r;var u=_g.$O.get_$Q();r=u.get_$VP().AllowUserChoiceOfSigningCertificate&&u.get_$1j().get_$2np()?u.get_$1j().get_$2Yr():null;_js.Trace.logInfo(_a.$0.$52,"Choosing a cert. KeyIdentifier={0}",r);var s=this;_a.$c.$19x.$6HK(r,function(n){var i=JsonParser.deserialize(n);i.ErrorCode?f(_a.$2f.$9("No certificate was found.",i.ErrorCode)):t(i.Data)})}catch(o){f(o)}},$A9c:function(n,t,i,r){var c=_g.$O.get_$Q().get_$VP();var l=_g.$O.get_$Q().get_$1j();var e=this.$Bpr(t,this.$c_2.get_$St(),this.$c_2.get_$PO());e=e||"SMIMEComposeUndefinedCtq";var d=_a.$6.$1f(_a.$0.$52,e,!0);var nt=this.$c_2.get_$6W();var it=this.$c_2.get_$5j();var y=c.AlwaysSign;var p=c.AlwaysEncrypt;var w=l.get_$2Yy();var v=l.get_$2Yw();var h=c.ClearSign;var s=c.TripleWrapSignedEncryptedMail;var ht=this;var st=function(n){_a.$6.$1F(d,e,"",null,ht.$7XH(nt,it,y,p,w,v,h,s));$C(i)||i(n)};var ot=this;var tt=function(n){_a.$6.$1F(d,e,n.message,null,ot.$7XH(nt,it,y,p,w,v,h,s));$C(r)||r(n)};try{_js.Trace.logInfo(_a.$0.$52,"Building S/MIME data package...");_js.Trace.logInfo(_a.$0.$52,"Admin.AlwaysEncrypt="+p);_js.Trace.logInfo(_a.$0.$52,"Admin.AlwaysSign="+y);_js.Trace.logInfo(_a.$0.$52,"Admin.IsClearSign="+h);_js.Trace.logInfo(_a.$0.$52,"Admin.TripleWrap="+s);_js.Trace.logInfo(_a.$0.$52,"User.AlwaysEncrypt="+v);_js.Trace.logInfo(_a.$0.$52,"User.AlwaysSign="+w);_js.Trace.logInfo(_a.$0.$52,"User.SigningCert="+l.get_$2xS());_js.Trace.logInfo(_a.$0.$52,"User.SigningCertId="+l.get_$2Yr());_js.Trace.logInfo(_a.$0.$52,"Context.Encrypt="+this.$c_2.get_$PO());_js.Trace.logInfo(_a.$0.$52,"Context.Sign="+this.$c_2.get_$St());var f;if(t===2&&this.$c_2.get_$PO()){var u=this.$v.get_$aa();var k=u.$NE?u.$GH.$5X.$GZ:u.$GH.$R5.get_$xO();var b=u.$NE?u.$GL.$5X.$GZ:u.$GL.$R5.get_$xO();var g=u.$NE?u.$Gb.$5X.$GZ:u.$Gb.$R5.get_$xO();var at=k?k.get_$A():0;var lt=b?b.get_$A():0;var ct=g?g.get_$A():0;var a=at+lt;f=this.$c_2.$1ht?this.$c_2.$1ht===1?this.$c_2.$4oQ(0,a):this.$c_2.$1ht===2?this.$c_2.$4oQ(a+this.$c_2.$3k8,1):this.$c_2.$1ht===3?this.$c_2.$4oQ(a,ct):null:this.$c_2.get_$9lV()}else f=null;var rt=this.$1kC();var et=JsonParser.serialize(rt.get_$Ad());var ft=f?JsonParser.serialize(f):null;var o;if(!this.$c_2.get_$St()&&this.$c_2.get_$PO())o=6;else if(this.$c_2.get_$St()&&!this.$c_2.get_$PO())o=h?11:10;else if(this.$c_2.get_$St()&&this.$c_2.get_$PO())o=s?14:12;else throw Error.invalidOperation("The context is not in S/MIME mode.");var ut=this;_a.$c.$19x.$APv(o,et,ft,this.$c_2.get_$4Hd(),function(t){ut.$Aky(t,n,st,tt)})}catch(vt){this.$7op(vt,tt)}},$1kC:function(){var n=new _g.$5w;n.set_$4n(this.$c_2.$7ec());n.get_$4n().get_$6P()==="HTML"&&n.get_$4n().set_$1Z(_a.$37.$6y1(n.get_$4n().get_$1Z(),!0));this.$DsT(n,this.$v.get_$eH().get_$9Z().get_$1l());n.set_$5Q(new _g.$8v);n.get_$5Q().Mailbox=this.$c_2.$3rz();if(!n.get_$5Q().Mailbox){var t=_g.$O.get_$Q().get_$4X();n.get_$5Q().Mailbox=new _g.$1K;n.get_$5Q().Mailbox.Name=t.get_$Lh();n.get_$5Q().Mailbox.EmailAddress=t.get_$Fu()||t.get_$s4();n.get_$5Q().Mailbox.MailboxType="Mailbox";n.get_$5Q().Mailbox.RoutingType="SMTP"}n.set_$77(new(_a.$u.$$(_g.$1K)));this.$c_2.get_$77()&&n.get_$77().$3x(this.$c_2.get_$77().$3T());n.set_$7x(new(_a.$u.$$(_g.$1K)));this.$c_2.get_$7x()&&n.get_$7x().$3x(this.$c_2.get_$7x().$3T());n.set_$3n(this.$c_2.get_$3n());n.set_$Bv(this.$c_2.get_$Bv());n.set_$ER(this.$c_2.get_$ER());n.set_$16r(_a.$8.get_$36());n.set_$Q1(this.$c_2.get_$Q1());n.set_$Qk(this.$c_2.get_$Qk());if(n.set_$a4(this.$c_2.get_$a4())){n.set_$1xa(this.$c_2.get_$1xa());n.set_$l1(this.$c_2.get_$l1());n.set_$gv(this.$c_2.get_$gv());n.set_$eR(this.$c_2.get_$eR())}return n},$DsT:function(n,t){if(t&&t.get_$A()){var i=new(_a.$2T.$$(_g.Attachment,_g.$Bf));var f=new(_ff.$18.$$(_y.$OS));var s=this;t.$Cj(function(t){var o=t;var r=o.get_$9M();if(r.get_$2mO()){_js.Trace.logInfo(_a.$0.$52,"Skipping SmimeDataPackage.");return}if(!(_g.$54.isInstanceOfType(r)||_g.$7c.isInstanceOfType(r)||_g.$7Q.isInstanceOfType(r))){_js.Trace.logWarning(_a.$0.$52,"S/MIME only supports FileAttachment, ItemAttachment, and ItemIdAttachment. The attachment {0} is ignored.",r.get_$1x());return}if(n.get_$4n().get_$6P()==="HTML"&&r.get_$C9()&&n.get_$4n().get_$1Z().indexOf(r.get_$SA())<0){_js.Trace.logInfo(_a.$0.$52,"Removing unreferenced inline attachment: {0}",r.get_$SA());f.$F(o);return}if(_g.$7Q.isInstanceOfType(r)){var e=r;var u=new _g.$7c;u.set_$1x(e.get_$1x());u.set_$KK(e.get_$KK()||"message/rfc822");u.set_$8A(e.get_$8A());u.set_$c0(e.get_$c0());i.$F(u)}else i.$F(r)});for(var u=f.get_$1z(),e=u.length,r=0;r<e;++r){var o=u[r];this.$v.get_$eH().get_$9Z().$1Wv(o,!1)}n.set_$1l(i.get_$A()>0?i:null)}},$Aky:function(n,t,i,r){var u=JsonParser.deserialize(n);if(u.ErrorCode){var f=_a.$2f.$1HQ(_a.$2f.$9("Cannot encode the message.",u.ErrorCode),15);this.$7op(f,r)}else{_js.Trace.logInfo(_a.$0.$52,"S/MIME data package built successfully.");this.$c_2.set_$9lU(u.Data);i(t)}},$7op:function(n,t){_js.Trace.logWarning(_a.$0.$52,n.message);if(_a.$2f.$1UB(n))this.$3fe(n);else{_js.Trace.logException(_a.$0.$52,n,"Unknown error occurred when building data package.");n=_a.$2f.$1HQ(_a.$2f.$9(n.message,11),15);this.$3fe(n)}t(n)},$7XH:function(n,t,i,r,u,f,e,o){var s=new _a.$3z;s.$CW("O",_y.$1m.toString(n));s.$CW("M",_y.$Ow.toString(t));s.$Ij("AS",i);s.$Ij("AE",r);s.$Ij("UAS",u);s.$Ij("UAE",f);s.$Ij("CS",e);s.$Ij("TW",o);return s.toString()},$Bpr:function(n,t,i){var r=null;t&&!i?n===2?r="SMIMESendSign":n===3&&(r="SMIMESaveSign"):!t&&i?n===2?r="SMIMESendEncrypt":n===3&&(r="SMIMESaveEncrypt"):t&&i&&(n===2?r="SMIMESendSignAndEncrypt":n===3&&(r="SMIMESaveSignAndEncrypt"));return r}};_mcp.$1Kx=function(n,t){_mcp.$1Kx.initializeBase(this,[23,n]);this.$l=t};_mcp.$1Kx.prototype={$l:null,$3e:function(){if(!this.get_$G6()&&this.$l.get_$5e().get_$Fa().get_$5ZO()===2&&this.$l.get_$15K().get_$EZ3().get_$Bzb()){var n=this.$1n.$5k(5);_mcp.$MY.$3IA(this.$1n.$v)&&!$C(n)&&($C(n.get_$9Z())||n.get_$9Z().$A3L())}_mcp.$14e.prototype.$3e.call(this)}};_mcp.$G7=function(n,t){this.$$d_$7Sy=Function.createDelegate(this,this.$7Sy);_mcp.$G7.initializeBase(this,[12,n]);this.$4Oz=new _C(this.$$d_$7Sy,this.get_$m());this.$1G=t;this.$1D=_a.UserAgent.getInstance();this.$6K=_a.$6i.$9()};_mcp.$G7.$6HJ=function(n,t){return t?n.get_$1Hc():n.get_$1YS()};_mcp.$G7.prototype={$4Oz:null,$1G:null,$4HK:null,$7CH:!1,$1D:null,$6K:null,set_$7El:function(n){if(this.$4HK!==n){this.$4HK=n;this.$4("Signature")}return n},set_$XV:function(n){this.$7CH=n;this.$4("ShouldAutoAddSignature");return n},$3e:function(){if(this.$1n.$v.$c.get_$XV()&&this.$AB1()){_a.$6.stPT(_a.$0.$15,"MailComposeAutoSig",5);var n=_a.$6.$1f(_a.$0.$15,"MailComposeAutoSig",!0);this.set_$XV(!0);this.$7Sy(!0);_a.$6.$1F(n);_a.$6.endPT("MailComposeAutoSig");_js.Trace.logInfo(_a.$0.$15,"Signature has been automatically added due to: contextAutoFlag=true, userOptionAutoFlag=true")}_mcp.$14e.prototype.$3e.call(this)},$Bid:function(){var n=this.$1D.get_$De()?"<P></P>":"<P><BR></P>";return n+n},$AB1:function(){var n=_g.$O.get_$Q().get_$1j();return"Mouse"===_y.$z.$1Q.get_$U()?n.get_$qW():this.$1D.get_$8Z()?this.$6K.$63("MOWA.IsSignatureChanged")==="true"?this.$6K.$63("MOWA.AutoAddSignature")==="true":!0:n.get_$1Pd()},$7YI:function(n,t){if("Mouse"===_y.$z.$1Q.get_$U())return _mcp.$G7.$6HJ(n,t);if(this.$1D.get_$8Z()){if(this.$6K.$63("MOWA.IsSignatureChanged")==="true")if(this.$6K.$63("MOWA.UseDesktopSignature")==="true")return _mcp.$G7.$6HJ(n,t);else{var r=this.$6K.$63("MOWA.SignatureText")||"";return t?_a.$1J.$1y5(r):r}return t?_a.$1J.$1y5(_c.$MG.$4nZ(this.$1D)):_c.$MG.$4nZ(this.$1D)}if(n.get_$1IL())return _mcp.$G7.$6HJ(n,t);else{var i=n.get_$1YT()||"";return t?_a.$1J.$1y5(i):i}},$7Sy:function(n){var o=null;var a=this.$1n.$5k(27);var c=this.$1n.$v.$c;var h=_g.$O.get_$Q().get_$1j();if(n)c.set_$6Ov(!0);else{_a.$6.stPT(_a.$0.$15,"MailComposeInsertSig",3);o=_a.$6.$1f(_a.$0.$15,"MailComposeInsertSig",!0)}var t=c.get_$6P()==="HTML"&&this.$1G.get_$NB();if(t){var r=this.$7YI(h,t);if(_js.$9.$o(r))_js.Trace.logInfo(_a.$0.$15,"Skipping inserting blank signature in HTML format.");else{var l='<DIV id = "Signature">';var v="</DIV>";var y=n?this.$Bid():_mcp.$G7.$9lD;var e=y+l+r.replace(_mcp.$G7.$9Ju," ")+v;_js.Trace.logInfo(_a.$0.$15,"Insert signature for mouse html OriSig="+r+"; FormattedSig="+e);this.set_$7El(e)}}else{var u=this.$7YI(h,t);if(_js.$9.$o(u))_js.Trace.logInfo(_a.$0.$15,"Skipping inserting blank signature in text format.");else{var f="\n\n"+u;_js.Trace.logInfo(_a.$0.$15,"Insert signature for touch text OriSig="+u+"; FormattedSig="+f);this.set_$7El(f)}}var s=!_js.$9.$o(this.$4HK);if(s){var i=new _cmc.$MU(0,this.$4HK,t);i.$28E=!0;i.$2z0=!1;a.set_$Nb(i)}else _js.Trace.logInfo(_a.$0.$15,"Skip insert signature due to HasSignature="+s+";");if(!n){_a.$6.$1F(o);_a.$6.endPT("MailComposeInsertSig")}}};_mcp.$ub=function(n,t,i){this.$$d_$3sq=Function.createDelegate(this,this.$3sq);this.$$d_$2W3=Function.createDelegate(this,this.$2W3);this.$$d_$6KN=Function.createDelegate(this,this.$6KN);this.$$d_$5wf=Function.createDelegate(this,this.$5wf);this.$$d_$4Bs=Function.createDelegate(this,this.$4Bs);this.$$d_$9jY=Function.createDelegate(this,this.$9jY);this.$$d_$EY4=Function.createDelegate(this,this.$EY4);_mcp.$ub.initializeBase(this,[11,n]);this.$5a=new _C(this.$$d_$9jY,this.get_$m());this.$3a=t;this.$1G=i};_mcp.$ub.$AJm=function(n){if(OwaApplication.$Ou)return null;var t=n.$5k(24);return new _y.$1P(_y.$U.get_$2dB(),_y.$U.get_$7V7(),_u.CommonStrings.l_AppsTouch_Text,t.$15N)};_mcp.$ub.prototype={$5a:null,$1aZ:null,$1o6:!1,$3a:null,$1G:null,$6Nr:!1,get_$5qo:function(){return this.$1aZ},set_$5qo:function(n){if(n!==this.$1aZ){this.$1aZ=n;this.$4("CloseConfirmDialogButtonData")}return n},get_$2NG:function(){return this.$1o6},set_$2NG:function(n){if(n!==this.$1o6){this.$1o6=n;this.$4("IsCloseConfirmDialogShown")}return n},set_$C6u:function(n){if(n!==this.$6Nr){this.$6Nr=n;this.$4("IsAppBarSetup")}return n},$EY4:function(){var i=this.$1n;var u=i.$v.$c;_js.Trace.logInfo(_a.$0.$15,"Setup appbar menu. Context: "+u.toString());var n=new(_ff.$18.$$(_y.$2Y));var t=i.$5k(1);_g.$O.get_$Q().get_$1j().get_$1Ie()?n.$F(t.get_$6KI()):n.$F(t.get_$7DC());if(u.get_$3J3())if(_g.$O.get_$Q().get_$1j().get_$tN()){n.$F(t.get_$4qT());t.$2OS=!1}else{n.$F(t.get_$3a9());t.$2OS=!0}else t.$2OS=!1;OwaApplication.$Ou||n.$F(new _y.$2Y(_nbs.NonBootStrings.l_CheckNamesMenuItem_LowerCase_Text,t.$1NR));var e=i.$5k(6);n.$F(e.$tP);var r=i.$5k(3);if(r.$tP&&r.$5pF()){n.$F(r.$tP);r.$2Nc=!0}else r.$2Nc=!1;var f=i.$5k(10);n.$F(new _y.$2Y(_nbs.NonBootStrings.l_ShowMessageOptions_Text,f.$3aH));i.$v.$5w.set_$vV(n.get_$1z());this.set_$C6u(!0)},$3e:function(){var t=this.$1n;var n=t.$v;var i=n.$c;_js.Trace.logInfo(_a.$0.$15,"InitTouchComponent:Context:"+i.toString());n.$5w||this.$2FQ();t.$5k(23);_mcp.$14e.prototype.$3e.call(this)},$3sq:function(n,t){if(this.$1n.$v.$1db)return!1;else if(this.$7CK()){this.$1o6||this.$9jY();return!0}else if(this.$1n.$v.$c.get_$1LY()&&!this.$lw()){_js.Trace.logInfo(_a.$0.$15,"Removing unedited reply forward draft if user clicks outside the form.");this.$5wf();return!0}else{this.$1n.$v.set_$1Ea(!0);var r=this.$1n;var i=r.$5k(2);i&&i.get_$5F()&&i.get_$5F().set_$3IV(!0);return!1}},$lw:function(){var n=this.$1n.$5k(7);return n.$bk},$2FQ:function(){var t=this.$1n;var f=t.$v;var o=f.$c;var l=t.$5k(7);var c=new _y.$1P(_y.$U.get_$wd(),_y.$U.get_$4Cp(),_u.CommonStrings.l_SendItemMobile_Text,l.$LA);var h=_y.$1P.$SB(_nbs.NonBootStrings.l_Close1_Text,this.$5a);var u=_mcp.$ub.$AJm(t);var r=this.$AMq(o,t);var e=2;e+=u?1:0;e+=r?1:0;var n=new Array(e);var i=0;n[i++]=c;u&&(n[i++]=u);n[i++]=h;r&&(n[i++]=r);_js.Trace.logInfo(_a.$0.$15,"Creating appbar. ContextId="+o.get_$D1());var s=_y.$1i.$FB(f,n,null);s.set_$3Hn("TouchNarrow"===_y.$z.$1Q.get_$U());f.$ETd(s)},$9jY:function(){var t=this.$1n;var i=t.$v;var n=i.$c;_js.Trace.logInfo(_a.$0.$15,"User hit close, decide whether to show the confirm dialog. Context:"+n.toString());if(this.$lw()){_js.Trace.logInfo(_a.$0.$15,"Skipping close since send is in progress. This is considered a corner case since going to local store should be quick. If this occurs frequently, an UX solution is needed.");return}if(this.$7CK()){this.$9iI();_js.Trace.logInfo(_a.$0.$15,"Toggle IsCloseConfirmDialogShown flag to show the dialog.");this.set_$2NG(!0)}else if(n.get_$1LY()){_js.Trace.logInfo(_a.$0.$15,"Removing unedited reply forward draft on close.");this.$5wf()}else{_js.Trace.logInfo(_a.$0.$15,"Navigate away due to unmodified message.");this.$266()}},$6KN:function(){_js.Trace.logInfo(_a.$0.$15,"Hide close confirm dialog");this.set_$2NG(!1)},$9iI:function(){if($C(this.$1aZ)){_js.Trace.logInfo(_a.$0.$15,"Create close confirm dialog.");var n=new _js.$X;OwaApplication.$Ou||n.$F(new _ff.$1l(new _C(this.$$d_$4Bs,this.get_$m()),_u.CommonStrings.l_ConfirmDialog_Save_Text,_nbs.NonBootStrings.l_SaveConfirmDialogButtonDescription_Text));n.$F(new _ff.$1l(new _C(this.$$d_$5wf,this.get_$m()),_u.Strings.l_ConfirmDialog_Discard_Text,_u.Strings.l_DeleteConfirmDialogButtonDescription_Text));n.$F(new _ff.$1l(new _C(this.$$d_$6KN,this.get_$m()),_bcs.BootCommonStrings.l_ConfirmDialog_Cancel_Text,_u.Strings.l_ReturnToMessageForEditing_Text));this.set_$5qo(n)}},$4Bs:function(){_js.Trace.logInfo(_a.$0.$15,"User select save and close");var n=this.$1n;n.$v.set_$1Ea(!0);this.$6KN();var t=n.$5k(8);t.$7NO(this.$$d_$2W3)},$2W3:function(n){this.$266()},$5wf:function(){_js.Trace.logInfo(_a.$0.$15,"User select discard and close");var n=this.$1n;n.$v.set_$1Ea(!0);this.$6KN();var t=n.$5k(21);t.$5xv()},$266:function(){var n=this.$1n;n.$v.set_$1Ea(!0);var t=n.$5k(2);t.get_$5F().$2SG(n.$v,!1)},$AMq:function(n,t){if(n.get_$3tm())return null;var i=new(_ff.$18.$$(_y.$2Y));var f=t.$5k(5);var u=f.$8Br();if(u&&u.length>0)for(var e=u,h=e.length,r=0;r<h;++r){var c=e[r];i.$F(c)}if(!OwaApplication.$Ou){var o=t.$5k(12);i.$F(new _y.$2Y(_nbs.NonBootStrings.l_InsertSignatureMenuItem_LowerCase_Text,o.$4Oz));if(this.$3a&&(this.$3a.$2u("iOSSharePointRichTextEditor")&&_a.UserAgent.getInstance().get_$JK()||this.$3a.$2u("AndroidCED")&&_a.UserAgent.getInstance().$YH)&&this.$1G.get_$NB()&&_a.UserAgent.getInstance().get_$8Z()){f=t.$5k(5);this.$1n.$v.$c.get_$6P()==="HTML"&&i.$F(new _y.$2Y(_nbs.NonBootStrings.l_LocationSubmenuItem_LowerCase_Text,f.get_$8PK()))}}if(OwaApplication.$Ou&&i.get_$1z().length===1){var s=i.get_$1z()[0];return new _y.$1P(_y.$U.get_$1PY(),_y.$U.get_$4RV(),_u.CommonStrings.l_IncludeMenuButtonText_Text,s.get_$Z2())}else return new _y.$1P(_y.$U.get_$1PY(),_y.$U.get_$4RV(),_u.CommonStrings.l_IncludeMenuButtonText_Text,null,i.get_$1z())}};_mcp.$1L0=function(n,t,i){this.$$d_$9CC=Function.createDelegate(this,this.$9CC);this.$$d_$7aP=Function.createDelegate(this,this.$7aP);this.$$d_$Dka=Function.createDelegate(this,this.$Dka);this.$$d_$ADv=Function.createDelegate(this,this.$ADv);this.$$d_$7cS=Function.createDelegate(this,this.$7cS);this.$$d_$DSV=Function.createDelegate(this,this.$DSV);_mcp.$1L0.initializeBase(this,[13,n]);this.$Lu=this.$1n.$v.$Lu;this.$1G=t;this.$3a=i};_mcp.$1L0.prototype={$Lu:null,$1G:null,$3a:null,$6UY:null,$2bD:null,$2T4:null,$7Mw:null,$7Mu:null,$7Mx:null,$4VL:null,$3di:null,$4L2:!1,get_$7cK:function(){this.$4VL||(this.$4VL=new _C(this.$$d_$DSV,_a.$0.$15));return this.$4VL},get_$9jA:function(){var n=this.$1n.$v.$c;return this.get_$2O0()&&!n.get_$2lt()},get_$8X4:function(){var n=this.$1n.$v.$c;return this.get_$2O0()&&n.get_$2lt()&&!this.$3di&&!n.get_$1ZE()},get_$2O0:function(){return!1},get_$CBb:function(){return this.get_$9jA()||this.get_$8X4()},$3e:function(){if(this.get_$2O0()){var t=this.$1n;var n=t.$v.$c;if(n.get_$2lt()&&n.get_$1ZE()){_js.Trace.logInfo(_a.$0.$dO,"initializing upgrade component, user requested upgrade and upgrade failed, show the failure message");this.$7Db();_mcp.$3s.$Js(t)}}_mcp.$14e.prototype.$3e.call(this)},$A89:function(){_a.$6.stPT(_a.$0.$15,"MailComposeUpgrade",3);this.$2bD=_y.$2E.$1f(_a.$0.$15,"MailComposeUpgrade",!0);var i=this.$1n.$v;var n=i.$c;var u=n.get_$D1();this.$6UY=u;if(!n.get_$OS()){if(!this.get_$2O0()){var f=this;_js.$D.get_$Q().$2V(_a.$0.$15,"ShowUpgradeMessage",function(){n.get_$OS()||n.get_$1ZE()||u!==f.$6UY||f.$7Ed(i.$1d)},5e3)}var t;t=this.$1G.get_$NB()||n.get_$6P()!=="HTML"?n.get_$6P()==="Text"?_h.$f.get_$3L6():_h.$f.get_$24B():_h.$f.get_$6We();if(t===_h.$f.get_$24B()||t===_h.$f.get_$6We()){t.BlockExternalImages=n.get_$IU().get_$uy();t.FilterHtmlContent=n.get_$IU().get_$uy()}var r=i.$Xe.$7gt(n,t,this.$1G);n.get_$6W()===12&&(r.$14o=new _g.$8b(new _g.$7P("internalsubmission")));r.add_$28N(this.$$d_$7cS);_js.Trace.logInfo(_a.$0.$dO,"Begin upgrade, context:"+n.toString()+"; OriParentFolderId="+(n.get_$IU()&&n.get_$IU().get_$3G()&&_g.$b.$2K?_g.$b.$2K.idToName(n.get_$IU().get_$3G()):"null"));r.$Ho="MailComposeUpgrade";if(n.get_$8Uj()){var e=new _mcp.$sG(r);i.$n.$t4(e,this.$$d_$ADv,this.$$d_$Dka,null)}else i.$n.$t4(r,this.$$d_$7aP,this.$$d_$9CC,null)}},$ADv:function(n){var t=n;this.$7aP(t.$1kE)},$Dka:function(n){var i=n;var t=i.$1kE;this.$9CC(t);this.$9JT(n.$2H,t.$99,t.$67?t.$67.correlationId:null,this.$1n.$v.$c)},$7aP:function(n){var s=this.$1n;var e=s.$v;var r=e.$c;var t=n;var c=s.$5k(21);var u=t.$5i;var i=n.$99;var o=t.$67?t.$67.correlationId:null;var l=!!t.$MD;if(this.$Lu.$1EF(i)){_js.Trace.logInfo(_a.$0.$dO,"Check upgrade callback, resume discard for context "+i);c.$5N0(i,u)}else if(i===r.get_$D1()){r.set_$Fc(u);_js.Trace.logInfo(_a.$0.$dO,"Context match, updated the draft id. Context:"+r.toString()+"; ResponseMessageBodyType="+(l&&t.$MD.get_$4n()?t.$MD.get_$4n().get_$6P():"null"));var f=e.get_$1X8();var h=e.get_$iD();if(!f.$GP&&h.$bk){_js.Trace.logInfo(_a.$0.$dO,"Skipping upgrade for contextId "+i+" since send was triggered during upgrade");this.$4AU("SkipUpgrade",o,"Skip upgrade since send is in progress");h.$3WY();return}if(f.$GP&&f.$2YV){_js.Trace.logInfo(_a.$0.$dO,"Skipping upgrade for contextId "+i+" since save and then send was triggered during upgrade");this.$4AU("SkipUpgrade",o,"SkipUpgrade since saving is in progress");f.$5N3();return}}if(t.$MD){_js.Trace.logInfo(_a.$0.$dO,"Check upgrade, action has response message, call complete upgrade. context: "+r.toString()+"; ActionItemId="+_h.$D0.$1cu(u));this.$7cS(n)}else if(n.$99===r.get_$D1()){_js.Trace.logInfo(_a.$0.$dO,"Check upgrade: action has id only, updated draft id. context: "+r.toString()+"; ActionItemId="+_h.$D0.$1cu(u));this.$7mp()}},$AGj:function(n){n.$6S4()&&this.$1n.$v.$1d.$4r(3050)},$7cS:function(n){var o=this.$1n;var r=o.$v;var t=r.$c;var i=n;var c=i.$67?i.$67.correlationId:null;var e=n.$99;i.remove_$28N(this.$$d_$7cS);if(e===t.get_$D1()){t.set_$ix(i.$MD);this.$3di=i.$MD;t.$EtU(i.$MD.get_$Bv());try{if(this.get_$2O0())if(t.get_$2lt()){_js.Trace.logInfo(_a.$0.$dO,"upgrade returned success, user already requested for upgrade, merge body and remove spinner");this.$5rV();this.$3h("IsWaitingForQuotedBody","IsOnDemandUpgradePending");_mcp.$3s.$Js(o)}else this.$4L2=!0;else this.$5rV();i.$MD.get_$1l()&&t.set_$EU(i.$MD.get_$1l().get_$7U());var s=r.get_$eH();s.$iW()}finally{t.set_$OS(this.$4L2);t.get_$OS()&&r.$1d.$9T(3440);_js.Trace.logInfo(_a.$0.$dO,"IsUpgraded for context is "+t.get_$OS())}this.$AGj(t);_mcp.$3s.$Js(this.$1n);_js.Trace.logInfo(_a.$0.$dO,"Complete upgrade context:"+t.toString());var u=r.get_$1X8();if(u.$GP)u.$5N3();else if(_a.$5N.$43){var f=this.$1n.$5k(25);var h=this;_js.$D.get_$Q().$6F(_a.$0.$15,"TriggerPolicyTipsIfNeeded",function(){f&&f.$2BC(32)})}r.$N.$1o(_y.$13O,new _mcp.$1L1(t.get_$ix().get_$y().Id,r))}else _js.Trace.logInfo(_a.$0.$dO,"MailComposeUpgrade failed since user switched view model context. ContextId="+e+"; Context="+t.toString())},$DSV:function(){this.$2T4=_y.$2E.$1f(_a.$0.$15,"MailComposeOnDemandUpgrade",!0);var n=this.$1n.$v.$c;n.set_$2lt(!0);if(this.$3di){_js.Trace.logInfo(_a.$0.$dO,"user requests for quoted body, upgrade was successful, complete the body merge");this.$5rV();this.$3h("ShouldShowQuoteBodyButton","IsOnDemandUpgradePending")}else if(n.get_$1ZE()){_js.Trace.logInfo(_a.$0.$dO,"user requests for quoted body, upgrade failed, show error message");this.$3h("ShouldShowQuoteBodyButton","IsOnDemandUpgradePending");this.$7Db();_mcp.$3s.$Js(this.$1n);this.$7mx()}else{_js.Trace.logInfo(_a.$0.$dO,"user requests for quoted body, upgrade has yet to come back, show spinner");this.$3h("ShouldShowQuoteBodyButton","IsWaitingForQuotedBody")}},$5rV:function(){var n=this.$1n.$v.$c;var r=!1;if(this.$1G.get_$pm()){if(n.get_$T5()){n.$Vx.$11();n.get_$MT()===n.get_$T5().get_$MT()&&(r=!0)}else n.$5Bd=!0;n.$4uM=!0}var f=this.$1n.$5k(27);this.$4L2=!1;if(this.$1G.get_$NB()||n.get_$6P()!=="HTML"){var t=this.$3di.get_$4n().get_$1Z();n.set_$1gD(!this.$1G.get_$pm()&&n.get_$6P()==="Text"?_a.$1J.$AIs(t):t)}else n.set_$1gD(this.$3di.get_$Ml().get_$1Z());var i=new _cmc.$1Kq(n.get_$1gD());try{f.set_$Nb(i)}finally{this.$4L2=i.$7OO}if(r){n.$Vx.$11();n.get_$T5().set_$MT(n.get_$MT());var u=n.$jS;u&&n.$jS.set_$MT(n.get_$MT())}this.$7mp()},$9CC:function(n){var o=this.$1n;var i=o.$v;var r=i.$c;var h=o.$5k(21);var f=n;var u=f.$67?f.$67.correlationId:null;r.set_$1ZE(!0);var t=n.$99;if(this.$Lu.$1EF(t)){_js.Trace.logInfo(_a.$0.$dO,"Resume discard for context "+t);h.$5N0(t,f.$5i)}else if(t===r.get_$D1()){_js.Trace.logInfo(_a.$0.$dO,"Recording on context upgrade failed");var e=i.get_$1X8();var s=i.get_$iD();if(e.$GP){if(e.$2YV){_js.Trace.logInfo(_a.$0.$dO,"Skipping upgrade for context "+t+" since save and then send was triggered during upgrade");this.$4AU("SkipUpgrade",u,"Skip upgrade since saving is in progress");e.$5N3();return}this.$7Ed(i.$1d)}else if(s.$bk){_js.Trace.logInfo(_a.$0.$dO,"Skipping upgrade for context "+t+" since send was triggered during upgrade");this.$4AU("SkipUpgrade",u,"Skip upgrade since send is in progress");s.$3WY();return}else this.$7Ed(i.$1d);if(this.get_$2O0()&&r.get_$2lt()){_js.Trace.logInfo(_a.$0.$dO,"upgrade failed and user requested for upgrade, show the failure and trigger property changes to hide the spinner");this.$3h("IsWaitingForQuotedBody","IsOnDemandUpgradePending");this.$7Db();_mcp.$3s.$Js(this.$1n)}}n.$2H&&this.$9JT(n.$2H,t,u,r)},$9JT:function(n,t,i,r){var f="UpgradeFailure_UnknownError";var u="";if(_g.$4k.$1dV(n)){f=_g.$4k.$2Kq(n);u=n.FaultMessage}_js.Trace.logWarning(_a.$0.$dO,String.format("Upgrade failed. ContextId={0}, Context={1}, Server Error: {2}",t,r.toString(),u));this.$4AU(f,i,u)},$7Ed:function(n){if(!this.get_$2O0()){n.$9T(3440);n.$4r(3440,null);_mcp.$3s.$Js(this.$1n)}},$7Db:function(){var n=this.$1n.$v.$1d;n.$9T(3450);n.$4r(3450,null)},$4AU:function(n,t,i){this.$7Mw=n;this.$7Mu=t;this.$7Mx=i;if(this.$2bD){_y.$2E.$1F(this.$2bD,null,n,t,i);this.$2bD=null;_a.$6.endPT("MailComposeUpgrade")}this.$7mx()},$7mp:function(){if(this.$2bD){_y.$2E.$1F(this.$2bD);this.$2bD=null;_a.$6.endPT("MailComposeUpgrade")}this.$Al8()},$Al8:function(){if(this.$2T4){_y.$2E.$1F(this.$2T4);this.$2T4=null}},$7mx:function(){if(this.$2T4){_y.$2E.$1F(this.$2T4,null,this.$7Mw,this.$7Mu,this.$7Mx);this.$2T4=null}}};_mcp.$1Ks=function(n,t){this.$$d_$Daz=Function.createDelegate(this,this.$Daz);this.$$d_$EoN=Function.createDelegate(this,this.$EoN);_mcp.$1Ks.initializeBase(this,[19,n]);var i=this;t.$9(function(t){i.$zR=t.$9(n.$5k(1),n.$v.$1d);i.$zR.set_$Db0(i.$$d_$Daz);if(i.$5W9){i.$zR.$3e();i.$5W9=!1}if(i.$5Wa){i.$zR.$2xt();i.$5Wa=!1}})};_mcp.$1Ks.prototype={$zR:null,$5W9:!1,$5Wa:!1,$3e:function(){this.$zR?this.$zR.$3e():this.$5W9=!0;_mcp.$14e.prototype.$3e.call(this)},$2xt:function(){if(this.$zR){_js.Trace.logInfo(_a.$0.$15,"Prepares to submit mailtips action");this.$zR.$2xt()}else{_js.Trace.logInfo(_a.$0.$15,"Remember to submit MailTips action once the MailTipsHandler is created");this.$5Wa=!0}},$EoN:function(){var i=this.$1n;var t=i.$v;var n=t.$c;if(n.get_$3xq()){t.$1d.$9T(4400);t.$1d.$4r(4400);_mcp.$3s.$Js(this.$1n)}if(n.get_$6W()&&n.get_$6W()!==3&&n.get_$6W()!==11){this.get_$G6()||this.$3e();this.$2xt()}},$9Lo:function(){if(this.$zR){_js.Trace.logInfo(_a.$0.$15,"Remove MailTips for deleted recipients");this.$zR.$9Lo()}else _js.Trace.logInfo(_a.$0.$15,"MailTips for deleted recipients was called when MailTipsHandler hasn't been created, no operation needed")},$Daz:function(){_mcp.$3s.$Js(this.$1n)}};_mcp.$1Kw=function(n,t){this.$$d_$9fV=Function.createDelegate(this,this.$9fV);this.$$d_$9AG=Function.createDelegate(this,this.$9AG);this.$$d_$9AF=Function.createDelegate(this,this.$9AF);this.$$d_$9AD=Function.createDelegate(this,this.$9AD);this.$$d_$DeJ=Function.createDelegate(this,this.$DeJ);_mcp.$1Kw.initializeBase(this,[25,n]);if(_a.$5N.$43){var i=this;t.$9(function(t){i.$WO=t.$9(i.$1n.$5k(1),i.$1n.$5k(5),n.$v.$1d);i.$WO.set_$DeK(i.$$d_$DeJ);i.$WO.set_$9AE(i.$$d_$9AD);i.$WO.set_$9AC(i.$$d_$9AF);i.$WO.set_$9AH(i.$$d_$9AG);i.$WO.set_$9BJ(i.$$d_$9fV);if(i.$5WA){i.$WO.$3e();i.$5WA=!1}if(i.$5WJ){i.$2BC(i.$6ru);i.$5WJ=!1}})}};_mcp.$1Kw.prototype={$2Or:null,$WO:null,$5WA:!1,$5WJ:!1,$6ru:0,$3e:function(){if(!_a.$5N.$43){_mcp.$14e.prototype.$3e.call(this);return}this.$WO?this.$WO.$3e():this.$5WA=!0;_mcp.$14e.prototype.$3e.call(this)},$2A:function(){this.$2Or&&(this.$2Or=_js.$D.get_$Q().$6Q(this.$2Or));_js.$Eb.prototype.$2A.call(this)},$CDK:function(){if(!_a.$5N.$43)return!1;switch(this.$3Da()){case 1:return!1;case 2:case 3:return $C(this.$1n.$v.$c.get_$uB())&&$C(this.$1n.$v.$c.get_$qx());case 4:case 5:return $C(this.$1n.$v.$c.get_$qx());default:return!1}},$Bs4:function(){if(!_a.$5N.$43)return"";switch(this.$3Da()){case 2:case 3:return _u.CommonStrings.l_PolicyTipsBlockOverrideSend_Text;case 4:case 5:return _u.CommonStrings.l_PolicyTipsBlockSend_Text;default:return""}},$EWP:function(){if(_a.$5N.$43){if(!this.$WO){_js.Trace.logInfo(_a.$0.$PD,"skip setting message sent flag since handler hasn't been created yet.");return}this.$WO.set_$CL7(!0);if(!$C(this.$1n.$v.$c.get_$uB())){var n=_a.$6.$1f(_a.$0.$PD,"DlpPolicyTipOverridden",!0);_a.$6.$1F(n,"DlpPolicyTipOverridden","",null)}}},$2BC:function(n){this.$9qh(n,0)},$4IL:function(n,t,i){_js.Trace.logInfo(_a.$0.$15,"Prepares to submit policyTips action");var u;var r;if(n.get_$T5()){u=_a.$37.$3Df(n.get_$T5().get_$3n());r=_a.$37.$3Df(n.get_$T5().get_$MT())}else{u=_a.$37.$3Df(n.get_$3n());r=_a.$37.$3Df(n.get_$MT())}this.$WO.$4IL(i,n.get_$EU(),u,r,t)},$9qh:function(n,t){if(_a.$5N.$43){if(!this.$WO){_js.Trace.logInfo(_a.$0.$PD,"Remember to resume triggering policy tips once the handler is created");this.$6ru=n;this.$5WJ=!0;return}var f=this.$1n;var e=f.$v;var r=e.$c;this.get_$G6()||this.$3e();this.$2Or&&(this.$2Or=_js.$D.get_$Q().$6Q(this.$2Or));var i=r.get_$Fc();if(i){_bc.$9E.$2lD(i)&&!_g.$1H.$Yr&&(i=_g.$1H.$1Q.$1cx(i));if(_bc.$9E.$2lD(i)){if(t<4){var u=this;this.$2Or=_js.$D.get_$Q().$2V(_a.$0.$PD,"TriggerPolicyTipsIfNeeded",function(){u.$9qh(n,t+1)},5e3)}}else this.$4IL(r,n,i)}}},$3Da:function(){this.get_$G6()||this.$3e();return this.$WO?this.$WO.$3Da():0},$DeJ:function(){_mcp.$3s.$Js(this.$1n)},$9AD:function(n){var r=this.$1n;var i=r.$v;var t=i.$c;t.set_$uB(n)},$9AF:function(n){var r=this.$1n;var i=r.$v;var t=i.$c;t.set_$qx(n)},$9AG:function(){this.$2BC(64)},$9fV:function(n){var r=this.$1n;var i=r.$v;var t=i.$c;t.set_$16w(n)}};_mcp.$1Kp=function(n,t){this.$$d_$Akx=Function.createDelegate(this,this.$Akx);this.$$d_$94l=Function.createDelegate(this,this.$94l);this.$$d_$94o=Function.createDelegate(this,this.$94o);this.$$d_$AGq=Function.createDelegate(this,this.$AGq);this.$$d_$Aqa=Function.createDelegate(this,this.$Aqa);this.$$d_$7V6=Function.createDelegate(this,this.$7V6);this.$$d_$Eb3=Function.createDelegate(this,this.$Eb3);_mcp.$1Kp.initializeBase(this,[24,n]);this.$2jw=!1;this.$iz=t;this.$15N=new _C(this.$$d_$Eb3,_a.$0.$4U);this.$15N.set_$8F(!1)};_mcp.$1Kp.prototype={$2jw:!1,$65:null,$iz:null,$ej:null,$15N:null,set_$17B:function(n){if(this.$65!==n){this.$65=n;this.$4("ExtensibilityViewModel")}return n},$3e:function(){if(!this.get_$G6()){var n=this;this.$iz.$9(function(t){n.$ej=t;n.set_$17B(t.$5tr(n,n.$$d_$7V6));var i=n.$1n.$5k(3);n.$65.set_$7qh(i.$2Nh);var r=n.$1n.$v.$N;r.$1k(_a.$Un,n.$$d_$Aqa);n.$65.$72();i.$p("IsIrmProtected",n.$$d_$AGq);n.$65.add_$2Sw(n.$$d_$94o);n.$65.add_$5D8(n.$$d_$94l);n.$65.get_$Anh()?n.$15N.set_$8F(n.$65.get_$2x6().$3r):n.$65.get_$2x6().add_$1aP(n.$$d_$Akx);_mcp.$14e.prototype.$3e.call(n)})}},$AU:function(){if(this.get_$G6()){var t=this.$1n.$5k(3);t.$1B("IsIrmProtected",this.$$d_$AGq);this.$65.remove_$2Sw(this.$$d_$94o);this.$65.remove_$5D8(this.$$d_$94l);this.$65.$AI();var n=this.$1n.$v.$N;n.$4A(_a.$Un,this.$$d_$Aqa)}_mcp.$14e.prototype.$AU.call(this)},$2Kg:function(){return _y.$z.$1Q.get_$U()==="Mouse"?this.$1n.$v.$c.get_$6P():this.$1n.$v.$c.get_$NB()?"HTML":"Text"},$uv:function(){return this.$1n.$v.$c.get_$3n()},$9hr:function(n){this.$1n.$v.$c.set_$3n(n)},$8HP:function(n,t,i){i.val=0;var r=new _fm.$lm(n);this.$1n.$v.$c.set_$28n(r);r.$2Ng&&(i.val=9016);t.val=r.$3aq;return r.$2WK},$9hd:function(n,t,i){i.val=0;var r=new _fm.$tv(n,!0);r.$z8=t;this.$1n.$v.$c.set_$28n(r);r.$4vf?i.val=2006:r.$2Ng&&(i.val=9016)},$8Gh:function(n){var t=this.$8Bv(n);return t.$3V},$9qn:function(n,t){return this.$9qo(n,t,!1)},$9hP:function(n,t){this.$9qo(n,t,!0)},$4Og:function(n,t){t.val=0;if(!this.$1n.$v.$c.get_$OS()){_js.Trace.logInfo(_a.$0.$4U,"Attachment not added - well not upgraded.");t.val=9005;return null}var r=this.$1n.$5k(5);var u=_y.$7w.$5tV(n);if(r.get_$9Z()){var f=_a.$6.$1f(_a.$0.$1l,"AttachmentExtensibilityItemAttachments",!0);var i=new(_ff.$18.$$(_y.$OS));r.get_$9Z().$30L(u,i,f);if(!i.get_$A()){_js.Trace.logInfo(_a.$0.$4U,"Attachment not added - max number exceeded.");t.val=9001;return null}return i.get_$E(0)}else{_js.Trace.logInfo(_a.$0.$4U,"Attachment not added - max number exceeded.");t.val=9001;return null}},$4Ob:function(n,t,i){i.val=0;if(!this.$1n.$v.$c.get_$OS()){_js.Trace.logInfo(_a.$0.$4U,"Attachment not added - well not upgraded.");i.val=9005;return null}var f=this.$1n.$5k(5);var r=f.get_$9Z();if(r){var u=this.$ej.$7hV(n,t);return r.$7RV(u)}_js.Trace.logError(_a.$0.$4U,"ComposeFormNotReadyForAttachments in mail module");i.val=9015;return null},$4mX:function(){return this.$1n.$v.$c.get_$5N()?this.$1n.$v.$c.get_$5N().Id:null},$8PC:function(n,t){var i=new _cmc.$MU(0,n,t);i.$2z0=!0;i.$28E=!0;this.$5Op(i)},$9Gh:function(n,t){var i=new _cmc.$MU(1,n,t);this.$5Op(i)},$Eb3:function(){this.$65&&this.$65.$7D7()},$Akx:function(n,t){this.$15N.set_$8F(this.$65.get_$2x6().$3r);this.$65.get_$2x6().remove_$1aP(this.$$d_$Akx)},$94o:function(){if(_y.$z.$1Q.get_$U()==="TouchWide"&&this.$65.get_$13L()){var n=this.$1n.$v;n.set_$2sh(6)}},$94l:function(){var n=this.$1n.$v;n.set_$2sh(4)},$5Op:function(n){var t=this.$1n.$5k(27);t.set_$Nb(n)},$2Kx:function(){return this.$1n.$v.$c.get_$Fc()?this.$1n.$v.$c.get_$Fc().Id:null},$3Dt:function(){this.$1n.$v.$c.get_$nu()||this.$1n.$v.$c.set_$nu(new _js.$X);return this.$1n.$v.$c.get_$nu()},$8b3:function(){},$9mw:function(){var n=new _cmc.$Tr(null);this.$5Op(n)},$7a4:function(n){var t=new _cmc.$Tr(n);this.$5Op(t)},$9qo:function(n,t,i){var u=this.$8Bv(n);i&&u.$AU();var f=t.get_$A();if(f+u.$3V.get_$A()>100)return!1;n===2&&this.$1n.$v.get_$aa().$4Gc.$11();for(var r=0;r<f;r++){var e=t.get_$E(r);u.$5jL(e)}return!0},$Aqa:function(n){if(this.$2jw){this.$2jw=!1;this.$65.$220(!1)}},$kK:function(){var n=this.$1n.$5k(14);n&&n.$kK()},$7V6:function(n){if(n===1){var r=window.document.body.clientWidth;if(r<1367){var i=this.$1n.$v.$N;i.$1o(_a.$eN,new _a.$eN(!0));this.$2jw=!0}}else if(n===2&&this.$2jw){var t=this.$1n.$v.$N;t.$1o(_a.$eN,new _a.$eN(!1));this.$2jw=!1}this.$kK()},$8Bv:function(n){var t=this.$1n.$v.get_$aa();return n?n===1?t.$GL.$5X:n===2?t.$Gb.$5X:null:t.$GH.$5X},$AGq:function(n,t){t==="IsIrmProtected"&&this.$EcM()},$EcM:function(){var n=this.$1n.$5k(3);this.$65.set_$7qh(n.$2Nh);n.$2Nh&&this.$65.$220(!1)}};_mcp.$1L1=function(n,t){this.$5yt=n;this.$6Wg=t};_mcp.$1L1.prototype={$5yt:null,$6Wg:null,get_$Fc:function(){return this.$5yt},get_$CIm:function(){return this.$6Wg}};_mcp.$1PK=function(n){this.$v=n};_mcp.$1PK.prototype={$v:null};_mcp.$1PL=function(n){this.$v=n};_mcp.$1PL.prototype={$v:null,get_$4D:function(){return this.$v}};_mcp.$pW=function(n,t,i,r){this.$6PL=n;this.$8B=t;this.$3Hq=i;this.$2IJ=r};_mcp.$pW.prototype={$6PL:!1,$8B:null,$3Hq:!1,$2IJ:null,get_$8Su:function(){return this.$6PL},get_$1xH:function(){return this.$8B},get_$4v4:function(){return this.$3Hq},get_$7rJ:function(){return this.$2IJ}};_mcp.$17r=function(n){this.$3Hq=n};_mcp.$17r.prototype={$3Hq:!1,get_$4v4:function(){return this.$3Hq}};_mcp.$1PQ=function(n){this.$v=n};_mcp.$1PQ.prototype={$v:null,get_$4D:function(){return this.$v}};_mcp.$mr=function(){};_mcp.$mr.prototype={$5t8:function(n,t,i){var r=n.$c;var u=r.get_$6W();var c=3===u||2===u||1===u;var s=i.get_$pm()&&r.get_$OS();n.get_$7Mt().get_$2O0()&&(s=!!(s&r.get_$2lt()));var f=null;if(c&&!s){_js.Trace.logInfo(_a.$0.$15,"Creating CreateResponseAction for context:"+r.toString()+"; layout="+_y.$z.$1Q.get_$U()+"; disposition="+t);var l=r.$1kC(!1);var o=this.$4XI(r,l,i);o.$M6=t;r.get_$Fc()&&t===1&&(o.$2zE=n.$2zD);o.$2dj=r.$6HY(100);o.$2Ph=_y.$1m.toString(r.get_$6W());if(r.get_$8Uj()){var a=new _mcp.$sG(o);f=a}else f=o}else if(r.get_$6SK()){_js.Trace.logInfo(_a.$0.$15,"Creating UpdateMessageForComposeAction for context:"+r.toString()+"; disposition="+t);var h=this.$AQe(t,r,i);t===1&&(h.$2zE=n.$2zD);f=h}else if(8===r.get_$6W()){_js.Trace.logInfo(_a.$0.$15,"Creating CancelCalendarItemAction for context:"+r.toString()+"; disposition="+t);f=this.$AsW(r,t)}else if(u===5||u===6||u===7){_js.Trace.logInfo(_a.$0.$15,"Creating MeetingResponseAction for context:"+r.toString()+"; disposition="+t);f=this.$64V(r,t)}else if(u===9||u===10){_js.Trace.logInfo(_a.$0.$15,"CreateComposeAction: ApprovalRequestAction");f=this.$As3(r,t,i)}else{_js.Trace.logInfo(_a.$0.$15,"Creating CreateMessageForComposeAction for context:"+r.toString()+"; disposition="+t);var e=null;if(u===11||u===12){e=new _h.$2j(r.$5uE(!1),r.get_$2sA());e.$M6=0}else{e=new _h.$2j(r.$1kC(!1),null);e.$M6=t}e.$1ju=!i.get_$NB();$C(r.get_$gz())||(e.$11p=r.get_$gz());e.$2dj=r.$6HY(100);e.$2Ph=_y.$1m.toString(r.get_$6W());f=e}f.$99=r.get_$D1();return f},$5tZ:function(n,t,i){var r=new _h.$1Gg(200,n);r.$W5=t||_h.$f.get_$24B();r.$ZE=$C(i)?"MailCompose":i;return r},$ALF:function(n,t){var r=t?"HardDelete":"MoveToDeletedItems";return new _h.$1Db([n],r,2)},$7gt:function(n,t,i){var u=null;u=n.get_$1Ed()?n.$5uE(!0):n.$1kC(!0);var r=this.$4XI(n,u,i);r.$W5=t;r.$ZE=!i.get_$NB()&&n.get_$6P()==="HTML"?"MailComposeNormalizedBody":"MailCompose";r.$2yS=_g.$O.get_$Q().get_$1j().get_$ca();return r},$AsW:function(n,t){var i=new _c.$kA(n.get_$14N(),1,n.get_$17A());i.$Os=n.$1kC(!1);n.get_$gz()&&(i.$11p=n.get_$gz());return i},$4XI:function(n,t,i){var u=n.get_$1LT()?new _h.$6e(n.get_$14N()):n.get_$14N();var r=null;r=new _h.$Bi(this.$4oP(n.get_$6W()),u,i);r.set_$6Z(t);r.$286=n.get_$5G2();r.$1ju=!i.get_$NB();n.get_$gz()&&(r.$11p=n.get_$gz());r.$Do_7=n.get_$5N();r.$kB=n.get_$3SR();r.$99=n.get_$D1();n.get_$IU()&&_g.$5w.isInstanceOfType(n.get_$IU())&&n.get_$IU().get_$Q1()&&(r.$3Ip=!0);switch(n.get_$6W()){case 1:case 2:r.$4IH=_u.Strings.l_ReplyPrefix_Text;break;case 3:r.$4IH=_nbs.NonBootStrings.l_ForwardPrefix_Text;break}return r},$64V:function(n,t){return _cc.$42.$64V(n.get_$IU(),_cc.$42.$2jr(n.get_$6W()),n.$1kC(!1),t,n.get_$5Jl())},$AQe:function(n,t,i){var r=null;if(t.get_$1Ed()){r=new _h.$48(t.$5uE(!1));r.$14o=_g.$1y.$tA(t.get_$2sA());r.$M6=0}else{r=new _h.$48(t.$1kC(!1));r.$M6=n}r.$6TS=!i.get_$NB();t.get_$gz()&&(r.$11p=t.get_$gz());r.$2dj=t.$6HY(100);r.$3jI="AlwaysOverwrite";r.$2Ph=_y.$1m.toString(t.get_$6W());return r},$4oP:function(n){switch(n){case 1:return new _g.$FX;case 2:return new _g.$E5;case 3:return new _g.$F5;case 12:return new _g.$XA;default:throw Error.invalidOperation("Unable to get SmartResponseType from MailComposeOperation "+_y.$1m.toString(n));}},$As3:function(n,t,i){var u=n.get_$IU();var r=new _c.$sF(u,n.$1kC(!1),n.get_$6W()===9,t);r.$1ju=!i.get_$NB();return r}};_mcp.$1Kj=function(n,t,i,r,u,f,e,o,s,h,c,l){_a.$4.$z(e,"nativeBridge");this.$1n=n;this.$3a=i;this.$1G=r;this.$N2=u;this.$Ex=t;this.$2Y=f;this.$l=e;this.$6R=o;this.$WF=s;this.$16A=h;this.$11U=c;this.$CX=l};_mcp.$1Kj.prototype={$1n:null,$3a:null,$1G:null,$N2:null,$WF:null,$Ex:null,$2Y:null,$l:null,$6R:null,$16A:null,$11U:null,$CX:null,$AKe:function(n,t){switch(n){case 0:return new _mcp.$14f(this.$1n,this.$1G,!!this.$6R);case 1:return new _mcp.$HY(this.$1n);case 2:return new _mcp.$1Ku(this.$1n);case 3:return new _mcp.$JP(this.$1n);case 4:return new _mcp.$7x(this.$1n);case 5:return new _mcp.$Gn(this.$1n,this.$Ex,this.$3a,this.$1G,this.$N2,this.$WF,this.$1n.$v.$tm,this.$CX);case 6:return new _mcp.$eR(this.$1n);case 7:return new _mcp.$G6(this.$1n,this.$1G,this.$3a,this.$1n.$v.$N);case 8:return new _mcp.$1Ki(this.$1n,this.$2Y,this.$1G);case 9:if(1===this.$1n.$v.$c.get_$5j())return new _mcp.$MX(this.$1n,this.$1G);break;case 10:return new _mcp.$1Kt(this.$1n,this.$6R,this.$3a);case 11:if("Mouse"!==t)return new _mcp.$ub(this.$1n,this.$3a,this.$1G);break;case 12:return new _mcp.$G7(this.$1n,this.$1G);case 13:return new _mcp.$1L0(this.$1n,this.$1G,this.$3a);case 14:if(t==="Mouse")return new _mcp.$3s(this.$1n,this.$6R);break;case 15:if(this.$l.$8D(this.$l.get_$JN())&&this.$l.get_$JN().get_$147().get_$4RL())return new _mcp.$MY(this.$1n,this.$l);break;case 22:if(this.$l.$8D(this.$l.get_$JN())&&this.$l.get_$JN().get_$147().get_$5BJ())return new _mcp.$1Kv(this.$1n,this.$l);break;case 16:return new _mcp.$eQ(this.$1n);case 17:if("Mouse"===t)return new _mcp.$1Kl(this.$1n,this.$6R);break;case 18:if("Mouse"===t)return new _mcp.$Ov(this.$1n);break;case 20:return new _mcp.$IF(this.$1n);case 19:return new _mcp.$1Ks(this.$1n,this.$16A);case 25:return new _mcp.$1Kw(this.$1n,this.$11U);case 21:return new _mcp.$1Kn(this.$1n);case 23:if(this.$l.$8D(this.$l.get_$15K()))return new _mcp.$1Kx(this.$1n,this.$l);break;case 24:return new _mcp.$1Kp(this.$1n,this.$1n.$v.$iz);case 26:if(this.$1G.get_$NB())return new _mcp.$1Kr(this.$1n,this.$3a);break;case 27:return new _mcp.$1Ko(this.$1n);case 29:return new _mcp.$1Ky(this.$1n)}return null}};_mcp.$1Km=function(n,t){this.$50z=n;this.$1G=t};_mcp.$1Km.prototype={$1G:null,$50z:null,$H0:function(n,t){var i=new _mcp.$V;if(this.$1G){i.set_$pm(this.$1G.get_$pm());i.set_$NB(this.$1G.get_$NB())}i.set_$5j(n?0:this.$50z.$6F4());return i},$34o:function(n,t,i,r){var u=this.$H0(!1,!1);u.set_$5j(this.$50z.$6F4());u.set_$6W(4);u.set_$XV(!1);u.set_$Fc(n);u.set_$3xF(t);r&&!r.get_$R9()?u.set_$6P(r.get_$6P()):u.set_$6P(i===1?"Text":"HTML");return u}};_mcp.$14h=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st){_a.$4.$z(k,"nativeBridge");this.$iz=n;this.$9J=t;this.$1Ct=i;this.$3VS=r;this.$7F=u;this.$Xe=f;this.$4x=e;this.$I=o;this.$2Ss=s;this.$Lu=h;this.$Lc=c;this.$N=l;this.$3a=v;this.$1G=y;this.$N2=p;this.$Ex=a;this.$2Y=w;this.$l4=b;this.$l=k;this.$2zD=d;this.$WF=g;this.$16A=nt;this.$11U=tt;this.$tm=it;this.$1th=rt;this.$sl=ut;this.$38y=ft;this.$2Yx=et;this.$CX=ot;this.$F1=st};_mcp.$14h.prototype={$iz:null,$9J:null,$1Ct:null,$3VS:null,$7F:null,$Xe:null,$N:null,$4x:null,$I:null,$2Ss:null,$Lu:null,$Lc:null,$3a:null,$1G:null,$N2:null,$Ex:null,$l4:null,$2Y:null,$tm:null,$WF:null,$l:null,$2zD:null,$16A:null,$11U:null,$1th:null,$sl:null,$38y:null,$2Yx:null,$CX:null,$F1:null,$wU:function(n,t,i){return this.$C5v(n,null,t,i)},$1CI:function(n,t,i){return this.$8Pn(n,null,t,i)},$C5v:function(n,t,i,r){var u=this.$7F.$H0(!1,!1);u.$6MF(n);return this.$8Pn(u,t,i,r)},$8Pn:function(n,t,i,r){var u=new _mcp.$8m(n,t,this.$iz,this.$9J,this.$1Ct,this.$3VS,this.$4x,this.$I,this.$2Ss,this.$Lu,this.$Lc,this.$N,this.$Ex,this.$3a,this.$1G,this.$N2,this.$2Y,this.$l4,this.$l,this.$2zD,this.$Xe,i,r,this.$WF,this.$16A,this.$11U,this.$tm,this.$1th,this.$sl,this.$38y,this.$2Yx,this.$CX,this.$F1);u.$3e();return u}};_mcp.$13y=function(){_mcp.$13y.initializeBase(this)};_mcp.$13y.prototype={$Qb:null,$4W2:null,set_$it:function(n){if(this.$Qb!==n){this.$Qb=n;this.$4("Description")}return n},set_$AIL:function(n){if(this.$4W2!==n){this.$4W2=n;this.$4("ConversationOwner")}return n}};_mcp.$uZ=function(n){this.$$d_$94T=Function.createDelegate(this,this.$94T);_mcp.$uZ.initializeBase(this);this.$n=OwaApplication.$2B;this.$2G=n};_mcp.$uZ.prototype={$n:null,$2G:null,$t4:function(n,t,i,r){$C(t)||n.add_$2s(t);n.add_$2b(i||this.$$d_$94T);$C(r)||n.add_$4T(r);this.$n.$1U(n)},$Eij:function(n,t,i,r,u,f){var e=n[t++];var s=this;var o=function(){t<n.length?s.$Eij(n,t,i,r,u,f):r(e)};var c=this,h=this;this.$t4(e,function(){o()},function(){u(e);i&&o()},f)},$9jL:function(n,t){var i=_nbs.NonBootStrings.l_MailComposeActionFailed_Text;this.$sw(n,i,null,i,null,t)},$2jf:function(n,t,i,r,u,f){var e=t;var o=n.$2H;if(o){if(_g.$4k.$1dV(o)){var h=o;if(_g.$4k.$8W1(h)){_js.Trace.logInfo(_a.$0.$15,"GetErrorMessage returning service unavailable "+_u.Strings.l_ErrorServiceUnavailable_Text+" since the specified exception was a service unavailable json fault body");e=_u.Strings.l_ErrorServiceUnavailable_Text}else if(_g.$4k.$8Vd(h)&&u){_js.Trace.logInfo(_a.$0.$15,"GetErrorMessage returning request timeout "+u+" since the specified exception was a request timeout json fault body");e=u}else if(_g.$4k.$8SR(h)&&i){_js.Trace.logInfo(_a.$0.$15,"GetErrorMessage returning disconnected "+i+" since the specified exception was a disconnected json fault body");e=i}}if(e===t){var s=_a.$4.$4o9(o);s?r&&s==="ErrorItemNotFound"?e=r:s==="ErrorAccessDenied"?e=_u.Strings.l_WarningNoPermissionToPerformAction_Text:f&&s==="ErrorQuotaExceeded"?e=f:_js.Trace.logInfo(_a.$0.$og,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not one of the specific jsonFaultBody or response code exceptions we are currently looking for"):_js.Trace.logWarning(_a.$0.$og,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not a JsonFaultBody exception or an exception with response code. The exception.Message was "+o.message)}}else _js.Trace.logInfo(_a.$0.$15,"GetErrorMessage returning default message "+t+" since the exception was null");_js.Trace.logInfo(_a.$0.$15,"MailComposeActionSubmitter.GetErrorMessage: showing error {0}",e);return e},$sw:function(n,t,i,r,u,f){var e=this.$2jf(n,t,i,r,u,null);this.$2G.$44(0,e,f)},$94T:function(n){this.$9jL(n,null);this.$6vZ(n)},$6vZ:function(n){this.$AQ("MailComposeActionFailed",n)}};_mcp.$V=function(){this.$$d_$ApZ=Function.createDelegate(this,this.$ApZ);_mcp.$V.initializeBase(this);this.set_$6P("Html"===_g.$O.get_$Q().get_$1j().get_$1xs()?"HTML":"Text");this.$p(_mcp.$V.$47u.$3C,this.$$d_$ApZ);this.$p(_mcp.$V.$4w2.$3C,this.$$d_$ApZ);if(_a.$c.$43&&_a.$c.get_$18X()){this.set_$PO(_g.$O.get_$Q().get_$1j().get_$2Yw());this.set_$St(_g.$O.get_$Q().get_$1j().get_$2Yy())}};_mcp.$V.$$cctor=function(){_mcp.$V.$2aO.set_$Qp(new _a.$C8(_g.$1K));_mcp.$V.$2EX.set_$Qp(new _a.$C8(_g.$1K));_mcp.$V.$2Dq.set_$Qp(new _a.$C8(_g.$1K));_mcp.$V.$5Z2.set_$Qp(new _a.$C8(_pc.$q));_mcp.$V.$2Dj.set_$Qp(new _a.$C8(_g.Attachment));_mcp.$V.$2HX.set_$Qp(new _a.$C8(_g.$HL))};_mcp.$V.$9Dv=function(n,t,i,r){if(!(i in t))return r;var u=t[i];return _js.$9.$o(u)?r:_js.$1I.$Ba(n,u)};_mcp.$V.$9Dt=function(n,t,i){if(!(t in n))return i;var r=n[t];return _js.$9.$o(r)?i:Boolean.parse(r)};_mcp.$V.$7Sf=function(n,t,i,r){if(n)for(var f=0;f<n.get_$A();f++){var u=n.get_$E(f);if(_g.$1Y.$5b(u,i)){_js.Trace.logInfo(_a.$0.$15,"Excluding original from {0}",i);continue}if(_mcp.$V.$23P(u.EmailAddress)){_js.Trace.logInfo(_a.$0.$15,"Excluding self address {0}",_mcp.$V.$1gs||"null");continue}if(r&&r.get_$A()!==r.$HC(function(n){return _g.$1Y.$5b(u,n)})){_js.Trace.logInfo(_a.$0.$15,"Excluding address {0} already in to",u);continue}t.$F(u)}};_mcp.$V.$23P=function(n){return!_js.$9.$1g(_mcp.$V.$1gs)&&!_js.$9.$1g(n)&&(_mcp.$V.$1gs===n||_mcp.$V.$1gs.toLowerCase()===n.toLowerCase())};_mcp.$V.$6WO=function(n,t,i,r){r.val+=" "+n+"(";if(t)for(var u=0;u<t.get_$A();u++){r.val+=_g.$1Y.$1cu(t.get_$E(u));u!==t.get_$A()-1&&(r.val+="|")}r.val+=" QS="+i+")"};_mcp.$V.prototype={$6tP:null,$Vx:null,$8N:null,$Vy:null,$4oZ:null,$3Hc:!1,$3w8:!1,$7CX:!1,$2gA:null,$6TW:!1,$jS:null,$5Bd:!1,$9jE:!1,$4uM:!1,$8Rg:!1,$1ht:0,$3k8:0,$32F:null,$51w:0,$5Ye:null,$3Ic:!1,$47U:null,get_$2Lq:function(){return!!this.get_$5Jl()},get_$5Jl:function(){return this.$w(_mcp.$V.$6v3)},set_$5Jl:function(n){this.$P(_mcp.$V.$6v3,_cc.$9c.$Arh(n));return n},get_$Ez1:function(){return this.get_$2Lq()?_nbs.NonBootStrings.l_CurrentMeetingTime_Short_Text:_u.MeetingMsgStrings.l_WhenLabel_Text},get_$6Ov:function(){return this.$4uM},set_$6Ov:function(n){this.$4uM=n;return n},get_$D1:function(){return this.$w(_mcp.$V.$7Nx)},set_$D1:function(n){this.$P(_mcp.$V.$7Nx,n);return n},get_$6W:function(){return this.$w(_mcp.$V.$47u)},set_$6W:function(n){this.$P(_mcp.$V.$47u,n);return n},get_$5j:function(){return this.$w(_mcp.$V.$25w)},set_$5j:function(n){this.$P(_mcp.$V.$25w,n);return n},get_$14N:function(){return this.$w(_mcp.$V.$6qP)},set_$14N:function(n){this.$P(_mcp.$V.$6qP,n);return n},get_$5G2:function(){return this.$w(_mcp.$V.$6qN)},set_$5G2:function(n){this.$P(_mcp.$V.$6qN,n);return n},get_$IU:function(){this.$8N||(this.$8N=this.$w(_mcp.$V.$6qQ));return this.$8N},set_$IU:function(n){this.$8N=n;this.$P(_mcp.$V.$6qQ,this.$8N);return n},get_$Fc:function(){return this.$w(_mcp.$V.$5yu)},set_$Fc:function(n){if($C(this.get_$Fc())||!n)this.$P(_mcp.$V.$5yu,n);else{this.get_$Fc().Id=n.Id;this.get_$Fc().ChangeKey=n.ChangeKey}return n},get_$6SK:function(){return!!this.get_$Fc()},get_$9my:function(){return this.$w(_mcp.$V.$7G7)},set_$9my:function(n){this.$P(_mcp.$V.$7G7,n);return n},get_$3n:function(){return this.$w(_mcp.$V.$qA)},set_$3n:function(n){this.$P(_mcp.$V.$qA,n);return n},get_$MT:function(){return this.$w(_mcp.$V.$37l)},set_$MT:function(n){this.$P(_mcp.$V.$37l,n);return n},get_$28n:function(){return this.$w(_mcp.$V.$71k)},set_$28n:function(n){this.$P(_mcp.$V.$71k,n);return n},get_$3rn:function(){return this.$Vx},set_$3rn:function(n){this.$Vx=n;return n},get_$dk:function(){return this.$w(_mcp.$V.$6vh)},set_$dk:function(n){this.$P(_mcp.$V.$6vh,n);return n},set_$Bqq:function(n){this.$Vy=n;return n},get_$1vK:function(){return this.$w(_mcp.$V.$7IM)},set_$1vK:function(n){this.$P(_mcp.$V.$7IM,n);return n},get_$6P:function(){return this.$w(_mcp.$V.$5n6)},set_$6P:function(n){this.$P(_mcp.$V.$5n6,n);return n},get_$8IE:function(){return this.$4oZ},set_$8IE:function(n){this.$4oZ=n;return n},get_$77:function(){return this.$w(_mcp.$V.$2aO)},set_$77:function(n){this.$P(_mcp.$V.$2aO,n);return n},get_$4Ho:function(){return this.$w(_mcp.$V.$5Z2)},set_$4Ho:function(n){this.$P(_mcp.$V.$5Z2,n);return n},get_$10q:function(){return this.$w(_mcp.$V.$3cX)},set_$10q:function(n){this.$P(_mcp.$V.$3cX,n);return n},get_$7x:function(){return this.$w(_mcp.$V.$2EX)},set_$7x:function(n){this.$P(_mcp.$V.$2EX,n);return n},get_$xl:function(){return this.$w(_mcp.$V.$33V)},set_$xl:function(n){this.$P(_mcp.$V.$33V,n);return n},get_$AO:function(){return this.$w(_mcp.$V.$2Dq)},set_$AO:function(n){this.$P(_mcp.$V.$2Dq,n);return n},get_$qX:function(){return this.$w(_mcp.$V.$32G)},set_$qX:function(n){this.$P(_mcp.$V.$32G,n);return n},get_$XV:function(){return this.$w(_mcp.$V.$5Vm)},set_$XV:function(n){this.$P(_mcp.$V.$5Vm,n);return n},get_$Bv:function(){return this.$w(_mcp.$V.$3G7)},set_$Bv:function(n){this.$P(_mcp.$V.$3G7,n);return n},get_$1gD:function(){return this.$w(_mcp.$V.$6vT)},set_$1gD:function(n){this.$P(_mcp.$V.$6vT,n);return n},get_$9lU:function(){return this.$w(_mcp.$V.$7F2)},set_$9lU:function(n){this.$P(_mcp.$V.$7F2,n);return n},get_$4HY:function(){return this.$w(_mcp.$V.$7F4)},set_$4HY:function(n){this.$P(_mcp.$V.$7F4,n);return n},get_$5Yi:function(){return this.$w(_mcp.$V.$7F6)},set_$5Yi:function(n){this.$P(_mcp.$V.$7F6,n);return n},get_$1yH:function(){return this.$3k8},set_$1yH:function(n){this.$3k8=n;return n},get_$1x0:function(){return this.$32F},set_$1x0:function(n){this.$32F=n;return n},get_$2AO:function(){return this.$1ht},set_$2AO:function(n){this.$1ht=n;return n},get_$rn:function(){return this.$w(_mcp.$V.$6OT)},set_$rn:function(n){this.$P(_mcp.$V.$6OT,n);return n},get_$ov:function(){return this.$w(_mcp.$V.$4w2)},set_$ov:function(n){this.$P(_mcp.$V.$4w2,n);return n},get_$230:function(){return this.$w(_mcp.$V.$6Ql)},set_$230:function(n){this.$P(_mcp.$V.$6Ql,n);return n},get_$3xq:function(){return this.$w(_mcp.$V.$6S3)},set_$3xq:function(n){this.$P(_mcp.$V.$6S3,n);return n},get_$6D:function(){return this.$w(_mcp.$V.$3Km)},set_$6D:function(n){this.$P(_mcp.$V.$3Km,n);return n},get_$3FJ:function(){return this.$w(_mcp.$V.$6Je)},set_$3FJ:function(n){this.$P(_mcp.$V.$6Je,n);return n},get_$1pL:function(){return this.$w(_mcp.$V.$6Xm)},set_$1pL:function(n){this.$P(_mcp.$V.$6Xm,n);return n},get_$5Q:function(){return this.$w(_mcp.$V.$2II)},set_$5Q:function(n){this.$P(_mcp.$V.$2II,n);return n},get_$Ek:function(){return this.$w(_mcp.$V.$72l)},set_$Ek:function(n){this.$P(_mcp.$V.$72l,n);return n},get_$OS:function(){return this.$w(_mcp.$V.$6TT)},set_$OS:function(n){this.$P(_mcp.$V.$6TT,n);return n},get_$ot:function(){return this.$w(_mcp.$V.$6PZ)},set_$ot:function(n){this.$P(_mcp.$V.$6PZ,n);return n},get_$1LG:function(){return this.$w(_mcp.$V.$6O5)},set_$1LG:function(n){this.$P(_mcp.$V.$6O5,n);return n},get_$19l:function(){return this.$w(_mcp.$V.$3SS)},set_$19l:function(n){this.$P(_mcp.$V.$3SS,n);return n},get_$2sA:function(){return this.$w(_mcp.$V.$6rU)},set_$2sA:function(n){this.$P(_mcp.$V.$6rU,n);return n},get_$1oS:function(){return this.$w(_mcp.$V.$6RN)},set_$1oS:function(n){this.$P(_mcp.$V.$6RN,n);return n},get_$1LT:function(){return this.$w(_mcp.$V.$6RF)},set_$1LT:function(n){this.$P(_mcp.$V.$6RF,n);return n},get_$17A:function(){return this.$w(_mcp.$V.$61e)},set_$17A:function(n){this.$P(_mcp.$V.$61e,n);return n},get_$8NJ:function(){return this.$w(_mcp.$V.$6Lk)},set_$8NJ:function(n){this.$P(_mcp.$V.$6Lk,n);return n},get_$1TJ:function(){return this.$w(_mcp.$V.$6JL)},set_$1TJ:function(n){this.$P(_mcp.$V.$6JL,n);return n},get_$1LY:function(){return this.$w(_mcp.$V.$6S5)},set_$1LY:function(n){this.$P(_mcp.$V.$6S5,n);return n},get_$ix:function(){return this.$w(_mcp.$V.$5yv)},set_$ix:function(n){this.$P(_mcp.$V.$5yv,n);return n},get_$2Dn:function(){return this.$w(_mcp.$V.$5lr)},set_$2Dn:function(n){this.$P(_mcp.$V.$5lr,n);return n},get_$EU:function(){return this.$w(_mcp.$V.$2Dj)},set_$EU:function(n){var i=null;if(n){i=new _js.$X;for(var t=0;t<n.get_$A();t++)i.$F(n.get_$E(t))}this.$P(_mcp.$V.$2Dj,i);this.$9sT();return n},get_$1ZE:function(){return this.$w(_mcp.$V.$7Mv)},set_$1ZE:function(n){this.$P(_mcp.$V.$7Mv,n);return n},get_$T5:function(){return this.$w(_mcp.$V.$5mh)},set_$T5:function(n){this.$P(_mcp.$V.$5mh,n);return n},get_$8Uj:function(){return this.$3Ic},get_$9i:function(){return this.$w(_mcp.$V.$6zv)},set_$9i:function(n){if(n!==this.get_$9i()){this.$P(_mcp.$V.$6zv,n);this.$3h("IsCopyRestricted","IsPrintRestricted")}return n},get_$gz:function(){return this.$w(_mcp.$V.$341)},set_$gz:function(n){this.$P(_mcp.$V.$341,n);return n},set_$EZn:function(n){this.$7CX=n;return n},get_$6P7:function(){return this.$3Hc},set_$6P7:function(n){this.$3Hc=n;n&&!this.get_$T5()&&this.$7nZ();return n},get_$6P8:function(){return this.$3w8},set_$6P8:function(n){if(this.$3w8!==n){this.$3w8=n;this.$4("IsEditorReady")}return n},set_$4bR:function(n){this.$2gA!==n&&(this.$2gA=n);return n},set_$CEW:function(n){this.$6TW=n;return n},get_$6Xg:function(){return 255},get_$22x:function(){return this.$w(_mcp.$V.$6QR)},set_$22x:function(n){this.$P(_mcp.$V.$6QR,n);return n},get_$1Op:function(){return this.$w(_mcp.$V.$7ON)},set_$1Op:function(n){this.$P(_mcp.$V.$7ON,n);return n},get_$3tm:function(){return this.$w(_mcp.$V.$6KU)},set_$3tm:function(n){this.$P(_mcp.$V.$6KU,n);return n},get_$3xF:function(){return this.$w(_mcp.$V.$6R4)},set_$3xF:function(n){this.$P(_mcp.$V.$6R4,n);return n},get_$3eD:function(){return this.$w(_mcp.$V.$7OP)},set_$3eD:function(n){this.$P(_mcp.$V.$7OP,n);return n},get_$CCM:function(){return!!this.get_$9i()&&!this.get_$9i().get_$R9()&&!this.get_$9i().get_$49n()&&!this.get_$9i().get_$KR()},get_$9kI:function(){return this.get_$ov()&&_mcp.$7x.$8WQ(this)},get_$2NL:function(){return!!this.get_$9i()&&0===this.get_$9i().get_$R9()&&!this.get_$9i().get_$3mx()&&!this.get_$9i().get_$KR()},get_$3Pv:function(){return null},get_$6tW:function(){return this.get_$3n()},get_$5Ic:function(){return this.$6tP},get_$a4:function(){return this.$w(_mcp.$V.$6OK)},set_$a4:function(n){this.$P(_mcp.$V.$6OK,n);return n},get_$l1:function(){return this.$w(_mcp.$V.$5q5)},set_$l1:function(n){this.$P(_mcp.$V.$5q5,n);return n},get_$uB:function(){return this.$w(_mcp.$V.$5yW)},set_$uB:function(n){this.$P(_mcp.$V.$5yW,n);return n},get_$qx:function(){return this.$w(_mcp.$V.$5yV)},set_$qx:function(n){this.$P(_mcp.$V.$5yV,n);return n},get_$16w:function(){return this.$w(_mcp.$V.$5yU)},set_$16w:function(n){this.$P(_mcp.$V.$5yU,n);return n},get_$gv:function(){return this.$w(_mcp.$V.$5q7)},set_$gv:function(n){this.$P(_mcp.$V.$5q7,n);return n},get_$eR:function(){return this.$w(_mcp.$V.$5q4)},set_$eR:function(n){this.$P(_mcp.$V.$5q4,n);return n},get_$1xa:function(){return this.$w(_mcp.$V.$5q6)},set_$1xa:function(n){this.$P(_mcp.$V.$5q6,n);return n},get_$ER:function(){return this.$w(_mcp.$V.$3Wa)},set_$ER:function(n){this.$P(_mcp.$V.$3Wa,n);return n},get_$Qk:function(){return this.$w(_mcp.$V.$3HX)},set_$Qk:function(n){this.$P(_mcp.$V.$3HX,n);return n},get_$Q1:function(){return this.$w(_mcp.$V.$3Iq)},set_$Q1:function(n){this.$P(_mcp.$V.$3Iq,n);return n},get_$ExJ:function(){return this.get_$ru()},get_$4Hd:function(){return this.$w(_mcp.$V.$7F7)},set_$4Hd:function(n){this.$P(_mcp.$V.$7F7,n);return n},get_$ru:function(){return _a.$c.$43&&(this.get_$PO()||this.get_$St())},get_$PO:function(){if(!_a.$c.$43||!_a.$c.get_$22a()||!this.$6Sj()||_g.$O.get_$Q().get_$1j().get_$tN())return!1;var n=_g.$O.get_$Q().get_$VP();return!!n&&n.AlwaysEncrypt||this.$w(_mcp.$V.$3af)},set_$PO:function(n){this.$P(_mcp.$V.$3af,n);this.$4(_mcp.$V.$4Ka);_js.Trace.logInfo(_a.$0.$52,"Context.SmimeEncryptMessage is set to "+n);return n},get_$St:function(){if(!_a.$c.$43||!_a.$c.get_$22a()||!this.$6Sj()||_g.$O.get_$Q().get_$1j().get_$tN())return!1;var n=_g.$O.get_$Q().get_$VP();return!!n&&n.AlwaysSign||this.$w(_mcp.$V.$3ai)},set_$St:function(n){this.$P(_mcp.$V.$3ai,n);this.$4(_mcp.$V.$4Ka);_js.Trace.logInfo(_a.$0.$52,"Context.SmimeSignMessage is set to "+n);return n},get_$9lW:function(){return _g.$O.get_$Q().get_$VP()&&(_g.$O.get_$Q().get_$VP().AlwaysEncrypt||_g.$O.get_$Q().get_$1j().get_$tN())||this.get_$ot()?!1:!0},get_$9lX:function(){return _g.$O.get_$Q().get_$VP()&&(_g.$O.get_$Q().get_$VP().AlwaysSign||_g.$O.get_$Q().get_$1j().get_$tN())||this.get_$ot()?!1:!0},get_$5N:function(){return this.$w(_mcp.$V.$34Y)},set_$5N:function(n){this.$P(_mcp.$V.$34Y,n);return n},get_$3SR:function(){return this.$w(_mcp.$V.$6rR)},set_$3SR:function(n){this.$P(_mcp.$V.$6rR,n);return n},get_$3J3:function(){if(this.get_$ov()||_y.$z.$1Q.get_$lJ()||this.get_$ru())return!1;var n=this.get_$9i();return!n||!!n.get_$R9()||n.get_$KR()},get_$6SL:function(){return OwaApplication.$Ou?!1:this.get_$6W()!==8&&!this.get_$1Ed()},get_$23H:function(){return this.$w(_mcp.$V.$6Rb)},set_$23H:function(n){this.$P(_mcp.$V.$6Rb,n);return n},get_$4GV:function(){return this.$9jE},get_$1Ed:function(){return this.get_$6W()===11||this.get_$6W()===12||this.get_$6W()===13},get_$di:function(){return this.$w(_mcp.$V.$6s3)},set_$di:function(n){this.$P(_mcp.$V.$6s3,n);return n},get_$1N4:function(){return this.$w(_mcp.$V.$6s2)},set_$1N4:function(n){this.$P(_mcp.$V.$6s2,n);return n},get_$2Bg:function(){return this.$w(_mcp.$V.$7OS)},set_$2Bg:function(n){this.$P(_mcp.$V.$7OS,n);return n},set_$pm:function(n){this.$P(_mcp.$V.$9OR,n);return n},get_$NB:function(){return this.$w(_mcp.$V.$6LA)},set_$NB:function(n){this.$P(_mcp.$V.$6LA,n);return n},get_$nu:function(){return this.$w(_mcp.$V.$2HX)},set_$nu:function(n){this.$P(_mcp.$V.$2HX,n);return n},get_$2lt:function(){return this.$w(_mcp.$V.$6RH)},set_$2lt:function(n){this.$P(_mcp.$V.$6RH,n);return n},get_$3xv:function(){return this.$w(_mcp.$V.$6SC)},set_$3xv:function(n){this.$P(_mcp.$V.$6SC,n);return n},get_$3FQ:function(){return this.$w(_mcp.$V.$6Jp)},set_$3FQ:function(n){this.$P(_mcp.$V.$6Jp,n);return n},get_$9R7:function(){return this.$w(_mcp.$V.$72n)},set_$9R7:function(n){this.$P(_mcp.$V.$72n,n);return n},get_$9lV:function(){this.$5Ye||(this.$5Ye=this.$4oQ());return this.$5Ye},get_$49P:function(){return this.$w(_mcp.$V.$aW)},set_$49P:function(n){this.$P(_mcp.$V.$aW,n);return n},get_$36v:function(){return this.$w(_mcp.$V.$5xV)},set_$36v:function(n){this.$P(_mcp.$V.$5xV,n);return n},get_$6p4:function(){return this.$47U},set_$6p4:function(n){this.$47U=n;return n},$6MF:function(n){this.set_$5j(_mcp.$V.$9Dv(_y.$Ow,n,_mcp.$V.$25w.$3C,0));this.set_$6W(_mcp.$V.$9Dv(_y.$1m,n,_mcp.$V.$47u.$3C,0));this.set_$XV(_mcp.$V.$9Dt(n,_mcp.$V.$5Vm.$3C,!0));this.set_$1oS(_mcp.$V.$9Dt(n,"IsCalendarItem",!1));if(n&&"StoreId"in n){this.set_$rn(!1);this.set_$9my(n.StoreId)}this.$C3O(n);this.set_$OS(0===this.get_$6W()||4===this.get_$6W())},$6MG:function(n){_g.$gc.isInstanceOfType(n)?this.set_$6W(1):_g.$gb.isInstanceOfType(n)?this.set_$6W(2):_g.$t1.isInstanceOfType(n)&&this.set_$6W(3);this.$9sZ(n,n.get_$2SQ());this.set_$14N(n.get_$2tW());this.set_$5G2(n.get_$4Aa());this.set_$Fc(n.get_$y());this.set_$3n(n.get_$3n());this.set_$dk(n.get_$2SQ().get_$1Z());this.set_$5Q(n.get_$5Q());this.set_$77(n.get_$77()?n.get_$77().get_$7U():null);this.set_$7x(n.get_$7x()?n.get_$7x().get_$7U():null);this.set_$AO(n.get_$AO()?n.get_$AO().get_$7U():null);this.set_$XV(!1);this.set_$Bv(n.get_$Bv());this.$4W9(n);this.set_$9i(n.get_$9i());this.set_$ER(n.get_$ER());this.set_$Qk(n.get_$Qk());this.set_$Q1(n.get_$Q1());this.get_$9i()&&!this.get_$9i().get_$R9()?this.set_$6P(this.get_$9i().get_$6P()):$C(n.get_$2SQ())||(n.get_$sz()?this.set_$6P(n.get_$sz().get_$6P()):this.set_$6P(n.get_$zy()===1?"Text":"HTML"));this.$8O5(n);this.set_$OS(!1);this.set_$rn(!0);_js.Trace.logInfo(_a.$0.$15,"Initialized context with smart response, context:"+this.toString())},$4rz:function(n){if($C(n))throw Error.argumentNull("message");this.$9sZ(n,n.get_$4n());this.set_$ix(n);this.set_$Fc(n.get_$y());this.set_$3n(n.get_$3n());this.set_$dk(n.get_$sz()?n.get_$sz().get_$1Z():n.get_$4n().get_$1Z());this.set_$5N(n.get_$5N());if(_g.$5w.isInstanceOfType(n)){var t=n;this.set_$5Q(t.get_$5Q());this.set_$77(t.get_$77()?t.get_$77().$5uX():null);this.set_$7x(t.get_$7x()?t.get_$7x().$5uX():null);this.set_$AO(t.get_$AO()?t.get_$AO().$5uX():null);this.set_$Qk(t.get_$Qk());this.set_$Q1(t.get_$Q1())}else if(_g.$L4.isInstanceOfType(n)){var u=n;this.set_$5Q(u.get_$5Q())}this.set_$XV(!1);this.set_$Bv(n.get_$Bv());this.$4W9(n);this.set_$9i(n.get_$9i());this.set_$ER(n.get_$ER());n.get_$9i()&&!n.get_$9i().get_$R9()?this.set_$6P(n.get_$9i().get_$6P()):n.get_$sz()?this.set_$6P(n.get_$sz().get_$6P()):this.set_$6P(n.get_$zy()===1?"Text":"HTML");this.set_$ov(_g.$Md.isInstanceOfType(n));if(this.get_$ov()){var i=n;this.$4c2(i.get_$Px());this.set_$230(_g.$9y.isInstanceOfType(i));i.get_$5Q()&&this.set_$5Q(i.get_$5Q());i.get_$Ek()&&this.set_$Ek(i.get_$Ek())}n.get_$1Ak()&&n.get_$1Ak().get_$A()?this.set_$EU(n.get_$1Ak()?n.get_$1Ak().get_$7U():null):(!this.get_$23H()||this.get_$OS())&&this.set_$EU(n.get_$1l()?n.get_$1l().get_$7U():null);if(this.get_$EU()&&n.get_$4n().get_$6P()==="Text")for(var r=0;r<this.get_$EU().get_$A();r++)this.get_$EU().get_$E(r)&&this.get_$EU().get_$E(r).get_$C9()&&this.get_$EU().get_$E(r).set_$C9(!1);this.$8O5(n);this.set_$OS(!0);this.set_$rn(!0);_js.Trace.logInfo(_a.$0.$15,"Initialized context with draft, context:"+this.toString())},$1Ta:function(n){this.set_$IU(n);this.$C39(n)},$1kC:function(n){var i=new _g.$5w;var t;this.$9gp(i,t={val:n}),n=t.val;return i},$5uE:function(n){var i=new _g.$L4;var t;this.$9gp(i,t={val:n}),n=t.val;return i},$7ec:function(){var t=this.$7gR();_a.$4.$z(this.$Vy,"GetRawEditorContentCommand");this.$Vy.$11();var n=this.get_$dk();t.set_$1Z(n);this.$51w=_js.$9.$o(n)?0:n.length;_js.Trace.logInfo(_a.$0.$15,"MailComposeContext.CreateBodyFromEditor, RawContentLength: "+this.$51w.toString());return t},$EtU:function(n){var t=this.get_$T5();if(!t||this.get_$Bv()===t.get_$Bv()){this.set_$Bv(n);t&&t.set_$Bv(n)}},$7nZ:function(){if(this.$3Hc&&this.$6TW){this.$Vx.$11();if($C(this.get_$T5())){this.set_$T5(_mcp.$1W.$33M(this));_js.Trace.logInfo(_a.$0.$15,"Captured baseline for the first time, context:"+this.toString());if(this.$5Bd&&this.$jS){this.$jS.set_$MT(this.get_$T5().get_$MT());this.$5Bd=!1}if(!this.get_$Fc()||this.get_$23H()&&this.get_$1Op()){this.$jS=_mcp.$1W.$33M(this);_js.Trace.logInfo(_a.$0.$15,"Captured initial baseline for context:"+this.toString())}}else{_mcp.$1W.$2W(this.get_$T5(),this);_js.Trace.logInfo(_a.$0.$15,"Updated baseline, context:"+this.toString())}}},$IN:function(){if($C(this.get_$T5()))return!1;this.$Vx.$11();return!this.get_$T5().$7nQ(this)},$6HY:function(n){this.$4oZ.$11();var t=this.get_$1vK();t=t?t.length>n?this.get_$1vK().substr(0,n)+"...":t:"";return t},$2A1:function(n,t,i,r){this.set_$77(new _js.$X);var u=n?n.Mailbox:null;if(!_mcp.$V.$1gs){var s=_g.$O.get_$Q().get_$4X();_mcp.$V.$1gs=_js.$9.$o(s.get_$1uX())?s.get_$Fu()||"":s.get_$s4()||""}if(this.get_$8NJ()||this.get_$6W()!==8&&(!r||!r.get_$A())&&u&&(2!==this.get_$6W()||!_mcp.$V.$23P(u.EmailAddress))){this.get_$77().$F(u);_js.Trace.logInfo(_a.$0.$15,"Adding original From to To, Operation="+this.get_$6W()+"; From="+_g.$1Y.$1cu(n)+"; Self="+_mcp.$V.$1gs)}if(this.get_$6W()===2||this.get_$6W()===8){_js.Trace.logInfo(_a.$0.$15,"Adding "+(t?t.get_$A():0)+" To recipients to To.");_mcp.$V.$7Sf(t,this.get_$77(),u,null);_js.Trace.logInfo(_a.$0.$15,"Adding "+(i?i.get_$A():0)+" Cc recipients to Cc");this.set_$7x(new _js.$X);_mcp.$V.$7Sf(i,this.get_$7x(),u,this.get_$77())}this.$7Ss();if(r&&r.get_$A()>0)if(this.get_$6W()===1){this.get_$77().$1u();for(var o=0;o<r.get_$A();o++){var c=r.get_$E(o);this.get_$77().$F(c)}}else if(this.get_$6W()===2)for(var f=0;f<r.get_$A();f++){var e=r.get_$E(f);var l=this;if(this.get_$77().get_$A()===this.get_$77().$HC(function(n){return _g.$1Y.$5b(e,n)})){var a=this;var h=this.get_$7x().$HC(function(n){return _g.$1Y.$5b(e,n)});h!==this.get_$7x().get_$A()&&this.get_$7x().$5W(h);this.get_$77().$F(e)}}if(this.get_$6W()!==8&&u&&0===this.get_$77().get_$A()&&(!this.get_$7x()||0===this.get_$7x().get_$A())){this.get_$77().$F(u);_js.Trace.logInfo(_a.$0.$15,"Adding original From since there are no recipients left, From="+_g.$1Y.$1cu(n))}},toString:function(){var n="Id="+this.get_$D1()+"; Op="+this.get_$6W()+"; Mode="+this.get_$5j()+"; Oid=";n+=this.get_$14N()?this.get_$14N().Id+":"+this.get_$14N().ChangeKey+";":this.$8N&&this.$8N.get_$y()?this.$8N.get_$y().Id+":"+this.$8N.get_$y().ChangeKey+";":"null;";n+=" Did=";n+=this.get_$Fc()?this.get_$Fc().Id+":"+this.get_$Fc().ChangeKey+";":this.get_$ix()&&this.get_$ix().get_$y()?this.get_$ix().get_$y().Id+":"+this.get_$ix().get_$y().ChangeKey+";":"null;";n+=" Subject="+this.get_$3n()+"; RawContentLength="+(_js.$9.$o(this.get_$dk())?"0":this.get_$dk().length.toString())+"; ContentLength="+(_js.$9.$o(this.get_$MT())?"0":this.get_$MT().length.toString())+"; TextEditorContentLength="+(_js.$9.$o(this.get_$1vK())?"0":this.get_$1vK().length.toString())+"; BodyType="+this.get_$6P()+";";var r;_mcp.$V.$6WO("To",this.get_$77(),this.get_$10q(),r={val:n}),n=r.val;var i;_mcp.$V.$6WO("Cc",this.get_$7x(),this.get_$xl(),i={val:n}),n=i.val;var t;_mcp.$V.$6WO("Bcc",this.get_$AO(),this.get_$qX(),t={val:n}),n=t.val;n+=" AutoSig="+this.get_$XV()+"; Imp="+this.get_$Bv()+"; QuotedBodyLength="+(_js.$9.$o(this.get_$1gD())?"0":this.get_$1gD().length.toString())+"; IsComplete="+this.get_$rn()+"; IsMeeting="+this.get_$ov()+"; IsMeetingForward="+this.get_$230()+"; IsReplyBcc="+this.get_$3xq()+"; HasLocation="+this.get_$3FJ()+"; MeetingTime="+(this.get_$1pL()?this.get_$1pL().get_$Q2()+":"+(this.get_$1pL().get_$1T()?this.get_$1pL().get_$1T().$Ep():"null")+":"+(this.get_$1pL().get_$2y()?this.get_$1pL().get_$2y().$Ep():"null"):"null")+"; From="+_g.$1Y.$1cu(this.get_$5Q())+"; Sender="+_g.$1Y.$1cu(this.get_$Ek())+"; IsFromShown="+this.get_$ot()+"; IsBccShown="+this.get_$1LG()+"; AttachmentCount="+(this.get_$EU()?this.get_$EU().get_$A().toString():"0")+"; UpgradeFailed="+this.get_$1ZE()+"; HasBaseline="+(!!this.get_$T5()).toString()+"; HasInitBaseline="+(!!this.$jS).toString()+"; UserSaved="+this.get_$1TJ()+"; IsReplyForward="+this.get_$1LY()+"; HasDraft="+(!!this.get_$ix()).toString()+"; HasRMLD="+(!!this.get_$9i()).toString()+"; Classified="+this.get_$a4()+"; Class="+this.get_$gv()+"; Sensitivity="+this.get_$ER()+"; DeliveryReceipt="+this.get_$Qk()+"; ReadReceipt="+this.get_$Q1()+"; SmimeEncryptMessage="+this.get_$PO()+"; SmimeSignMessage="+this.get_$St()+"; ConversationId="+(this.get_$5N()?this.get_$5N().Id+":"+this.get_$5N().ChangeKey:"null")+" ParentConversationNodeId="+this.get_$3SR()+"; IsOriCalId="+this.get_$1oS()+"; OccurrenceRefMaster="+this.get_$1LT()+"; IsLoadedDraft="+this.get_$22x()+"; IsMovedToDraftFromOutbox="+this.get_$3xF()+"; IsUpgraded="+this.get_$OS()+"; IsCached="+this.$8Rg+";";return n},$AU:function(){_js.Trace.logInfo(_a.$0.$15,"Context reset start.");this.set_$D1(null);this.get_$6W()&&this.set_$6W(0);this.get_$5j()&&this.set_$5j(0);this.get_$14N()&&this.set_$14N(null);this.get_$IU()&&this.set_$IU(null);this.get_$Fc()&&this.set_$Fc(null);_js.$9.$o(this.get_$3n())||this.set_$3n(null);_js.$9.$o(this.get_$dk())||this.set_$dk("");_js.$9.$o(this.get_$MT())||this.set_$MT("");_js.$9.$o(this.get_$1vK())||this.set_$1vK("");this.get_$77()&&this.set_$77(null);_js.$9.$o(this.get_$10q())||this.set_$10q(null);this.get_$7x()&&this.set_$7x(null);_js.$9.$o(this.get_$xl())||this.set_$xl(null);this.get_$AO()&&this.set_$AO(null);_js.$9.$o(this.get_$qX())||this.set_$qX(null);this.get_$XV()||this.set_$XV(!0);this.get_$Bv()!=="Normal"&&this.set_$Bv("Normal");_js.$9.$o(this.get_$1gD())||this.set_$1gD(null);this.get_$rn()&&this.set_$rn(!1);this.get_$ov()&&this.set_$ov(!1);this.get_$230()&&this.set_$230(!1);this.get_$3xq()&&this.set_$3xq(!1);this.get_$6D()&&this.set_$6D(null);this.get_$3FJ()&&this.set_$3FJ(!1);this.get_$1pL()&&this.set_$1pL(null);this.get_$5Q()&&this.set_$5Q(null);this.get_$Ek()&&this.set_$Ek(null);this.get_$OS()&&this.set_$OS(!1);this.get_$ot()&&this.set_$ot(!1);this.get_$1LG()&&this.set_$1LG(!1);this.get_$EU()&&this.set_$EU(null);this.get_$1ZE()&&this.set_$1ZE(!1);this.get_$T5()&&this.set_$T5(null);this.get_$1TJ()&&this.set_$1TJ(!1);this.get_$1LY()&&this.set_$1LY(!1);this.get_$ix()&&this.set_$ix(null);this.get_$9i()&&this.set_$9i(null);_js.$9.$o(this.get_$gz())||this.set_$gz(null);this.get_$a4()&&this.set_$a4(!1);_js.$9.$o(this.get_$l1())||this.set_$l1(null);_js.$9.$o(this.get_$gv())||this.set_$gv(null);_js.$9.$o(this.get_$eR())||this.set_$eR(null);this.get_$1xa()&&this.set_$1xa(!1);this.get_$ER()!=="Normal"&&this.set_$ER("Normal");this.get_$Qk()&&this.set_$Qk(!1);this.get_$Q1()&&this.set_$Q1(!1);this.get_$PO()&&this.set_$PO(!1);this.get_$St()&&this.set_$St(!1);this.get_$5Yi()&&this.set_$5Yi(null);this.get_$5N()&&this.set_$5N(null);_js.$9.$o(this.get_$3SR())||this.set_$3SR(null);this.get_$1oS()&&this.set_$1oS(!1);this.get_$1LT()&&this.set_$1LT(!1);this.get_$22x()&&this.set_$22x(!1);this.get_$3xF()&&this.set_$3xF(!1);this.get_$nu()&&this.set_$nu(null);_js.Trace.logInfo(_a.$0.$15,"Context reset end.")},$6S4:function(){return!!this.get_$IU().get_$9i()&&0===this.get_$IU().get_$9i().get_$R9()&&!this.get_$IU().get_$9i().get_$4bI()&&!this.get_$IU().get_$9i().get_$4dJ()},$3rz:function(){var n=null;if(this.get_$5Q()&&this.get_$5Q().Mailbox&&!_js.$9.$o(this.get_$5Q().Mailbox.EmailAddress))n=this.get_$5Q().Mailbox;else if(this.get_$Ek()&&this.get_$Ek().Mailbox&&!_js.$9.$o(this.get_$Ek().Mailbox.EmailAddress))n=this.get_$Ek().Mailbox;else if(!_js.$9.$o(_mcp.$V.$1gs)){n=new _g.$1K;n.EmailAddress=_mcp.$V.$1gs;n.MailboxType="Mailbox";n.RoutingType="SMTP"}return n},$6Sj:function(){if(!_a.$c.$43)return!1;switch(this.get_$6W()){case 0:case 1:case 2:case 3:case 4:break;default:return!1}return this.get_$ix()&&!this.$6Si(this.get_$ix())?!1:this.get_$IU()&&!this.$6Si(this.get_$IU())?!1:_js.$9.$o(this.get_$36v())?!0:!1},$6Si:function(n){if(_js.$9.$o(n.get_$CJ())||n.get_$CJ()==="IPM.Note"||n.get_$Mg())return!0;else{var i=this.get_$6W()===1||this.get_$6W()===2;var t=i||this.get_$6W()===3;return i&&(n.get_$CJ().startsWith("IPM.Schedule.Meeting")||n.get_$CJ().startsWith("IPM.Appointment"))?!0:t&&n.get_$CJ().startsWith("REPORT.IPM.Note")?!0:t&&n.get_$CJ().startsWith("IPM.Note.Rules")?!0:t&&n.get_$CJ()==="IPM.Post"?!0:!1}},$9vC:function(n){_js.Trace.logInfo(_a.$0.$52,"Updating S/MIME options...");if(_a.$c.$43)switch(n){case 6:this.set_$PO(!0);this.set_$St(!1);break;case 10:case 11:this.set_$PO(!1);this.set_$St(!0);break;case 12:case 13:case 14:this.set_$PO(!0);this.set_$St(!0);break;case-1:case 0:default:this.set_$PO(!1);this.set_$St(!1);break}},$Eww:function(n){_js.Trace.logInfo(_a.$0.$52,"Upgrading S/MIME options...");if(_a.$c.$43)switch(n){case 6:this.set_$PO(!0);break;case 10:case 11:this.set_$St(!0);break;case 12:case 13:case 14:this.set_$PO(!0);this.set_$St(!0);break;case-1:case 0:default:break}},$7BU:function(){if(this.get_$di()){var t=!1;var n=this;this.$6tP=function(i){if(!t&&n.get_$di()){_y.$2E.$1F(n.get_$di(),null,i);n.set_$di(null);t=!0}}}},$4oQ:function(n,t){var i=this.get_$5Yi();if(!i||!i.length)return null;$C(n)&&(n=0);$C(t)&&(t=i.length);for(var r=new(_ff.$18.$$(String)),h=n;h<n+t;h++){var s=i[h];if(s&&s.length)for(var a=s,v=a.length,f=0;f<v;++f){var u=a[f];_js.$9.$o(u)||r.$5o(u)||r.$F(u)}}if(n+t<i.length){var o=i[i.length-1];if(o&&o.length>0)for(var l=o,y=l.length,e=0;e<y;++e){var c=l[e];_js.$9.$o(c)||r.$5o(c)||r.$F(c)}}return r.get_$A()>0?r.get_$1z():null},$9gp:function(n,t){t.val=$C(t.val)?!1:t.val;n.set_$3n(this.get_$3n());n.set_$Bv(this.get_$Bv());n.set_$y(this.get_$Fc());n.set_$1l(new(_a.$2T.$$(_g.Attachment,_g.$Bf)));if(this.get_$ru()){var o=_g.$O.get_$Q().get_$VP().ClearSign;n.set_$CJ(this.get_$PO()?"IPM.Note.SMIME":o?"IPM.Note.SMIME.MultipartSigned":"IPM.Note.SMIME");n.get_$CJ()==="IPM.Note.SMIME.MultipartSigned"?n.set_$4n(this.$7eb(t.val)):n.set_$4n(new _g.$5E(new _g.$5d(this.get_$6P(),"")));var e=_a.$5u.$Jc(this.get_$9lU());n.set_$c0(new _g.$Wg(e))}else{n.set_$4n(this.$7eb(t.val));(this.get_$ix()&&this.get_$ix().get_$Mg()||this.get_$IU()&&this.get_$IU().get_$Mg())&&n.set_$CJ("IPM.Note");this.get_$EU()&&n.get_$1l().$3x(this.get_$EU().$3T())}n.set_$9i(this.get_$9i());n.set_$ER(this.get_$ER());n.set_$a4(this.get_$a4());n.set_$gv(this.get_$gv());n.set_$eR(this.get_$eR());n.set_$l1(this.get_$l1());n.set_$uB(this.get_$uB());n.set_$qx(this.get_$qx());n.set_$16w(this.get_$16w());if(this.get_$nu()){n.set_$Pi(new(_a.$2T.$$(_g.$HL,_g.$Bk)));n.get_$Pi().$3x(this.get_$nu().$3T())}if(_g.$5w.isInstanceOfType(n)){var i=n;i.set_$5Q(this.get_$5Q());if(this.get_$ru()&&this.$1ht){if(this.$1ht===1){i.set_$77(new(_a.$u.$$(_g.$1K)));this.get_$77()&&i.get_$77().$3x(this.get_$77().$3T());i.set_$7x(new(_a.$u.$$(_g.$1K)));this.get_$7x()&&i.get_$7x().$3x(this.get_$7x().$3T())}else if(this.$1ht===2){i.set_$AO(new(_a.$u.$$(_g.$1K)));this.get_$AO()&&i.get_$AO().$F(this.get_$AO().get_$E(this.$3k8))}else if(this.$1ht===3){i.set_$AO(new(_a.$u.$$(_g.$1K)));this.get_$AO()&&i.get_$AO().$3x(this.get_$AO().$3T())}}else{i.set_$77(new(_a.$u.$$(_g.$1K)));this.get_$77()&&i.get_$77().$3x(this.get_$77().$3T());i.set_$7x(new(_a.$u.$$(_g.$1K)));this.get_$7x()&&i.get_$7x().$3x(this.get_$7x().$3T());i.set_$AO(new(_a.$u.$$(_g.$1K)));this.get_$AO()&&i.get_$AO().$3x(this.get_$AO().$3T())}i.set_$Qk(this.get_$Qk());i.set_$Q1(this.get_$Q1());i.set_$PO(this.get_$PO());i.set_$St(this.get_$St())}else{var u=n;u.set_$3G(this.get_$2sA());var f=_g.$O.get_$Q().get_$4X();var r=null;r=_js.$9.$o(f.get_$s4())?null!==this.get_$5Q()&&this.get_$5Q().Mailbox?this.get_$5Q().Mailbox.EmailAddress:_h.$2j.$4mh(null)||f.get_$Fu():f.get_$s4();if(r){u.set_$5Q(new _g.$8v);u.get_$5Q().Mailbox=new _g.$1K;u.get_$5Q().Mailbox.EmailAddress=r}}},$ApZ:function(n,t){this.$4("ShowMeetingReadonlyFields")},$C3O:function(n){var t=this.$Dn5(n);switch(this.get_$6W()){case 0:case 4:this.set_$Fc(t);break;case 1:case 2:case 3:this.set_$14N(t);break}},$8O5:function(n){if(n.get_$Pi()){this.set_$nu(new _js.$X);this.get_$nu().$3x(n.get_$Pi().$3T())}},$Dn5:function(n){var t=null;if(!$C(n)&&"Id"in n){t=new _g.$1T(n.Id);"ChangeKey"in n&&(t.ChangeKey=n.ChangeKey)}return t},$9sZ:function(n,t){0===n.get_$zy()&&n.set_$zy(t&&t.get_$6P()==="Text"?1:3)},$C3C:function(n){var r=_h.$2j.$4mh(n);if(r){this.set_$5Q(new _g.$8v);this.get_$5Q().Mailbox=new _g.$1K;this.get_$5Q().Mailbox.EmailAddress=r}this.set_$1oS(!1);this.get_$9i()&&!this.get_$9i().get_$R9()?this.set_$6P(n.get_$9i().get_$6P()):n.get_$sz()?this.set_$6P(n.get_$sz().get_$6P()):n.get_$4n()&&this.set_$6P(n.get_$4n().get_$6P());switch(this.get_$6W()){case 1:case 2:case 12:this.$4W9(n);if(_g.$5w.isInstanceOfType(n)){var t=n;t.get_$S6()?this.$2A1(t.get_$5Q()||t.get_$Ek(),null,null,null):this.$2A1(t.get_$5Q()||t.get_$Ek(),t.get_$77()?t.get_$77().get_$7U():null,t.get_$7x()?t.get_$7x().get_$7U():null,t.get_$5M9()?t.get_$5M9().get_$7U():null);this.set_$3xq(this.get_$6W()===2&&n.get_$51s()&&!t.get_$8TD());this.set_$5G2(n.get_$2fx())}else if(_g.$L4.isInstanceOfType(n)){var u=n;this.$2A1(u.get_$5Q()||u.get_$Ek(),null,null,null)}this.$70L(n);break;case 5:case 6:case 7:if(_g.$5w.isInstanceOfType(n)){var i=n;this.$2A1(i.get_$5Q()||i.get_$Ek(),i.get_$77()?i.get_$77().get_$7U():null,i.get_$7x()?i.get_$7x().get_$7U():null,i.get_$5M9()?i.get_$5M9().get_$7U():null)}break;case 3:_g.$Md.isInstanceOfType(n)||this.$4W9(n);this.set_$5G2(n.get_$2fx());this.$7Ss();this.$70L(n);break;case 9:case 10:_g.$5w.isInstanceOfType(n)?this.$2A1(n.get_$Ek(),null,null,null):_g.$L4.isInstanceOfType(n)&&this.$2A1(n.get_$Ek(),null,null,null);this.$70L(n);break;default:this.$9p0();break}_js.Trace.logInfo(_a.$0.$15,"Initialized context with original email message, context:"+this.toString())},$C39:function(n){this.set_$14N(n.get_$y());var i=this.$6S4();this.set_$9i(i?null:n.get_$9i());this.$EXI(n.get_$149());this.set_$ER(n.get_$ER());this.set_$dk(this.get_$dk()||"");this.get_$9i()&&!this.get_$9i().get_$R9()?this.set_$6P(this.get_$9i().get_$6P()):n.get_$sz()?this.set_$6P(n.get_$sz().get_$6P()):this.set_$6P(n.get_$zy()===1?"Text":"HTML");if(!this.get_$OS()){this.set_$OS(!(this.get_$6W()===1||this.get_$6W()===2||this.get_$6W()===3||this.get_$6W()===12));this.get_$6W()!==3||_a.$c.$43&&n.get_$Mg()||i||this.get_$9i()&&this.get_$9i().get_$R9()||this.set_$EU(n.get_$1l()?n.get_$1l().get_$7U():null)}if(_g.ICalendaring.isInstanceOfType(n)){var t=n;t.$5V1();this.$C3B(t)}else if(_g.$5w.isInstanceOfType(n)||_g.$L4.isInstanceOfType(n)){if(3===this.get_$6W()&&!this.get_$OS()){this.set_$Bv(n.get_$Bv());_js.Trace.logInfo(_a.$0.$15,"Setting importance to "+this.get_$Bv()+" since we are forwarding item "+_h.$D0.$1cu(n.get_$y())+" with that importance")}this.$C3C(n)}else throw Error.invalidOperation(String.format("Original item of type {0} is not supported.",Object.getType(n).getName()));this.$9sT();_g.$5w.isInstanceOfType(n)&&n.$21w?this.set_$rn(!1):this.set_$rn(!0)},$BmC:function(n){var t=null;_g.$Me.isInstanceOfType(n)||_g.$Go.isInstanceOfType(n)?t=n.get_$5Q():n.get_$MA()?t=n.get_$MA():_js.Trace.logError(_a.$0.$15,"ICalendaring doesnt have an organizer");return t},$9sT:function(){var n=new(_ff.$18.$$(String));this.get_$230()&&n.$3x(_g.$9y.$6Fl(this.get_$EU()));if(this.$8N&&_a.$c.$43&&this.$8N.get_$Mg()&&this.$8N.get_$3FR()){var t=this.$8N.get_$1l().get_$E(0).get_$6I().Id;n.$F(t)}this.set_$2Dn(n.$3T())},$C3B:function(n){this.set_$1oS(!0);n.get_$4n()&&this.set_$6P(n.get_$4n().get_$6P());var r=this.$BmC(n);var t;var i;if(_g.$Me.isInstanceOfType(n)||_g.$Go.isInstanceOfType(n)){t=n.get_$77()?_g.$1Y.$3nl(n.get_$77().get_$7U()):null;i=n.get_$7x()?_g.$1Y.$3nl(n.get_$7x().get_$7U()):null}else{t=n.get_$Bm()?_g.$1Y.$3nl(_g.$2o.$7J4(n.get_$Bm().get_$7U())):null;i=n.get_$DH()?_g.$1Y.$3nl(_g.$2o.$7J4(n.get_$DH().get_$7U())):null}switch(this.get_$6W()){case 1:case 2:this.$2A1(r,t,i,null);break;case 5:case 6:case 7:this.$2A1(r,t,i,null);this.$4c2(n);this.set_$3tm(!0);break;case 8:var u=n.get_$Bm().$4s();u.$3x(n.get_$EP().$3T());t=_g.$1Y.$3nl(_g.$2o.$7J4(u.get_$7U()));this.$2A1(r,t,i,null);this.$4c2(n);this.set_$3tm(!0);break;case 3:if(_g.$9y.isInstanceOfType(n)||_g.$2g.isInstanceOfType(n)){this.set_$230(!0);this.set_$5Q(r);this.$4c2(n)}break;default:this.$9p0();break}this.set_$ov(!0);_js.Trace.logInfo(_a.$0.$15,"Initialized context from original calendar item, context:"+this.toString())},$4c2:function(n){this.set_$1pL(_cc.$85.$Arg(n));this.set_$6D(n.get_$6D());this.set_$3FJ(!!this.get_$6D()&&!_js.$9.$o(this.get_$6D().get_$29()))},$EXI:function(n){var t="";switch(this.get_$6W()){case 1:case 2:case 12:t=_u.Strings.l_ReplyPrefix_Text;break;case 3:t=_nbs.NonBootStrings.l_ForwardPrefix_Text;break;case 5:t=_nbs.NonBootStrings.l_AcceptPrefix_Text;break;case 6:t=_nbs.NonBootStrings.l_TentativelyAcceptPrefix_Text;break;case 7:t=_nbs.NonBootStrings.l_DeclinePrefix_Text;break;case 8:t=_nbs.NonBootStrings.l_CanceledMeetingMessagePrefix_Text;break;case 9:t=_nbs.NonBootStrings.l_ApprovePrefix_Text;break;case 10:t=_nbs.NonBootStrings.l_RejectPrefix_Text;break}this.get_$2Lq()&&(t=_nbs.NonBootStrings.l_NewTimeProposedPrefix_Text);var i=String.format(_nbs.NonBootStrings.l_SubjectFormat_Text,t,n);_js.Trace.logInfo(_a.$0.$15,"Formatted subject with Prefix="+t+"; Operation="+this.get_$6W());if(255<i.length){this.set_$3n(i.substr(0,255));_js.Trace.logInfo(_a.$0.$15,"Truncated subject from "+i+" to "+this.get_$3n()+" to meet the "+255+" characters rule.")}else this.set_$3n(i)},$70L:function(n){this.set_$5N(n.get_$5N());_g.$5w.isInstanceOfType(n)?this.set_$3SR(n.get_$HR()):_g.$L4.isInstanceOfType(n)&&this.set_$3SR(n.get_$HR())},$9p0:function(){var n=_js.$1I.$Gr(_y.$1m,this.get_$6W());throw Error.invalidOperation(String.format("Cannot perform operation {0} with original item.",n));},$4W9:function(n){this.set_$a4(n.get_$a4());this.set_$l1(n.get_$l1());this.set_$gv(n.get_$gv());this.set_$eR(n.get_$eR());this.set_$1xa(n.get_$1xa())},$7eb:function(n){return n?this.$7gR():this.$7ec()},$7gR:function(){var n=new _g.$5E(new _g.$5d("HTML",""));n.set_$1Z("");if(4!==this.get_$6W()&&13!==this.get_$6W()||this.get_$NB()){_js.Trace.logInfo(_a.$0.$15,"Create new body for action email message, setting body type to context body type: "+this.get_$6P());n.set_$6P(this.get_$6P())}else{_js.Trace.logInfo(_a.$0.$15,"Create new body for action email message, setting body type to text due to lack of support for RichTextEditor.");n.set_$6P("Text")}return n},$7Ss:function(){if(_y.$z.$1Q.get_$lJ()){var t=this.$3rz();if(t){var i=!1;if(this.get_$7x())for(var n=0;n<this.get_$7x().get_$A();n++){var r=this.get_$7x().get_$E(n);if(t.EmailAddress.toLowerCase()===r.EmailAddress.toLowerCase()){i=!0;break}}if(!i){this.get_$7x()||this.set_$7x(new _js.$X);this.get_$7x().$F(t);_js.Trace.logInfo(_a.$0.$15,"Adding self to CC")}}else _js.Trace.logError(_a.$0.$15,"Could not add self to CC as the address was missing")}}};_mcp.$ua=function(n){this.$1uz={};this.$Xe=n};_mcp.$ua.prototype={$Xe:null,$1EF:function(n){return n in this.$1uz},$9h4:function(n,t){if(n in this.$1uz){var i=this.$1uz[n];!i.$5W2&&t&&(this.$1uz[n]=new _mcp.$vx(t))}else this.$1uz[n]=new _mcp.$vx(t)},$7ko:function(n,t){var u=n.$v;var i=u.$c;var r=i.get_$D1();var o=i.get_$Fc();var f=!1;if(i.get_$22x())_js.Trace.logInfo(_a.$0.$15,"Not discarding a loaded draft for context "+r);else if(i.get_$1TJ())_js.Trace.logInfo(_a.$0.$15,"Not discarding an explicitly saved draft for context "+r);else if(u.get_$1X8().get_$C7z())_js.Trace.logInfo(_a.$0.$15,"Not discarding a draft currently being explicitly saved for context "+r);else if(u.get_$iD().get_$lw())_js.Trace.logInfo(_a.$0.$15,"Not discarding a draft currently being sent for context "+r);else{var e=!1;if(t)_js.Trace.logInfo(_a.$0.$15,"Skipping dirty check for context "+r);else{_js.Trace.logInfo(_a.$0.$15,"Checking dirty for determining whether to discard unused message on navigate away. Context:"+i.toString());e=u.$IN()}if(e)_js.Trace.logInfo(_a.$0.$15,"Not discarding a dirty draft for context "+r);else if(i.$jS)if(i.$jS.$5b(i.get_$T5())){if(_g.$1H.$Yr&&i.get_$1LY()&&!i.get_$Fc()){_js.Trace.logInfo(_a.$0.$15,"Calling main window to remember the pending discard for context "+r);_g.$1H.$Yr.$9h4(r,!i.get_$1TJ());f=!0}else if(!i.get_$1Ed()){_js.Trace.logInfo(_a.$0.$15,"Discarding unused draft for context "+r);this.$5xy(r,o,u.$n,i.get_$1TJ());f=!0}}else _js.Trace.logInfo(_a.$0.$15,"Not discarding a draft different from the initial baseline for context "+r);else _js.Trace.logInfo(_a.$0.$15,"Not discarding without an initial baseline for context "+r)}return f},$5xy:function(n,t,i,r){i||(i=new _mcp.$uZ(new _bc.$3e));var u;if(this.$1uz[n]){var e=this.$1uz[n];u=e.$5W2}else u=!r;if(t){var f=this.$Xe.$ALF(t,u);i.$t4(f,null,null,null);delete this.$1uz[n];_js.Trace.logInfo(_a.$0.$15,"Delete action submitted, ID={0}, Changekey={1}, isHardDelete={2}",t.Id,t.ChangeKey,u)}else{this.$1uz[n]=new _mcp.$vx(u);_js.Trace.logInfo(_a.$0.$15,"Discard pending because we do not have the draft ID yet. ContextId="+n+"; Hard="+u)}},$AVb:function(n,t){this.$5xy(n,t,new _mcp.$uZ(new _bc.$3e),!1)}};_mcp.$1W=function(){_mcp.$1W.initializeBase(this)};_mcp.$1W.$$cctor=function(){_mcp.$1W.$2aO.set_$Qp(_mcp.$1W.$4bd);_mcp.$1W.$2EX.set_$Qp(_mcp.$1W.$4bd);_mcp.$1W.$2Dq.set_$Qp(_mcp.$1W.$4bd);_mcp.$1W.$2Dj.set_$Qp(new _a.$C8(_g.Attachment));_mcp.$1W.$2HX.set_$Qp(new _a.$C8(_g.$HL))};_mcp.$1W.$33M=function(n){var t=new _mcp.$1W;_mcp.$1W.$2W(t,n);return t};_mcp.$1W.$2W=function(n,t){n.set_$3n(t.get_$3n());n.set_$MT(t.get_$MT());if(t.get_$77()){n.set_$77(new _js.$X);n.get_$77().$3x(t.get_$77().$3T())}else n.set_$77(null);n.set_$10q(t.get_$10q());if(t.get_$7x()){n.set_$7x(new _js.$X);n.get_$7x().$3x(t.get_$7x().$3T())}else n.set_$7x(null);n.set_$xl(t.get_$xl());if(t.get_$AO()){n.set_$AO(new _js.$X);n.get_$AO().$3x(t.get_$AO().$3T())}else n.set_$AO(null);if(t.get_$EU()){n.set_$EU(new _js.$X);n.get_$EU().$3x(t.get_$EU().$3T())}else n.set_$EU(null);if(t.get_$nu()){n.set_$nu(new _js.$X);n.get_$nu().$3x(t.get_$nu().$3T())}else n.set_$nu(null);n.set_$qX(t.get_$qX());n.set_$Bv(t.get_$Bv());n.set_$5Q(t.get_$5Q());n.set_$gz(t.get_$gz());n.set_$ER(t.get_$ER());n.set_$Qk(t.get_$Qk());n.set_$Q1(t.get_$Q1());n.set_$PO(t.get_$PO());n.set_$St(t.get_$St())};_mcp.$1W.$31O=function(n,t,i,r){if(i!==r&&!(_js.$9.$o(i)&&_js.$9.$o(r))||!_mcp.$1W.$7lE(n,t))return!1;if($C(n)||$C(t))return!0;for(var u=0;u<n.get_$A();u++){var e=n.get_$E(u);var f=t.get_$E(u);if(!_mcp.$1W.$5l0(e,f))return!1}return!0};_mcp.$1W.$5l0=function(n,t){return $C(n)&&!$C(t)||$C(t)&&!$C(n)?!1:$C(n)&&$C(t)?!0:_g.$1Y.$5b(n,t)};_mcp.$1W.$7lE=function(n,t){var r=_mcp.$1W.$8Co(n);var i=_mcp.$1W.$8Co(t);return r===i};_mcp.$1W.$8Co=function(n){return $C(n)?0:n.get_$A()};_mcp.$1W.$7VD=function(n,t){if(!_mcp.$1W.$7lE(n,t))return!1;if(!n||!t)return!0;for(var i=0;i<n.get_$A();i++){var u=n.get_$E(i);var r=t.get_$E(i);if(!_mcp.$1W.$A6H(u,r))return!1}return!0};_mcp.$1W.$A6C=function(n,t){return _h.$Ua.$7VF(n,t)};_mcp.$1W.$A6H=function(n,t){return!n&&t||!t&&n?!1:!n&&!t?!0:!n.get_$6I()&&t.get_$6I()||!t.get_$6I()&&n.get_$6I()?!1:n.get_$6I()&&n.get_$6I().Id!==t.get_$6I().Id?!1:n.get_$1x()!==t.get_$1x()?!1:n.get_$KK()!==t.get_$KK()?!1:n.get_$SA()!==t.get_$SA()?!1:n.get_$4Vn()!==t.get_$4Vn()?!1:n.get_$8A()!==t.get_$8A()?!1:!n.get_$Jl()&&t.get_$Jl()||!t.get_$Jl()&&n.get_$Jl()?!1:n.get_$Jl()&&!n.get_$Jl().$5b(t.get_$Jl())?!1:n.get_$C9()!==t.get_$C9()?!1:!0};_mcp.$1W.prototype={get_$3n:function(){return this.$w(_mcp.$1W.$qA)},set_$3n:function(n){this.$P(_mcp.$1W.$qA,n);return n},get_$MT:function(){return this.$w(_mcp.$1W.$37l)},set_$MT:function(n){this.$P(_mcp.$1W.$37l,n);return n},get_$77:function(){return this.$w(_mcp.$1W.$2aO)},set_$77:function(n){this.$P(_mcp.$1W.$2aO,n);return n},get_$10q:function(){return this.$w(_mcp.$1W.$3cX)},set_$10q:function(n){this.$P(_mcp.$1W.$3cX,n);return n},get_$7x:function(){return this.$w(_mcp.$1W.$2EX)},set_$7x:function(n){this.$P(_mcp.$1W.$2EX,n);return n},get_$xl:function(){return this.$w(_mcp.$1W.$33V)},set_$xl:function(n){this.$P(_mcp.$1W.$33V,n);return n},get_$AO:function(){return this.$w(_mcp.$1W.$2Dq)},set_$AO:function(n){this.$P(_mcp.$1W.$2Dq,n);return n},get_$qX:function(){return this.$w(_mcp.$1W.$32G)},set_$qX:function(n){this.$P(_mcp.$1W.$32G,n);return n},get_$Bv:function(){return this.$w(_mcp.$1W.$3G7)},set_$Bv:function(n){this.$P(_mcp.$1W.$3G7,n);return n},get_$5Q:function(){return this.$w(_mcp.$1W.$2II)},set_$5Q:function(n){this.$P(_mcp.$1W.$2II,n);return n},get_$gz:function(){return this.$w(_mcp.$1W.$341)},set_$gz:function(n){this.$P(_mcp.$1W.$341,n);return n},get_$ER:function(){return this.$w(_mcp.$1W.$3Wa)},set_$ER:function(n){this.$P(_mcp.$1W.$3Wa,n);return n},get_$Qk:function(){return this.$w(_mcp.$1W.$3HX)},set_$Qk:function(n){this.$P(_mcp.$1W.$3HX,n);return n},get_$Q1:function(){return this.$w(_mcp.$1W.$3Iq)},set_$Q1:function(n){this.$P(_mcp.$1W.$3Iq,n);return n},get_$PO:function(){return this.$w(_mcp.$1W.$3af)},set_$PO:function(n){this.$P(_mcp.$1W.$3af,n);return n},get_$St:function(){return this.$w(_mcp.$1W.$3ai)},set_$St:function(n){this.$P(_mcp.$1W.$3ai,n);return n},get_$EU:function(){return this.$w(_mcp.$1W.$2Dj)},set_$EU:function(n){this.$P(_mcp.$1W.$2Dj,n);return n},get_$nu:function(){return this.$w(_mcp.$1W.$2HX)},set_$nu:function(n){this.$P(_mcp.$1W.$2HX,n);return n},$7nQ:function(n){if(this.get_$Bv()!==n.get_$Bv()){_js.Trace.logInfo(_a.$0.$15,"Dirty due to importance: snapshotImportance={0}, contextImportance={1}",this.get_$Bv(),n.get_$Bv());return!1}if(this.get_$3n()!==n.get_$3n()){_js.Trace.logInfo(_a.$0.$15,"Dirty due to subject: snapshotSubjectLength={0}, contextSubjectLength={1}",$C(this.get_$3n())?0:this.get_$3n().length,$C(n.get_$3n())?0:n.get_$3n().length);return!1}if(this.get_$gz()!==n.get_$gz()){_js.Trace.logInfo(_a.$0.$15,"Dirty due to compliance ID: snapshotId={0}, contextId={1}",this.get_$gz(),n.get_$gz());return!1}if(this.get_$ER()!==n.get_$ER()){_js.Trace.logInfo(_a.$0.$15,"Dirty due to sensitivity: snapshot={0}, context={1}",this.get_$ER(),n.get_$ER());return!1}if(this.get_$Qk()!==n.get_$Qk()){_js.Trace.logInfo(_a.$0.$15,"Dirty due to IsDeliveryReceiptRequested: snapshot={0}, context={1}",this.get_$Qk(),n.get_$Qk());return!1}if(this.get_$Q1()!==n.get_$Q1()){_js.Trace.logInfo(_a.$0.$15,"Dirty due to IsReadReceiptRequested: snapshot={0}, context={1}",this.get_$Q1(),n.get_$Q1());return!1}if(this.get_$PO()!==n.get_$PO()){_js.Trace.logInfo(_a.$0.$15,"Dirty due to SmimeEncryptMessage: snapshot={0}, context={1}",this.get_$PO(),n.get_$PO());return!1}if(this.get_$St()!==n.get_$St()){_js.Trace.logInfo(_a.$0.$15,"Dirty due to SmimeSignMessage: snapshot={0}, context={1}",this.get_$St(),n.get_$St());return!1}var i=this.get_$5Q()?this.get_$5Q().Mailbox:null;var t=n.get_$5Q()?n.get_$5Q().Mailbox:null;if(!_mcp.$1W.$5l0(i,t)){_js.Trace.logInfo(_a.$0.$15,"Dirty due to From: snapshotFrom={0}, contextFrom={1}",i?i.EmailAddress:"null",t?t.EmailAddress:"null");return!1}if(!_mcp.$1W.$31O(this.get_$77(),n.get_$77(),this.get_$10q(),n.get_$10q())){_js.Trace.logInfo(_a.$0.$15,"Dirty due to To: snapshotToCout={0}, contextToCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$C(this.get_$77())?0:this.get_$77().get_$A(),$C(n.get_$77())?0:n.get_$77().get_$A(),$C(this.get_$10q())?0:this.get_$10q().length,$C(n.get_$10q())?0:n.get_$10q().length);return!1}if(!_mcp.$1W.$31O(this.get_$7x(),n.get_$7x(),this.get_$xl(),n.get_$xl())){_js.Trace.logInfo(_a.$0.$15,"Dirty due to To: snapshotCcCout={0}, contextCcCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$C(this.get_$7x())?0:this.get_$7x().get_$A(),$C(n.get_$7x())?0:n.get_$7x().get_$A(),$C(this.get_$xl())?0:this.get_$xl().length,$C(n.get_$xl())?0:n.get_$xl().length);return!1}if(!_mcp.$1W.$31O(this.get_$AO(),n.get_$AO(),this.get_$qX(),n.get_$qX())){_js.Trace.logInfo(_a.$0.$15,"Dirty due to To: snapshotBccCout={0}, contextBccCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$C(this.get_$AO())?0:this.get_$AO().get_$A(),$C(n.get_$AO())?0:n.get_$AO().get_$A(),$C(this.get_$qX())?0:this.get_$qX().length,$C(n.get_$qX())?0:n.get_$qX().length);return!1}if(!_mcp.$1W.$7VD(this.get_$EU(),n.get_$EU())){_js.Trace.logInfo(_a.$0.$15,"snapshotAttachmentCount="+(this.get_$EU()?this.get_$EU().get_$A():0)+", contextAttachmentCount="+(n.get_$EU()?n.get_$EU().get_$A():0));return!1}if(!_mcp.$1W.$A6C(this.get_$nu(),n.get_$nu())){_js.Trace.logInfo(_a.$0.$15,"snapshotExtendedPropertyCount="+(this.get_$nu()?this.get_$nu().get_$A():0)+", contextExtendedPropertyCount="+(n.get_$nu()?n.get_$nu().get_$A():0));return!1}if(this.get_$MT()!==n.get_$MT()){_js.Trace.logInfo(_a.$0.$15,"Dirty due to editor content: snapshotContentLength={0}, contextContentLength={1}",$C(this.get_$MT())?0:this.get_$MT().length,$C(n.get_$MT())?0:n.get_$MT().length);return!1}_js.Trace.logInfo(_a.$0.$15,"Context is clean");return!0},$5b:function(n){if(!n){_js.Trace.logInfo(_a.$0.$15,"Comparing with a null snapshot, this case is always considered equal.");return!0}if(this.get_$Bv()!==n.get_$Bv()){_js.Trace.logInfo(_a.$0.$15,"sourceImportance={0}, targetImportance={1}",this.get_$Bv(),n.get_$Bv());return!1}if(this.get_$3n()!==n.get_$3n()){_js.Trace.logInfo(_a.$0.$15,"sourceSubject={0}, targetSubject={1}",this.get_$3n(),n.get_$3n());return!1}if(this.get_$gz()!==n.get_$gz()){_js.Trace.logInfo(_a.$0.$15,"sourceComplianceId={0}, targetComplianceId={1}",this.get_$gz(),n.get_$gz());return!1}if(this.get_$ER()!==n.get_$ER()){_js.Trace.logInfo(_a.$0.$15,"sourceSensitivity={0}, targetSensitivity={1}",this.get_$ER(),n.get_$ER());return!1}if(this.get_$Qk()!==n.get_$Qk()){_js.Trace.logInfo(_a.$0.$15,"sourceIsDeliveryReceiptRequested={0}, targetIsDeliveryReceiptRequested={1}",this.get_$Qk(),n.get_$Qk());return!1}if(this.get_$Q1()!==n.get_$Q1()){_js.Trace.logInfo(_a.$0.$15,"sourceIsReadReceiptRequested={0}, targetIsReadReceiptRequested={1}",this.get_$Q1(),n.get_$Q1());return!1}var i=this.get_$5Q()?this.get_$5Q().Mailbox:null;var t=n.get_$5Q()?n.get_$5Q().Mailbox:null;if(!_mcp.$1W.$5l0(i,t)){_js.Trace.logInfo(_a.$0.$15,"sourceFrom={0}, targetFrom={1}",i?i.EmailAddress:"null",t?t.EmailAddress:"null");return!1}if(!_mcp.$1W.$31O(this.get_$77(),n.get_$77(),this.get_$10q(),n.get_$10q())){_js.Trace.logInfo(_a.$0.$15,"sourceToCout={0}, targetToCout={1}, sourceQueryString={2}, targetQueryString={3}",this.get_$77()?this.get_$77().get_$A():0,n.get_$77()?n.get_$77().get_$A():0,this.get_$10q(),n.get_$10q());return!1}if(!_mcp.$1W.$31O(this.get_$7x(),n.get_$7x(),this.get_$xl(),n.get_$xl())){_js.Trace.logInfo(_a.$0.$15,"sourceCcCout={0}, targetCcCout={1}, sourceQueryString={2}, targetQueryString={3}",this.get_$7x()?this.get_$7x().get_$A():0,n.get_$7x()?n.get_$7x().get_$A():0,this.get_$xl(),n.get_$xl());return!1}if(!_mcp.$1W.$31O(this.get_$AO(),n.get_$AO(),this.get_$qX(),n.get_$qX())){_js.Trace.logInfo(_a.$0.$15,"sourceBccCout={0}, targetBccCout={1}, sourceQueryString={2}, targetQueryString={3}",this.get_$AO()?this.get_$AO().get_$A():0,n.get_$AO()?n.get_$AO().get_$A():0,this.get_$qX(),n.get_$qX());return!1}if(!_mcp.$1W.$7VD(this.get_$EU(),n.get_$EU())){_js.Trace.logInfo(_a.$0.$15,"sourceAttachmentCount="+(this.get_$EU()?this.get_$EU().get_$A():0)+", targetAttachmentCount="+(n.get_$EU()?n.get_$EU().get_$A():0));return!1}if(this.get_$MT()!==n.get_$MT()){_js.Trace.logInfo(_a.$0.$15,"Dirty due to editor content: snapshotContentLength={0}, snapshotContentLength={1}",this.get_$MT()?this.get_$MT().length:0,n.get_$MT()?n.get_$MT().length:0);return!1}_js.Trace.logInfo(_a.$0.$15,"snapshot is clean");return!0}};_mcp.$1Kz=function(n,t){this.$$d_$Ami=Function.createDelegate(this,this.$Ami);if($C(n))throw Error.argumentNull("callback");if(t<=3e3)throw Error.argumentOutOfRange("timeoutPeriod");this.$1i5=t;this.$8B=n};_mcp.$1Kz.prototype={$1i5:0,$8B:null,$1Yx:null,$4y0:!0,$1T:function(){!this.$1Yx&&this.$4y0&&(this.$1Yx=_js.$D.get_$Q().$2V(_a.$0.$15,"MailComposeTimer",this.$$d_$Ami,this.$1i5))},$370:function(){_js.Trace.logInfo(_a.$0.$15,"Disabling timer.");this.$4y0=!1;this.$1u()},$1u:function(){if(this.$1Yx){_js.Trace.logInfo(_a.$0.$15,"Clearing timer.");this.$1Yx=_js.$D.get_$Q().$6Q(this.$1Yx)}},$Ami:function(){_js.Trace.logInfo(_a.$0.$15,"Executing timer callback.");this.$1u();this.$8B()}};_mcp.$8m=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt){this.$$d_$DLI=Function.createDelegate(this,this.$DLI);this.$$d_$936=Function.createDelegate(this,this.$936);this.$$d_$7cN=Function.createDelegate(this,this.$7cN);this.$$d_$Dke=Function.createDelegate(this,this.$Dke);this.$$d_$4so=Function.createDelegate(this,this.$4so);_mcp.$8m.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;this.dispose=this.$1v;_mcp.$8m.initializeBase(this);_a.$4.$z(k,"nativeBridge");this.$1sN=4;this.$c=n;this.$2G=t||new _bc.$3e;this.$2G.set_$c8(nt);this.$1d=this.$1ao();this.$iz=i;this.$9J=r;this.$1Ct=u;this.$n=new _mcp.$uZ(this.$2G);this.$3VS=f;this.$2Ss=s;this.$4x=e;this.$I=o;this.$Lu=h;this.$Lc=c;this.$N=l;this.$3a=v;this.$N2=p;this.$Ex=a;this.$2Y=w;this.$l4=b;this.$1G=y;this.$l=k;this.$2zD=d;this.$Xe=g;this.$6R=nt;this.$mX=tt;this.$WF=it;this.$16A=rt;this.$11U=ut;this.$tm=ft;this.$1th=et;this.$sl=ot;this.$38y=st;this.$2Yx=ht;this.$CX=ct;this.$F1=lt;if(o){var at=o;this.$sO=at.$$d_$Ax||(at.$$d_$Ax=Function.createDelegate(at,at.$Ax))}this.$6R||(this.$3xk=!0);this.$I&&this.$I.get_$U()==="Mouse"&&this.$CGz();_js.Trace.logInfo(_a.$0.$15,"ViewModel created")};_mcp.$8m.$AsP=function(){return+new Date+":"+Math.random()};_mcp.$8m.prototype={$iz:null,$c:null,$9J:null,$1Ct:null,$3VS:null,$4x:null,$2Ss:null,$2G:null,$I:null,$3a:null,$N2:null,$Lu:null,$N:null,$Lc:null,$1G:null,$l:null,$2Y:null,$F1:null,$2zD:null,$Xe:null,$16A:null,$11U:null,$tm:null,$6R:null,$mX:null,$1th:null,$sl:null,$38y:null,$l4:null,$1n:null,$n:null,$DE:null,$1d:null,$2mG:!1,$hZ:!1,$5WW:!1,$5bw:null,$5Vp:!1,$1db:!1,$J4:!0,$7CJ:!0,$Ex:null,$WF:null,$1sN:0,$w8:null,$sO:null,$3xk:!1,$5WS:!1,$25x:null,$24C:null,$2Yx:null,$CX:null,get_$8b:function(){return this.$c},set_$135:function(n){if(this.$1d!==n){this.$1d=n;this.$4("InfoBarViewModel")}return n},get_$4Hb:function(){_a.$4.$FX(this.$2Yx.get_$bo(),"MailComposeViewModel: Smime override factory has not been created");return this.$2Yx.get_$1Z()},get_$7F5:function(){return this.$1n.$5k(7).get_$7F5()},get_$2Mg:function(){return this.$1n.$5k(0)},get_$5cA:function(){return this.$1n.$5k(11)},get_$2qj:function(){return this.$1n.$5k(2)},get_$AYX:function(){return this.$1n.$5k(14)},get_$eH:function(){return this.$1n.$5k(5)},get_$7dI:function(){return this.$1n.$5k(17)},get_$CKR:function(){return this.$1n.$5k(4)},get_$aa:function(){return this.$1n.$5k(1)},get_$C23:function(){return this.$1n.$5k(6)},get_$iD:function(){return this.$1n.$5k(7)},get_$1X8:function(){return this.$1n.$5k(8)},get_$2Mn:function(){return this.$1n.$5k(9)},get_$3Lw:function(){return this.$1n.$5k(10)},get_$1k2:function(){return this.$1n.$5k(18)},get_$E7K:function(){return this.$1n.$5k(20)},get_$AGp:function(){return this.$1n.$5k(3)},get_$6Ws:function(){return this.$1n.$5k(19)},get_$9Fg:function(){return this.$1n.$5k(25)},get_$5xw:function(){return this.$1n.$5k(21)},get_$38b:function(){return this.$1n.$5k(24)},get_$CGS:function(){return this.$1n.$5k(26)},get_$AYT:function(){return this.$1n.$5k(27)},get_$7Mt:function(){return this.$1n.$5k(13)},get_$Egx:function(){return this.$1n.$5k(29)},get_$c8:function(){return this.$6R},get_$3xb:function(){return!this.$I.get_$Cp()||!!this.$6R},set_$9j9:function(n){if(this.$5WS!==n){this.$5WS=n;this.$4("ShouldShowModernAttachmentsIntroductionPeek")}return n},get_$7iA:function(){var t=this.get_$3xb();var n=new _a.$3z;n.$Ij("P",t);n.$CW("I",t?this.get_$4va().toString():"NA");n.$CW("ET",this.$c.$2gA);return n.toString()},get_$C0y:function(){return this.get_$3xb()||this.$I.get_$lJ()},set_$CCY:function(n){if(this.$3xk!==n){this.$3xk=n;this.$4("IsReadyForViewInitialization")}return n},get_$4va:function(){return!!this.$6R},get_$2sh:function(){return this.$1sN},set_$2sh:function(n){if(this.$1sN!==n){this.$1sN=n;this.$4("PopupPanelSize")}return n},get_$3sq:function(){return this.get_$5cA()?this.get_$5cA().$$d_$3sq:this.$$d_$4so},get_$gw:function(){return this.$DE},set_$gw:function(n){_js.Trace.logInfo(_a.$0.$15,"Shell setting ClosePopupCommand from "+(this.$DE?"non-null":"null")+" to "+(n?"non-null":"null"));this.$DE=n;return n},get_$7kt:function(){return this.$J4},set_$7kt:function(n){this.$J4=n;return n},set_$EZS:function(n){this.$7CJ=n;return n},get_$4tv:function(){return _a.UserAgent.getInstance().$22Y},get_$fJ:function(){return _a.UserAgent.getInstance().$YH},get_$1dn:function(){return _a.UserAgent.getInstance().$z5},get_$jb:function(){return _a.UserAgent.getInstance().$a3},get_$a5:function(){return _a.UserAgent.getInstance().$Ea},get_$S5:function(){return this.$I.get_$U()==="Mouse"?0:1},get_$lJ:function(){return OwaApplication.$Ou},get_$AVU:function(){return _a.UserAgent.getInstance().$6QB&&_a.UserAgent.getInstance().get_$8Z()},get_$6SX:function(){return this.$2mG},set_$6SX:function(n){this.$2mG=n;return n},set_$8Th:function(n){if(this.$hZ!==n){this.$hZ=n;this.$4("IsInView")}return n},set_$9jD:function(n){var t=this.get_$9il();if(this.$5WW!==t){this.$5WW=t;this.$4("ShouldShowToolbarMessage")}return n},set_$9pf:function(n){if(this.$5bw!==n){this.$5bw=n;this.$4("ToolbarMessage")}return n},set_$EZR:function(n){var t=this.get_$9il();if(t!==this.$5Vp){this.$5Vp=t;this.$4("ShouldBlockView")}return n},get_$1Ea:function(){return this.$1db},set_$1Ea:function(n){if(this.$1db!==n){this.$1db=n;this.$4("IsNavigatingAway")}return n},get_$9il:function(){return this.get_$2Mn()&&(this.get_$2Mn().get_$3y2()||this.get_$2Mn().get_$4xJ())?!0:this.get_$iD()&&this.get_$iD().get_$lw()?!0:!1},get_$5yb:function(){return!_a.$g.get_$CE()||_a.$g.get_$CE().toLowerCase()!=="pl-pl"},set_$5DS:function(n){this.$w8=n;return n},set_$9AJ:function(n){this.$sO=n;return n},get_$4Km:function(){return this.$c.get_$ExJ()},$Dke:function(n,t){if(this.$c.get_$ru()){this.$2wg();this.$1n.$2wg();this.$4("SmimeInvalidRecipientsDialogViewModel")}else{this.$2Ek();this.$1n.$2Ek();this.$4("SmimeInvalidRecipientsDialogViewModel")}},$A3r:function(){this.$c.$p(_mcp.$V.$4Ka,this.$$d_$Dke)},$2wg:function(){if(this.get_$4Km()&&!this.$24C){_js.Trace.logInfo(_a.$0.$15,"Setting mail compose viewmodel override");this.$24C=this.get_$4Hb().$ANI();this.$24C.$3e(this.$1d)}},$2Ek:function(){if(this.$24C){this.$24C.$AU();this.$24C=null}},$3e:function(){this.$c.get_$D1()&&(this.$c.get_$23H()||this.$c.get_$3xv())||this.$c.set_$D1(_mcp.$8m.$AsP());_js.Trace.logInfo(_a.$0.$15,"Init:Context:"+this.$c.toString());this.$1n||(this.$1n=new _mcp.$1Kk(this,this.$Ex,this.$3a,this.$1G,this.$N2,this.$2Y,this.$l,this.$6R,this.$WF,this.$16A,this.$11U,this.$CX));if(this.get_$4Km()){_js.Trace.logInfo(_a.$0.$15,"Creating Smime override factory");this.$5uY(this.$$d_$7cN)}else this.$7cN()},$5uY:function(n){_js.Trace.logInfo(_a.$0.$15,"Calling CreateSmimeOverrideFactoryAsync");var t=this;this.$2Yx.$9(function(i){_js.Trace.logInfo(_a.$0.$15,"Smime override factory created");i.$3e(t.$c,t.$N);_js.Trace.logInfo(_a.$0.$15,"Calling createFactoryCallback");n()})},$7cN:function(){_js.Trace.logInfo(_a.$0.$15,"Completing initialization");this.$2wg();this.$A3r();if(this.$1d){this.$1d.$AU();this.$N.$1o(_y.$mw,new _y.$mw);this.$c.get_$3xv()&&this.$1d.$4r(this.$c.get_$9R7(),null)}this.set_$1Ea(!1);this.$1n.$5k(0).$3e();if(!this.$6R){this.$I.remove_$Xh(this.$$d_$936);this.$I.add_$Xh(this.$$d_$936);_js.Trace.logInfo(_a.$0.$15,"Before unload handler has been hooked up")}},$ETd:function(n){this.set_$A0(n);_js.Trace.logInfo(_a.$0.$15,"Set screen view model appbar. ContextId="+this.$c.get_$D1())},$IW:function(){_y.$1aq.prototype.$IW.call(this);var n=this.get_$2Mg();if(n.get_$G6()){_js.Trace.logInfo(_a.$0.$15,"PostTransitionIn view model, begin 2nd init since view model is already initialized");n.$7Wf()}else _js.Trace.logInfo(_a.$0.$15,"PostTransitionIn view model, not initialized yet");this.set_$8Th(!0);_a.$6.acea(null,"VM.MailCompose.Navigate");if(this.$c.get_$3xv()&&this.$c.get_$3FQ()){var i=this.$c.get_$D1();this.$N.$1o(_y.$xF,new _y.$xF(i))}this.$I.get_$U()!=="TouchNarrow"&&this.$c.$47U&&this.$c.$47U();if(this.$I.get_$U()==="Mouse"){var t=this;_js.$D.get_$Q().$6F(_a.$0.$1l,"PreloadOwaFilePicker",function(){var n=t.$1n.$5k(5);n&&n.$Dqx()})}},$Tj:function(){_js.Trace.logInfo(_a.$0.$15,"Post transition out");this.get_$iD().get_$72h()&&(this.$c.get_$3FQ()?_a.$6.$1F(this.get_$iD().get_$72h(),"MailComposeSendClose",null,null,"SentViaNotification"):_a.$6.$1F(this.get_$iD().get_$72h(),"MailComposeSendClose",null,null,"NotSentViaNotificationDueToOtherPendingFailedAsyncSend"));this.get_$iD().get_$DMh()||this.$AU(!1);this.set_$8Th(!1);_y.$1aq.prototype.$Tj.call(this)},$AU:function(n){_js.Trace.logInfo(_a.$0.$15,"Calling reset on the mail compose view model, context:"+this.$c.toString());this.$2Ek();this.$c.$1B(_mcp.$V.$4Ka,this.$$d_$Dke);if(this.$1n){var i=this.get_$2qj();if(i){var t=i.get_$5F();if(t&&t.get_$3IV()){this.$1n.$AU();this.$c&&!n&&this.$c.$AU();this.$1d&&this.$1d.$G4.$1u();this.get_$38b()&&this.get_$38b().$65&&this.get_$38b().$65.$220(!1);this.$6R||this.$I.remove_$Xh(this.$$d_$936);this.$sO=null;t.set_$3IV(!1)}else _js.Trace.logInfo(_a.$0.$15,"Conductor is either null or not navigating away from compose, skipping post transition out processing")}else _js.Trace.logInfo(_a.$0.$15,"Navigation component was null, skipping post transition out processing")}else _js.Trace.logInfo(_a.$0.$15,"Skipping post transition out processing since this instance is already reset and the component map is empty");this.$2mG=!1},$IN:function(){var t=this.$1n.$5k(5);if(t.get_$Pz()){_js.Trace.logInfo(_a.$0.$15,"Dirty due to attachment in progress");return!0}var n=this.$1n.$5k(1);n.$2yz();return this.$c.$IN()},$1ao:function(){$C(this.$1d)&&this.set_$135(new _y.$5y);return this.$1d},$Dni:function(){_h.$3m.$Dng()},$E3G:function(){_h.$3m.$9O2()},$7EW:function(){this.$24C&&this.$24C.$7EW()},$Der:function(){this.set_$CCY(!0)},$DQZ:function(){var n=new _y.$rG;this.$936(n);return n.$1NE},$936:function(n){this.get_$2qj().$4Vb(n)},$6oz:function(){},$9vX:function(){this.get_$3xb()&&this.$c&&!_js.$9.$o(this.$c.get_$3n())&&!this.$6R&&(document.title=this.$c.get_$3n())},$2A:function(){_js.Trace.logInfo(_a.$0.$15,"Disposing view model, context: "+(this.$c?this.$c.toString():"null"));this.$1n&&this.$1n.$AU();this.$25x&&this.$25x.remove_$1R1(this.$$d_$DLI);_a.$1aV.prototype.$2A.call(this)},$AFY:function(){this.$25x&&this.$25x.$10t(!0)},$CGz:function(){if(this.$F1&&this.$3a&&this.$CX&&_y.$2M.$1LP(9)&&this.$1G.$4RN(this.$CX.AttachmentDataProviderAvailable)){var n=this;this.$F1.$9(function(t){n.$25x=t.$7j(_u.Strings.l_ModernAttachments_IntroductionPeekTitle_Text,_u.Strings.l_ModernAttachments_IntroductionPeekDescription_Text,10,null,null,9);n.set_$9j9(!0);n.$25x.add_$1R1(n.$$d_$DLI);n.$25x.$1ve()})}},$DLI:function(){this.set_$9j9(!1)},$4so:function(n,t){return t===1?!this.$7CJ:!1}};_mcp.$uk=function(n,t,i,r,u,f){this.$$d_$Bo7=Function.createDelegate(this,this.$Bo7);this.$$d_$5uP=Function.createDelegate(this,this.$5uP);this.$$d_$APM=Function.createDelegate(this,this.$APM);_mcp.$uk.initializeBase(this);this.$5rI=f;this.$8N=f.$8N;this.$2Y=n;this.$d=t;this.$5D=f.$5D;this.$7F=i;this.$Xe=r;this.$Bq=u};_mcp.$uk.prototype={$d:null,$2Y:null,$8N:null,$5D:null,$5rI:null,$7F:null,$Xe:null,$Bq:null,$48:null,$14L:0,$3Ic:!1,$4Ha:null,$Eh:null,$48h:null,$4L3:!1,get_$5F:function(){$C(this.$48)&&(this.$48=new _y.$Cb);return this.$48},set_$5F:function(n){this.$48=n;return n},$2rd:function(n){_a.$6.stPT(_a.$0.$Kz,"MailComposeReplyLoad",3);this.$4L3=!0;this.$Eh=_y.$2E.$1f(_a.$0.$Kz,"MailComposeReply",!0);this.$48h=_y.$2E.$1f(_a.$0.$Kz,"MailComposeReplyLoad",!0);this.$2Y.$7Jr("Inference.Reply",this.$8N.get_$y(),this.$8N.get_$5N(),this.$5D?this.$5D.get_$I5():null);this.$5Ep(1,n)},$26k:function(n){_a.$6.stPT(_a.$0.$Kz,"MailComposeReplyAllLoad",3);this.$4L3=!0;this.$Eh=_y.$2E.$1f(_a.$0.$Kz,"MailComposeReplyAll",!0);this.$48h=_y.$2E.$1f(_a.$0.$Kz,"MailComposeReplyAllLoad",!0);this.$2Y.$7Jr("Inference.ReplyAll",this.$8N.get_$y(),this.$8N.get_$5N(),this.$5D?this.$5D.get_$I5():null);this.$5Ep(2,n)},$6oy:function(n){this.$2Y.$nA("Inference.PostReply",this.$8N.get_$y());this.$5Ep(12,n)},$26Y:function(n){_a.$6.stPT(_a.$0.$Kz,"MailComposeForwardLoad",3);this.$4L3=!0;this.$Eh=_y.$2E.$1f(_a.$0.$Kz,"MailComposeForward",!0);this.$48h=_y.$2E.$1f(_a.$0.$Kz,"MailComposeForwardLoad",!0);this.$2Y.$7Jr("Inference.Forward",this.$8N.get_$y(),this.$8N.get_$5N(),this.$5D?this.$5D.get_$I5():null);this.$5Ep(3,n)},$5E1:function(n){this.$3Ic=!0;this.$26Y(n)},$9BD:function(){if(!this.$5rI.get_$4Ty())throw Error.invalidOperation("OnSendAgain is invoked on an item that can't be sent again. ");var t=_g.$b.$2K.nameToId("drafts");var n=new _c.$1DB(this.$8N.get_$y().Id,t.Id);n.add_$2s(this.$$d_$APM);n.add_$2b(this.$$d_$5uP);OwaApplication.$2B.$1U(n)},$APM:function(n){var i=n.$26C;if(i.length>0){var t=this.$Xe.$5tZ(_g.$1T.$1yB(i));t.add_$2s(this.$$d_$Bo7);t.add_$2b(this.$$d_$5uP);OwaApplication.$2B.$1U(t)}else this.$5uP(n)},$5uP:function(n){this.$5D.get_$135().$9T(9500);this.$5D.get_$135().$4r(9500)},$Bo7:function(n){var t=n;if(t.$Os){this.$5D.get_$135().$9T(9500);var i=this.$7F.$34o(t.get_$y(),!1,t.$Os.get_$zy(),t.$Os.get_$9i());_y.$z.$1Q.get_$Cp()||i.set_$5j(0);_a.$6.acsa(_a.$0.$15,"VM.MailCompose.Navigate");this.get_$5F().$WH(i)}else this.$5uP(n)},$5Ep:function(n,t){this.$14L=n;this.$WH(t)},$WH:function(n){var u=_g.$2g.isInstanceOfType(this.$8N);n||(n=!_y.$z.$1Q.get_$Cp());var t=this.$7F.$H0(n,!1);t.set_$2Bg(this.$4L3);n&&t.set_$5j(0);var r=null;switch(this.$14L){case 1:r=!t.get_$5j()||u?"MailComposeReplyPopOut":"MailComposeReply";break;case 2:r=!t.get_$5j()||u?"MailComposeReplyAllPopOut":"MailComposeReplyAll";break;case 3:r=!t.get_$5j()||u?"MailComposeForwardPopOut":"MailComposeForward";break;default:break}if(r&&this.$Eh){this.$Eh.$3C=r;t.set_$di(this.$Eh);t.set_$1N4(this.$48h);t.$7BU()}t.set_$2sA(this.$8N.get_$3G());this.$5D&&t.set_$19l(this.$5D.get_$19l());t.set_$6W(this.$14L);t.set_$XV(!0);t.set_$1LY(!0);t.$3Ic=this.$3Ic;var i=new _g.$8v;i.Mailbox=new _g.$1K;i.Mailbox.EmailAddress=this.$d.get_$4X().get_$Fu();i.Mailbox.Name=this.$d.get_$4X().get_$Lh();i.Mailbox.MailboxType="Mailbox";i.Mailbox.RoutingType="SMTP";t.set_$Ek(i);if(u){var f=this.$8N;if(f.get_$1LO())t.$1Ta(f);else{t.set_$1oS(!0);t.set_$14N(this.$8N.get_$y());t.set_$1LT(_g.$2g.$1LT(f))}}else t.$1Ta(this.$8N);if((_g.$5w.isInstanceOfType(this.$8N)||u)&&t.$6Si(this.$8N)){var o=_a.$c.get_$18X();o&&t.$Eww(this.$8N.get_$2xZ());if(this.$8N.get_$X2()||t.get_$ru()&&o){var e=this;this.$uE(function(n){n.$Es4(t,e.$8N,e.$14L)})}else{_a.$6.acsa(_a.$0.$15,"VM.MailCompose.Navigate");this.get_$5F().$WH(t)}}else{_a.$6.acsa(_a.$0.$15,"VM.MailCompose.Navigate");this.get_$5F().$WH(t)}},$uE:function(n){_js.Trace.logInfo(_a.$0.$52,"[MailResponseViewModel] Creating Smime command factory.");var t=this;this.$Bq.$9(function(i){if(!t.$4Ha){_js.Trace.logInfo(_a.$0.$52,"[MailResponseViewModel] Creating SmimeMailResponseViewModelCommand instance.");t.$4Ha=i.$ANO();t.$4Ha.$3e(t,t.$d,function(n,t){var i=new _cc.$Di(200,_cc.$Di.$H0(n.get_$y(),t.get_$1LT()));i.$99=t.get_$D1();return i},function(n,t,i){var r=new _mcp.$1Oi(n,t,i);return r.toString()})}_js.Trace.logInfo(_a.$0.$52,"[MailResponseViewModel] Executing smime operation.");n(t.$4Ha)})}};_mcp.$14l=function(n,t,i,r,u){this.$2Y=n;this.$d=t;this.$7F=i;this.$Xe=r;this.$Bq=u};_mcp.$14l.prototype={$2Y:null,$d:null,$7F:null,$Xe:null,$Bq:null,$7j:function(n){return new _mcp.$uk(this.$2Y,this.$d,this.$7F,this.$Xe,this.$Bq,n)}};_mcp.$nK=function(){_mcp.$nK.initializeBase(this)};_mcp.$nK.prototype={$2Wo:null,$3WZ:"Normal",$3vx:!1,$3xj:!1,$1YX:!1,$1YY:!1,$5Yf:!1,$5Yj:!1,$48:null,$5Y6:!1,$5fy:!1,$7OK:!1,get_$E80:function(){if($C(this.$2Wo)){this.$2Wo=new _js.$X;this.$2Wo.$F("Normal");this.$2Wo.$F("Personal");this.$2Wo.$F("Private");this.$2Wo.$F("Confidential")}return this.$2Wo},set_$ER:function(n){if(this.$3WZ!==n){this.$3WZ=n;this.$4("Sensitivity")}return n},set_$Qk:function(n){if(this.$3vx!==n){this.$3vx=n;this.$4("IsDeliveryReceiptRequested")}return n},get_$Ebm:function(){return!OwaApplication.$Ou},set_$Q1:function(n){if(this.$3xj!==n){this.$3xj=n;this.$4("IsReadReceiptRequested")}return n},get_$EdP:function(){return!OwaApplication.$Ou},set_$Edn:function(n){if(this.$5Y6!==n){this.$5Y6=n;this.$4("ShowSmimeOptions")}return n},set_$PO:function(n){if(this.$1YX!==n){this.$1YX=n;this.$4("SmimeEncryptMessage")}return n},set_$St:function(n){if(this.$1YY!==n){this.$1YY=n;this.$4("SmimeSignMessage")}return n},set_$9lW:function(n){if(this.$5Yf!==n){this.$5Yf=n;this.$4("SmimeEncryptMessageIsEnabled")}return n},set_$9lX:function(n){if(this.$5Yj!==n){this.$5Yj=n;this.$4("SmimeSignMessageIsEnabled")}return n},set_$Eya:function(n){if(this.$7OK!==n){this.$7OK=n;this.$4("WaitingForPreviousAction")}return n},set_$5F:function(n){if(this.$48!==n){this.$48=n;this.$4("Conductor")}return n},$1TZ:function(n){this.$5fy=n.get_$ru();this.set_$Edn(_a.$c.$43&&_a.$c.get_$22a()&&n.$6Sj());this.set_$Eya(!1);this.set_$ER(n.get_$ER());this.set_$Qk(n.get_$Qk());this.set_$Q1(n.get_$Q1());this.set_$PO(n.get_$PO());this.set_$St(n.get_$St());this.set_$9lW(n.get_$9lW());this.set_$9lX(n.get_$9lX())}};_mcp.$vx=function(n){this.$5W2=n};_mcp.$vx.prototype={$5W2:!1};_mcp.$1My=function(n,t){this.$2xy=n;this.$3n1=t};_mcp.$1My.prototype={$2xy:null,$3n1:null};_mcp.$1Oi=function(n,t,i){this.$9KG=new RegExp("<","g");this.$9Jw=new RegExp(">","g");this.$z8=n;this.$8N=t;this.$14L=i};_mcp.$1Oi.prototype={$14L:0,$8N:null,$z8:!1,toString:function(){_js.Trace.logInfo(_a.$0.$15,"Building message headers for reply/fwd. locally.");var a=this.$uv();var t=this.$8EB(!0);var r=this.$8EB(!1);r&&r.toLowerCase()!==t.toLowerCase()&&(t=String.format(_u.Strings.l_OnBehalfOf_Text,r,t));var o=this.$8N.get_$16r()||this.$8N.get_$1CU();var w=o?o.toString():this.$8N.get_$Duo();var h=this.$8IM(!0);var e=this.$8IM(!1);var i,n;var s,u;this.$Bu4(s={val:i},u={val:n}),i=s.val,n=u.val;var p=this.$2dt(_nbs.NonBootStrings.l_FromLabel_Text,t);var k=this.$2dt(_nbs.NonBootStrings.l_SentLabel_Text,w);var b=h?this.$2dt(_u.Strings.l_ToRecipientsLabel_Text,h.join("; ")):null;var y=e?this.$2dt(_u.Strings.l_CcRecipientsLabel_Text,e.join("; ")):null;var l=this.$2dt(_u.CommonStrings.l_SubjectLabel_Text,a);var c=i?this.$2dt(_u.MeetingMsgStrings.l_WhenLabel_Text,i):null;var v=n?this.$2dt(_u.MeetingMsgStrings.l_WhereLabel_Text,n):null;var f=this.$A9I(p,k,b,y,l,c,v);return this.$z8?'<p style="color:black;border-top:1pt solid #E1E1E1;padding-top:3pt;margin-bottom:13pt;font-family:Calibri,sans-serif;font-size:11pt">'+f.join("<br/>")+"</p>":String.format("________________________________________{0}{1}{0}{0}","\r\n",f.join("\r\n"))},$A9I:function(){for(var u=[],n=0;n<arguments.length;++n)u[n]=arguments[n];for(var f=new(_ff.$18.$$(String)),r=u,e=r.length,t=0;t<e;++t){var i=r[t];_js.$9.$o(i)||f.$F(i)}return f.$3T()},$uv:function(){if(this.$8N.get_$3n())return this.$8N.get_$3n();else{var n;switch(this.$14L){case 1:case 2:case 12:n=_u.Strings.l_ReplyPrefix_Text;break;case 3:n=_nbs.NonBootStrings.l_ForwardPrefix_Text;break;case 5:n=_nbs.NonBootStrings.l_AcceptPrefix_Text;break;case 6:n=_nbs.NonBootStrings.l_TentativelyAcceptPrefix_Text;break;case 7:n=_nbs.NonBootStrings.l_DeclinePrefix_Text;break;case 8:n=_nbs.NonBootStrings.l_CanceledMeetingMessagePrefix_Text;break;case 9:n=_nbs.NonBootStrings.l_ApprovePrefix_Text;break;case 10:n=_nbs.NonBootStrings.l_RejectPrefix_Text;break;default:n="";break}return String.format(_nbs.NonBootStrings.l_SubjectFormat_Text,n,this.$8N.get_$149()||_u.Strings.l_EmptySubjectMask_Text)}},$8EB:function(n){if(_g.$5w.isInstanceOfType(this.$8N)){var r=this.$8N;var i=n?r.get_$5Q():r.get_$Ek();return i?this.$3sH(i.Mailbox):null}else if(_g.$2g.isInstanceOfType(this.$8N)){var t=this.$8N;return t.get_$MA()?this.$3sH(t.get_$MA().Mailbox):null}else return null},$8IM:function(n){if(_g.$5w.isInstanceOfType(this.$8N)){var i=this.$8N;return this.$Bqy(n?i.get_$77():i.get_$7x())}else if(_g.$2g.isInstanceOfType(this.$8N)){var t=this.$8N;return this.$BiY(n?t.get_$Bm():t.get_$DH(),n)}else return null},$Bu4:function(n,t){var i=null;var r=null;n.val=t.val=null;if(_g.$Md.isInstanceOfType(this.$8N)){var f=this.$8N;i=f.get_$Px();r=f.get_$8MY()}else if(_g.$2g.isInstanceOfType(this.$8N)){var u=this.$8N;i=u;r=u}if(r){var e=new _cc.$Tl;n.val=e.$4L(r,null)||" "}i&&(t.val=i.get_$6D()?i.get_$6D().get_$29()||" ":" ")},$Bqy:function(n){if(!n||!n.get_$A())return null;var t=new(_ff.$18.$$(String));var i=this;n.$Cj(function(n){t.$F(i.$3sH(n))});return t.$3T()},$BiY:function(n,t){if(!n||!n.get_$A())return t?[this.$3sH(this.$8N.get_$MA().Mailbox)]:null;var i=new(_ff.$18.$$(String));var r=this;n.$Cj(function(n){i.$F(r.$3sH(n.get_$AA()))});return i.$3T()},$3sH:function(n){return n?n.Name||n.OriginalDisplayName||n.EmailAddress||"":""},$2dt:function(n,t){return this.$z8?"<b>"+n+"</b> "+this.$4Br(t):n+" "+t},$4Br:function(n){if(!n)return null;n=n.replace(this.$9KG,"&lt;");n=n.replace(this.$9Jw,"&gt;");return n}};_mcp.$17u=function(){};_mcp.$17u.prototype={$4L:function(n,t){var r=n;var i=null;switch(r){case"Normal":i=_nbs.NonBootStrings.l_Normal_Text;break;case"Personal":i=_nbs.NonBootStrings.l_Personal_Text;break;case"Private":i=_nbs.NonBootStrings.l_Private_Text;break;case"Confidential":i=_nbs.NonBootStrings.l_Confidential_Text;break;default:i=_nbs.NonBootStrings.l_Normal_Text;break}return i},$7dj:function(n,t){throw Error.notImplemented();}};_mcp.$sX=function(n){_mcp.$sX.initializeBase(this,[n])};_mcp.$sX.prototype={$ZW:null,$DPU:function(){},$DPT:function(){},$DYO:function(n){},$DYM:function(n){},$DYN:function(n){},$EUq:function(n){},$DYQ:function(n,t){t.val=3;this.$ZW.$11();return!0}};_mcp.$1=function(){};_mcp.$1.get_$wd=function(){return _fm.$G.$9("send","x18","owa","ms-font-color-neutralSecondary")};_mcp.$1.get_$72r=function(){return _fm.$G.$9("send-hover","x18","owa","ms-font-color-neutralDark")};_mcp.$1.get_$Dqe=function(){return _fm.$G.$9("post-hover","x16","owa","ms-font-color-neutralDark")};_mcp.$1.get_$9M=function(){return _fm.$G.$9("attachment","x16","owa","ms-font-color-neutralSecondary")};_mcp.$1.get_$7UX=function(){return _fm.$G.$9("app-hero","x12","owa","ms-font-color-neutralSecondary")};_mcp.$1.get_$7UY=function(){return _fm.$G.$9("app-hero-hover","x12","owa","ms-font-color-neutralDark")};_mcp.$1.get_$7Vp=function(){return _fm.$G.$9("attachment-hover","x16","owa","ms-font-color-neutralDark")};_mcp.$1.get_$9y=function(){return _fm.$G.$9("pop-out","x18","owa","ms-font-color-neutralSecondary")};_mcp.$1.get_$1WS=function(){return _fm.$G.$9("pop-out-hover","x18","owa","ms-font-color-neutralDark")};_mcp.$1.get_$1BR=function(){return _fm.$G.$9("add-small","add-small","owa","ms-font-color-neutralSecondary")};_mcp.$1.get_$11L=function(){return _fm.$G.$9("add-small-hover","add-small-hover","owa","ms-font-color-neutralDark")};_mcp.$1.get_$3zp=function(){return _fm.$G.$9("lock","x16","owa","ms-font-color-neutralSecondary")};_mcp.$1.get_$5iY=function(){return _fm.$G.$9("add-circle-grey-small","x16-circle","owa","ms-border-color-neutralSecondary ms-font-color-neutralSecondary")};_mcp.$1.get_$5iZ=function(){return _fm.$G.$9("add-circle-grey-small-pressed","x16-circle","owa","ms-bg-color-neutralSecondary ms-border-color-neutralSecondary ms-font-color-white")};_mcp.$mt=function(n){_mcp.$mt.initializeBase(this,[n])};_mcp.$mt.prototype={$3np:null,$C1C:function(){this.$3np&&_rw.$Af.$6Kn(this.$3np.get_$S(),this.$3np.get_$S())},$4Q:function(){_js.$7.prototype.$4Q.call(this);this.$3np=this.$u?this.$u.$1N("FromPersona"):null}};_mcp.$mv=function(n,t,i,r,u,f){this.$$d_$DuT=Function.createDelegate(this,this.$DuT);this.$$d_$DuU=Function.createDelegate(this,this.$DuU);this.$$d_$A4n=Function.createDelegate(this,this.$A4n);this.$$d_$BxY=Function.createDelegate(this,this.$BxY);this.$$d_$8Jt=Function.createDelegate(this,this.$8Jt);this.$$d_$8Ju=Function.createDelegate(this,this.$8Ju);this.$$d_$8Js=Function.createDelegate(this,this.$8Js);this.$$d_$8Jv=Function.createDelegate(this,this.$8Jv);this.$$d_$8Jy=Function.createDelegate(this,this.$8Jy);this.$$d_$BxZ=Function.createDelegate(this,this.$BxZ);this.$$d_$BxX=Function.createDelegate(this,this.$BxX);this.$$d_$DfS=Function.createDelegate(this,this.$DfS);this.$$d_$26R=Function.createDelegate(this,this.$26R);this.$$d_$DdK=Function.createDelegate(this,this.$DdK);this.$$d_$DbV=Function.createDelegate(this,this.$DbV);this.$$d_$DbU=Function.createDelegate(this,this.$DbU);this.$$d_$6n8=Function.createDelegate(this,this.$6n8);this.$$d_$DTT=Function.createDelegate(this,this.$DTT);this.$$d_$6pF=Function.createDelegate(this,this.$6pF);this.$$d_$DQP=Function.createDelegate(this,this.$DQP);this.$$d_$5Dx=Function.createDelegate(this,this.$5Dx);this.$$d_$6np=Function.createDelegate(this,this.$6np);this.$$d_$6z8=Function.createDelegate(this,this.$6z8);this.$$d_$94m=Function.createDelegate(this,this.$94m);this.$$d_$6mf=Function.createDelegate(this,this.$6mf);this.$$d_$DYh=Function.createDelegate(this,this.$DYh);this.$$d_$DYg=Function.createDelegate(this,this.$DYg);this.$$d_$DbS=Function.createDelegate(this,this.$DbS);this.$$d_$DRa=Function.createDelegate(this,this.$DRa);this.$$d_$DtN=Function.createDelegate(this,this.$DtN);this.$$d_$DtO=Function.createDelegate(this,this.$DtO);this.$$d_$7Wx=Function.createDelegate(this,this.$7Wx);this.$$d_$DvE=Function.createDelegate(this,this.$DvE);this.$$d_$4eQ=Function.createDelegate(this,this.$4eQ);this.$$d_$A8c=Function.createDelegate(this,this.$A8c);this.$$d_$9mJ=Function.createDelegate(this,this.$9mJ);this.$$d_$C1F=Function.createDelegate(this,this.$C1F);this.$$d_$DTV=Function.createDelegate(this,this.$DTV);this.$$d_$DUz=Function.createDelegate(this,this.$DUz);this.$$d_$ByN=Function.createDelegate(this,this.$ByN);this.$$d_$DV3=Function.createDelegate(this,this.$DV3);this.$$d_$Dkz=Function.createDelegate(this,this.$Dkz);this.$$d_$7qP=Function.createDelegate(this,this.$7qP);this.$$d_$5mo=Function.createDelegate(this,this.$5mo);this.$5p={};this.$1ai={};_mcp.$mv.initializeBase(this,[n]);this.$fx=t;this.$1D=i;this.$1G=r;this.$l=f;_js.Trace.logInfo(_a.$0.$15,"View created with layout="+this.$fx);this.$1x1=new _C(this.$$d_$5mo,_a.$0.$15);if(t==="Mouse"&&u.$2u("Water")){this.$3JZ=!0;this.set_$6Lq(this.$3JZ)}};_mcp.$mv.prototype={$1D:null,$1G:null,$1x1:null,$h6:null,$11Z:null,$OI:null,$4GL:!1,$4y3:!1,$4ts:!1,$4td:!1,$fx:0,$3Zz:!1,$2Bl:!1,$hZ:!1,$5fz:!1,$4L1:!1,$3xl:!1,$6T0:!1,$7CG:null,$l:null,$3JZ:!1,$18I:!1,$z8:!1,set_$6Lq:function(n){if(this.$18I!==n){this.$18I=n;this.$3h("InContentEditableDivMode","IsReadyToShowContentInRTE")}return n},get_$CCZ:function(){return this.$3xl&&!this.$18I},set_$12F:function(n){if(this.$OI!==n){this.$OI=n;this.$Eow()}return n},get_$3yO:function(){return _y.$z.$1Q.get_$lJ()?!1:this.$4y3},set_$3yO:function(n){if(this.$4y3!==n){this.$4y3=n;this.$4("IsToRecipientWellPeoplePickerButtonShown")}return n},get_$3vZ:function(){return _y.$z.$1Q.get_$lJ()?!1:this.$4ts},set_$3vZ:function(n){if(this.$4ts!==n){this.$4ts=n;this.$4("IsCcRecipientWellPeoplePickerButtonShown")}return n},get_$3vS:function(){return _y.$z.$1Q.get_$lJ()?!1:this.$4td},set_$3vS:function(n){if(this.$4td!==n){this.$4td=n;this.$4("IsBccRecipientWellPeoplePickerButtonShown")}return n},get_$4GW:function(){return!0},set_$6Rt:function(n){if(this.$3xl!==n){this.$3xl=n;this.$3JZ&&this.$5p.Ribbon.set_$17(!(n&&this.$z8));this.$3h("IsReadyToShowContent","IsReadyToShowContentInRTE")}return n},set_$4GM:function(n){if(this.$4GL!==n){this.$4GL=n;this.$4("ShouldPreventShiftTabDefault")}return n},set_$CDm:function(n){this.$6T0=n;this.$4("IsTabAnchorNeeded");return n},get_$AWT:function(){return this.$1G.get_$pm()},get_$m:function(){return _a.$0.$15},$9gM:function(){if(this.$OI){_js.Trace.logInfo(_a.$0.$15,"Already have focused control name, skipping set initial focus");return}if(!this.get_$k()){_js.Trace.logInfo(_a.$0.$15,"No data context yet, skipping set initial focus");return}var n=this.get_$k();if(n.get_$aa().$GH.$21j()<1){_js.Trace.logInfo(_a.$0.$15,"Queue task to set initial focus to To well. Context:"+n.$c.toString());if(this.$1D.get_$JK()||this.$1D.get_$fJ())this.$1Jk("ToRecipientWellControl");else{var i=this;_js.$D.get_$Q().$2V(_a.$0.$15,"SetFocusToRecipientWell",function(){i.$1Jk("ToRecipientWellControl")},500)}}else if(_js.$9.$o(this.$5p.SubjectTextBox.get_$S().val())){_js.Trace.logInfo(_a.$0.$15,"Set initial focus to subject. Context: "+n.$c.toString());this.$1Jk("SubjectTextBox");if(this.$1D.get_$De()){_js.Trace.logInfo(_a.$0.$15,"Queue task to set initial focus to subject for IE. Context:"+n.$c.toString());var t=this;_js.$D.get_$Q().$2V(_a.$0.$15,"SetFocusToSubject",function(){t.$1Jk("SubjectTextBox")},500)}}else{_js.Trace.logInfo(_a.$0.$15,"Set initial focus to body. Context: "+n.$c.toString());if(this.$1D.get_$De()){_js.Trace.logInfo(_a.$0.$15,"Queue task to set initial focus to body for IE. Context:"+n.$c.toString());_js.$D.get_$Q().$2V(_a.$0.$15,"SetFocusToEditor",this.$$d_$7qP,500)}else this.$7qP()}},$mV:function(n){},$IW:function(n){this.$5fz=!this.get_$k();if(this.$5fz)_js.Trace.logInfo(_a.$0.$15,"PostTransitionIn with null DataContext.");else{var t=this.get_$k();var i=t.get_$2Mg();if(i.get_$G6()){this.$4L1=!!this.$5p.EditorControl;if(this.$4L1){this.get_$33()?t.get_$4va()&&!t.$3xk?t.$p("IsReadyForViewInitialization",this.$$d_$Dkz):this.$8Ol():_js.Trace.logInfo(_a.$0.$15,"PostTransitionIn view not active yet. Context:"+t.$c.toString());var r=this.$18I?this.$5p.CED:this.$5p.EditorControl;r.$IW()}else _js.Trace.logInfo(_a.$0.$15,"PostTransitionIn template not applied yet. Context:"+t.$c.toString())}else this.$9iL(i,t.$c);if(this.$fx==="Mouse"){t.$9vX();this.$6z8()}}this.$hZ=!0},$pa:function(){this.$hZ=!1;_js.Trace.logInfo(_a.$0.$15,"PreTransitionOut view");var n=this.$OI;if(n&&n in this.$5p)switch(n){case"FromFieldControl":case"ToRecipientWellControl":case"CcRecipientWellControl":case"BccRecipientWellControl":case"SubjectTextBox":this.$7Xl();this.$3Zz=!0;var t=this.$1ai[n];if(t[0]===document.activeElement){_js.Trace.logInfo(_a.$0.$15,"Blur from "+n);t.blur()}this.$OI=null;this.$3Zz=!1;break;case"EditorControl":this.$3Zz=!0;this.$5p.EditorControl.$A8a();this.$OI=null;this.$3Zz=!1;break}else _js.Trace.logInfo(_a.$0.$15," Skip pre-transition out focus related processing for current focused control "+n+", since it's not present in the controls dictionary");"EditorControl"in this.$5p?this.$5p.EditorControl.$pa():_js.Trace.logInfo(_a.$0.$15," Skip calling editor.PreTransitionOut since it's not present in the controls dictionary")},$Tj:function(){_js.Trace.logInfo(_a.$0.$15,"PostTransitionOut view");this.set_$3yO(!0);this.set_$3vZ(!1);this.set_$3vS(!1);this.set_$6Rt(!1);var n=this.$5p.EditorControl;n&&n.$Tj()},$3Q:function(){this.$1t6();return!0},$2A:function(){_js.Trace.logInfo(_a.$0.$15,"Disposing view");this.$ElJ();this.$2BG();this.$1ai=null;this.$5p=null;this.$OI=null;_js.$7.prototype.$2A.call(this)},$4Q:function(){_js.$7.prototype.$4Q.call(this);var n=this.$u;var t=null;this.get_$k()&&(t=this.get_$k());if(n){this.$5p.SubjectTextBox=n.$1N("SubjectTextBox");this.$5p.FromFieldControl=n.$1N("FromFieldControl");this.$5p.ToRecipientWellControl=n.$1N("ToRecipientWellControl");this.$5p.CcRecipientWellControl=n.$1N("CcRecipientWellControl");this.$5p.BccRecipientWellControl=n.$1N("BccRecipientWellControl");var r=n.$1N("EditorControl");this.$5p.EditorControl=r;var i=n.$1N("CED");this.$5p.CED=i;if(i){i.$EK=!this.$18I;r.$EK=this.$18I;this.$18I&&i.$EXX()}if(this.$3JZ){var u=n.$1N("Ribbon");this.$5p.Ribbon=u;if(this.$18I){u.set_$5zK(i);i.$EY2(r,this.$$d_$DV3)}}this.$5p.CancelConfirmDialog=n.$1N("CancelConfirmDialog");this.$5p.MessageBox=n.$1N("MessageBox");this.$5p.ComposeDockPanel=n.$1N("ComposeDockPanel");this.$5p.ToRecipientButton=n.$1N("ToRecipientButton");this.$5p.CcRecipientButton=n.$1N("CcRecipientButton");this.$5p.BccRecipientButton=n.$1N("BccRecipientButton");this.$5p.QuotedBodyHtmlLabel=n.$1N("QuotedBodyHtmlLabel");if(this.$fx==="Mouse"){this.$5p.SendButton=n.$1N("SendButton");this.$5p.DiscardButton=n.$1N("DiscardButton");this.$5p.InsertButton=n.$1N("InsertButton");this.$5p.AppsButton=n.$1N("AppsButton");this.$5p.AffordanceMenuButton=n.$1N("AffordanceMenuButton");this.$5p.OpenSeperateWindowButton=n.$1N("OpenSeperateWindowButton");this.$5p.ComposeAppsPane=n.$1N("ComposeAppsPane");if(t){this.$z8=t.$c.get_$6P()==="HTML";!this.$z8&&this.$18I&&this.$5mo()}}this.$7CG=new _C(this.$$d_$ByN,this.get_$m());r.$5WZ=!0;this.$EY5();if(this.$hZ&&!this.$4L1){_js.Trace.logInfo(_a.$0.$15,"Applied template, already in view and template was not applied at PostTransitionIn, calling PostTransitionIn. Context:"+(t?t.$c.toString():"null"));this.$IW(null)}else _js.Trace.logInfo(_a.$0.$15,"Applying template. Context:"+(t?t.$c.toString():"null"));this.$5p.EditorControl&&this.$5p.EditorControl.$p("IsPlainTextContent",this.$$d_$DUz)}else{_js.Trace.logInfo(_a.$0.$15,"Applying null template. Context:"+(t?t.$c.toString():"null"));this.$5p.SubjectTextBox=null;this.$5p.FromFieldControl=null;this.$5p.ToRecipientWellControl=null;this.$5p.CcRecipientWellControl=null;this.$5p.BccRecipientWellControl=null;this.$5p.EditorControl=null;this.$5p.CED=null;this.$5p.CancelConfirmDialog=null;this.$5p.MessageBox=null;this.$5p.ComposeDockPanel=null}this.$9tf()},$8g:function(){_js.$F.prototype.$8g.call(this);if(this.get_$k()){var n=this.get_$k();var t=n.get_$2Mg();this.$z8=n.$c.get_$6P()==="HTML";!this.$z8&&this.$18I&&this.$u&&this.$5mo();if(this.$5fz)if(t.get_$G6()){_js.Trace.logInfo(_a.$0.$15,"DataContext updated, PostTransitionIn with null DataContext and view model initialized, call PostTransitionIn with Context: "+n.$c.toString());this.$IW(null)}else this.$9iL(t,n.$c);t.$4xU?this.$7Ve():t.$p("IsSecondInitializationComplete",this.$$d_$DTV);n.get_$aa().$EVg(this.$$d_$C1F)}else _js.Trace.logInfo(_a.$0.$15,"Updated DataContext to null")},$3R:function(){_js.$7.prototype.$3R.call(this);if(this.$hZ&&this.get_$k()&&this.$4L1){var r=this.get_$k();var u=r.get_$2Mg();if(u.get_$G6()){this.set_$6Rt(!0);_js.Trace.logInfo(_a.$0.$15,"Show content on activate. Context:"+r.$c.toString());this.$9gM();this.$1aD();var t=this.$5p.EditorControl;if(t){if(_z.$CR.isInstanceOfType(t)){var n=t;if(n.get_$ASo()){_js.Trace.logInfo(_a.$0.$15,"Restore extendable editor to original height on ready to show content");n.$9Nx()}else if(n.get_$ASm()){_js.Trace.logInfo(_a.$0.$15,"Set extendable editor to full screen height on ready to show content");n.$EVa()}}var i=t;if(i.$1Qv){_js.Trace.logInfo(_a.$0.$15,"Set editor to current scroll height if it is more than full screen on ready to show content");i.$1OD()}}_js.$D.get_$Q().$2V(_a.$0.$15,"MailCompose.Editor.Resize",this.$$d_$9mJ,500)}}},$1aD:function(){var n=this.get_$k();if(this.$2Bl){_js.Trace.logInfo(_a.$0.$15,"Events already bound. Context:"+n.$c.toString());return}if(this.$1D.get_$JK()){$(window.document.body).bind("mousedown",{uiComponent:"Body"},this.$$d_$A8c);var u=this;_js.$D.get_$Q().$2V(_a.$0.$15,"RemoveBodyFocusHandler",function(){$(window.document.body).unbind("mousedown",u.$$d_$A8c)},1e3)}this.$h6=new(_ff.$18.$$(_mcp.$mv.$y0));if(this.$fx==="Mouse"){this.$h6.$F(new _mcp.$mv.$y0("DiscardButton",this.$$d_$4eQ));this.$h6.$F(new _mcp.$mv.$y0("InsertButton",this.$$d_$4eQ));this.$h6.$F(new _mcp.$mv.$y0("AppsButton",this.$$d_$4eQ));this.$h6.$F(new _mcp.$mv.$y0("AffordanceMenuButton",this.$$d_$4eQ));this.$h6.$F(new _mcp.$mv.$y0("OpenSeperateWindowButton",this.$$d_$4eQ));this.$h6.$F(new _mcp.$mv.$y0("ToRecipientButton",this.$$d_$4eQ))}this.$h6.$F(new _mcp.$mv.$y0("SubjectTextBox",this.$$d_$4eQ));this.$h6.$F(new _mcp.$mv.$y0("FromFieldControl",this.$$d_$4eQ));this.$h6.$F(new _mcp.$mv.$y0("ToRecipientWellControl",this.$$d_$DvE));this.$h6.$F(new _mcp.$mv.$y0("CcRecipientWellControl",this.$$d_$DvE));this.$h6.$F(new _mcp.$mv.$y0("BccRecipientWellControl",this.$$d_$DvE));this.$11Z=new(_ff.$18.$$(_mcp.$mv.$y0));this.$11Z.$F(new _mcp.$mv.$y0("FromFieldControl",this.$$d_$7Wx));this.$11Z.$F(new _mcp.$mv.$y0("ToRecipientWellControl",this.$$d_$7Wx));this.$11Z.$F(new _mcp.$mv.$y0("CcRecipientWellControl",this.$$d_$7Wx));this.$11Z.$F(new _mcp.$mv.$y0("BccRecipientWellControl",this.$$d_$7Wx));if(n.get_$4va()){n.$6R.addEventListener("focusin",this.$$d_$DtO,!0);n.$6R.addEventListener("focusout",this.$$d_$DtN,!0)}else{for(var i=0;i<this.$h6.get_$A();i++)this.$5p[this.$h6.get_$E(i).$1IR].get_$S().bind("focusin",{uiComponent:this.$h6.get_$E(i).$1IR},this.$h6.get_$E(i).$2c4);for(var t=0;t<this.$11Z.get_$A();t++)this.$5p[this.$11Z.get_$E(t).$1IR].get_$S().bind("focusout",{uiComponent:this.$11Z.get_$E(t).$1IR},this.$11Z.get_$E(t).$2c4)}this.$4S6();this.$7md();this.$5p.CancelConfirmDialog.$p("IsHidden",this.$$d_$DRa);this.$5p.MessageBox.$p("IsHidden",this.$$d_$DbS);n.$1d.$p("ActionPerformed",this.$$d_$DYg);n.$1d.$p("Count",this.$$d_$DYh);n.get_$eH().add_$6mf(this.$$d_$6mf);if(!$C(this.$5p.ComposeAppsPane)){this.$5p.ComposeAppsPane.$p("IsHidden",this.$$d_$94m);_y.$z.$1Q.add_$1Ge(this.$$d_$6z8);_g.$O.get_$Q().get_$6o().add_$1zY(this.$$d_$6np)}if(this.$l.$8D(this.$l.get_$IE())&&this.$fx==="TouchWide"){var r=n.get_$38b().$65;if(r){r.add_$2T8(this.$$d_$5Dx);r.add_$3RD(this.$$d_$DQP)}}n.$c.$p("SelectedDataCallContext",this.$$d_$6pF);this.$2Bl=!0},$2BG:function(){if(this.$5p){"CancelConfirmDialog"in this.$5p&&this.$5p.CancelConfirmDialog.$1B("IsHidden",this.$$d_$DRa);"MessageBox"in this.$5p&&this.$5p.MessageBox.$1B("IsHidden",this.$$d_$DbS);var u=this.get_$k();if(u&&u.get_$4va()){u.$6R.removeEventListener("focusin",this.$$d_$DtO,!0);u.$6R.removeEventListener("focusout",this.$$d_$DtN,!0)}else{for(var i=0;i<this.$h6.get_$A();i++)this.$h6.get_$E(i).$1IR in this.$5p&&this.$5p[this.$h6.get_$E(i).$1IR].get_$S().unbind("focusin",this.$h6.get_$E(i).$2c4);for(var t=0;t<this.$11Z.get_$A();t++)this.$11Z.get_$E(t).$1IR in this.$5p&&this.$5p[this.$11Z.get_$E(t).$1IR].get_$S().unbind("focusout",this.$11Z.get_$E(t).$2c4)}"EditorControl"in this.$5p&&this.$5p.EditorControl.$1B("IsPlainTextContent",this.$$d_$DUz);this.$Epq()}if(this.get_$k()){var n=this.get_$k();_js.Trace.logInfo(_a.$0.$15,"Unbind view events on view model. Context:"+n.$c.toString());var e=n.get_$2Mg();e.$1B("IsInitialized",this.$$d_$DTT);e.$1B("IsSecondInitializationComplete",this.$$d_$DTV);n.get_$1k2()&&n.get_$1k2().get_$Tb()&&n.get_$1k2().get_$Tb().$1B("IsShown",this.$$d_$6n8);var r=n.get_$3Lw();if(r){r.$1B("DialogViewModel",this.$$d_$DbU);r.$E5&&r.$E5.$1B("IsShown",this.$$d_$DbV)}var o=n.get_$aa();o&&o.$1B("IsPeoplePickerShown",this.$$d_$DdK);n.$1d.$1B("ActionPerformed",this.$$d_$DYg);n.$1d.$1B("Count",this.$$d_$DYh);n.get_$eH().remove_$6mf(this.$$d_$6mf);n.$1B("IsReadyForViewInitialization",this.$$d_$Dkz);n.get_$eH().get_$9Z()&&n.get_$eH().get_$9Z().remove_$26R(this.$$d_$26R);if(this.$l.$8D(this.$l.get_$IE())&&this.$fx==="TouchWide"){var f=n.get_$38b().$65;if(f){f.remove_$2T8(this.$$d_$5Dx);f.remove_$3RD(this.$$d_$DQP)}}n.$c.$1B("SelectedDataCallContext",this.$$d_$6pF)}if(!$C(this.$5p.ComposeAppsPane)){this.$5p.ComposeAppsPane.$1B("IsHidden",this.$$d_$94m);_y.$z.$1Q.remove_$1Ge(this.$$d_$6z8);_g.$O.get_$Q().get_$6o().remove_$1zY(this.$$d_$6np)}this.$2Bl=!1},$BxX:function(n){_js.Trace.logInfo(_a.$0.$15,"Focused in the RTE");this.set_$12F("EditorControl")},$BxY:function(n){_js.Trace.logInfo(_a.$0.$15,"Focused in the Water");this.set_$12F("CED")},$4eQ:function(n){var i=n.data;var t=i.uiComponent;this.$7qF(t)},$DvE:function(n){this.$4eQ(n);this.$6J7()},$7Wx:function(n){_js.Trace.logInfo(_a.$0.$15,"User blured from "+this.$OI);if(this.get_$k()&&_mcp.$8m.isInstanceOfType(this.get_$k())&&!this.$3Zz&&!this.get_$k().$1db){if(this.$OI==="FromFieldControl"){var t=this.get_$k().get_$aa();if(t&&t.get_$1Rl()){var u=t.get_$1Rl().get_$Bx();_js.$9.$o(u)||t.$4Fk(u,!0)}}var r=this;_js.$D.get_$Q().$2V(this.get_$m(),"Delayed MailTips retrieval",function(){if(r.get_$k()){var n=r.get_$k().get_$6Ws();n.get_$G6()||n.$3e();n.$2xt()}},100);if(_a.$5N.$43){var i=this;_js.$D.get_$Q().$2V(this.get_$m(),"Delayed PolicyTips retrieval",function(){if(i.get_$k()){var n=i.get_$k().get_$9Fg();n.$2BC(1)}},100)}}},$1t6:function(){if(this.$5p&&this.get_$33()&&this.$hZ&&this.$OI&&this.get_$k()&&!this.get_$k().$1db){_js.Trace.logInfo(_a.$0.$15,"Restore focus to "+this.$OI);this.$1Jk(this.$OI)}else _js.Trace.logInfo(_a.$0.$15,"Skip restore focus, controls="+(this.$5p?"non-null":"null")+"; Active="+this.get_$33().toString()+"; InView="+this.$hZ.toString()+"; Name="+this.$OI+"; VM="+(this.get_$k()?"non-null":"null"))},$1Jk:function(n){this.$7Xl();switch(n){case"SubjectTextBox":case"BccRecipientWellControl":case"CcRecipientWellControl":case"ToRecipientWellControl":case"FromFieldControl":this.$1ai[n].focus();this.set_$12F(n);this.$6J7();break;case"EditorControl":case"CED":this.$5p[n].$3Q();this.set_$12F(n);break}},$7Xl:function(){if(this.$1ai&&!("SubjectTextBox"in this.$1ai)){this.$1ai.SubjectTextBox=this.$5p.SubjectTextBox.get_$S();this.$1ai.FromFieldControl=this.$5p.FromFieldControl.get_$S().find("input");this.$1ai.ToRecipientWellControl=this.$5p.ToRecipientWellControl.get_$S().find("input");this.$1ai.CcRecipientWellControl=this.$5p.CcRecipientWellControl.get_$S().find("input");this.$1ai.BccRecipientWellControl=this.$5p.BccRecipientWellControl.get_$S().find("input")}},$A8c:function(n){var i=n.data;var t=i.uiComponent;if(t==="Body"){_js.Trace.logInfo(_a.$0.$15,"MouseDown event on Body is being ignored to prevent hiding the keyboard.");n.preventDefault()}},$EY5:function(){this.$5p.FromFieldControl.add_$102(this.$$d_$DfS);this.$5p.ToRecipientWellControl.add_$102(this.$$d_$DfS);this.$5p.CcRecipientWellControl.add_$102(this.$$d_$DfS);this.$5p.BccRecipientWellControl.add_$102(this.$$d_$DfS)},$94m:function(n,t){var i=this.$5p.ComposeAppsPane;i.get_$17()&&this.$1Jk("ToRecipientWellControl")},$6pF:function(n,t){var i=this.get_$k();if(this.$OI==="SubjectTextBox"){i.$c.get_$28n().set_$1He("subject");this.$5p.SubjectTextBox.set_$16L(i.$c.get_$28n())}else if(this.$OI==="EditorControl"){"EditorControl"in this.$5p&&this.$5p.EditorControl.set_$16L(i.$c.get_$28n());i.$c.get_$28n().set_$1He("body")}else i.$c.get_$28n().set_$6QA(!0)},$ElJ:function(){var i=this.$5p.FromFieldControl;var r=this.$5p.ToRecipientWellControl;var n=this.$5p.CcRecipientWellControl;var t=this.$5p.BccRecipientWellControl;i&&i.remove_$102(this.$$d_$DfS);r&&r.remove_$102(this.$$d_$DfS);n&&n.remove_$102(this.$$d_$DfS);t&&t.remove_$102(this.$$d_$DfS)},$DfS:function(n){if(this.$5p.FromFieldControl===n){var u=n.get_$S().find("input");u.attr("aria-labelledby","MailCompose.FromRecipientWellButton")}else if(this.$5p.ToRecipientWellControl===n){var r=n.get_$S().find("input");r.attr("aria-label",_nbs.NonBootStrings.l_ToRecipients_AT_TextBox_Text);r.attr("role","combobox");r.attr("aria-haspopup","true")}else if(this.$5p.CcRecipientWellControl===n){var t=n.get_$S().find("input");t.attr("aria-label",_nbs.NonBootStrings.l_CcRecipients_AT_TextBox_Text);t.attr("role","combobox");t.attr("aria-haspopup","true")}else if(this.$5p.BccRecipientWellControl===n){var i=n.get_$S().find("input");i.attr("aria-label",_nbs.NonBootStrings.l_BccRecipients_AT_TextBox_Text);i.attr("role","combobox");i.attr("aria-haspopup","true")}},$C1F:function(){var n=this.$5p.FromFieldControl;n&&n.$C1C()},$6J7:function(){switch(this.$OI){case"ToRecipientWellControl":this.set_$3yO(!0);this.set_$3vZ(!1);this.set_$3vS(!1);break;case"CcRecipientWellControl":this.set_$3vZ(!0);this.set_$3yO(!1);this.set_$3vS(!1);break;case"BccRecipientWellControl":this.set_$3vS(!0);this.set_$3vZ(!1);this.set_$3yO(!1);break}},$ByN:function(){var n=!0;if(this.$4GL){if(this.$OI==="DiscardButton"){this.$5p.SendButton.$3Q();this.set_$12F("SendButton")}else if(this.$OI==="InsertButton"){this.$5p.DiscardButton.$3Q();this.set_$12F("DiscardButton");n=!1}else if(this.$OI==="AppsButton"){this.$5p.InsertButton.$3Q();this.set_$12F("InsertButton");n=!1}else if(this.$OI==="AffordanceMenuButton"){var i=this.$5p.AppsButton;if(i.get_$17()){this.$5p.InsertButton.$3Q();this.set_$12F("InsertButton")}else{i.$3Q();this.set_$12F("AppsButton")}n=!1}else if(this.$OI==="OpenSeperateWindowButton"){this.$5p.AffordanceMenuButton.$3Q();this.set_$12F("AffordanceMenuButton");n=!1}else if(this.$OI==="ToRecipientButton"){var t=this.get_$k();if(t.get_$aa().$4v2||t.$1d.get_$A())this.set_$4GM(!1);else{var u=this.$5p.ComposeAppsPane;if(u.get_$17()){this.$5p.OpenSeperateWindowButton.$3Q();this.set_$12F("OpenSeperateWindowButton");n=!1}else this.set_$4GM(!1)}}else if(this.$OI==="ToRecipientWellControl")if(this.$fx==="Mouse"){this.$5p.ToRecipientButton.$3Q();this.set_$12F("ToRecipientButton");n=!1}else this.set_$4GM(!1);else if(this.$OI==="CcRecipientWellControl"){this.$5p.CcRecipientButton.$3Q();this.set_$12F("CcRecipientButton")}else if(this.$OI==="BccRecipientWellControl"){this.$5p.BccRecipientButton.$3Q();this.set_$12F("BccRecipientButton")}if(n){var r=this;_js.$D.get_$Q().$2V(this.get_$m(),"MailComposeView.HandleShiftTabOnRecipientWell",function(){r.set_$4GM(!1)},100)}}},$Eow:function(){if(this.$EZg()){var n=this.get_$k();switch(this.$OI){case"ToRecipientWellControl":n.get_$aa().$GL.$2BD();n.get_$aa().$Gb.$2BD();break;case"CcRecipientWellControl":n.get_$aa().$GH.$2BD();n.get_$aa().$Gb.$2BD();break;case"BccRecipientWellControl":n.get_$aa().$GH.$2BD();n.get_$aa().$GL.$2BD();break;default:n.get_$aa().$GH.$2BD();n.get_$aa().$GL.$2BD();n.get_$aa().$Gb.$2BD();break}}},$EZg:function(){return this.$fx!=="Mouse"&&this.get_$k()?!0:!1},$DRa:function(n,t){if(this.$5p.CancelConfirmDialog.get_$17()&&this.get_$k()&&!this.get_$k().$1db){_js.Trace.logInfo(_a.$0.$15,"Restore focus on hide of cancel confirm dialog.");this.$1t6()}},$DbS:function(n,t){if(this.$5p.MessageBox.get_$17()){_js.Trace.logInfo(_a.$0.$15,"Restore focus on hide of message box.");this.$1t6()}},$DTT:function(n,t){var i=this.get_$k();i.get_$2Mg().$1B("IsInitialized",this.$$d_$DTT);_js.Trace.logInfo(_a.$0.$15,"Calling PostTransitionIn on initialize of Data Context.");this.$IW(null)},$DTV:function(n,t){var i=this.get_$k();i.get_$2Mg().$1B("IsSecondInitializationComplete",this.$$d_$DTV);this.$7Ve();this.$fx==="Mouse"&&i.get_$1k2().get_$Tb()&&i.get_$1k2().get_$Tb().$p("IsShown",this.$$d_$6n8);var r=i.get_$3Lw();r.$E5?r.$E5.$p("IsShown",this.$$d_$DbV):r.$p("DialogViewModel",this.$$d_$DbU);var u=i.get_$aa();u&&u.$p("IsPeoplePickerShown",this.$$d_$DdK)},$7Ve:function(){if(this.$fx==="Mouse"){var n=this.get_$k();n&&this.$18I&&(n.get_$7dI().$1x1=this.$1x1)}},$6n8:function(n,t){var i=this.get_$k();if(!i.get_$1k2().get_$Tb().$3U){var r=i.get_$3Lw();var u=this;_js.$D.get_$Q().$2V(this.get_$m(),"MailComposeView.OnContextMenuShownChanged",function(){var t=!r.$E5||!r.$E5.$3U;var n=!i.$2G||!i.$2G.$3U;if(t&&n){_js.Trace.logInfo(_a.$0.$15,"Restore focus on hide of context menu");u.$1t6()}},100)}},$DbU:function(n,t){var r=this.get_$k();var i=r.get_$3Lw();i.$1B("DialogViewModel",this.$$d_$DbU);i.$E5.$p("IsShown",this.$$d_$DbV)},$DbV:function(n,t){var r=this.get_$k();var i=this;_js.$D.get_$Q().$2V(this.get_$m(),"MailComposeView.OnMessageOptionsShownChanged",function(){if(!r.get_$3Lw().$E5.$3U){_js.Trace.logInfo(_a.$0.$15,"Restore focus on hide of message options dialog");i.$1t6()}},100)},$DdK:function(n,t){var i=this.get_$k();if(!i.get_$aa().$6RU){_js.Trace.logInfo(_a.$0.$15,"Restore focus on hide of people picker");this.$1t6()}},$DYg:function(n,t){this.$1t6()},$DYh:function(n,t){this.$9tf();this.$9mJ()},$9tf:function(){var a=this.$u.$1N("InfoBarControl");if(a){var f=this.get_$k();if(f.$1d.$G4.get_$A()>0){for(var l=new _y.$tr,o=_nbs.NonBootStrings.l_Infobar_AT_Region_Text+". ",n,r=0;r<f.$1d.$G4.get_$A();r++){n="";var t=f.$1d.$G4.get_$E(r);if(_y.$dq.isInstanceOfType(t)){var h=t;h&&(n=h.$3S)}else if(_y.$dr.isInstanceOfType(t)){var e=t;e&&(n=e.$3S)}else if(_y.$W2.isInstanceOfType(t)){var i=t;if(i&&_y.$1IX.isInstanceOfType(i.$Fb)){var u=i.$Fb;u&&u.get_$1F0()&&(n=u.get_$1F0())}}if(n===""){var s=t;s&&(n=l.$4L(s.$5h,null))}o+=n+". "}var c=this.$u.$1N("InfoBarControl").get_$S();c.attr("aria-label",o)}}},$6mf:function(n){n.get_$9Z().add_$26R(this.$$d_$26R)},$26R:function(n){if(n.get_$8Mx()){n.set_$8Mx(!1);this.set_$12F("EditorControl")}this.$1t6()},$9iL:function(n,t){if(n.$Bqi("IsInitialized"))_js.Trace.logInfo(_a.$0.$15,"PostTransitionIn before DataContext was initialized. DataContext initialization handler is already setup. Context:"+t.toString());else{_js.Trace.logInfo(_a.$0.$15,"PostTransitionIn before DataContext was initialized. Adding handler to call PostTransitionIn after DataContext is initialized. Context:"+t.toString());n.$p("IsInitialized",this.$$d_$DTT)}},$4S6:function(){if("EditorControl"in this.$5p&&this.$5p.EditorControl){var t=this.$5p.EditorControl;t.add_$1rq(this.$$d_$BxX);t.add_$1fb(this.$$d_$BxZ);t.add_$2rj(this.$$d_$8Jy);t.add_$3RY(this.$$d_$8Jv);t.add_$XH(this.$$d_$8Js);t.add_$3RW(this.$$d_$8Ju);t.add_$3RR(this.$$d_$8Jt)}if("CED"in this.$5p&&this.$5p.CED){var n=this.$5p.CED;n.add_$1rq(this.$$d_$BxY);n.add_$1fb(this.$$d_$BxZ);n.add_$2rj(this.$$d_$8Jy);n.add_$3RY(this.$$d_$8Jv);n.add_$XH(this.$$d_$8Js);n.add_$3RW(this.$$d_$8Ju);n.add_$3RR(this.$$d_$8Jt)}if(this.$1D.get_$De()){var i=this.$u.$1N("TabAnchor");i&&i.get_$S().bind("focusin",this.$$d_$A4n)}},$Epq:function(){if("EditorControl"in this.$5p&&this.$5p.EditorControl){var t=this.$5p.EditorControl;t.remove_$1rq(this.$$d_$BxX);t.remove_$1fb(this.$$d_$BxZ);t.remove_$2rj(this.$$d_$8Jy);t.remove_$3RY(this.$$d_$8Jv);t.remove_$XH(this.$$d_$8Js);t.remove_$3RW(this.$$d_$8Ju);t.remove_$3RR(this.$$d_$8Jt)}if("CED"in this.$5p&&this.$5p.CED){var n=this.$5p.CED;n.remove_$1rq(this.$$d_$BxY);n.remove_$1fb(this.$$d_$BxZ);n.remove_$2rj(this.$$d_$8Jy);n.remove_$3RY(this.$$d_$8Jv);n.remove_$XH(this.$$d_$8Js);n.remove_$3RW(this.$$d_$8Ju);n.remove_$3RR(this.$$d_$8Jt)}if(this.$1D.get_$De()){var i=this.$u.$1N("TabAnchor");i&&i.get_$S().unbind("focusin")}},$DUz:function(n,t){if(_z.$Ao.isInstanceOfType(n)){var i=n;this.$z8=!i.$Eq;i&&this.$z8&&this.get_$k().$c.set_$1vK(i.get_$1K());this.$7md();if(this.$3JZ){var r=this.$5p.Ribbon;r&&r.set_$17(!this.$z8)}}},$A4n:function(n){var t=new _a.$7D(n);this.$1Jk("EditorControl");t.$Dy()},$BxZ:function(n){var t=this.get_$k();t.$c.get_$9kI()?this.$1Jk("CcRecipientWellControl"):this.$1Jk("SubjectTextBox");n.set_$Dy(!0)},$8Jy:function(n){var t=this.get_$k();if(t){t.$c.set_$EZn(n.get_$EZo());t.$c.set_$4bR(n.get_$4bR());t.$c.set_$6P7(n.get_$G6());t.$c.set_$6P8(n.get_$dF())}},$8Jv:function(n){var t=this.get_$k();t&&t.$1n.$5k(5).$Ex1(n.get_$1l())},$8Js:function(n){var i=this.get_$k();if(i){var t=i.get_$eH().get_$9Z().get_$135();t.$9T(n.get_$4cS());t.$4r(n.get_$4cS())}},$8Ju:function(n){var i=this.get_$k();if(i){var t=i.get_$eH().get_$9Z();t.set_$4Us(n.get_$4Us());t.set_$4Ut(n.get_$4Ut());t.set_$2dX(n.get_$2dX());t.get_$2ch().$11()}},$8Jt:function(n){var i=this.get_$k();if(i){var t=i.get_$eH().get_$9Z();t.set_$el(n.get_$lp());t.get_$2ch().$11()}},$9mJ:function(){var n=this.$5p.EditorControl;n.$5WZ=!1;n.$Js()},$6np:function(n,t){this.$6z8()},$6z8:function(){},$5Dx:function(){var n=this.$5p.QuotedBodyHtmlLabel;if(n){this.$5p.QuotedBodyHtmlLabel.get_$Gv().on("touchstart",null,null,this.$$d_$DuU);this.$5p.QuotedBodyHtmlLabel.get_$Gv().on("touchend",null,null,this.$$d_$DuT)}},$DQP:function(){var n=this.$5p.QuotedBodyHtmlLabel;if(n){this.$5p.QuotedBodyHtmlLabel.get_$Gv().off("touchstart",null,this.$$d_$DuU);this.$5p.QuotedBodyHtmlLabel.get_$Gv().off("touchend",null,this.$$d_$DuT)}},$DuT:function(n){if(n.target.tagName==="A"){var t=n.target.getAttribute("href");this.$l.get_$IE().$2PA(t);n.stopImmediatePropagation();n.preventDefault()}},$DuU:function(n){if(n.target.tagName==="A"){n.stopPropagation();n.preventDefault()}},$8Ol:function(){var n=this.get_$k();this.set_$6Rt(!0);_js.Trace.logInfo(_a.$0.$15,"PostTransitionIn active view. Context: "+n.$c.toString());this.$9gM();this.$1aD();_js.$D.get_$Q().$2V(_a.$0.$15,"MailCompose.Editor.Resize",this.$$d_$9mJ,500)},$Dkz:function(n,t){var i=n;i.$1B("IsReadyForViewInitialization",this.$$d_$Dkz);this.$8Ol()},$5mo:function(){if(this.$18I){var t=this.$5p.CED;var n=this.$5p.EditorControl;var i=this.$5p.Ribbon;i.set_$5zK(n);i.set_$17(!0);if(t&&n){n.$EK=!1;n.set_$ma(t.get_$ma());t.$7ao()}this.set_$6Lq(!1);if(n){n.$IW();n.$Js()}}},$7qP:function(){this.$18I?this.$1Jk("CED"):this.$1Jk("EditorControl")},$DV3:function(){this.set_$6Lq(!1)},$DtO:function(n){for(var t=0;t<this.$h6.get_$A();t++){var r=this.$h6.get_$E(t);var i=this.$5p[r.$1IR];if(n.target===i.$O||i.get_$S().has(n.target).length){this.$7qF(r.$1IR);this.$6J7();break}}return!0},$DtN:function(n){for(var t=0;t<this.$11Z.get_$A();t++){var r=this.$11Z.get_$E(t);var i=this.$5p[r.$1IR];if(n.target===i.$O||i.get_$S().has(n.target).length){r.$2c4(null);break}}return!0},$7qF:function(n){_js.Trace.logInfo(_a.$0.$15,"Focused in "+n);this.set_$12F(n);this.set_$4GM(n==="CcRecipientWellControl"||n==="BccRecipientWellControl"||n==="ToRecipientWellControl"||n==="ToRecipientButton"||n==="OpenSeperateWindowButton"||n==="AffordanceMenuButton"||n==="InsertButton"||n==="DiscardButton"||n==="AppsButton");if(this.get_$k()&&_mcp.$8m.isInstanceOfType(this.get_$k())){var i=this.get_$k();if(this.$OI==="FromFieldControl"){var t=i.get_$aa();t&&t.set_$9iy(!1)}this.$OI==="InsertButton"&&i.$AFY()}},$7md:function(){var n=this.get_$k();n&&this.set_$CDm(this.$1D.get_$De()&&n.$c.get_$6P()==="Text"?!0:!1)}};_mcp.$mv.$y0=function(n,t){this.$1IR=n;this.$2c4=t};_mcp.$mv.$y0.prototype={$1IR:null,$2c4:null};_mcp._TI=function(){};_mcp._TI.$$cctor=function(){var l="IrmDialogView";new _A(l,function(){_mcp._TI.$1[l]===undefined&&(_mcp._TI.$1[l]=[[[-1,0,["Description"],[_mcp._TI.$D0X],null,"Text",null,_mcp._TI.$H,1,null,null,null]],[[-1,0,["ConversationOwner"],[_mcp._TI.$D0W],null,"Text",null,_mcp._TI.$H,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[0].cloneNode(!0);var i=new _fc.$A(n.children[1]);var t=new _fc.$A(n.children[0]);return new _B(n,[t,i])},_mcp.$13y,_js.$7,!1,!1,!1,0,_mcp._TI.$1);var a="MailComposeView._tid1._tid3";new _A(a,function(){_mcp._TI.$1[a]===undefined&&(_mcp._TI.$1[a]=[[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.$Eg,_mcp._TI.$2RR],null,"DataContext",null,_mcp._TI.$Y,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[1].cloneNode(!0);var n=new _pe.$2J(t.children[0],_js.$2.Instance.$2(_a.$1w));n.set_$Z0("_mcp_v ms-font-weight-regular ms-font-color-black bidi");n.set_$6("PersonaView.BasicDetailsPopup");n.set_$7P("MailCompose.FromRecipientWellButton");return new _B(t,[n])},_mcp.$8m,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var h="MailComposeView._tid1._tid4";new _A(h,function(){_mcp._TI.$1[h]===undefined&&(_mcp._TI.$1[h]=[[[-1,0,["RecipientComponent","FromFindRecipientViewModel"],[_mcp._TI.$Eg,_mcp._TI.$8ti],null,"DataContext",null,_mcp._TI.$Y,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[2].cloneNode(!0);var n=new _fp.$I5(t.children[0],_js.$2.Instance.$2(_y.$W),_js.$2.Instance.$2(_ff.$M));n.set_$7P("MailCompose.FromRecipientWellButton");return new _B(t,[n])},_mcp.$8m,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var c="MailComposeView._tid1";new _A(c,function(){_mcp._TI.$1[c]===undefined&&(_mcp._TI.$1[c]=[[[-1,4,null,null,null,"ImageId",null,_mcp._TI.$x,0,null,null,null,_b.$1.get_$nB()],[-1,4,null,null,null,"Text",null,_mcp._TI.$1V,0,null,null,null,_nbs.NonBootStrings.l_FromSendAsLabel_Text],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.$2m,0,null,null,null,_nbs.NonBootStrings.l_FromAddressSelector_AT_Button_Text],[-1,5,["SendAsContextMenuComponent","Menu","IsShown"],[_mcp._TI.$3OM,_mcp._TI.$3OI,_mcp._TI.$2q],null,"contextMenu",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.$Eg,_mcp._TI.$2RR],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$23(),null,!0]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.$Eg,_mcp._TI.$2RR],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$23(),null,!0]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.$Eg,_mcp._TI.$2RR],null,"IsHidden",null,_mcp._TI.$8,1,new _js.$x([_mcp._TI.get_$23(),_mcp._TI.get_$K()],[null,null]),null,!0],[-1,5,["RecipientComponent","ShouldHighlightFromAsInvalid"],[_mcp._TI.$Eg,_mcp._TI.$8tj],null,"_mcp_d",null,null,0,null,null,null]]]);var t=_mcp._TI._hf.childNodes[3].cloneNode(!0);var u=new _js.$7(t.children[3]);u.set_$6("MailComposeView._tid1._tid4");var f=new _js.$7(t.children[2]);var r=new _js.$7(t.children[1]);r.set_$6("MailComposeView._tid1._tid3");var n=new _fc.$H(t.children[0]);n.set_$6("MailComposeView.FromButtonTemplate");n.set_$3E("MailCompose.FromRecipientWellButton");n.set_$g(0);var i=new _fce.$1D(_js.$2.Instance.$2(_fc.$l),_js.$2.Instance.$2(_ff.$M),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$K));i.$M(_E.$D(["SendAsContextMenuComponent","Menu"],[_mcp._TI.$3OM,_mcp._TI.$3OI],null,"MenuDataContext",null,_mcp._TI.$3p,1)).$M(_E.$D(["SendAsContextMenuComponent","Menu","IsShown"],[_mcp._TI.$3OM,_mcp._TI.$3OI,_mcp._TI.$2q],_mcp._TI.$49,"IsShown",_mcp._TI.$3m,_mcp._TI.$3l,2,null,null,!1));i.$58=3;i.$7W=1;n.set_$12([i]);return new _B(t,[n,r,f,u]).R({FromPersona:r})},_mcp.$8m,_mcp.$mt,!1,!0,!1,0,_mcp._TI.$1);var p="MailComposeView._tid8";new _A(p,function(){_mcp._TI.$1[p]===undefined&&(_mcp._TI.$1[p]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_u.CommonStrings.l_SubjectLabel_Text]],[[-1,0,["Context","Subject"],[_mcp._TI.$EA,_mcp._TI.$56d],null,"Text",null,_mcp._TI.$H,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[4].cloneNode(!0);var i=new _fc.$A(_B.$3(n,[1,0]));var t=new _fc.$A(n.children[0]);return new _B(n,[t,i])},_mcp.$8m,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var w="MailComposeView._tid9._tida";new _A(w,function(){_mcp._TI.$1[w]===undefined&&(_mcp._TI.$1[w]=[[[-1,0,["MeetingComponent","SenderDetailsViewModel"],[_mcp._TI.$1VI,_mcp._TI.$8te],_mcp._TI.$8tf,"DataContext",_mcp._TI.$2T,_mcp._TI.$Y,2,null,null,null]],[[-1,0,["MeetingComponent","FromDetailsViewModel"],[_mcp._TI.$1VI,_mcp._TI.$581],null,"DataContext",null,_mcp._TI.$Y,1,null,null,null]]]);var i=_mcp._TI._hf.childNodes[5].cloneNode(!0);var t=new _pe.$2J(i.children[1],_js.$2.Instance.$2(_a.$1w));t.set_$Z0("_mcp_j ms-font-weight-regular ms-font-color-black bidi");t.set_$6("PersonaView.PresenceBasicDetailsPopup");var n=new _pe.$2J(i.children[0],_js.$2.Instance.$2(_a.$1w));n.set_$Z0("_mcp_j ms-font-weight-regular ms-font-color-black bidi");n.set_$6("PersonaView.PresenceBasicDetailsPopup");return new _B(i,[n,t])},_mcp.$8m,_b.$8L,!1,!0,!1,0,_mcp._TI.$1);var v="MailComposeView._tid9._tidb";new _A(v,function(){_mcp._TI.$1[v]===undefined&&(_mcp._TI.$1[v]=[[[-1,0,["MeetingComponent","FromDetailsViewModel"],[_mcp._TI.$1VI,_mcp._TI.$581],null,"DataContext",null,_mcp._TI.$Y,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[6].cloneNode(!0);var n=new _pe.$2J(t.children[0],_js.$2.Instance.$2(_a.$1w));n.set_$Z0("_mcp_j ms-font-weight-regular ms-font-color-black bidi");n.set_$6("PersonaView.PresenceBasicDetailsPopup");return new _B(t,[n])},_mcp.$8m,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var y="MailComposeView._tid9";new _A(y,function(){_mcp._TI.$1[y]===undefined&&(_mcp._TI.$1[y]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_nbs.NonBootStrings.l_FromLabel_Text]],[[-1,4,null,null,null,"FormatString",null,_mcp._TI.$ze,0,null,null,null,_u.Strings.l_OnBehalfOf_Text],[-1,0,["MeetingComponent","IsMeetingForwardOnBehalfOf"],[_mcp._TI.$1VI,_mcp._TI.$582],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["MeetingComponent","IsMeetingForwardOnBehalfOf"],[_mcp._TI.$1VI,_mcp._TI.$582],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]]]);var n=_mcp._TI._hf.childNodes[7].cloneNode(!0);var i=new _js.$7(_B.$3(n,[1,1]));i.set_$6("MailComposeView._tid9._tidb");var t=new _b.$8L(_B.$3(n,[1,0]));t.set_$6("MailComposeView._tid9._tida");var r=new _fc.$A(n.children[0]);return new _B(n,[r,t,i])},_mcp.$8m,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var s="MailComposeView._tidc";new _A(s,function(){_mcp._TI.$1[s]===undefined&&(_mcp._TI.$1[s]=[[[-1,0,["Context","WhenLabel"],[_mcp._TI.$EA,_mcp._TI.$8ta],null,"Text",null,_mcp._TI.$H,1,null,null,null]],[[-1,0,["Context","MeetingCalendarTimePeriod"],[_mcp._TI.$EA,_mcp._TI.$8tZ],null,"Text",null,_mcp._TI.$H,1,_mcp._TI.get_$2oK(),null,null]]]);var n=_mcp._TI._hf.childNodes[8].cloneNode(!0);var i=new _fc.$A(_B.$3(n,[1,0]));var t=new _fc.$A(n.children[0]);return new _B(n,[t,i])},_mcp.$8m,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var i="MailComposeView._tidd";new _A(i,function(){_mcp._TI.$1[i]===undefined&&(_mcp._TI.$1[i]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_nbs.NonBootStrings.l_ProposeNewTimeLabel_Short_Text]],[[-1,0,["Context","ProposedNewTime"],[_mcp._TI.$EA,_mcp._TI.$8og],null,"Text",null,_mcp._TI.$H,1,_mcp._TI.get_$41d(),null,null]]]);var n=_mcp._TI._hf.childNodes[9].cloneNode(!0);var r=new _fc.$A(_B.$3(n,[1,0]));var t=new _fc.$A(n.children[0]);return new _B(n,[t,r])},_mcp.$8m,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var r="MailComposeView._tide";new _A(r,function(){_mcp._TI.$1[r]===undefined&&(_mcp._TI.$1[r]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_u.MeetingMsgStrings.l_WhereLabel_Text]],[[-1,0,["MeetingComponent","LocationViewModel"],[_mcp._TI.$1VI,_mcp._TI.$8td],null,"DataContext",null,_mcp._TI.$Y,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[10].cloneNode(!0);var n=new _cmm.$WS(_B.$3(t,[1,0]));n.set_$3yi(!0);n.set_$4P(!0);var i=new _fc.$A(t.children[0]);return new _B(t,[i,n])},_mcp.$8m,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var n="MailComposeView._tidf";new _A(n,function(){_mcp._TI.$1[n]===undefined&&(_mcp._TI.$1[n]=[[[-1,4,null,null,null,"ImageId",null,_mcp._TI.$x,0,null,null,null,_b.$1.get_$qk()],[-1,4,null,null,null,"HoveredImageId",null,_mcp._TI.$1p,0,null,null,null,_n.$1.get_$1Iz()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.$5m,0,null,null,null,_n.$1.get_$1Iz()],[-1,4,null,null,null,"Text",null,_mcp._TI.$1V,0,null,null,null,_nbs.NonBootStrings.l_showOriginalMessage_Text],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.$2m,0,null,null,null,_nbs.NonBootStrings.l_showOriginalMessage_Text],[-1,0,["UpgradeComponent","CompleteBodyUpgradeCommand"],[_mcp._TI.$2RT,_mcp._TI.$8tl],null,"ClickCommand",null,_mcp._TI.$Z,1,null,null,null],[-1,0,["UpgradeComponent","ShouldShowQuoteBodyButton"],[_mcp._TI.$2RT,_mcp._TI.$8to],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp._TI.$60,0,null,null,0,0],[-1,4,null,null,null,"BusyText",null,_mcp._TI.$BT,0,null,null,null,_nbs.NonBootStrings.l_showOriginalMessage_Text],[-1,0,["UpgradeComponent","IsWaitingForQuotedBody"],[_mcp._TI.$2RT,_mcp._TI.$8tn],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]]]);var i=_mcp._TI._hf.childNodes[11].cloneNode(!0);var t=new _fce.$20(i.children[1],_js.$2.Instance.$2(_js.$p),_js.$2.Instance.$2(_ff.$C));t.$78=0;t.set_$g(-1);var r=new _fc.$H(i.children[0]);r.set_$g(0);return new _B(i,[r,t])},_mcp.$8m,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var t="MailComposeView.FromButtonTemplate";new _A(t,function(){_mcp._TI.$1[t]===undefined&&(_mcp._TI.$1[t]=[[[-1,1,["Text"],[_mcp._TI.$Tg],null,"Text",null,_mcp._TI.$H,1,null,null,null]],[[-1,1,["CurrentImageId"],[_mcp._TI.$79],null,"Id",null,_mcp._TI.$16,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[12].cloneNode(!0);var r=new _fc.$Z(n.children[1],_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$K));var i=new _fc.$A(n.children[0]);return new _B(n,[i,r]).R({Label:i,Image:r})},Object,_fc.$H,!1,!1,!1,0,_mcp._TI.$1);var e="MailComposeView";new _A(e,function(){_mcp._TI.$1[e]===undefined&&(_mcp._TI.$1[e]=[[[-1,4,null,null,null,"SpinnerSize",null,_mcp._TI.$60,0,null,null,0,1],[-1,1,["IsReadyToShowContent"],[_mcp._TI.$25M],null,"IsBusy",null,_mcp._TI.$AM,1,_mcp._TI.get_$K(),null,!1]],[[-1,1,["IsReadyToShowContent"],[_mcp._TI.$25M],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,5,["GenericMailMode"],[_mcp._TI.$8tq],null,"_mcp_N",null,null,0,_mcp._TI.get_$K(),null,null]],[[-1,5,["ExtensibilityComponent","ExtensibilityViewModel","AppPaneIsHidden"],[_mcp._TI.$3OK,_mcp._TI.$3OF,_mcp._TI.$zh],null,"_mcp_V",null,null,0,_mcp._TI.get_$K(),null,null],[-1,5,["GenericMailMode"],[_mcp._TI.$8tq],null,"_mcp_Q",null,null,0,null,null,null],[-1,5,["DisableMomemtumScrolling"],[_mcp._TI.$D0r],null,"_mcp_J",null,null,0,null,null,null]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp._TI.$60,0,null,null,0,0],[-1,0,["ToolbarMessage"],[_mcp._TI.$8tw],null,"BusyText",null,_mcp._TI.$BT,1,null,null,null],[-1,0,["ShouldShowToolbarMessage"],[_mcp._TI.$6hA],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,1,["IsReadyToShowContent"],[_mcp._TI.$25M],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["InfoBarViewModel"],[_mcp._TI.$6h7],null,"DataSource",null,_mcp._TI.$OT,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.$1FZ],null,"_mcp_S",null,null,0,null,null,null],[-1,5,["IsInternetExplorer"],[_mcp._TI.$6h9],null,"_mcp_R",null,null,0,null,null,null]],[[-1,5,["DoesSupportRichText"],[_mcp._TI.$8u6],null,"_mcp_4",null,null,1,null,null,null]],[[-1,0,["Context","IsFromShown"],[_mcp._TI.$EA,_mcp._TI.$8of],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$1V,0,null,null,null,_u.Strings.l_ToRecipientsLabel_Text],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.$2m,0,null,null,null,_nbs.NonBootStrings.l_ToRecipients_AT_Button_Text],[-1,0,["RecipientComponent","To","RichPeoplePickerCommand"],[_mcp._TI.$Eg,_mcp._TI.$2RS,_mcp._TI.$1VH],null,"ClickCommand",null,_mcp._TI.$Z,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.$1FZ],null,"_mcp_S",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp._TI.$fo],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.$Eg,_mcp._TI.$1VG],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp._TI.$x,0,null,null,null,_mcp.$1.get_$5iY()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.$5m,0,null,null,null,_mcp.$1.get_$5iZ()],[-1,1,["IsToRecipientWellPeoplePickerButtonShown"],[_mcp._TI.$8u9],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,0,["RecipientComponent","To","RichPeoplePickerCommand"],[_mcp._TI.$Eg,_mcp._TI.$2RS,_mcp._TI.$1VH],null,"ClickCommand",null,_mcp._TI.$Z,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$6h8],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","To","ReadWriteRecipientWellViewModel"],[_mcp._TI.$Eg,_mcp._TI.$2RS,_mcp._TI.$3OH],null,"DataContext",null,_mcp._TI.$Y,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$3NY],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.$Eg,_mcp._TI.$1VG],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]],[[-1,0,["RecipientComponent","To","ReadOnlyRecipientWellViewModel"],[_mcp._TI.$Eg,_mcp._TI.$2RS,_mcp._TI.$3OG],null,"DataContext",null,_mcp._TI.$Y,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$3NY],null,"Android",null,null,0,null,null,null]],null,[[-1,4,null,null,null,"Text",null,_mcp._TI.$1V,0,null,null,null,_u.Strings.l_CcRecipientsLabel_Text],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.$2m,0,null,null,null,_nbs.NonBootStrings.l_CcRecipients_AT_Button_Text],[-1,0,["RecipientComponent","Cc","RichPeoplePickerCommand"],[_mcp._TI.$Eg,_mcp._TI.$2RQ,_mcp._TI.$1VH],null,"ClickCommand",null,_mcp._TI.$Z,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.$1FZ],null,"_mcp_S",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp._TI.$fo],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.$Eg,_mcp._TI.$1VG],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp._TI.$x,0,null,null,null,_mcp.$1.get_$5iY()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.$5m,0,null,null,null,_mcp.$1.get_$5iZ()],[-1,1,["IsCcRecipientWellPeoplePickerButtonShown"],[_mcp._TI.$8u8],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,0,["RecipientComponent","Cc","RichPeoplePickerCommand"],[_mcp._TI.$Eg,_mcp._TI.$2RQ,_mcp._TI.$1VH],null,"ClickCommand",null,_mcp._TI.$Z,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$6h8],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","Cc","ReadWriteRecipientWellViewModel"],[_mcp._TI.$Eg,_mcp._TI.$2RQ,_mcp._TI.$3OH],null,"DataContext",null,_mcp._TI.$Y,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$3NY],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.$Eg,_mcp._TI.$1VG],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]],[[-1,0,["RecipientComponent","Cc","ReadOnlyRecipientWellViewModel"],[_mcp._TI.$Eg,_mcp._TI.$2RQ,_mcp._TI.$3OG],null,"DataContext",null,_mcp._TI.$Y,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$3NY],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["Context","IsBccShown"],[_mcp._TI.$EA,_mcp._TI.$8oe],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$1V,0,null,null,null,_u.Strings.l_BccRecipientsLabel_Text],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.$2m,0,null,null,null,_nbs.NonBootStrings.l_BccRecipients_AT_Button_Text],[-1,0,["RecipientComponent","Bcc","RichPeoplePickerCommand"],[_mcp._TI.$Eg,_mcp._TI.$2RP,_mcp._TI.$1VH],null,"ClickCommand",null,_mcp._TI.$Z,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.$1FZ],null,"_mcp_S",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp._TI.$fo],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.$Eg,_mcp._TI.$1VG],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp._TI.$x,0,null,null,null,_mcp.$1.get_$5iY()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.$5m,0,null,null,null,_mcp.$1.get_$5iZ()],[-1,1,["IsBccRecipientWellPeoplePickerButtonShown"],[_mcp._TI.$8u7],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,0,["RecipientComponent","Bcc","RichPeoplePickerCommand"],[_mcp._TI.$Eg,_mcp._TI.$2RP,_mcp._TI.$1VH],null,"ClickCommand",null,_mcp._TI.$Z,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$6h8],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","Bcc","ReadWriteRecipientWellViewModel"],[_mcp._TI.$Eg,_mcp._TI.$2RP,_mcp._TI.$3OH],null,"DataContext",null,_mcp._TI.$Y,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$3NY],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.$Eg,_mcp._TI.$1VG],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]],[[-1,0,["RecipientComponent","Bcc","ReadOnlyRecipientWellViewModel"],[_mcp._TI.$Eg,_mcp._TI.$2RP,_mcp._TI.$3OG],null,"DataContext",null,_mcp._TI.$Y,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$3NY],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["Context","IsMeetingForward"],[_mcp._TI.$EA,_mcp._TI.$3Nf],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_u.CommonStrings.l_SubjectLabel_Text]],[[-1,4,null,null,null,"ImageId",null,_mcp._TI.$x,0,null,null,null,_mcp.$1.get_$3zp()],[-1,0,["ComplianceComponent","ShowIrmInformationCommand"],[_mcp._TI.$583,_mcp._TI.$D0a],null,"ClickCommand",null,_mcp._TI.$Z,1,null,null,null],[-1,0,["ComplianceComponent","IsIrmProtected"],[_mcp._TI.$583,_mcp._TI.$8tV],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp._TI.$16,0,null,null,null,_n.$1.get_$4Be()],[-1,0,["Context","SmimeSignMessage"],[_mcp._TI.$EA,_mcp._TI.$8ok],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp._TI.$16,0,null,null,null,_n.$1.get_$a()],[-1,0,["Context","SmimeEncryptMessage"],[_mcp._TI.$EA,_mcp._TI.$8oj],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["ImportanceComponent","IsNormalImportance"],[_mcp._TI.$8tr,_mcp._TI.$8tb],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0],[-1,0,["Context","Importance"],[_mcp._TI.$EA,_mcp._TI.$8od],null,"Id",null,_mcp._TI.$16,1,_mcp._TI.get_$vp(),null,null]],[[-1,0,["Context","Subject"],[_mcp._TI.$EA,_mcp._TI.$56d],_mcp._TI.$8om,"Text",_mcp._TI.$5K,_mcp._TI.$5G,2,null,null,null],[-1,0,["Context","MaxSubjectLength"],[_mcp._TI.$EA,_mcp._TI.$8tY],null,"MaxLength",null,_mcp._TI.$Yi,1,null,null,0]],[[-1,0,["Context","ShowMeetingReadonlyFields"],[_mcp._TI.$EA,_mcp._TI.$8oi],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["Context","IsMeetingForward"],[_mcp._TI.$EA,_mcp._TI.$3Nf],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["Context","IsMeetingForward"],[_mcp._TI.$EA,_mcp._TI.$3Nf],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],null,[[-1,0,["Context","HasProposedNewTime"],[_mcp._TI.$EA,_mcp._TI.$8tX],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$23(),null,!0]],[[-1,0,["Context","HasLocation"],[_mcp._TI.$EA,_mcp._TI.$8oc],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["AttachmentComponent","AttachmentWellViewModel","ShouldBeHidden"],[_mcp._TI.$43m,_mcp._TI.$6gp,_mcp._TI.$8o5],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]],[[-1,0,["AttachmentComponent","AttachmentWellViewModel"],[_mcp._TI.$43m,_mcp._TI.$6gp],_mcp._TI.$D0Y,"DataContext",_mcp._TI.$2T,_mcp._TI.$Y,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_nbs.NonBootStrings.l_PrintRestricted_Text],[-1,0,["Context","IsPrintRestricted"],[_mcp._TI.$EA,_mcp._TI.$1qT],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,5,["Context","IsPrintRestricted"],[_mcp._TI.$EA,_mcp._TI.$1qT],null,"noScreen:hiddenMsg",null,null,0,null,null,null]],[[-1,4,null,null,null,"EditorAriaLabel",null,_mcp._TI.$1pj,0,null,null,null,_nbs.NonBootStrings.l_MessageBody_AT_TextBox_Text],[-1,1,["IsReadyToShowContent"],[_mcp._TI.$25M],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,0,["Context","IsCopyRestricted"],[_mcp._TI.$EA,_mcp._TI.$43j],null,"IsCopyRestricted",null,_mcp._TI.$XA,1,null,null,!1],[-1,0,["Context","IsPrintRestricted"],[_mcp._TI.$EA,_mcp._TI.$1qT],null,"ShouldRestrictFramePrinting",null,_mcp._TI.$6cg,1,null,null,!1],[-1,0,["Context","EditorContent"],[_mcp._TI.$EA,_mcp._TI.$6eZ],_mcp._TI.$6ec,"Content",_mcp._TI.$2od,_mcp._TI.$2oe,2,null,null,null],[-1,0,["Context","RawEditorContent"],[_mcp._TI.$EA,_mcp._TI.$6ea],_mcp._TI.$6ed,"RawContent",_mcp._TI.$1pi,_mcp._TI.$1eT,2,null,null,null],[-1,0,["Context","TextEditorContent"],[_mcp._TI.$EA,_mcp._TI.$6eb],_mcp._TI.$6ee,"TextContent",_mcp._TI.$6cY,_mcp._TI.$6ci,2,null,null,null],[-1,0,["ContentConversionComponent","SwitchToHtmlContent"],[_mcp._TI.$43n,_mcp._TI.$8tW],null,"SwitchToHtmlContent",null,_mcp._TI.$8lD,1,null,null,null],[-1,0,["ContentConversionComponent","SwitchToPlainTextContent"],[_mcp._TI.$43n,_mcp._TI.$6gq],null,"SwitchToPlainTextContent",null,_mcp._TI.$6ch,1,null,null,null],[-1,0,["EditorResizeComponent","ResizeEditorCommand"],[_mcp._TI.$D0s,_mcp._TI.$D0e],_mcp._TI.$D0f,"ResizeCommand",_mcp._TI.$42S,_mcp._TI.$42T,2,null,null,null],[-1,0,["Context","BodyType"],[_mcp._TI.$EA,_mcp._TI.$8ob],_mcp._TI.$8ol,"IsPlainTextContent",_mcp._TI.$42R,_mcp._TI.$8lC,2,_mcp._TI.get_$8l3(),null,!1],[-1,0,["EditorComponent","EditorCallContext"],[_mcp._TI.$6h6,_mcp._TI.$6gs],_mcp._TI.$6gt,"CallContext",_mcp._TI.$3NJ,_mcp._TI.$3NK,2,null,null,null],[-1,0,["Context","IsEditorInitialized"],[_mcp._TI.$EA,_mcp._TI.$Clw],null,"IsInitialized",null,_mcp._TI.$Ccp,1,null,null,!1],[-1,0,["TouchComponent","CloseCommand"],[_mcp._TI.$584,_mcp._TI.$8tk],null,"DiscardCommand",null,_mcp._TI.$2of,1,null,null,null],[-1,0,["SaveComponent","SaveCommand"],[_mcp._TI.$43o,_mcp._TI.$42z],null,"SaveCommand",null,_mcp._TI.$2og,1,null,null,null],[-1,0,["SendComponent","SendCommand"],[_mcp._TI.$1VJ,_mcp._TI.$2pI],null,"SendCommand",null,_mcp._TI.$3NM,1,null,null,null],[-1,0,["SendComponent","AltSSendCommand"],[_mcp._TI.$1VJ,_mcp._TI.$43l],null,"AltSSendCommand",null,_mcp._TI.$55I,1,null,null,null],[-1,0,["RecipientComponent","ResolveCommand"],[_mcp._TI.$Eg,_mcp._TI.$43k],null,"ResolveCommand",null,_mcp._TI.$3NL,1,null,null,null],[-1,0,["LinkPreviewComponent","IsLinkPreviewEnabled"],[_mcp._TI.$k2,_mcp._TI.$6gv],null,"IsLinkPreviewEnabled",null,_mcp._TI.$6cc,1,null,null,!1],[-1,0,["LinkPreviewComponent","GetLinkPreviewRequest"],[_mcp._TI.$k2,_mcp._TI.$6gu],_mcp._TI.$6h0,"GetLinkPreviewRequest",_mcp._TI.$6cW,_mcp._TI.$6cb,2,null,null,null],[-1,0,["LinkPreviewComponent","LinkPreviewResponse"],[_mcp._TI.$k2,_mcp._TI.$6gw],null,"LinkPreviewResponse",null,_mcp._TI.$6cd,1,null,null,null],[-1,0,["LinkPreviewComponent","YouTubePlayerAnchorClicked"],[_mcp._TI.$k2,_mcp._TI.$6gz],_mcp._TI.$6h3,"YouTubePlayerAnchorClicked",_mcp._TI.$6ca,_mcp._TI.$6ck,2,null,null,null],[-1,0,["LinkPreviewComponent","OEmbedVideoPlayerAnchorClicked"],[_mcp._TI.$k2,_mcp._TI.$6gx],_mcp._TI.$6h1,"OEmbedVideoPlayerAnchorClicked",_mcp._TI.$6cX,_mcp._TI.$6ce,2,null,null,null],[-1,0,["LinkPreviewComponent","VideoPlayerHtmlLookup"],[_mcp._TI.$k2,_mcp._TI.$6gy],_mcp._TI.$6h2,"VideoPlayerHtmlLookup",_mcp._TI.$6cZ,_mcp._TI.$6cj,2,null,null,null],[-1,5,["Context","IsPrintRestricted"],[_mcp._TI.$EA,_mcp._TI.$1qT],null,"noPrint",null,null,0,null,null,null]],[[-1,1,["IsReadyToShowContent"],[_mcp._TI.$25M],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,5,["UpgradeComponent","IsOnDemandUpgradePending"],[_mcp._TI.$2RT,_mcp._TI.$8tm],null,"_mcp_I",null,null,0,_mcp._TI.get_$K(),null,null]],[[-1,1,["DoesSupportRichText"],[_mcp._TI.$8u6],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0],[-1,0,["Context","IsCopyRestricted"],[_mcp._TI.$EA,_mcp._TI.$43j],null,"TextSelectionType",null,_mcp._TI.$3B,1,_mcp._TI.get_$dS(),null,0]],[[-1,0,["Context","IsCopyRestricted"],[_mcp._TI.$EA,_mcp._TI.$43j],null,"IsCopyRestricted",null,_mcp._TI.$XA,1,null,null,!1],[-1,0,["Context","QuotedBody"],[_mcp._TI.$EA,_mcp._TI.$8oh],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$23(),null,!0],[-1,0,["Context","QuotedBody"],[_mcp._TI.$EA,_mcp._TI.$8oh],null,"Html",null,_mcp._TI.$Ix,1,null,null,null]],[[-1,0,["ExtensibilityComponent","ExtensibilityViewModel"],[_mcp._TI.$3OK,_mcp._TI.$3OF],null,"DataContext",null,_mcp._TI.$Y,1,null,null,null],[0,0,["AppPaneIsHidden"],[_mcp._TI.$zh],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]],[[-1,0,["MessageBoxViewModel"],[_mcp._TI.$8tt],null,"DataContext",null,_mcp._TI.$Y,1,null,null,null]],[[-1,4,null,null,null,"DialogTitle",null,_mcp._TI.$FS,0,null,null,null,_nbs.NonBootStrings.l_CloseMessageConfirmDialogTitle_Text],[-1,0,["TouchComponent","CloseConfirmDialogButtonData"],[_mcp._TI.$584,_mcp._TI.$Clz],null,"ButtonDataList",null,_mcp._TI.$FR,1,null,null,null],[-1,0,["TouchComponent","IsCloseConfirmDialogShown"],[_mcp._TI.$584,_mcp._TI.$Cm0],_mcp._TI.$Cm1,"IsShown",_mcp._TI.$4w,_mcp._TI.$4f,2,null,null,!1]],[[-1,0,["ComplianceComponent","DialogViewModel"],[_mcp._TI.$583,_mcp._TI.$D0Z],null,"DataContext",null,_mcp._TI.$Y,1,null,null,null],[0,0,["IsShown"],[_mcp._TI.$AC],_mcp._TI.$Dh,"IsShown",_mcp._TI.$4w,_mcp._TI.$4f,2,null,null,!1],[0,0,["Title"],[_mcp._TI.$HZ],null,"DialogTitle",null,_mcp._TI.$Dv,1,null,null,null],[0,0,["CloseCommand"],[_mcp._TI.$Ef],null,"CloseCommand",null,_mcp._TI.$BU,1,null,null,null],[0,0,["ContentDataContext"],[_mcp._TI.$HF],null,"ContentDataContext",null,_mcp._TI.$G8,1,null,null,null],[0,0,["FooterButtons"],[_mcp._TI.$DR],null,"ButtonDataList",null,_mcp._TI.$DS,1,null,null,null]],[[-1,0,["MessageOptionsComponent","DialogViewModel"],[_mcp._TI.$8tu,_mcp._TI.$8tg],null,"DataContext",null,_mcp._TI.$Y,1,null,null,null],[0,0,["IsBusy"],[_mcp._TI.$42t],_mcp._TI.$8nj,"IsBusy",_mcp._TI.$6jA,_mcp._TI.$8zR,2,null,null,!1],[0,0,["IsShown"],[_mcp._TI.$AC],_mcp._TI.$Dh,"IsShown",_mcp._TI.$4w,_mcp._TI.$4f,2,null,null,!1],[0,0,["Title"],[_mcp._TI.$HZ],null,"DialogTitle",null,_mcp._TI.$Dv,1,null,null,null],[0,0,["CloseCommand"],[_mcp._TI.$Ef],null,"CloseCommand",null,_mcp._TI.$BU,1,null,null,null],[0,0,["ContentDataContext"],[_mcp._TI.$HF],null,"ContentDataContext",null,_mcp._TI.$G8,1,null,null,null],[0,0,["FooterButtons"],[_mcp._TI.$DR],null,"ButtonDataList",null,_mcp._TI.$DS,1,null,null,null]],[[-1,0,["IsNavigatingAway"],[_mcp._TI.$D0v],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]]]);var n=_mcp._TI._hf.childNodes[13].cloneNode(!0);var fi=new _js.$F(n.children[8]);var dt=new _fce.$5M(n.children[7],_js.$2.Instance.$2(_fc.$l),_js.$2.Instance.$2(_ff.$M),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$K));dt.set_$B0("MessageOptionsView");var kt=new _fce.$5M(n.children[6],_js.$2.Instance.$2(_fc.$l),_js.$2.Instance.$2(_ff.$M),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$K));kt.set_$B0("IrmDialogView");var ft=new _b.$5L(n.children[5],_js.$2.Instance.$2(_y.$W),_js.$2.Instance.$2(_fc.$l),_js.$2.Instance.$2(_ff.$M),_js.$2.Instance.$2(_ff.$K));ft.set_$iO(!1);var ot=new _js.$7(n.children[4]);ot.set_$6("MessageBoxDefaultView");var ct=new _js.$7(n.children[3]);ct.set_$6("ComposeExtensibilityView");var yt=new _b.$4B(_B.$3(n,[2,1,4,0]));var ti=new _js.$F(_B.$3(n,[2,1,4]));var vt=new _js.$7(_B.$3(n,[2,1,3]));vt.set_$6("MailComposeView._tidf");var t=_js.$2.Instance.$2(_js.$5P.$$(_z.$Ao)).$9(_B.$3(n,[2,1,2]));t.set_$1z5("_mcp_y ms-font-weight-regular ms-font-color-neutralPrimary");t.set_$3Hi(!0);t.set_$4P(!0);t.set_$g(-1);t.set_$3mF("0");var si=new _fc.$A(_B.$3(n,[2,1,1,7]));var f=new _js.$7(_B.$3(n,[2,1,1,6,0,0]));f.set_$6("AttachmentWellViewWrapper");f.set_$re(!0);f.set_$4P(!0);var bi=new _js.$F(_B.$3(n,[2,1,1,6]));var at=new _js.$7(_B.$3(n,[2,1,1,5,4]));at.set_$6("MailComposeView._tide");var wt=new _js.$7(_B.$3(n,[2,1,1,5,3]));wt.set_$6("MailComposeView._tidd");var lt=new _js.$7(_B.$3(n,[2,1,1,5,2]));lt.set_$6("MailComposeView._tidc");var ht=new _js.$7(_B.$3(n,[2,1,1,5,1]));ht.set_$6("MailComposeView._tid9");var bt=new _js.$7(_B.$3(n,[2,1,1,5,0]));bt.set_$6("MailComposeView._tid8");var wi=new _js.$F(_B.$3(n,[2,1,1,5]));var et=new _fc.$1C(_B.$3(n,[2,1,1,4,1,4,0]));et.set_$g(0);var li=new _fc.$Z(_B.$3(n,[2,1,1,4,1,3]),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$K));var hi=new _fc.$Z(_B.$3(n,[2,1,1,4,1,2]),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$K));var ai=new _fc.$Z(_B.$3(n,[2,1,1,4,1,1]),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$K));var yi=new _fc.$H(_B.$3(n,[2,1,1,4,1,0]));var gt=new _fc.$A(_B.$3(n,[2,1,1,4,0]));gt.set_$g(-1);var vi=new _js.$F(_B.$3(n,[2,1,1,4]));var c=new _js.$7(_B.$3(n,[2,1,1,3,2,0]));c.set_$6("ReadOnlyRecipientWellView");c.set_$re(!0);c.set_$4P(!0);var pi=new _js.$F(_B.$3(n,[2,1,1,3,2]));var k=new _js.$7(_B.$3(n,[2,1,1,3,1,1]));k.set_$6("ReadWriteRecipientWellView");k.set_$re(!0);var s=new _fc.$H(_B.$3(n,[2,1,1,3,1,0,0]));s.$MH=!0;s.set_$g(-1);s.set_$2v(!0);var ci=new _js.$F(_B.$3(n,[2,1,1,3,1,0]));var ri=new _js.$F(_B.$3(n,[2,1,1,3,1]));var b=new _fc.$H(_B.$3(n,[2,1,1,3,0]));b.set_$g(-1);var ni=new _js.$F(_B.$3(n,[2,1,1,3]));var o=new _js.$7(_B.$3(n,[2,1,1,2,2,0]));o.set_$6("ReadOnlyRecipientWellView");o.set_$re(!0);o.set_$4P(!0);var nr=new _js.$F(_B.$3(n,[2,1,1,2,2]));var u=new _js.$7(_B.$3(n,[2,1,1,2,1,1]));u.set_$6("ReadWriteRecipientWellView");u.set_$re(!0);u.set_$4P(!0);var h=new _fc.$H(_B.$3(n,[2,1,1,2,1,0,0]));h.$MH=!0;h.set_$g(-1);h.set_$2v(!0);var tr=new _js.$F(_B.$3(n,[2,1,1,2,1,0]));var ir=new _js.$F(_B.$3(n,[2,1,1,2,1]));var it=new _fc.$H(_B.$3(n,[2,1,1,2,0]));it.set_$g(-1);var pt=new _js.$F(_B.$3(n,[2,1,1,2]));var nt=new _js.$7(_B.$3(n,[2,1,1,1,2,0]));nt.set_$6("ReadOnlyRecipientWellView");nt.set_$4P(!0);var gi=new _js.$F(_B.$3(n,[2,1,1,1,2]));var r=new _js.$7(_B.$3(n,[2,1,1,1,1,1]));r.set_$6("ReadWriteRecipientWellView");r.set_$4P(!0);var i=new _fc.$H(_B.$3(n,[2,1,1,1,1,0,0]));i.$MH=!0;i.set_$g(-1);i.set_$2v(!0);var ki=new _js.$F(_B.$3(n,[2,1,1,1,1,0]));var di=new _js.$F(_B.$3(n,[2,1,1,1,1]));var g=new _fc.$H(_B.$3(n,[2,1,1,1,0]));g.set_$g(0);var d=new _mcp.$mt(_B.$3(n,[2,1,1,0,0]));d.set_$6("MailComposeView._tid1");var ii=new _js.$F(_B.$3(n,[2,1,1]));var rt=_js.$2.Instance.$2(_js.$5P.$$(_b.$9H)).$9(_B.$3(n,[2,1,0]));rt.set_$g(0);var ut=new _js.$F(_B.$3(n,[2,1]));ut.set_$g(-1);var st=new _fc.$17;var tt=new _fc.$N;tt.$M(_E.$D(["TouchComponent","CloseCommand"],[_mcp._TI.$584,_mcp._TI.$8tk],null,"Command",null,_mcp._TI.$i,1));tt.set_$a("ESC");var p=new _fc.$N;p.$M(_E.$D(["SaveComponent","SaveCommand"],[_mcp._TI.$43o,_mcp._TI.$42z],null,"Command",null,_mcp._TI.$i,1));p.set_$a("S");p.$2c=2;var l=new _fc.$N;l.$M(_E.$D(["SendComponent","AltSSendCommand"],[_mcp._TI.$1VJ,_mcp._TI.$43l],null,"Command",null,_mcp._TI.$i,1)).$M(_E.$D(["DoesSupportAltSForSend"],[_mcp._TI.$8tp],null,"PreventDefault",null,_mcp._TI.$2Rm,1,null,null,!1));l.set_$a("S");l.$2c=4;var y=new _fc.$N;y.$M(_E.$D(["SendComponent","SendCommand"],[_mcp._TI.$1VJ,_mcp._TI.$2pI],null,"Command",null,_mcp._TI.$i,1));y.set_$a("ENTER");y.$2c=2;var v=new _fc.$N;v.$M(_E.$D(["RecipientComponent","ResolveCommand"],[_mcp._TI.$Eg,_mcp._TI.$43k],null,"Command",null,_mcp._TI.$i,1));v.set_$a("K");v.$2c=2;var a=new _fc.$N;a.$W(_E.$D(["ContextParent","ContextParent","ShiftTabCommand"],[_mcp._TI.$e,_mcp._TI.$e,_mcp._TI.$6hC],null,"Command",null,_mcp._TI.$i,1)).$W(_E.$D(["ContextParent","ContextParent","ShouldPreventShiftTabDefault"],[_mcp._TI.$e,_mcp._TI.$e,_mcp._TI.$3ON],null,"PreventDefault",null,_mcp._TI.$2Rm,1,null,null,!1)).$W(_E.$D(["ContextParent","ContextParent","ShouldPreventShiftTabDefault"],[_mcp._TI.$e,_mcp._TI.$e,_mcp._TI.$3ON],null,"StopPropagation",null,_mcp._TI.$6jM,1,null,null,!1));a.set_$a("TAB");a.$2c=1;st.set_$2j([tt,p,l,y,v,a]);ut.set_$12([st]);var ei=new _fce.$20(_B.$3(n,[2,0]),_js.$2.Instance.$2(_js.$p),_js.$2.Instance.$2(_ff.$C));var oi=new _fce.$1F(n.children[2],_js.$2.Instance.$2(_js.$p),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$M));var ui=new _js.$F(n.children[1]);var w=new _fce.$20(n.children[0],_js.$2.Instance.$2(_js.$p),_js.$2.Instance.$2(_ff.$C));w.$78=0;w.set_$Lm("");return new _B(n,[w,ui,oi,ei,ut,rt,ii,d,g,di,ki,i,r,gi,nt,pt,it,ir,tr,h,u,nr,o,ni,b,ri,ci,s,k,pi,c,vi,gt,yi,ai,hi,li,et,wi,bt,ht,lt,wt,at,bi,f,si,t,vt,ti,yt,ct,ot,ft,kt,dt,fi]).R({InfoBarControl:rt,FromFieldControl:d,ToRecipientButton:g,ToRecipientWellControl:r,CcRecipientWellControl:pt,CcRecipientButton:it,BccRecipientWellControl:ni,BccRecipientButton:b,SubjectTextBox:et,EditorControl:t,QuotedBodyHtmlLabel:yt,MessageBox:ot,CancelConfirmDialog:ft})},_mcp.$8m,_mcp.$mv,!1,!1,!1,0,_mcp._TI.$1);var o="MessageOptionsView._tidC";new _A(o,function(){_mcp._TI.$1[o]===undefined&&(_mcp._TI.$1[o]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.$1V,0,null,null,null,_nbs.NonBootStrings.l_Smime_EncryptMessage_Text],[-1,0,["SmimeEncryptMessage"],[_mcp._TI.$D10],_mcp._TI.$D14,"IsChecked",_mcp._TI.$61,_mcp._TI.$4p,2,null,null,!1],[-1,0,["SmimeEncryptMessageIsEnabled"],[_mcp._TI.$D11],null,"IsEnabled",null,_mcp._TI.$9x,1,null,null,!1]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$1V,0,null,null,null,_nbs.NonBootStrings.l_Smime_SignMessage_Text],[-1,0,["SmimeSignMessage"],[_mcp._TI.$D12],_mcp._TI.$D15,"IsChecked",_mcp._TI.$61,_mcp._TI.$4p,2,null,null,!1],[-1,0,["SmimeSignMessageIsEnabled"],[_mcp._TI.$D13],null,"IsEnabled",null,_mcp._TI.$9x,1,null,null,!1]]]);var n=_mcp._TI._hf.childNodes[29].cloneNode(!0);var i=new _fc.$2p(n.children[1],_js.$2.Instance.$2(_ff.$C));var t=new _fc.$2p(n.children[0],_js.$2.Instance.$2(_ff.$C));return new _B(n,[t,i])},_mcp.$nK,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var u="MessageOptionsView.SensitivityTemplate";new _A(u,function(){_mcp._TI.$1[u]===undefined&&(_mcp._TI.$1[u]=[[[-1,1,["DataContext"],[_mcp._TI.$2T],null,"Text",null,_mcp._TI.$H,1,_mcp._TI.get_$8tT(),null,null]]]);var n=_mcp._TI._hf.childNodes[1].cloneNode(!0);var t=new _fc.$A(n.children[0]);return new _B(n,[t])},Object,_js.$7,!1,!1,!1,0,_mcp._TI.$1);var f="MessageOptionsView";new _A(f,function(){_mcp._TI.$1[f]===undefined&&(_mcp._TI.$1[f]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_nbs.NonBootStrings.l_Sensitivity_Text]],[[-1,0,["SensitivityOptions"],[_mcp._TI.$8u0],null,"Options",null,_mcp._TI.$Cd,1,null,null,null],[-1,0,["Sensitivity"],[_mcp._TI.$8tz],_mcp._TI.$8u5,"SelectedValue",_mcp._TI.$CP,_mcp._TI.$CQ,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$1V,0,null,null,null,_nbs.NonBootStrings.l_RequestDeliveryReceipt_Text],[-1,0,["IsDeliveryReceiptRequested"],[_mcp._TI.$8tx],_mcp._TI.$8u3,"IsChecked",_mcp._TI.$61,_mcp._TI.$4p,2,null,null,!1],[-1,0,["ShowDeliveryReceiptRequest"],[_mcp._TI.$8u1],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$1V,0,null,null,null,_nbs.NonBootStrings.l_RequestReadReceipt_Text],[-1,0,["IsReadReceiptRequested"],[_mcp._TI.$8ty],_mcp._TI.$8u4,"IsChecked",_mcp._TI.$61,_mcp._TI.$4p,2,null,null,!1],[-1,0,["ShowReadReceiptRequest"],[_mcp._TI.$8u2],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["ShowSmimeOptions"],[_mcp._TI.$D0z],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]]]);var n=_mcp._TI._hf.childNodes[30].cloneNode(!0);var i=new _js.$7(n.children[4]);i.set_$6("MessageOptionsView._tidC");var u=new _fc.$2p(n.children[3],_js.$2.Instance.$2(_ff.$C));var e=new _fc.$2p(n.children[2],_js.$2.Instance.$2(_ff.$C));var t=new _fce.$39(n.children[1]);t.set_$CS("MessageOptionsView.SensitivityTemplate");var r=new _fc.$A(n.children[0]);return new _B(n,[r,t,e,u,i])},_mcp.$nK,_js.$7,!1,!1,!1,0,_mcp._TI.$1)};_mcp._TI.$9V=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_mcp_2'></span> <span class='_mcp_2'></span> </div><div> <span></span> </div><div> <div class='_mcp_s ms-font-weight-regular ms-font-color-neutralDark'></div> </div><div> <button type='button' class='_mcp_e'></button> <div class='_mcp_u'></div> <div class='_mcp_c'></div> <div class='_mcp_c'></div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_j ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_q'></span> <span class='_mcp_q'></span> </div><div> <span class='_mcp_q'></span> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_n _mcp_o _mcp_p ms-font-weight-regular ms-font-color-neutralSecondary'></span> <div></div> </div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_p ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_p'></span> </div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_7'></span> </div> </div><div> <button autoid=\"_mcp_5\" type='button'></button> <div></div> </div><div> <span class='_mcp_g ms-font-weight-semibold ms-font-color-black'></span> <span class='_mcp_f'></span> </div><div> <div class='_mcp_D'></div>  <div class='ms-bg-color-themePrimary'></div> <div class='_mcp_F'> <div class='_mcp_G ms-font-weight-regular ms-font-color-neutralPrimary'></div> <div>  <div class='_mcp_M'></div> <div class='_mcp_K'> <div class='_mcp_a'> <div class='_mcp_5 _mcp_L _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'></div> </div> <div class='_mcp_5 _mcp_O _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_h ms-font-weight-semibold ms-font-color-black _mcp_C'></button> <div> <div class='_mcp_B'> <button type='button'></button> </div> <div autoid=\"_mcp_0\" class='_mcp_8 _mcp_x'></div> </div> <div> <div class='_mcp_8 _mcp_x'></div> </div> </div> <div class='_mcp_5 _mcp_O _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_h ms-font-weight-semibold ms-font-color-black _mcp_C'></button> <div> <div class='_mcp_B'> <button type='button'></button> </div> <div autoid=\"_mcp_1\" class='_mcp_8 _mcp_x'></div> </div> <div> <div class='_mcp_8 _mcp_x'></div> </div> </div> <div class='_mcp_5 _mcp_O _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_h ms-font-weight-semibold ms-font-color-black _mcp_C'></button> <div> <div class='_mcp_B'> <button type='button'></button> </div> <div autoid=\"_mcp_2\" class='_mcp_8 _mcp_x'></div> </div> <div> <div class='_mcp_8 _mcp_x'></div> </div> </div> <div class='_mcp_5 _mcp_9 _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <span class='_mcp_h ms-font-weight-semibold ms-font-color-black _mcp_k'></span> <div class='_mcp_r'> <button type='button' class='_mcp_w _mcp_m'></button> <span class='_mcp_w _mcp_l'></span> <span class='_mcp_w _mcp_l'></span> <span class='_mcp_w _mcp_l'></span> <div class='_mcp_x'> <input autoid=\"_mcp_3\" class='_mcp_s _mcp_t ms-font-weight-regular ms-font-color-neutralSecondary'/> </div> </div> </div> <div> <div class='_mcp_6 ms-bg-color-white'></div> <div class='_mcp_6 ms-bg-color-white'></div> <div class='_mcp_6 ms-bg-color-white'></div> <div class='_mcp_6'></div> <div class='_mcp_6 ms-bg-color-white'></div> </div> <div> <div class='_mcp_5 ms-bg-color-white'> <div></div> </div> </div> <span></span> </div> <div autoid=\"_mcp_4\" class='_mcp_K ms-bg-color-white'></div> <div class='_mcp_H ms-border-color-neutralTertiary'></div> <div class='_mcp_K ms-bg-color-white'> <span class='_mcp_z ms-font-weight-regular'></span> </div> </div> </div> <div class='_mcp_T _mcp_U'></div> <div></div> <div></div> <div></div> <div></div> <div class='_mcp_E'></div>  </div><div>  <span></span> </div><div> <div class='_mcp_t1 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralSecondaryAlt'></div> </div><div> <button autoid=\"_mcp_c\" type='button' class='_mcp_h1'></button> <div class='_mcp_w1'></div> <div class='_mcp_e1'></div> <div class='_mcp_e1'></div> </div><div> <span class='_mcp_l1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_p1'> <span autoid=\"_mcp_l\" class='_mcp_m1 ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_C1'></span> <span class='_mcp_C1'></span> </div><div> <span class='_mcp_C1'></span> </div><div> <span class='_mcp_l1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_p1'> <div> <span class='_mcp_C1 _mcp_B1 ms-font-weight-regular ms-font-color-neutralSecondary _mcp_D1'></span> <div></div> </div> </div> </div><div> <span class='_mcp_l1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_p1'> <span autoid=\"_mcp_m\" class='_mcp_B1 ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_l1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_p1'> <span autoid=\"_mcp_n\" class='_mcp_B1 ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_l1 ms-font-weight-semibold ms-font-color-black _mcp_n1'></span> <div class='_mcp_p1'> <span class='_mcp_a1'></span> </div> </div><div> <button autoid=\"_mcp_o\" type='button'></button> <div></div> </div><div> <span class='_mcp_j1 ms-font-weight-semibold ms-font-color-black'></span> <span class='_mcp_i1'></span> </div><div> <iframe autoid=\"_mcp_s\" class='_mcp_Y1'></iframe> </div><div> <div class='_mcp_Z1'> <span></span> </div> </div><div> <div class='_mcp_R1'></div> <span class='_mcp_R1'></span> <div class='_mcp_11 ms-bg-color-white'> <div class='_mcp_31'>  <span class='_mcp_51'> <div class='_mcp_M1'> <button autoid=\"_mcp_6\" type='button' class='_mcp_H1 ms-font-weight-regular sendButton'></button> <button type='button' class='_mcp_H1 ms-font-weight-regular sendButton'></button> </div> <div class='_mcp_M1'> <button autoid=\"_mcp_7\" type='button' class='_mcp_H1 ms-font-weight-regular closeButton'></button> </div> <div class='_mcp_M1'> <button autoid=\"_mcp_8\" type='button' class='_mcp_H1 ms-font-weight-regular includeButton'></button> </div> <div class='_mcp_M1'> <button autoid=\"_mcp_9\" type='button' class='_mcp_H1 ms-font-weight-regular _mcp_K1'></button> </div> <button autoid=\"_mcp_a\" type='button' class='_mcp_H1 ms-font-weight-regular'></button> </span> <span class='_mcp_61'> <button autoid=\"_mcp_b\" type='button' class='_mcp_H1 ms-font-weight-regular'></button> </span> </div> <div class='_mcp_41 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> <div class='_mcp_Y'> <div class='_mcp_Z _mcp_X1'></div> <div class='_mcp_Z'> <div class='_mcp_01 ms-bg-color-white customScrollBar'>  <div class='_mcp_71 ms-font-weight-regular'></div> <div class='_mcp_81 _mcp_d1 ms-border-color-neutralTertiary'></div> <div class='_mcp_81 _mcp_b1 _mcp_d1 ms-border-color-neutralTertiary'> <button autoid=\"_mcp_d\" type='button' class='_mcp_k1 ms-font-weight-semibold ms-font-color-black _mcp_V1'></button> <div class='_mcp_p1 _mcp_r1 _mcp_q1'> <div class='_mcp_U1'> <button autoid=\"_mcp_e\" type='button'></button> </div> <div autoid=\"_mcp_f\" class='_mcp_O1'></div> </div> <div class='_mcp_p1 _mcp_r1 _mcp_q1'> <div class='_mcp_O1'></div> </div>  </div> <div class='_mcp_81 _mcp_b1 _mcp_d1 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_k1 ms-font-weight-semibold ms-font-color-black _mcp_V1'></button> <div class='_mcp_p1 _mcp_r1 _mcp_q1'> <div class='_mcp_U1'> <button type='button'></button> </div> <div autoid=\"_mcp_g\" class='_mcp_O1'></div> </div> <div class='_mcp_p1 _mcp_r1'> <div class='_mcp_O1'></div> </div>  </div> <div class='_mcp_81 _mcp_b1 _mcp_d1 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_k1 ms-font-weight-semibold ms-font-color-black _mcp_V1'></button> <div class='_mcp_p1 _mcp_r1 _mcp_q1'> <div class='peoplePickerContainer'> <button type='button'></button> </div> <div autoid=\"_mcp_h\" class='_mcp_O1'></div> </div> <div class='_mcp_p1 _mcp_r1'> <div class='_mcp_O1'></div> </div>  </div> <div class='_mcp_81'> <span class='_mcp_k1 ms-font-weight-semibold ms-font-color-black _mcp_o1 '></span> <span class='_mcp_k1 ms-font-weight-semibold ms-font-color-black _mcp_o1 '></span> </div> <div class='_mcp_81 _mcp_91 _mcp_d1 ms-border-color-neutralTertiary'> <span class='_mcp_k1 ms-font-weight-semibold ms-font-color-black _mcp_o1'></span> <div class='_mcp_p1'> <span class='_mcp_Q1'></span> <span autoid=\"_mcp_i\" class='_mcp_P1'></span> <span autoid=\"_mcp_j\" class='_mcp_P1'></span> <span class='_mcp_P1'></span> <div class='_mcp_O1'> <input autoid=\"_mcp_k\" class='_mcp_t1 _mcp_u1 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralPrimary'/> </div> </div> </div> <div> <div class='_mcp_c1'></div> <div class='_mcp_c1'></div> <div class='_mcp_c1'></div> <div class='_mcp_c1'></div> <div class='_mcp_c1'></div> </div> <div class='_mcp_y1 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_z1'></div> </div> <span></span> <span></span> <div class='_mcp_W ms-bg-color-white'></div> <div class='_mcp_E1 _mcp_F1 ms-font-color-neutralDark'></div> <div class='_mcp_E1 ms-bg-color-white'></div> <div class='_mcp_02 ms-border-color-neutralTertiary'></div> </div> </div> <div></div> <div class='_mcp_S1 ms-bg-color-white'></div> <div autoid=\"_mcp_p\"></div> <div></div> <div></div>  <div autoid=\"_mcp_q\"></div> <div autoid=\"_mcp_r\"></div>     </div><div> <button autoid=\"_mcp_w\" type='button' class='_mcp_32'></button> <button autoid=\"_mcp_x\" type='button' class='_mcp_32'></button> </div><div> <span class='_mcp_12 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div autoid=\"_mcp_t\" class='_mcp_22'></div> <button autoid=\"_mcp_u\" type='button' class='_mcp_32'></button> <button autoid=\"_mcp_v\" type='button' class='_mcp_32'></button>  <div></div> <div class='_mcp_42'></div>  </div><div> <span class='_mcp_52 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_62'></div> <button type='button' class='_mcp_72'></button> <button type='button' class='_mcp_72'></button>  </div>";_js.$F.get_$9N().appendChild(n);return n};_mcp._TI.$D0X=function(n){return n.$Qb};_mcp._TI.$D0W=function(n){return n.$4W2};_mcp._TI.$Eg=function(n){return n.get_$aa()};_mcp._TI.$2RR=function(n){return n.$o1};_mcp._TI.$8ti=function(n){return n.get_$1Rl()};_mcp._TI.$3OM=function(n){return n.get_$E7K()};_mcp._TI.$3OI=function(n){return n.get_$Tb()};_mcp._TI.$2q=function(n){return n.$3U};_mcp._TI.$3m=function(n){return n.get_$1C()};_mcp._TI.$8tj=function(n){return n.$5W7};_mcp._TI.$EA=function(n){return n.$c};_mcp._TI.$56d=function(n){return n.get_$3n()};_mcp._TI.$1VI=function(n){return n.get_$CKR()};_mcp._TI.$8te=function(n){return n.get_$2v5()};_mcp._TI.$2T=function(n){return n.get_$k()};_mcp._TI.$581=function(n){return n.get_$4f8()};_mcp._TI.$582=function(n){return n.get_$6Qj()};_mcp._TI.$8ta=function(n){return n.get_$Ez1()};_mcp._TI.$8tZ=function(n){return n.get_$1pL()};_mcp._TI.$8og=function(n){return n.get_$5Jl()};_mcp._TI.$8td=function(n){return n.get_$50Z()};_mcp._TI.$2RT=function(n){return n.get_$7Mt()};_mcp._TI.$8tl=function(n){return n.get_$7cK()};_mcp._TI.$8to=function(n){return n.get_$9jA()};_mcp._TI.$8tn=function(n){return n.get_$8X4()};_mcp._TI.$Tg=function(n){return n.$3S};_mcp._TI.$79=function(n){return n.get_$ZU()};_mcp._TI.$25M=function(n){return n.$3xl};_mcp._TI.$8tq=function(n){return n.get_$lJ()};_mcp._TI.$3OK=function(n){return n.get_$38b()};_mcp._TI.$3OF=function(n){return n.$65};_mcp._TI.$zh=function(n){return n.get_$1PS()};_mcp._TI.$D0r=function(n){return n.get_$AVU()};_mcp._TI.$8tw=function(n){return n.$5bw};_mcp._TI.$6hA=function(n){return n.$5WW};_mcp._TI.$584=function(n){return n.get_$5cA()};_mcp._TI.$8tk=function(n){return n.$5a};_mcp._TI.$43o=function(n){return n.get_$1X8()};_mcp._TI.$42z=function(n){return n.get_$1AE()};_mcp._TI.$1VJ=function(n){return n.get_$iD()};_mcp._TI.$43l=function(n){return n.$1Zv};_mcp._TI.$8tp=function(n){return n.get_$5yb()};_mcp._TI.$2pI=function(n){return n.get_$2Wk()};_mcp._TI.$43k=function(n){return n.$1NR};_mcp._TI.$e=function(n){return n.$7X};_mcp._TI.$6hC=function(n){return n.$7CG};_mcp._TI.$3ON=function(n){return n.$4GL};_mcp._TI.$6h7=function(n){return n.$1d};_mcp._TI.$1FZ=function(n){return n.get_$jb()};_mcp._TI.$6h9=function(n){return n.get_$a5()};_mcp._TI.$8u6=function(n){return n.get_$AWT()};_mcp._TI.$8of=function(n){return n.get_$ot()};_mcp._TI.$2RS=function(n){return n.$GH};_mcp._TI.$1VH=function(n){return n.get_$E3n()};_mcp._TI.$fo=function(n){return n.get_$4tv()};_mcp._TI.$1VG=function(n){return n.$NE};_mcp._TI.$8u9=function(n){return n.get_$3yO()};_mcp._TI.$6h8=function(n){return n.get_$fJ()};_mcp._TI.$3OH=function(n){return n.$5X};_mcp._TI.$3NY=function(n){return n.get_$fJ()};_mcp._TI.$3OG=function(n){return n.$R5};_mcp._TI.$2RQ=function(n){return n.$GL};_mcp._TI.$8u8=function(n){return n.get_$3vZ()};_mcp._TI.$8oe=function(n){return n.get_$1LG()};_mcp._TI.$2RP=function(n){return n.$Gb};_mcp._TI.$8u7=function(n){return n.get_$3vS()};_mcp._TI.$3Nf=function(n){return n.get_$230()};_mcp._TI.$583=function(n){return n.get_$AGp()};_mcp._TI.$D0a=function(n){return n.$4Gt};_mcp._TI.$8tV=function(n){return n.$2Nh};_mcp._TI.$8ok=function(n){return n.get_$St()};_mcp._TI.$8oj=function(n){return n.get_$PO()};_mcp._TI.$8tr=function(n){return n.get_$C23()};_mcp._TI.$8tb=function(n){return n.$4wP};_mcp._TI.$8od=function(n){return n.get_$Bv()};_mcp._TI.$5K=function(n){return n.get_$1K()};_mcp._TI.$8tY=function(n){return n.get_$6Xg()};_mcp._TI.$8oi=function(n){return n.get_$9kI()};_mcp._TI.$8tX=function(n){return n.get_$2Lq()};_mcp._TI.$8oc=function(n){return n.get_$3FJ()};_mcp._TI.$43m=function(n){return n.get_$eH()};_mcp._TI.$6gp=function(n){return n.get_$9Z()};_mcp._TI.$8o5=function(n){return n.get_$ka()};_mcp._TI.$1qT=function(n){return n.get_$CCM()};_mcp._TI.$43j=function(n){return n.get_$2NL()};_mcp._TI.$6eZ=function(n){return n.get_$MT()};_mcp._TI.$2od=function(n){return n.get_$DX()};_mcp._TI.$6ea=function(n){return n.get_$dk()};_mcp._TI.$1pi=function(n){return n.get_$ma()};_mcp._TI.$6eb=function(n){return n.get_$1vK()};_mcp._TI.$6cY=function(n){return n.get_$7IL()};_mcp._TI.$43n=function(n){return n.get_$7dI()};_mcp._TI.$8tW=function(n){return n.$7H8};_mcp._TI.$6gq=function(n){return n.$7HA};_mcp._TI.$D0s=function(n){return n.get_$AYX()};_mcp._TI.$D0e=function(n){return n.get_$3VH()};_mcp._TI.$42S=function(n){return n.$10O};_mcp._TI.$8ob=function(n){return n.get_$6P()};_mcp._TI.$42R=function(n){return n.$Eq};_mcp._TI.$6h6=function(n){return n.get_$AYT()};_mcp._TI.$6gs=function(n){return n.$qy};_mcp._TI.$3NJ=function(n){return n.$1Q1};_mcp._TI.$Clw=function(n){return n.get_$6P7()};_mcp._TI.$k2=function(n){return n.get_$CGS()};_mcp._TI.$6gv=function(n){return n.$SW};_mcp._TI.$6gu=function(n){return n.$rW};_mcp._TI.$6cW=function(n){return n.$rW};_mcp._TI.$6gw=function(n){return n.$23w};_mcp._TI.$6gz=function(n){return n.$cg};_mcp._TI.$6ca=function(n){return n.$cg};_mcp._TI.$6gx=function(n){return n.$c3};_mcp._TI.$6cX=function(n){return n.$c3};_mcp._TI.$6gy=function(n){return n.$VU};_mcp._TI.$6cZ=function(n){return n.$VU};_mcp._TI.$8tm=function(n){return n.get_$CBb()};_mcp._TI.$8oh=function(n){return n.get_$1gD()};_mcp._TI.$8tt=function(n){return n.$2G};_mcp._TI.$Clz=function(n){return n.get_$5qo()};_mcp._TI.$Cm0=function(n){return n.get_$2NG()};_mcp._TI.$4w=function(n){return n.get_$1C()};_mcp._TI.$D0Z=function(n){return n.$E5};_mcp._TI.$AC=function(n){return n.$3U};_mcp._TI.$HZ=function(n){return n.$7w};_mcp._TI.$Ef=function(n){return n.$5a};_mcp._TI.$HF=function(n){return n.$Vi};_mcp._TI.$DR=function(n){return n.$9B};_mcp._TI.$8tu=function(n){return n.get_$3Lw()};_mcp._TI.$8tg=function(n){return n.$E5};_mcp._TI.$42t=function(n){return n.$G5};_mcp._TI.$6jA=function(n){return n.$G5};_mcp._TI.$D0v=function(n){return n.$1db};_mcp._TI.$3OL=function(n){return n.get_$1dn()};_mcp._TI.$8th=function(n){return n.$5wv};_mcp._TI.$D0j=function(n){return n.$1Za};_mcp._TI.$D0g=function(n){return n.$1Vw};_mcp._TI.$8ts=function(n){return n.get_$2Mg()};_mcp._TI.$8tc=function(n){return n.$4Ti};_mcp._TI.$6h4=function(n){return n.get_$CCC()};_mcp._TI.$3OJ=function(n){return n.get_$5xw()};_mcp._TI.$580=function(n){return n.$Fp};_mcp._TI.$Clv=function(n){return n.get_$3tm()};_mcp._TI.$8tU=function(n){return n.get_$Tb()};_mcp._TI.$D0x=function(n){return n.$5WS};_mcp._TI.$8tv=function(n){return n.$25x};_mcp._TI.$jz=function(n){return n.get_$22R()};_mcp._TI.$1eb=function(n){return n.get_$1C()};_mcp._TI.$1eR=function(n){return n.get_$1C()};_mcp._TI.$fk=function(n){return n.get_$S()};_mcp._TI.$8oN=function(n){return n.get_$2x6()};_mcp._TI.$8oO=function(n){return n.get_$5Wp()};_mcp._TI.$6h5=function(n){return n.get_$1k2()};_mcp._TI.$6gr=function(n){return n.get_$Tb()};_mcp._TI.$D0t=function(n){return n.get_$C0y()};_mcp._TI.$D0u=function(n){return n.get_$2Mn()};_mcp._TI.$Cly=function(n){return n.get_$DlL()};_mcp._TI.$ClA=function(n){return n.get_$3ga()};_mcp._TI.$sA=function(n){return n.$G4};_mcp._TI.$EM=function(n){return n.get_$A()};_mcp._TI.$D0p=function(n){return n.get_$CE1()};_mcp._TI.$D0q=function(n){return n.get_$Emf()};_mcp._TI.$D0o=function(n){return n.get_$C7Z()};_mcp._TI.$D0n=function(n){return n.get_$ACy()};_mcp._TI.$D0m=function(n){return n.get_$A84()};_mcp._TI.$Clx=function(n){return n.get_$19l()};_mcp._TI.$D18=function(n){return n.$6T0};_mcp._TI.$D16=function(n){return n.$18I};_mcp._TI.$D17=function(n){return n.get_$CCZ()};_mcp._TI.$D0w=function(n){return n.$5Vp};_mcp._TI.$D0b=function(n){return n.$1kn};_mcp._TI.$D0c=function(n){return n.$22g};_mcp._TI.$1eY=function(n){return n.$6R};_mcp._TI.$D0y=function(n){return n.get_$7F5()};_mcp._TI.$D0i=function(n){return n.$1YQ};_mcp._TI.$D0h=function(n){return n.$1YN};_mcp._TI.$D10=function(n){return n.$1YX};_mcp._TI.$61=function(n){return n.$HS};_mcp._TI.$D11=function(n){return n.$5Yf};_mcp._TI.$D12=function(n){return n.$1YY};_mcp._TI.$D13=function(n){return n.$5Yj};_mcp._TI.$8u0=function(n){return n.get_$E80()};_mcp._TI.$8tz=function(n){return n.$3WZ};_mcp._TI.$CP=function(n){return n.get_$BJ()};_mcp._TI.$8tx=function(n){return n.$3vx};_mcp._TI.$8u1=function(n){return n.get_$Ebm()};_mcp._TI.$8ty=function(n){return n.$3xj};_mcp._TI.$8u2=function(n){return n.get_$EdP()};_mcp._TI.$D0z=function(n){return n.$5Y6};_mcp._TI.$H=function(n,t){n.set_$1K(t)};_mcp._TI.$Y=function(n,t){n.set_$k(t)};_mcp._TI.$x=function(n,t){n.set_$BP(t)};_mcp._TI.$1V=function(n,t){n.set_$1K(t)};_mcp._TI.$2m=function(n,t){n.set_$4E(t)};_mcp._TI.$3p=function(n,t){n.set_$KU(t)};_mcp._TI.$49=function(n,t){n.set_$1C(t)};_mcp._TI.$3l=function(n,t){n.set_$1C(t)};_mcp._TI.$8=function(n,t){n.set_$17(t)};_mcp._TI.$8tf=function(n,t){n.set_$2v5(t)};_mcp._TI.$ze=function(n,t){n.set_$1lX(t)};_mcp._TI.$Z=function(n,t){n.set_$4k(t)};_mcp._TI.$1p=function(n,t){n.set_$F0(t)};_mcp._TI.$5m=function(n,t){n.set_$aX(t)};_mcp._TI.$60=function(n,t){n.set_$O7(t)};_mcp._TI.$BT=function(n,t){n.set_$Lm(t)};_mcp._TI.$16=function(n,t){n.set_$2P(t)};_mcp._TI.$AM=function(n,t){n.set_$7f(t)};_mcp._TI.$i=function(n,t){n.$6J=t};_mcp._TI.$2Rm=function(n,t){n.$QF=t};_mcp._TI.$6jM=function(n,t){n.$GE=t};_mcp._TI.$OT=function(n,t){n.set_$20(t)};_mcp._TI.$8om=function(n,t){n.set_$3n(t)};_mcp._TI.$5G=function(n,t){n.set_$1K(t)};_mcp._TI.$Yi=function(n,t){n.set_$D6(t)};_mcp._TI.$D0Y=function(n,t){n.set_$9Z(t)};_mcp._TI.$XA=function(n,t){n.set_$2NL(t)};_mcp._TI.$6cg=function(n,t){n.set_$Ea6(t)};_mcp._TI.$6ec=function(n,t){n.set_$MT(t)};_mcp._TI.$2oe=function(n,t){n.set_$DX(t)};_mcp._TI.$6ed=function(n,t){n.set_$dk(t)};_mcp._TI.$1eT=function(n,t){n.set_$ma(t)};_mcp._TI.$6ee=function(n,t){n.set_$1vK(t)};_mcp._TI.$6ci=function(n,t){n.set_$7IL(t)};_mcp._TI.$8lD=function(n,t){n.set_$7H9(t)};_mcp._TI.$6ch=function(n,t){n.set_$7HB(t)};_mcp._TI.$D0f=function(n,t){n.set_$3VH(t)};_mcp._TI.$42T=function(n,t){n.set_$6z7(t)};_mcp._TI.$8ol=function(n,t){n.set_$6P(t)};_mcp._TI.$8lC=function(n,t){n.set_$4wm(t)};_mcp._TI.$6gt=function(n,t){n.set_$Nb(t)};_mcp._TI.$3NK=function(n,t){n.set_$16L(t)};_mcp._TI.$Ccp=function(n,t){n.set_$G6(t)};_mcp._TI.$1pj=function(n,t){n.$2H5=t};_mcp._TI.$2of=function(n,t){n.$Fp=t};_mcp._TI.$2og=function(n,t){n.$Dz=t};_mcp._TI.$3NM=function(n,t){n.$LA=t};_mcp._TI.$55I=function(n,t){n.$1Zv=t};_mcp._TI.$3NL=function(n,t){n.$1NR=t};_mcp._TI.$6cc=function(n,t){n.$SW=t};_mcp._TI.$6h0=function(n,t){n.set_$4nP(t)};_mcp._TI.$6cb=function(n,t){n.set_$4nP(t)};_mcp._TI.$6cd=function(n,t){n.set_$3KY(t)};_mcp._TI.$6h3=function(n,t){n.set_$1wB(t)};_mcp._TI.$6ck=function(n,t){n.set_$1wB(t)};_mcp._TI.$6h1=function(n,t){n.set_$1rj(t)};_mcp._TI.$6ce=function(n,t){n.set_$1rj(t)};_mcp._TI.$6h2=function(n,t){n.set_$1ZP(t)};_mcp._TI.$6cj=function(n,t){n.set_$1ZP(t)};_mcp._TI.$3B=function(n,t){n.set_$VS(t)};_mcp._TI.$Ix=function(n,t){n.set_$SU(t)};_mcp._TI.$FS=function(n,t){n.set_$IC(t)};_mcp._TI.$FR=function(n,t){n.set_$I9(t)};_mcp._TI.$Cm1=function(n,t){n.set_$2NG(t)};_mcp._TI.$4f=function(n,t){n.set_$1C(t)};_mcp._TI.$Dh=function(n,t){n.set_$1C(t)};_mcp._TI.$Dv=function(n,t){n.set_$IC(t)};_mcp._TI.$BU=function(n,t){n.set_$Gy(t)};_mcp._TI.$G8=function(n,t){n.set_$FA(t)};_mcp._TI.$DS=function(n,t){n.set_$I9(t)};_mcp._TI.$8nj=function(n,t){n.set_$7f(t)};_mcp._TI.$8zR=function(n,t){n.set_$7f(t)};_mcp._TI.$LW=function(n,t){n.set_$Br(t)};_mcp._TI.$1m=function(n,t){n.set_$4E(t)};_mcp._TI.$dW=function(n,t){n.set_$2r(t)};_mcp._TI.$aF=function(n,t){n.set_$19q(t)};_mcp._TI.$1ec=function(n,t){n.set_$1C(t)};_mcp._TI.$1eS=function(n,t){n.set_$1C(t)};_mcp._TI.$Yb=function(n,t){n.set_$T1(t)};_mcp._TI.$1c=function(n,t){n.set_$3u(t)};_mcp._TI.$6hB=function(n,t){n.$ZW=t};_mcp._TI.$8m=function(n,t){n.set_$g(t)};_mcp._TI.$D0d=function(n,t){n.set_$2lJ(t)};_mcp._TI.$1f4=function(n,t){n.set_$c8(t)};_mcp._TI.$D0l=function(n,t){n.set_$3aY(t)};_mcp._TI.$D0k=function(n,t){n.set_$3aL(t)};_mcp._TI.$D14=function(n,t){n.set_$PO(t)};_mcp._TI.$4p=function(n,t){n.set_$8x(t)};_mcp._TI.$9x=function(n,t){n.set_$2r(t)};_mcp._TI.$D15=function(n,t){n.set_$St(t)};_mcp._TI.$Cd=function(n,t){n.set_$B5(t)};_mcp._TI.$8u5=function(n,t){n.set_$ER(t)};_mcp._TI.$CQ=function(n,t){n.set_$BJ(t)};_mcp._TI.$8u3=function(n,t){n.set_$Qk(t)};_mcp._TI.$8u4=function(n,t){n.set_$Q1(t)};_mcp._TI.get_$23=function(){_mcp._TI.$47||(_mcp._TI.$47=new _fc.$6Q);return _mcp._TI.$47};_mcp._TI.get_$K=function(){_mcp._TI.$2M||(_mcp._TI.$2M=new _fc.$45);return _mcp._TI.$2M};_mcp._TI.get_$2oK=function(){_mcp._TI.$114||(_mcp._TI.$114=new _cc.$Tl);return _mcp._TI.$114};_mcp._TI.get_$41d=function(){_mcp._TI.$113||(_mcp._TI.$113=new _cc.$Zn);return _mcp._TI.$113};_mcp._TI.get_$vp=function(){_mcp._TI.$Xd||(_mcp._TI.$Xd=new _n.$RN);return _mcp._TI.$Xd};_mcp._TI.get_$8l3=function(){_mcp._TI.$4M7||(_mcp._TI.$4M7=new _b.$1BI);return _mcp._TI.$4M7};_mcp._TI.get_$dS=function(){_mcp._TI.$1P4||(_mcp._TI.$1P4=new _n.$rK);return _mcp._TI.$1P4};_mcp._TI.get_$7u=function(){_mcp._TI.$EE||(_mcp._TI.$EE=new _fce.$F8);return _mcp._TI.$EE};_mcp._TI.get_$hq=function(){_mcp._TI.$Sz||(_mcp._TI.$Sz=new _n.$Oh);return _mcp._TI.$Sz};_mcp._TI.get_$8tT=function(){_mcp._TI.$4Mm||(_mcp._TI.$4Mm=new _mcp.$17u);return _mcp._TI.$4Mm};MailComposeComponent.registerClass("MailComposeComponent",null,_a.$1XU);_mcp.$sG.registerClass("_mcp.$sG",_h.$TO.$$(_g.$aY,_g.$WD));_mcp.$14e.registerClass("_mcp.$14e",_js.$Eb);_mcp.$Gn.registerClass("_mcp.$Gn",_mcp.$14e,_y.$1US,IMailComposeOverridable);_mcp.$Kl.registerClass("_mcp.$Kl",_mcp.$14e,IMailComposeSaveComponent,IMailComposeOverridable);_mcp.$1Ki.registerClass("_mcp.$1Ki",_mcp.$Kl);_mcp.$JP.registerClass("_mcp.$JP",_mcp.$14e);_mcp.$1Kk.registerClass("_mcp.$1Kk");_mcp.$1Kl.registerClass("_mcp.$1Kl",_mcp.$14e);_mcp.$Ov.registerClass("_mcp.$Ov",_mcp.$14e);_mcp.$1Kn.registerClass("_mcp.$1Kn",_mcp.$14e);_mcp.$1Ko.registerClass("_mcp.$1Ko",_mcp.$14e);_mcp.$eR.registerClass("_mcp.$eR",_mcp.$14e);_mcp.$1Kr.registerClass("_mcp.$1Kr",_mcp.$14e);_mcp.$eQ.registerClass("_mcp.$eQ",_mcp.$14e);_mcp.$14f.registerClass("_mcp.$14f",_mcp.$14e);_mcp.$MX.registerClass("_mcp.$MX",_mcp.$14e,_y.$1UV);_mcp.$7x.registerClass("_mcp.$7x",_mcp.$14e);_mcp.$1Kt.registerClass("_mcp.$1Kt",_mcp.$14e);_mcp.$1Ku.registerClass("_mcp.$1Ku",_mcp.$14e,_y.$1UU);_mcp.$1Kv.registerClass("_mcp.$1Kv",_mcp.$14e);_mcp.$MY.registerClass("_mcp.$MY",_mcp.$14e);_mcp.$HY.registerClass("_mcp.$HY",_mcp.$14e,_y.$1Xy);_mcp.$JQ.registerClass("_mcp.$JQ",_js.$Eb);_mcp.$3s.registerClass("_mcp.$3s",_mcp.$14e);_mcp.$IF.registerClass("_mcp.$IF",_mcp.$14e);_mcp.$G6.registerClass("_mcp.$G6",_mcp.$14e,IMailComposeSendComponent,IMailComposeOverridable);_mcp.$1Ky.registerClass("_mcp.$1Ky",_mcp.$14e);_mcp.$1Kx.registerClass("_mcp.$1Kx",_mcp.$14e);_mcp.$G7.registerClass("_mcp.$G7",_mcp.$14e);_mcp.$ub.registerClass("_mcp.$ub",_mcp.$14e,IMailComposeTouchComponent);_mcp.$1L0.registerClass("_mcp.$1L0",_mcp.$14e);_mcp.$1Ks.registerClass("_mcp.$1Ks",_mcp.$14e);_mcp.$1Kw.registerClass("_mcp.$1Kw",_mcp.$14e);_mcp.$1Kp.registerClass("_mcp.$1Kp",_mcp.$14e,_y.$1Ue,_y.$1Uc,_y.$1VA);_mcp.$1L1.registerClass("_mcp.$1L1",null,_y.$13O);_mcp.$1PK.registerClass("_mcp.$1PK",null,ISendEvent);_mcp.$1PL.registerClass("_mcp.$1PL",null,ISendFailedEvent);_mcp.$pW.registerClass("_mcp.$pW",null,ISendFailedO365Event);_mcp.$17r.registerClass("_mcp.$17r",null,ISendFailureRemoveO365Event);_mcp.$1PQ.registerClass("_mcp.$1PQ",null,ISendSucceededEvent);_mcp.$mr.registerClass("_mcp.$mr",null,IMailComposeActionFactory);_mcp.$1Kj.registerClass("_mcp.$1Kj");_mcp.$1Km.registerClass("_mcp.$1Km",null,IMailComposeContextFactory);_mcp.$14h.registerClass("_mcp.$14h",null,IMailComposeViewModelFactory,_bc.$1JX);_mcp.$13y.registerClass("_mcp.$13y",_a.$Em);_mcp.$uZ.registerClass("_mcp.$uZ",_js.$Eb,_y.$1UX);_mcp.$V.registerClass("_mcp.$V",_a.$1aV,_g.$1Uk,_y.$1Ur,_bc.$1Va);_mcp.$ua.registerClass("_mcp.$ua",null,IMailComposeDiscardManager);_mcp.$1W.registerClass("_mcp.$1W",_a.$10n);_mcp.$1Kz.registerClass("_mcp.$1Kz");_mcp.$8m.registerClass("_mcp.$8m",_y.$1aq,_y.$Cy,_y.$IB,_bc.$m7,_a.$1Xr,_js.$13h,Sys.IDisposable,_y.$13i,_y.$tZ,_bc.$Ki,_bc.$dz,_y.$IA,IMailComposeOverridable);_mcp.$uk.registerClass("_mcp.$uk",_a.$Em,_y.$1Ut);_mcp.$14l.registerClass("_mcp.$14l",null,IMailResponseViewModelFactory);_mcp.$nK.registerClass("_mcp.$nK",_a.$Em);_mcp.$vx.registerClass("_mcp.$vx");_mcp.$1My.registerClass("_mcp.$1My");_mcp.$1Oi.registerClass("_mcp.$1Oi");_mcp.$17u.registerClass("_mcp.$17u",null,_js.$1K7);_mcp.$sX.registerClass("_mcp.$sX",_js.$F,_b.$1Iv);_mcp.$1.registerClass("_mcp.$1");_mcp.$mt.registerClass("_mcp.$mt",_js.$7);_mcp.$mv.registerClass("_mcp.$mv",_js.$7,_ff.$FA);_mcp.$mv.$y0.registerClass("_mcp.$mv.$y0");_mcp._TI.registerClass("_mcp._TI");_mcp.$Gn.$5lv=new _H("AttachmentWellViewModel",_y.$1IE,_mcp.$Gn);_mcp.$Gn.$24N=new _H("Menu",_fm.$1t,_mcp.$14e);_mcp.$JP.$6Vv=new _y.$2Y(_u.CommonStrings.l_LoadingPermissions_LowerCase_Text,null,null);_mcp.$Ov.$24N=new _H("Menu",_fm.$1t,_mcp.$Ov);_mcp.$eQ.$3TF=[6800,3200,3205,3210,3215,3220,3100,3105,3110,3115,3120,3250,3255,3260];_mcp.$MX.$wI=[84,85,86,87];_mcp.$7x.$64A=new _H("FromDetailsViewModel",_pe.$95,_mcp.$7x);_mcp.$7x.$72k=new _H("SenderDetailsViewModel",_pe.$95,_mcp.$7x);_mcp.$7x.$6WD=new _H("LocationViewModel",_cc.$Ca,_mcp.$7x);_mcp.$7x.$6Qk=new _H("IsMeetingForwardOnBehalfOf",Boolean,_mcp.$7x);_mcp.$7x.$DvQ=new _H("RecurrencePatternDataObject",_cc.$Ci,_mcp.$7x);_mcp.$JQ.$2tK=7;_mcp.$JQ.$5KR=1;_mcp.$3s.$6z9=new _H("ResizeEditorCommand",_js.$Cs,_mcp.$3s);_mcp.$Kl.$wI=[60,40,43,1001,700,50,800,88,89];_mcp.$IF.$24N=new _H("Menu",_fm.$1t,_mcp.$IF);_mcp.$G6.$6Xd=10;_mcp.$G6.$8ac="MailSatisfactionSurvey";_mcp.$G6.$wI=[62,45,46,47,700,55,70,65,66,75,800,88,80,48,89];_mcp.$G7.$9lD=_a.UserAgent.getInstance().$Ea?_js.$9.$5M("{0}{0}","<P></P>"):_js.$9.$5M("{0}{0}","<P><BR></P>");_mcp.$G7.$9Ju=new RegExp("[\n\r]+","g");_mcp.$V.$7Nx=new _H("ViewModelId",String,_mcp.$V);_mcp.$V.$47u=new _H("Operation",_y.$1m,_mcp.$V);_mcp.$V.$25w=new _H("Mode",_y.$Ow,_mcp.$V);_mcp.$V.$6qP=new _H("OriginalId",_g.$1T,_mcp.$V);_mcp.$V.$6qN=new _H("OriginalDocumentId",Number,_mcp.$V);_mcp.$V.$6qQ=new _H("OriginalItem",_g.$11,_mcp.$V);_mcp.$V.$5yu=new _H("DraftId",_g.$1T,_mcp.$V);_mcp.$V.$7G7=new _H("StoreId",String,_mcp.$V);_mcp.$V.$qA=new _H("Subject",String,_mcp.$V,"");_mcp.$V.$71k=new _H("SelectedDataCallContext",_fm.$1Ib,_mcp.$V);_mcp.$V.$37l=new _H("EditorContent",String,_mcp.$V,"");_mcp.$V.$6vh=new _H("RawEditorContent",String,_mcp.$V);_mcp.$V.$7IM=new _H("TextEditorContent",String,_mcp.$V);_mcp.$V.$5n6=new _H("BodyType",String,_mcp.$V);_mcp.$V.$2aO=new _H("ToRecipients",_js.$I9,_mcp.$V);_mcp.$V.$5Z2=new _H("SpeechResultRecipients",_js.$I9,_mcp.$V);_mcp.$V.$3cX=new _H("ToQueryString",String,_mcp.$V);_mcp.$V.$2EX=new _H("CcRecipients",_js.$I9,_mcp.$V);_mcp.$V.$33V=new _H("CcQueryString",String,_mcp.$V);_mcp.$V.$2Dq=new _H("BccRecipients",_js.$I9,_mcp.$V);_mcp.$V.$32G=new _H("BccQueryString",String,_mcp.$V);_mcp.$V.$5Vm=new _H("AutoAddSignature",Boolean,_mcp.$V,!0);_mcp.$V.$3G7=new _H("Importance",String,_mcp.$V,"Normal");_mcp.$V.$6vT=new _H("QuotedBody",String,_mcp.$V);_mcp.$V.$7F2=new _H("SmimeContent",String,_mcp.$V);_mcp.$V.$7F4=new _H("SmimeErrorCode",Number,_mcp.$V);_mcp.$V.$7F6=new _H("SmimeRecipientCerts",Array,_mcp.$V);_mcp.$V.$7F7=new _H("SmimeSigningCert",String,_mcp.$V);_mcp.$V.$6OT=new _H("IsComplete",Boolean,_mcp.$V);_mcp.$V.$4w2=new _H("IsMeeting",Boolean,_mcp.$V);_mcp.$V.$6Ql=new _H("IsMeetingForward",Boolean,_mcp.$V);_mcp.$V.$6S3=new _H("IsReplyAllOnBcc",Boolean,_mcp.$V);_mcp.$V.$3Km=new _H("Location",_g.$3Q,_mcp.$V);_mcp.$V.$6Je=new _H("HasLocation",Boolean,_mcp.$V);_mcp.$V.$6Xm=new _H("MeetingCalendarTimePeriod",_cc.$85,_mcp.$V);_mcp.$V.$6v3=new _H("ProposedNewTime",_cc.$9c,_mcp.$V);_mcp.$V.$2II=new _H("From",_g.$8v,_mcp.$V);_mcp.$V.$72l=new _H("Sender",_g.$8v,_mcp.$V);_mcp.$V.$6TT=new _H("IsUpgraded",Boolean,_mcp.$V);_mcp.$V.$6PZ=new _H("IsFromShown",Boolean,_mcp.$V);_mcp.$V.$6O5=new _H("IsBccShown",Boolean,_mcp.$V);_mcp.$V.$3SS=new _H("ParentFolderNameToPost",String,_mcp.$V);_mcp.$V.$6rU=new _H("ParentFolderIdToPost",_g.$38,_mcp.$V);_mcp.$V.$2Dj=new _H("AttachmentCollection",_js.$X,_mcp.$V);_mcp.$V.$5lr=new _H("AttachmentsToHide",Array,_mcp.$V);_mcp.$V.$7Mv=new _H("UpgradeFailed",Boolean,_mcp.$V);_mcp.$V.$5mh=new _H("Baseline",_mcp.$1W,_mcp.$V);_mcp.$V.$6JL=new _H("HasBeenSavedByUser",Boolean,_mcp.$V);_mcp.$V.$6S5=new _H("IsReplyForward",Boolean,_mcp.$V);_mcp.$V.$5yv=new _H("Draft",_g.$11,_mcp.$V);_mcp.$V.$6zv=new _H("RightsManagementLicenseData",_g.$gj,_mcp.$V);_mcp.$V.$341=new _H("ComplianceId",String,_mcp.$V);_mcp.$V.$6OK=new _H("IsClassified",Boolean,_mcp.$V);_mcp.$V.$5q5=new _H("ClassificationGuid",String,_mcp.$V);_mcp.$V.$5q7=new _H("Classification",String,_mcp.$V);_mcp.$V.$5q4=new _H("ClassificationDescription",String,_mcp.$V);_mcp.$V.$5q6=new _H("ClassificationKeep",Boolean,_mcp.$V);_mcp.$V.$3Wa=new _H("Sensitivity",String,_mcp.$V,"Normal");_mcp.$V.$3HX=new _H("IsDeliveryReceiptRequested",Boolean,_mcp.$V);_mcp.$V.$3Iq=new _H("IsReadReceiptRequested",Boolean,_mcp.$V);_mcp.$V.$3af=new _H("SmimeEncryptMessage",Boolean,_mcp.$V);_mcp.$V.$3ai=new _H("SmimeSignMessage",Boolean,_mcp.$V);_mcp.$V.$34Y=new _H("ConversationId",_g.$1T,_mcp.$V);_mcp.$V.$6rR=new _H("ParentConversationNodeId",String,_mcp.$V);_mcp.$V.$6RN=new _H("IsOriginalIdCalendarItemId",Boolean,_mcp.$V);_mcp.$V.$6RF=new _H("IsOccurrenceReferencingMaster",Boolean,_mcp.$V);_mcp.$V.$6Rb=new _H("IsPoppedOutFromInline",Boolean,_mcp.$V);_mcp.$V.$6QR=new _H("IsLoadedDraft",Boolean,_mcp.$V);_mcp.$V.$7ON=new _H("WasCleanNewMessageBeforePopout",Boolean,_mcp.$V);_mcp.$V.$6KU=new _H("HideIncludeEntrypoint",Boolean,_mcp.$V,!1);_mcp.$V.$7OP=new _H("WasSavingBeforePopout",Boolean,_mcp.$V,!1);_mcp.$V.$6R4=new _H("IsMovedToDraftFromOutbox",Boolean,_mcp.$V,!1);_mcp.$V.$6s3=new _H("PerfContext",_a.$5U,_mcp.$V,null);_mcp.$V.$6s2=new _H("PerfContextE2E",_a.$5U,_mcp.$V,null);_mcp.$V.$7OS=new _H("WaterfallTraceStarted",Boolean,_mcp.$V,null);_mcp.$V.$9OR=new _H("RichTextEditorSupported",Boolean,_mcp.$V,null);_mcp.$V.$6LA=new _H("HtmlSupportedProperty",Boolean,_mcp.$V,null);_mcp.$V.$5yW=new _H("DlpSenderOverride",String,_mcp.$V,null);_mcp.$V.$5yV=new _H("DlpFalsePositive",String,_mcp.$V,null);_mcp.$V.$5yU=new _H("DlpDetectedClassification",String,_mcp.$V,null);_mcp.$V.$61e=new _H("ExplicitLogonUser",String,_mcp.$V,null);_mcp.$V.$6Lk=new _H("IncludeOriginalFromInToRecipients",Boolean,_mcp.$V,!1);_mcp.$V.$2HX=new _H("ExtendedPropertyCollection",_js.$X,_mcp.$V,null);_mcp.$V.$6RH=new _H("IsOnDemandUpgradeRequested",Boolean,_mcp.$V,!1);_mcp.$V.$6SC=new _H("IsResumingSendFailure",Boolean,_mcp.$V,!1);_mcp.$V.$6Jp=new _H("HasSentViaNotification",Boolean,_mcp.$V,!1);_mcp.$V.$72n=new _H("SendFailureInfobarMessageId",_bc.InfoBarMessageId,_mcp.$V,45);_mcp.$V.$aW=new _H("PopoutPerfContext",_a.$5U,_mcp.$V);_mcp.$V.$5xV=new _H("DiagnosticContent",String,_mcp.$V);_mcp.$V.$4Ka="UseOverride";_mcp.$V.$1gs=null;_mcp.$V.$$cctor();_mcp.$1W.$qA=new _H("Subject",String,_mcp.$1W,"");_mcp.$1W.$37l=new _H("EditorContent",String,_mcp.$1W,"");_mcp.$1W.$2aO=new _H("ToRecipients",_js.$X,_mcp.$1W);_mcp.$1W.$3cX=new _H("ToQueryString",String,_mcp.$1W);_mcp.$1W.$2EX=new _H("CcRecipients",_js.$X,_mcp.$1W);_mcp.$1W.$33V=new _H("CcQueryString",String,_mcp.$1W);_mcp.$1W.$2Dq=new _H("BccRecipients",_js.$X,_mcp.$1W);_mcp.$1W.$32G=new _H("BccQueryString",String,_mcp.$1W);_mcp.$1W.$3G7=new _H("Importance",String,_mcp.$1W,"Normal");_mcp.$1W.$2II=new _H("From",_g.$1K,_mcp.$1W);_mcp.$1W.$341=new _H("ComplianceId",String,_mcp.$1W);_mcp.$1W.$3Wa=new _H("Sensitivity",String,_mcp.$1W,"Normal");_mcp.$1W.$3HX=new _H("IsDeliveryReceiptRequested",Boolean,_mcp.$1W);_mcp.$1W.$3Iq=new _H("IsReadReceiptRequested",Boolean,_mcp.$1W);_mcp.$1W.$3af=new _H("SmimeEncryptMessage",Boolean,_mcp.$1W);_mcp.$1W.$3ai=new _H("SmimeSignMessage",Boolean,_mcp.$1W);_mcp.$1W.$2Dj=new _H("AttachmentCollection",_js.$X,_mcp.$1W);_mcp.$1W.$2HX=new _H("ExtendedPropertyCollection",_js.$X,_mcp.$1W,null);_mcp.$1W.$4bd=new _a.$C8(_g.$1K);_mcp.$1W.$$cctor();_mcp.$uk.$L=_a.$0.$15;_mcp._TI._hf=_mcp._TI.$9V();_mcp._TI.$47=null;_mcp._TI.$2M=null;_mcp._TI.$114=null;_mcp._TI.$113=null;_mcp._TI.$Xd=null;_mcp._TI.$4M7=null;_mcp._TI.$1P4=null;_mcp._TI.$EE=null;_mcp._TI.$Sz=null;_mcp._TI.$4Mm=null;_mcp._TI.$1={};_mcp._TI.$$cctor();
window.scriptsLoaded['microsoft.exchange.clients.owa2.client.mail.compose.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.exchange.clients.owa2.client.mail.compose.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
